{"evaluation": {"episode_reward_max": -5171.335022032261, "episode_reward_min": -5171.335022032261, "episode_reward_mean": -5171.335022032261, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5171.335022032261], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1881.3127236366272, "episode_reward_min": -14075.393624573946, "episode_reward_mean": -5164.3728257053535, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3305.731960505247, -2147.7166624069214, -3496.139536380768, -7980.8973996937275, -5168.970385789871, -4361.951659619808, -7520.790738046169, -4120.469264388084, -7805.45442661643, -4627.8080068826675, -3915.2752436995506, -3758.7843891084194, -6704.917393684387, -7139.933518856764, -5066.736934751272, -2596.2274283766747, -5004.914333283901, -4519.949294090271, -5610.114912897348, -7435.211905807257, -4797.284302175045, -5473.162486732006, -5253.295640975237, -3519.549624323845, -2596.5982297062874, -3133.701182693243, -2817.2459116876125, -7238.844004720449, -3379.0074684619904, -4571.063658237457, -4970.969218373299, -6096.086606234312, -2903.9230846762657, -10954.201054781675, -3836.3757969141006, -3489.2002009153366, -6908.261439949274, -4494.399181574583, -5189.937999159098, -4985.443651407957, -4144.734982341528, -7229.325259447098, -5144.823547184467, -2738.7220271527767, -2967.1151627898216, -5673.774946630001, -4662.931334733963, -4778.056497395039, -6195.615413844585, -6726.324708342552, -14075.393624573946, -5255.620734483004, -6966.096744149923, -9371.306305497885, -4253.4406307935715, -2686.249658405781, -2523.081529200077, -3234.1434487700462, -9908.70496326685, -11753.242005467415, -5189.424605488777, -2764.2944188416004, -2548.546890795231, -4983.257159173489, -6110.340183287859, -3997.7240284085274, -5234.563386619091, -3419.878309547901, -3604.699578642845, -2401.027222752571, -11803.323660463095, -5263.2978928387165, -4741.771813511848, -3285.7392304837704, -4655.345117241144, -6359.581491023302, -2313.5867844522, -7812.641968280077, -4334.746945112944, -6193.043865978718, -3495.991527199745, -7854.294843047857, -3995.890648573637, -6689.754461497068, -6653.28217163682, -3726.316396743059, -3562.4942429065704, -5738.513551533222, -8509.365591228008, -4008.478148728609, -4455.718145370483, -3844.80374661088, -4151.015918761492, -4719.149727940559, -5014.812766581774, -3789.798022687435, -7251.809569627047, -6047.410579770803, -11675.661436587572, -3898.4021679759026, -2419.273595571518, -4603.27236661315, -2802.24721211195, -5018.97874802351, -9421.151520341635, -3762.3203843832016, -12302.520362615585, -1881.3127236366272, -6866.464622467756, -3459.883027046919, -2937.040446817875, -5877.562880516052, -4395.061859428883, -3201.0167900025845, -4308.885324954987, -3028.130234479904, -7805.888317197561, -3298.7505918443203, -6578.247822850943, -3501.3550297617912, -4793.472892135382, -4755.764247119427, -3013.8231915831566, -3789.258187890053, -3336.867389857769, -7589.958275049925, -2265.168723374605, -3372.6039496064186, -3058.6613356769085, -7517.242467880249, -5877.395262360573, -6900.5485163629055, -5860.5814217329025, -3564.267017364502, -6098.216435134411, -5860.247115641832, -3623.5132232904434, -6717.133179664612, -5319.238081037998, -2325.856223374605, -4335.588445335627, -3650.13825109601, -3280.0005056262016, -5530.6171661913395, -3901.06887871027, -4964.319682896137, -5799.878430515528, -4667.58773124218, -5180.805444538593, -5097.605714887381, -11270.790843844414, -4194.368008166552, -3328.943131506443, -9829.24724239111, -3355.8217808008194, -3002.8307015001774, -4430.0101608633995, -5404.967248618603, -9853.957200944424, -4407.169447571039, -5394.796050101519, -3054.1544748544693, -3046.7723225951195, -13623.75507697463, -4088.2582971155643, -10383.352146476507, -7927.400582432747, -4066.416031330824, -8517.353442132473, -2067.476070523262, -3247.8718814253807, -8261.28643232584, -6265.709628522396, -5821.381127119064, -4754.286399841309, -4357.53472083807, -5633.75178077817, -7486.839426159859, -6144.32259196043, -4534.936458259821, -9990.366635024548, -3073.016131967306, -3941.684223264456, -3638.7803958058357, -4065.576766550541, -8920.566476017237, -4630.058638811111, -3106.6038422584534, -2453.901318460703, -6307.45144662261, -3103.6098316013813, -7657.708002090454, -6606.451817512512, -3850.375198304653, -5941.523444771767, -4303.15589633584, -5266.393345713615, -3775.582313388586, -2649.074278384447, -4405.25098952651, -5611.911879599094, -5761.794811010361, -2085.7590842843056, -3140.4620569348335, -4819.527643829584, -4256.970369756222, -8944.56515237689, -5580.192991256714, -8355.771208912134, -3237.2176840901375, -6061.306281358004, -7313.978730350733, -2951.3528015613556, -5808.854856729507, -4397.357415556908, -5616.888658106327, -9074.276944935322, -4701.889214456081, -2724.8677284121513, -4420.476151317358, -5934.576291024685, -3906.344025492668, -6917.6706519424915, -5394.619969844818, -4515.623166054487, -3599.5503473877907, -6502.762754589319, -7984.385562181473, -3417.370041459799, -3515.5011909008026, -4592.697933673859, -8979.925576716661, -7976.947327524424, -4204.735762119293, -2966.0073024630547, -6206.06615871191, -6896.458004325628, -6891.151008844376, -2563.168151527643, -2554.4695878624916, -3726.0131561160088, -3962.545921444893, -5088.381940901279, -5290.932565361261, -6334.5742463469505, -6911.056851893663, -5220.417932242155, -3259.2032031416893, -4072.473541676998, -8944.446816921234, -3052.430915683508, -6171.510265737772, -11138.364983409643, -3719.9187945723534, -8102.153425842524, -4524.403329312801, -3825.8142065107822, -3033.0775535702705, -4366.51469913125, -3601.162973791361, -4350.323698967695, -3737.578037470579, -8723.354706436396, -4769.8017599880695, -4479.257313579321, -8201.948427528143, -3232.2351925969124, -7279.280784517527, -3380.441909313202, -4731.026006489992, -7173.745739042759, -6874.446710526943, -4317.308888047934, -6785.070921868086, -5091.791464745998, -5299.824643313885, -5190.878719508648, -5461.183282285929, -7027.54557877779, -7459.42751199007, -7913.297253191471, -6645.312036126852, -7017.875275075436, -4203.992859989405, -2081.752736032009, -2011.3565680086613, -5036.936005949974, -2671.8831304609776, -3962.8396680653095, -4222.04425996542, -3144.503184258938, -6054.505547255278, -7830.756294667721, -3884.6355540454388, -3547.259292155504, -5989.50832504034, -4229.710065186024, -5641.116960942745, -5058.376442015171, -3944.1298239827156, -2989.815746843815, -4790.388033777475, -6973.861893683672, -6289.175703674555, -2448.510307967663, -7998.5075614750385, -3745.5820985138416, -3406.0126819312572, -7768.259997308254, -4217.681207150221, -8410.854398965836, -5469.935016870499, -4079.4587590694427, -2910.503982067108, -2820.835145443678, -2259.7188225984573, -2776.703709810972, -2255.0789097845554, -3778.738802433014, -3575.838234603405], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.558214980932483, "mean_inference_ms": 4.545534156165716, "mean_action_processing_ms": 4.279248192446152, "mean_env_wait_ms": 3.1364981246141843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 131040, "timesteps_this_iter": 131040, "agent_timesteps_total": 131040, "timers": {"sample_time_ms": 24740.636, "sample_throughput": 5296.549, "load_time_ms": 58.258, "load_throughput": 2249302.63, "learn_time_ms": 15452.178, "learn_throughput": 8480.358, "update_time_ms": 2.663}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.19999999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 402.65259729884815, "policy_loss": -0.001701961845700084, "vf_loss": 80.53204802372977, "vf_explained_var": -0.000136080715391371, "kl": 5.0491503636821194e-05, "entropy": -0.16474361250370634, "entropy_coeff": 0.001}}}, "num_steps_sampled": 131040, "num_agent_steps_sampled": 131040, "num_steps_trained": 131040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 131040}, "done": false, "episodes_total": 320, "training_iteration": 1, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-23-54", "timestamp": 1691000634, "time_this_iter_s": 107.94271492958069, "time_total_s": 107.94271492958069, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 107.94271492958069, "timesteps_since_restore": 131040, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 40.02322580645161, "ram_util_percent": 92.72129032258064}}
{"evaluation": {"episode_reward_max": -3188.5990592837334, "episode_reward_min": -3188.5990592837334, "episode_reward_mean": -3188.5990592837334, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3188.5990592837334], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1605.0217930078506, "episode_reward_min": -14508.611102849245, "episode_reward_mean": -5390.653506449237, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4609.483263522387, -5376.690047621727, -3922.63916310668, -3930.707632571459, -3730.061654150486, -7720.074413567781, -7061.927724152803, -7025.880756556988, -10138.315882205963, -3321.7332307100296, -2813.320159137249, -6262.583706229925, -3317.6814981400967, -9789.682620286942, -11821.473125457764, -3328.8255343437195, -6076.39035987854, -3457.823846012354, -3771.972761154175, -7039.528697192669, -4339.668086528778, -6863.892160743475, -4113.164047628641, -4772.5933928489685, -4596.9398256242275, -11157.091855853796, -5853.2294082939625, -6485.500340491533, -5522.079042941332, -4332.967182606459, -6615.162501960993, -1605.0217930078506, -13993.83980178833, -8861.733566522598, -2297.6982451975346, -3943.4971129000187, -8381.587721645832, -3700.4021539092064, -3125.2564592659473, -3814.860194891691, -9769.026297867298, -3546.131516367197, -7104.736931294203, -3948.4396496117115, -4189.728133201599, -2973.855847477913, -7436.927960246801, -2776.9287669360638, -7216.239351987839, -4919.982156902552, -6759.083552211523, -5255.155946582556, -2918.2058955430984, -5672.997111290693, -5503.0588310062885, -5516.487899452448, -3664.7160424292088, -9924.411225944757, -4068.273622274399, -4936.97922334075, -5360.6168040037155, -4623.866440623999, -8428.28075632453, -1649.751153767109, -2691.0814864337444, -9371.669970333576, -9459.712020158768, -3976.3373233377934, -7837.949445724487, -2789.9563670158386, -5755.718646585941, -3039.2789315879345, -6273.192232936621, -11216.270020097494, -3582.5274319946766, -7388.257418513298, -3635.9353294074535, -5091.271837174892, -5665.432147920132, -9203.771745920181, -4798.362614899874, -8001.1935977339745, -3450.9899428486824, -8292.166122198105, -4691.692324191332, -4677.756610691547, -6751.038033008575, -5210.970582276583, -9411.174301624298, -5066.0357638299465, -6484.722497135401, -7003.521528929472, -6637.849202036858, -4139.423458695412, -3844.1922359764576, -3883.9477991461754, -7093.453216671944, -5111.077605158091, -8846.629011690617, -4168.3359208106995, -3937.8419414162636, -6328.450064480305, -3733.1502076387405, -7749.775010466576, -7089.578861832619, -3484.457963258028, -4567.408603698015, -4535.049658566713, -7311.130457043648, -2683.947128236294, -4694.226600527763, -2586.4014272391796, -3916.135706335306, -5224.669606238604, -8312.402517914772, -2649.0807733237743, -6574.389338552952, -4426.5616081357, -7756.525911003351, -7094.498847514391, -3227.0170980095863, -7281.252600818872, -4918.23967975378, -3913.180468350649, -4821.437059670687, -3263.2952598929405, -5360.542753905058, -5750.390372663736, -2094.4197769761086, -5937.282393544912, -12884.070930480957, -3865.456680506468, -4334.717737048864, -5619.49991440773, -2476.3955053687096, -7633.620734214783, -3357.1673298478127, -3076.463939458132, -11771.685709863901, -4226.886116743088, -6138.684955209494, -4601.826245605946, -4219.424018800259, -8141.580196768045, -13091.937866806984, -2701.950533747673, -5032.624030828476, -4545.203320801258, -5110.248732179403, -4086.743777215481, -5998.9212945103645, -7117.198454260826, -5925.208776205778, -4130.894979804754, -2958.093544214964, -3678.255348920822, -7236.671959996223, -4412.293457567692, -2940.5272854566574, -6645.283437877893, -3368.0100869834423, -3965.719762325287, -5071.365280747414, -5552.675682067871, -7388.425240963697, -13295.691460847855, -6261.450946033001, -10921.548684448004, -9852.83164101839, -6401.338863700628, -7772.527432739735, -5812.788377612829, -1998.1807126998901, -3466.704324990511, -2623.371278345585, -3527.9943650066853, -4084.343791216612, -2109.20475846529, -3189.06494101882, -3133.850858837366, -2502.631819188595, -3702.2710351347923, -2863.2169293761253, -3311.6995671391487, -3133.5393011569977, -2946.368559986353, -3553.1044912934303, -4314.690318256617, -4520.849863648415, -9468.084604114294, -4936.2089031636715, -6611.837139040232, -6062.3636193573475, -4243.665166705847, -5942.790925651789, -4602.430465996265, -3711.656767398119, -14351.100189447403, -4320.56708535552, -4710.837789654732, -3571.6949228942394, -4562.166893750429, -5427.593792527914, -4520.516217947006, -3782.4364926218987, -5602.2938014268875, -6648.2207907140255, -7108.878472447395, -2010.6528269052505, -8043.648775994778, -5174.480107754469, -10167.208142369986, -4607.818719655275, -7060.578983724117, -10616.372604846954, -2169.9772869348526, -3192.20892482996, -5374.535377532244, -6686.346667945385, -3797.7395454347134, -8085.175233274698, -4194.772736012936, -3919.4025656580925, -7894.575563043356, -3266.082860648632, -5014.386836528778, -3823.7284050881863, -4570.87873634696, -7255.036175727844, -2843.1706967651844, -2725.7058924138546, -10043.78626382351, -4145.276121228933, -6652.108698219061, -14394.966209083796, -3525.6448779702187, -1725.140683978796, -3386.9672713577747, -4644.964100658894, -5158.221445769072, -3047.498180925846, -2276.482369720936, -5951.165123343468, -2925.269829839468, -7631.815893441439, -4765.680474668741, -8928.570433408022, -5267.4903492331505, -3693.6180854439735, -4654.239332675934, -4759.387485057116, -5528.7149459421635, -12418.501855105162, -9099.983732044697, -6508.222659409046, -3106.5674967467785, -5217.927666515112, -10366.250764369965, -4380.770960330963, -2797.8026201725006, -5396.562050551176, -4590.256984323263, -4124.052308678627, -3332.7428929507732, -3793.838459044695, -4029.0374374091625, -7762.150572031736, -4573.391312092543, -5496.033867955208, -5471.872486770153, -2314.1138433218002, -2747.519842326641, -3480.4381438195705, -4286.67739713192, -5696.61344730854, -4238.959952771664, -4606.064156264067, -4172.828216850758, -4558.115089744329, -6086.539594203234, -5852.453992307186, -3273.7621770203114, -4114.844071477652, -6544.55965384841, -2580.9222613871098, -5988.128022491932, -5535.150925457478, -2570.871993482113, -6642.91064491868, -4506.233113765717, -4694.332288444042, -4690.441395372152, -9989.320275992155, -8706.082525163889, -5444.993538439274, -7085.782939046621, -2489.5777920484543, -9424.258525162935, -4100.427272349596, -7215.228795289993, -3361.5661328732967, -2994.8093396127224, -4392.734593153, -4793.405294328928, -3287.2636722028255, -5355.6597256064415, -3825.9674212932587, -3199.617901235819, -3501.800080180168, -3761.1874237656593, -3950.2685179412365, -6554.188126653433, -6172.093799591064, -3733.193444043398, -5675.172589957714, -3870.243827521801, -4675.859104514122, -4244.43952152133, -11354.6599881351, -2896.0255092978477, -4113.1844700574875, -3819.2039281725883, -4013.2583672106266, -8213.925460398197, -7379.716820836067, -7044.926164984703, -4525.854494661093, -5101.874558001757, -3574.188554286957, -10523.157061457634, -3327.0856387019157, -4144.764834403992, -4045.344231635332, -3952.949491262436, -2998.0324279367924, -5895.124054998159, -3571.2397100925446, -2338.352856129408, -6371.200072616339, -3934.57245567441, -4411.195471048355, -3493.6424562633038, -6339.126184940338, -7114.751898795366, -4160.58808657527, -4691.539775133133, -5050.658340841532, -4306.936217337847, -4661.295104801655, -2928.9136250317097, -10638.43645453453, -4567.4148645401, -4866.899417221546, -10075.383734107018, -5914.051027923822, -4841.8841197788715, -5713.0852726101875, -11122.216129153967, -5258.669198840857, -3568.3505575954914, -4626.830433636904, -4916.659870326519, -4882.984256058931, -6057.125234186649, -2652.142640709877, -3329.585663795471, -2808.1549185216427, -5099.677734434605, -4199.625895380974, -7275.481491416693, -3906.233339637518, -2019.9036792218685, -3464.585560232401, -3838.7790467739105, -6941.210448622704, -8073.289260715246, -6317.862099587917, -4800.579089790583, -5758.776276767254, -4520.298323512077, -3204.718816667795, -3845.8872731924057, -3961.1516415178776, -3067.7551562786102, -5760.933778941631, -2156.1238651275635, -6502.831289619207, -4237.643330127001, -6789.470740258694, -4863.265464663506, -9791.818822979927, -8355.326963841915, -10345.774381488562, -5591.616599500179, -8493.564586997032, -4615.988933563232, -3309.0263544619083, -4604.169706493616, -3845.1581858098507, -5200.307708144188, -4420.928067237139, -3936.9034376442432, -3869.890615105629, -4489.684964418411, -6077.707634150982, -7659.590650647879, -5815.61205124855, -4270.450872689486, -3852.802419155836, -7517.914297640324, -4383.40621855855, -10230.136282980442, -7750.929789632559, -6892.269722759724, -4963.738571792841, -10018.889455467463, -7196.4658063054085, -5294.218794196844, -3239.410777449608, -3622.823143720627, -5981.290711551905, -5957.05191886425, -11085.37616404891, -4140.611303627491, -1996.8692404031754, -6583.940292149782, -4949.737619191408, -5588.12635833025, -5762.4258797466755, -2516.9982430934906, -6027.922521859407, -4270.154051989317, -3018.083492219448, -6025.208535403013, -2738.5422571599483, -3525.8634432554245, -8521.853232264519, -9677.169971704483, -7825.981941878796, -4474.665706723928, -5697.108728557825, -12381.19586917758, -3019.4333006441593, -5798.7006540596485, -5277.331049054861, -4192.0236856639385, -3865.2204317450523, -7079.67754894495, -3446.2893810272217, -5525.769102662802, -3245.761677503586, -6189.960202991962, -5332.124313354492, -3477.4616661667824, -3278.1138568520546, -5818.521048694849, -2294.8380386531353, -5854.157502561808, -7371.21706110239, -5704.383921533823, -4594.785717636347, -6099.95193529129, -2713.116130679846, -6174.496245145798, -2224.3404766619205, -2697.262639284134, -14508.611102849245, -6416.3567724227905, -11241.061271190643, -3903.4003308415413, -5076.2114643752575, -3173.449434787035, -2420.661080390215, -7997.628288298845, -5149.7283373475075, -6809.584086209536, -7656.1137509047985, -9196.942108511925, -3522.2236062288284, -3352.9067561626434], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.487746497670523, "mean_inference_ms": 4.455179207275053, "mean_action_processing_ms": 4.20945205518236, "mean_env_wait_ms": 3.082333386987908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 262080, "timesteps_this_iter": 131040, "agent_timesteps_total": 262080, "timers": {"sample_time_ms": 65867.222, "sample_throughput": 1989.457, "load_time_ms": 45.334, "load_throughput": 2890516.503, "learn_time_ms": 15211.825, "learn_throughput": 8614.351, "update_time_ms": 2.428}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.09999999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 402.1919536977205, "policy_loss": 0.005673838329921533, "vf_loss": 80.43248238785719, "vf_explained_var": -0.0003082881477998576, "kl": 0.0006923622033369729, "entropy": -0.16693468415929424, "entropy_coeff": 0.001}}}, "num_steps_sampled": 262080, "num_agent_steps_sampled": 262080, "num_steps_trained": 262080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 262080}, "done": false, "episodes_total": 800, "training_iteration": 2, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-24-33", "timestamp": 1691000673, "time_this_iter_s": 38.619765520095825, "time_total_s": 146.5624804496765, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 146.5624804496765, "timesteps_since_restore": 262080, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.30545454545453, "ram_util_percent": 73.91636363636364}}
{"evaluation": {"episode_reward_max": -12079.526084631681, "episode_reward_min": -12079.526084631681, "episode_reward_mean": -12079.526084631681, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12079.526084631681], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1996.8692404031754, "episode_reward_min": -14508.611102849245, "episode_reward_mean": -5544.92300634116, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3204.718816667795, -3845.8872731924057, -3961.1516415178776, -3067.7551562786102, -5760.933778941631, -2156.1238651275635, -6502.831289619207, -4237.643330127001, -6789.470740258694, -4863.265464663506, -9791.818822979927, -8355.326963841915, -10345.774381488562, -5591.616599500179, -8493.564586997032, -4615.988933563232, -3309.0263544619083, -4604.169706493616, -3845.1581858098507, -5200.307708144188, -4420.928067237139, -3936.9034376442432, -3869.890615105629, -4489.684964418411, -6077.707634150982, -7659.590650647879, -5815.61205124855, -4270.450872689486, -3852.802419155836, -7517.914297640324, -4383.40621855855, -10230.136282980442, -7750.929789632559, -6892.269722759724, -4963.738571792841, -10018.889455467463, -7196.4658063054085, -5294.218794196844, -3239.410777449608, -3622.823143720627, -5981.290711551905, -5957.05191886425, -11085.37616404891, -4140.611303627491, -1996.8692404031754, -6583.940292149782, -4949.737619191408, -5588.12635833025, -5762.4258797466755, -2516.9982430934906, -6027.922521859407, -4270.154051989317, -3018.083492219448, -6025.208535403013, -2738.5422571599483, -3525.8634432554245, -8521.853232264519, -9677.169971704483, -7825.981941878796, -4474.665706723928, -5697.108728557825, -12381.19586917758, -3019.4333006441593, -5798.7006540596485, -5277.331049054861, -4192.0236856639385, -3865.2204317450523, -7079.67754894495, -3446.2893810272217, -5525.769102662802, -3245.761677503586, -6189.960202991962, -5332.124313354492, -3477.4616661667824, -3278.1138568520546, -5818.521048694849, -2294.8380386531353, -5854.157502561808, -7371.21706110239, -5704.383921533823, -4594.785717636347, -6099.95193529129, -2713.116130679846, -6174.496245145798, -2224.3404766619205, -2697.262639284134, -14508.611102849245, -6416.3567724227905, -11241.061271190643, -3903.4003308415413, -5076.2114643752575, -3173.449434787035, -2420.661080390215, -7997.628288298845, -5149.7283373475075, -6809.584086209536, -7656.1137509047985, -9196.942108511925, -3522.2236062288284, -3352.9067561626434], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.544394856828452, "mean_inference_ms": 4.418004406222844, "mean_action_processing_ms": 4.25207021512242, "mean_env_wait_ms": 3.0442091578108075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 393120, "timesteps_this_iter": 131040, "agent_timesteps_total": 393120, "timers": {"sample_time_ms": 49008.301, "sample_throughput": 2673.833, "load_time_ms": 34.423, "load_throughput": 3806753.417, "learn_time_ms": 14920.593, "learn_throughput": 8782.493, "update_time_ms": 2.417}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04999999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 401.50961611749614, "policy_loss": -0.01358251096591415, "vf_loss": 80.3152839633299, "vf_explained_var": -0.0005056129561530219, "kl": 0.001143190209352408, "entropy": -0.16581920942952555, "entropy_coeff": 0.001}}}, "num_steps_sampled": 393120, "num_agent_steps_sampled": 393120, "num_steps_trained": 393120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 393120}, "done": false, "episodes_total": 800, "training_iteration": 3, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-24-48", "timestamp": 1691000688, "time_this_iter_s": 14.613614320755005, "time_total_s": 161.17609477043152, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 161.17609477043152, "timesteps_since_restore": 393120, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.576190476190474, "ram_util_percent": 74.88095238095237}}
{"evaluation": {"episode_reward_max": -6085.108941495419, "episode_reward_min": -6085.108941495419, "episode_reward_mean": -6085.108941495419, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6085.108941495419], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1388.7136935591698, "episode_reward_min": -14153.719854474068, "episode_reward_mean": -4156.790239832612, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7183.232490122318, -2842.94980224967, -4580.337824344635, -4467.617614209652, -3749.4428516328335, -5205.7406605780125, -3120.9646066129208, -4398.149374365807, -4874.633901000023, -6214.41834372282, -1814.96987169981, -4031.167301505804, -2591.0244429707527, -4821.234333306551, -6219.702843248844, -14153.719854474068, -4434.3215935230255, -2281.502370774746, -5723.209732234478, -4051.443667024374, -3974.647947639227, -3866.352272719145, -4615.4068557322025, -4864.190014153719, -4500.307073771954, -4400.566123187542, -2695.866210669279, -6088.230923146009, -5506.635706812143, -4642.960984051228, -6525.235006600618, -3650.64997279644, -2587.1614919900894, -4562.382117331028, -2173.849716037512, -3624.7150017917156, -7329.026230990887, -8944.230170428753, -8363.972408920527, -2466.814822137356, -1619.3722533881664, -3834.4729954004288, -2755.433391571045, -3294.664496779442, -5545.582639187574, -6402.826760262251, -5304.691652625799, -2352.7813085615635, -4121.178309887648, -3264.9408586919308, -2227.925655156374, -4445.130058765411, -4045.135377407074, -2094.778283983469, -3120.8219415843487, -2363.6512298583984, -6391.017271965742, -3138.0139390826225, -3276.1826435923576, -5359.984658032656, -3186.895423710346, -4741.002254873514, -2090.5585989952087, -3135.0237920880318, -1990.0840401947498, -4280.682189881802, -8028.241358160973, -2489.5773656070232, -3716.0857951045036, -2499.2237817943096, -2610.258423626423, -6412.252092272043, -4287.572772651911, -8211.398205280304, -1760.837554216385, -3089.7509300112724, -2584.649127691984, -2064.893398016691, -3307.204284876585, -7602.265072822571, -1821.2099433243275, -4168.407577782869, -5702.343244433403, -2597.43017244339, -2550.120616108179, -3222.49301558733, -3037.1743657290936, -2291.2838984429836, -5136.787495344877, -5588.878934115171, -3066.5711851119995, -3459.490540623665, -3282.037845939398, -6369.857336491346, -1388.7136935591698, -4245.873587787151, -3264.1555745899677, -4064.5921308100224, -13944.353424459696, -6219.910467237234, -3918.6780363321304, -4784.672595232725, -3166.9825898110867, -13525.192691206932, -3895.5181741416454, -1740.5262907147408, -8598.498788356781, -3452.813347518444, -5590.779335677624, -3367.891577988863, -3587.1465099155903, -4060.405034095049, -4053.3819603323936, -3088.837706029415, -2999.075380295515, -4382.477820396423, -4535.508818358183, -3164.433459699154, -5296.017762392759, -2973.0346978902817, -4230.285557806492, -3332.8707473278046, -4706.205116420984, -9270.038992077112, -4267.281165629625, -6310.270433545113, -5236.0053914785385, -2418.3846701085567, -3570.0791592001915, -3518.1265612840652, -4934.467162281275, -2742.4334827959538, -6029.143928170204, -8852.707956194878, -4694.868990719318, -3409.9086121320724, -2372.2424148619175, -2894.5543779432774, -2418.9719128012657, -2947.908669054508, -1840.0073193311691, -2921.4175163805485, -2984.7059611678123, -2635.3870446681976, -3792.369341701269, -2091.464102715254, -2916.1491905152798, -3601.2689400315285, -4436.119662344456, -2902.7368329763412, -11630.96139511466, -2086.9393758177757, -5940.208386510611, -3818.1940636336803, -2498.595028668642, -6095.994278788567, -3572.6433592140675, -3017.6385211348534, -2091.8184827268124, -4173.928212106228, -4813.010771512985, -4715.984869897366, -4973.394275099039, -2560.088199496269, -2267.59805855155, -1677.627793341875, -6303.455822348595, -2826.925060123205, -2544.0468840003014, -2763.9866902530193, -3554.9361424148083, -6735.248454898596, -2037.2525216639042, -3319.296800583601, -1935.8843462765217, -3282.9218613803387, -2577.8853546977043, -2673.9186823666096, -3160.926053225994, -5231.6067237854, -1795.668611586094, -3071.1981666088104, -3820.040649563074, -4168.904672384262, -3679.4330727159977, -5711.087507635355, -5891.49629253149, -4537.819873124361, -3367.072847187519, -4331.646139740944, -2427.71984320879, -2438.609304845333, -7060.310407429934, -2880.5614644289017, -7478.157476425171, -7124.063313961029, -6893.3961762189865, -2467.2093735039234, -4550.470904201269, -5384.260351270437, -4056.46902269125, -11434.528176486492, -4964.1760584414005, -2716.4910429418087, -3155.49052169919, -5330.519908964634, -5435.230476111174, -7604.5874072909355, -5629.203055113554, -2720.933698773384, -6714.289559930563, -5464.435633510351, -4631.187218785286, -5339.447630614042, -3095.3447570204735, -1874.841385602951, -5456.545446038246, -3129.3302493989468, -6546.489697128534, -10203.05314642191, -5476.044156253338, -4736.65983325243, -6136.927672803402, -4081.4690756201744, -4091.8438706696033, -4124.6066181361675, -2500.415824562311, -6798.794140219688, -3722.676264822483, -5327.49572712183, -2896.584209948778, -2285.4729768633842, -3870.1295452415943, -5522.33485558629, -3747.5448846817017, -5567.499259233475, -2091.8363734185696, -3379.261333614588, -3691.0664824545383, -1965.0338186621666, -3408.7547464370728, -5094.5259011387825, -5080.161161601543, -2508.17530426383, -3999.3126371204853, -3811.8578005731106, -3359.3739707171917, -3513.47140789032, -1976.1441288590431, -2144.074721366167, -5608.309628427029, -1947.9770957529545, -3145.0585843920708, -2566.0709833800793, -3300.3952501416206, -3545.385286092758, -12743.244049042463, -3032.524447977543, -4594.763771921396, -6532.470704942942, -2685.767361611128, -3203.5373467803, -3835.2702362835407, -4226.805223017931, -2728.9998538196087, -3193.866365134716, -3716.345267057419, -3864.1314909756184, -3111.4854089319706, -1765.6274956166744, -3260.6646190583706, -8137.107468396425, -2489.972118228674, -2662.9355675280094, -2826.5755899250507, -6486.192821323872, -4365.249695509672, -2401.3066554665565, -3827.707205206156, -5127.092768520117, -3213.266903460026, -3585.0227878689766, -3881.007298707962, -5758.680798858404, -3008.909880697727, -3094.7416999936104, -2172.5142042040825, -3248.300803601742, -5118.109330296516, -1705.3824770748615, -9848.018266826868, -5382.392027795315, -4643.345036536455, -5733.9359965622425, -8357.545947670937, -10022.278072834015, -5030.414949804544, -5390.134051471949, -12356.474334299564, -3053.02524420619, -4332.373655438423, -5100.738996744156, -3677.2760729193687, -3870.3106620013714, -5971.969419062138, -3403.7356800436974, -8139.722228705883, -4753.574502766132, -3725.9875923395157, -3873.2775191664696, -7912.921963989735, -2607.7878974974155, -3397.063584268093, -2981.8530969023705, -3653.6921966075897, -4615.5795540213585, -5385.783792048693, -4066.769401848316, -3505.192868977785, -10836.273457080126, -1608.6185917258263, -1864.9581254124641, -2234.5727817714214, -4609.217204928398, -2388.7092786431313, -2433.3317601680756, -2256.1329694092274, -3146.2729659080505, -2883.833329886198, -2893.2298480272293, -3413.7185147702694, -3442.87468200922, -2915.5396332144737, -3362.819869160652, -5747.103921562433, -3174.1394827365875, -4006.287035703659, -6257.356253057718, -5329.488167613745, -5312.231303304434, -4259.48966896534, -2882.6247506141663, -2333.0503754019737, -1645.9344564080238, -2678.8342355787754, -4316.189364910126, -3195.0594617426395, -2865.8575451672077, -3794.314459949732, -3754.440054446459, -2564.9900279045105, -2506.931978583336, -2847.410524278879, -4893.511571794748, -6506.53985863924, -2090.4053458869457, -1693.4035024642944, -3220.5076812803745, -3194.2287313342094, -3448.4416568279266, -4752.87839281559, -2930.325193285942, -1404.576402246952, -4494.6729310154915, -3988.2608910799026, -2264.5735879540443, -3631.3796993494034, -3459.9068785607815, -2498.0572488904, -3214.3922603428364, -4087.012148797512, -3023.1762255728245, -4879.155392974615, -2701.9646151959896, -4152.241150259972, -2938.3345259428024, -3396.1976934075356, -3417.4755839407444, -3521.9859878718853, -4242.9616487026215, -6174.807751059532, -3555.5872389376163, -2025.186059385538, -2498.9845086038113, -10690.020256072283, -8243.330867171288, -5141.707187950611, -2939.5214931964874, -5279.245400547981, -2308.4149321615696, -4550.788371056318, -4947.503166437149, -3270.6960377693176, -3773.6354134082794, -4663.369786500931, -3092.0430093705654, -2986.4815647900105, -2661.861032128334, -2236.4574329555035, -3079.318409472704, -6734.952287316322, -3698.1975294053555, -6157.530015945435, -6992.967344522476, -2322.5368277430534, -4470.038556963205, -2636.093410283327, -5489.875349789858, -3306.3325984179974, -4191.678169310093, -4152.948784917593, -5039.374621510506, -3026.4364362955093, -3021.877394556999, -4519.187650233507, -4852.016092658043, -4939.981766521931, -2617.2438657283783, -2538.487226575613, -5677.834169924259, -5513.791357189417, -4031.743496954441, -8995.804099142551, -2482.6979909539223, -1702.009763777256, -5299.556548953056, -3207.051445275545, -2778.7085949778557, -3040.341146618128, -3028.1173810064793, -3405.355740815401, -4339.733969420195, -4023.2429923415184, -7419.551498502493, -1955.0797837078571, -5823.961905092001, -3195.1851370334625, -5126.995107412338, -2550.4345083534718, -3222.24634835124, -3929.177671313286, -4111.677054852247, -1975.9708572626114, -5123.321440935135, -3025.0635319054127, -3430.0965226590633, -3634.3169692754745, -4263.296069800854, -3240.606659799814, -3057.7860343158245, -4237.136121720076, -3422.777138978243, -1631.4437409341335, -2949.6982990801334, -2567.7400605380535, -2246.2564341127872, -5335.598423868418, -4559.364152729511, -2511.0892992317677, -5546.430503666401, -4416.195176333189, -4835.687766253948, -5101.883376479149, -5968.985792905092, -2990.760985136032, -3399.1705800890923, -2560.7575428187847, -2744.8946009278297, -4040.8756805062294, -1915.257632523775, -3277.668187558651, -2820.853141695261, -3068.623677790165, -3327.047592997551, -11662.685403764248, -2481.27290558815, -3202.969262421131, -5030.195115566254, -4806.537712663412, -5395.481847673655], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.449543142024045, "mean_inference_ms": 4.453599597584276, "mean_action_processing_ms": 4.188914134208275, "mean_env_wait_ms": 3.084236851380275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 524160, "timesteps_this_iter": 131040, "agent_timesteps_total": 524160, "timers": {"sample_time_ms": 46285.159, "sample_throughput": 2831.145, "load_time_ms": 32.125, "load_throughput": 4079066.632, "learn_time_ms": 15034.136, "learn_throughput": 8716.164, "update_time_ms": 2.401}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.024999999999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 400.78044386938217, "policy_loss": 0.0038858643379048926, "vf_loss": 80.1520040915431, "vf_explained_var": -0.0009603924435099393, "kl": 0.0013192966561603422, "entropy": -0.16746126929812108, "entropy_coeff": 0.001}}}, "num_steps_sampled": 524160, "num_agent_steps_sampled": 524160, "num_steps_trained": 524160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 524160}, "done": false, "episodes_total": 1280, "training_iteration": 4, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-25-27", "timestamp": 1691000727, "time_this_iter_s": 39.15027451515198, "time_total_s": 200.3263692855835, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 200.3263692855835, "timesteps_since_restore": 524160, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.564285714285724, "ram_util_percent": 74.63214285714285}}
{"evaluation": {"episode_reward_max": -4213.128893136978, "episode_reward_min": -4213.128893136978, "episode_reward_mean": -4213.128893136978, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4213.128893136978], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1631.4437409341335, "episode_reward_min": -11662.685403764248, "episode_reward_mean": -4054.9280980214476, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6174.807751059532, -3555.5872389376163, -2025.186059385538, -2498.9845086038113, -10690.020256072283, -8243.330867171288, -5141.707187950611, -2939.5214931964874, -5279.245400547981, -2308.4149321615696, -4550.788371056318, -4947.503166437149, -3270.6960377693176, -3773.6354134082794, -4663.369786500931, -3092.0430093705654, -2986.4815647900105, -2661.861032128334, -2236.4574329555035, -3079.318409472704, -6734.952287316322, -3698.1975294053555, -6157.530015945435, -6992.967344522476, -2322.5368277430534, -4470.038556963205, -2636.093410283327, -5489.875349789858, -3306.3325984179974, -4191.678169310093, -4152.948784917593, -5039.374621510506, -3026.4364362955093, -3021.877394556999, -4519.187650233507, -4852.016092658043, -4939.981766521931, -2617.2438657283783, -2538.487226575613, -5677.834169924259, -5513.791357189417, -4031.743496954441, -8995.804099142551, -2482.6979909539223, -1702.009763777256, -5299.556548953056, -3207.051445275545, -2778.7085949778557, -3040.341146618128, -3028.1173810064793, -3405.355740815401, -4339.733969420195, -4023.2429923415184, -7419.551498502493, -1955.0797837078571, -5823.961905092001, -3195.1851370334625, -5126.995107412338, -2550.4345083534718, -3222.24634835124, -3929.177671313286, -4111.677054852247, -1975.9708572626114, -5123.321440935135, -3025.0635319054127, -3430.0965226590633, -3634.3169692754745, -4263.296069800854, -3240.606659799814, -3057.7860343158245, -4237.136121720076, -3422.777138978243, -1631.4437409341335, -2949.6982990801334, -2567.7400605380535, -2246.2564341127872, -5335.598423868418, -4559.364152729511, -2511.0892992317677, -5546.430503666401, -4416.195176333189, -4835.687766253948, -5101.883376479149, -5968.985792905092, -2990.760985136032, -3399.1705800890923, -2560.7575428187847, -2744.8946009278297, -4040.8756805062294, -1915.257632523775, -3277.668187558651, -2820.853141695261, -3068.623677790165, -3327.047592997551, -11662.685403764248, -2481.27290558815, -3202.969262421131, -5030.195115566254, -4806.537712663412, -5395.481847673655], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.508761665482194, "mean_inference_ms": 4.417760665205529, "mean_action_processing_ms": 4.238773973726469, "mean_env_wait_ms": 3.0511110798667027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 655200, "timesteps_this_iter": 131040, "agent_timesteps_total": 655200, "timers": {"sample_time_ms": 40158.507, "sample_throughput": 3263.07, "load_time_ms": 28.499, "load_throughput": 4598089.527, "learn_time_ms": 15096.356, "learn_throughput": 8680.241, "update_time_ms": 2.397}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012499999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 400.0324250352548, "policy_loss": -0.00042183379491734884, "vf_loss": 80.00671811941277, "vf_explained_var": -0.0019159020061561283, "kl": 0.00143185625099794, "entropy": -0.17224307854970297, "entropy_coeff": 0.001}}}, "num_steps_sampled": 655200, "num_agent_steps_sampled": 655200, "num_steps_trained": 655200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 655200}, "done": false, "episodes_total": 1280, "training_iteration": 5, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-25-43", "timestamp": 1691000743, "time_this_iter_s": 15.587624549865723, "time_total_s": 215.91399383544922, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 215.91399383544922, "timesteps_since_restore": 655200, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 16.31818181818182, "ram_util_percent": 74.85454545454544}}
{"evaluation": {"episode_reward_max": -3582.5426836907864, "episode_reward_min": -3582.5426836907864, "episode_reward_mean": -3582.5426836907864, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3582.5426836907864], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1228.6127269268036, "episode_reward_min": -10947.538973629475, "episode_reward_mean": -3255.527053050014, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3868.809246689081, -2573.1269418001175, -3978.458453565836, -4131.604659616947, -1994.8945116996765, -2934.5154097676277, -2739.118028998375, -3863.8477156460285, -1602.2067199647427, -2174.1219748854637, -4279.637651413679, -4554.084868550301, -6234.309776514769, -5213.307303965092, -4829.827805966139, -2531.12214499712, -5751.164009839296, -4545.256559073925, -5286.132409274578, -4311.4556413292885, -6256.112290650606, -2949.8387277424335, -2958.815006941557, -1622.0706820487976, -2308.749651879072, -2943.625287950039, -4045.914863049984, -4623.389387577772, -5903.3186792731285, -3161.9706053733826, -3662.389000594616, -2094.490209430456, -4014.818176627159, -2925.8662462830544, -3123.406678766012, -3076.12722492218, -1935.3086112737656, -2597.5151336193085, -2746.8525978922844, -2882.011679559946, -5210.50216293335, -2941.935582190752, -2976.08251157403, -2759.156002432108, -3816.20126375556, -1595.6719215512276, -3020.583794414997, -3341.1656236350536, -1531.1610461473465, -2499.9527166187763, -2527.0817960202694, -3015.3262653052807, -2631.6897572875023, -4041.229977965355, -2126.4189627170563, -2884.045872837305, -2335.862113326788, -3198.344187438488, -1875.8753505945206, -1701.166505664587, -3920.68403878808, -5042.802202671766, -5130.259676575661, -2338.811558544636, -2243.255754262209, -2145.1724341213703, -2567.4172296226025, -2384.3969321250916, -1823.899091243744, -2037.798362225294, -3615.450419843197, -4674.758482307196, -10133.471055269241, -2064.770801335573, -6219.376519203186, -3267.2874911129475, -3858.8446383476257, -2738.509672999382, -3064.982730448246, -1711.2620632648468, -2780.4970366060734, -2360.3313850164413, -1903.0498568415642, -2027.053785085678, -1804.5909122228622, -2078.254705965519, -2728.735865831375, -4827.207594156265, -1416.3447585999966, -5192.6437193751335, -2154.567671775818, -1811.4425234496593, -3794.4602583944798, -2740.195426315069, -2605.3561771810055, -2112.2318130731583, -3099.4348852932453, -4275.983143121004, -8099.945508629084, -6174.9463693499565, -2805.5356037020683, -3612.2662030756474, -6591.753619760275, -3005.7174611985683, -3226.0332965552807, -1906.9891681671143, -1929.8124745190144, -2866.2888708412647, -3639.1017223596573, -10947.538973629475, -4755.506176024675, -4005.1911156475544, -2739.7551001906395, -2576.47770306468, -3557.05469712615, -3085.1816631257534, -2024.4522403478622, -2522.196040868759, -3060.4041100144386, -2564.6515033245087, -7246.626614063978, -2564.5564185082912, -2239.685830593109, -2206.403634518385, -1314.8903932273388, -3717.4977290332317, -3933.365481644869, -5677.206095606089, -5476.071112304926, -1642.8537085652351, -3703.3348262906075, -1928.735977679491, -2935.578139811754, -2063.450617045164, -5250.699530482292, -2404.3211148679256, -2327.8629684746265, -2356.5605735480785, -5665.737055152655, -6942.240056723356, -1919.6522139310837, -1604.206843584776, -1905.191154628992, -3267.783703893423, -2678.1021123230457, -2267.236953407526, -3882.83977073431, -1228.6127269268036, -1388.6984006762505, -1516.9828634858131, -2689.9261823296547, -2602.298159688711, -1846.2147353291512, -3189.3580608665943, -3955.250338047743, -1572.789643138647, -2495.2854392826557, -1914.2065077126026, -5815.630723536015, -5842.431588083506, -2219.1885680556297, -3492.2840448617935, -3660.3833396434784, -1764.2995980083942, -1599.310302555561, -1245.682109028101, -1341.0448518395424, -2979.0802441239357, -1715.6324453651905, -4797.384901106358, -3032.36662119627, -3053.3818674981594, -1783.0734841525555, -2033.943147301674, -3868.815386325121, -3561.661553531885, -1424.8143910467625, -3743.560994952917, -2474.94533136487, -2285.294223487377, -2047.6483482718468, -1935.373008131981, -5035.37223598361, -3131.973282814026, -4032.183342218399, -2726.008199483156, -2235.291199415922, -2013.939869403839, -2975.3821842372417, -1807.956054508686, -4259.616376668215, -2123.610618531704, -5252.059402823448, -3245.4529261291027, -6399.496077716351, -6159.809572279453, -2525.961168587208, -3770.1767411231995, -5314.550573557615, -2788.651596367359, -5103.848670333624, -4485.4680680036545, -2068.8937878012657, -2384.960458010435, -2496.1690349578857, -8120.653204679489, -2483.7591521143913, -4736.54432746768, -2060.883939474821, -7255.536663264036, -1669.3111534714699, -5270.124907433987, -6595.299956083298, -3271.8212913274765, -3029.795551121235, -2368.5190111994743, -3559.1621879935265, -2140.853138387203, -6984.327363073826, -2690.1829683482647, -4268.410882622004, -5618.7365601062775, -3457.2398610711098, -2947.7961857914925, -2392.0125099122524, -3264.953259855509, -4399.669597834349, -1474.3709461987019, -2582.7280903458595, -4859.963521718979, -2998.3341030180454, -3290.643857806921, -3588.329834371805, -2096.868544191122, -2320.593714296818, -1872.6312868595123, -2433.2407743632793, -3085.814798682928, -3563.6928848922253, -3878.183322519064, -5260.5701087117195, -2548.7720482349396, -2355.0267644822598, -2202.8450257778168, -4181.867950409651, -3396.3866026699543, -2962.137841761112, -1432.1254644095898, -2553.6452203392982, -3934.8906700909138, -1746.9187938869, -6369.096019089222, -4644.446881949902, -2691.2153929769993, -1600.653946518898, -2339.3189926445484, -2326.504415243864, -4549.631518214941, -3469.483783006668, -5917.431855350733, -1941.9833379983902, -1738.8187433481216, -3803.925753593445, -2793.0365903675556, -2918.6467839181423, -2062.402159243822, -3175.5162422657013, -3854.772318303585, -2590.5088787674904, -3397.88375762105, -2122.379198163748, -4301.05631724, -5912.476193457842, -4606.724505096674, -2180.6205382347107, -2415.9983346760273, -2869.322783946991, -2373.0835113823414, -1564.1010344028473, -2301.165887117386, -3002.96041315794, -4268.211352914572, -2400.128722399473, -2240.324662297964, -2022.0572463870049, -2451.2053682804108, -1720.5826560556889, -3183.0956296622753, -4796.549556821585, -4009.914967417717, -1800.9642115533352, -3312.2428199648857, -3535.276891052723, -3409.298478871584, -1970.980046480894, -1920.6815553605556, -2549.4905704557896, -3651.74270093441, -1828.287876933813, -2020.8858679533005, -5049.98551645875, -3341.840151309967, -4375.454202502966, -4323.090512216091, -6868.26086166501, -6531.135498821735, -5098.396537870169, -2327.031903833151, -2963.4214856624603, -3721.3463571965694, -1525.8138891756535, -3308.489876538515, -4402.039161652327, -5035.390449911356, -3865.059723138809, -3142.964312374592, -2496.381382972002, -3476.356725782156, -2866.800843000412, -2283.235342025757, -2379.774789839983, -3061.8081156611443, -3618.797812819481, -2240.9771626889706, -2989.7977235615253, -2973.176206678152, -1907.0830932855606, -7325.6098774671555, -4461.556325435638, -1705.6204431355, -1348.7093449532986, -2834.980527460575, -2906.520462989807, -3399.6573657393456, -2169.5322290956974, -3133.6962038874626, -2543.178819000721, -2795.3129563629627, -4604.880043715239, -3400.3189276456833, -3828.5589129924774, -3868.982060343027, -3941.4867687523365, -2176.2574315667152, -3723.4791985452175, -3625.970052987337, -1438.7865356206894, -2486.3072639405727, -3050.2403216063976, -1903.9195759892464, -1992.1281359493732, -4134.464770704508, -2695.8735384345055, -4188.806386440992, -1750.6203905642033, -6757.287157475948, -2600.175098478794, -2021.1850698590279, -2744.6414197981358, -1774.7638473808765, -2590.5496248304844, -1869.3177156746387, -3167.8521416783333, -3806.2493256926537, -3275.8594972789288, -2080.4397370517254, -4934.519076138735, -1688.5763013064861, -2962.943191885948, -1893.3394961953163, -2142.4567073881626, -1995.5178222954273, -2586.979464620352, -2340.999090284109, -2497.526882261038, -3422.9478571414948, -2900.606936752796, -2070.054551035166, -3709.4568341970444, -2563.556255489588, -4776.143215447664, -1538.0871258080006, -2892.340264469385, -3878.6737031936646, -2380.324663102627, -5139.413474321365, -2089.388751089573, -1756.2770865261555, -3033.3512295782566, -5993.542608618736, -6109.032047748566, -6869.7564360797405, -10825.58994564414, -2145.9747362434864, -1883.3590715527534, -4072.6438734531403, -3044.9872449934483, -3471.0367719233036, -3050.2990561425686, -3664.5497612953186, -3557.7002865970135, -1786.0297880470753, -5649.144830614328, -1595.4924975335598, -2286.4904969632626, -3272.072892576456, -2929.489174067974, -10908.07443112135, -2030.2589420676231, -1746.4014939963818, -3669.422261983156, -3944.4812617897987, -4765.490875452757, -5690.159771800041, -3829.462942659855, -3992.5584992170334, -2106.476280450821, -3692.445259064436, -4582.960243344307, -3663.8450583815575, -2888.327592730522, -5231.1795654296875, -4693.677779614925, -3209.86753231287, -3614.3478412032127, -2090.527687072754, -1268.2732663154602, -4628.615453839302, -1431.0943657457829, -2441.0344217717648, -1772.0715683996677, -3612.0697625279427, -2723.4624998271465, -3313.370371848345, -2273.708622455597, -5514.719771504402, -1615.9093982577324, -2600.510229855776, -2564.80074891448, -3593.0563925802708, -2436.2215316295624, -2063.7559131979942, -2595.476324260235, -2703.6227083802223, -3479.7001016438007, -3191.6583433151245, -1730.061730414629, -1959.1582789123058, -2428.0902916789055, -2307.524122953415, -3207.3285298645496, -1680.755121588707, -2393.5624644458294, -1957.0894793868065, -4515.1102214455605, -2841.948861718178, -3225.9735976159573, -4915.516079723835, -2613.7342024743557, -4217.990977525711, -2290.1539610624313, -1986.909726947546, -3034.9267904162407, -1861.9227911233902, -4193.827039986849, -3650.2852445542812, -5684.223174840212, -2423.189455896616, -3756.723200649023, -3048.485901027918, -2149.936839669943, -2744.936944872141, -1625.0117503404617, -3272.263624280691, -6341.457388073206, -3734.358869820833, -1232.0205903053284, -2443.306517213583, -2019.3329765498638, -1933.3373569846153], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402453058267357, "mean_inference_ms": 4.437560167435413, "mean_action_processing_ms": 4.178325014564612, "mean_env_wait_ms": 3.0702112468015486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 786240, "timesteps_this_iter": 131040, "agent_timesteps_total": 786240, "timers": {"sample_time_ms": 40022.839, "sample_throughput": 3274.131, "load_time_ms": 28.487, "load_throughput": 4600036.793, "learn_time_ms": 15011.962, "learn_throughput": 8729.039, "update_time_ms": 2.376}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.006249999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 399.84605636061116, "policy_loss": 0.0022160006261717053, "vf_loss": 79.96681540157633, "vf_explained_var": -0.002033263872173952, "kl": 0.0014243937009716847, "entropy": -0.17243941699732163, "entropy_coeff": 0.001}}}, "num_steps_sampled": 786240, "num_agent_steps_sampled": 786240, "num_steps_trained": 786240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 786240}, "done": false, "episodes_total": 1760, "training_iteration": 6, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-26-21", "timestamp": 1691000781, "time_this_iter_s": 38.58671855926514, "time_total_s": 254.50071239471436, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 254.50071239471436, "timesteps_since_restore": 786240, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.561818181818175, "ram_util_percent": 73.49818181818185}}
{"evaluation": {"episode_reward_max": -2522.9434303939342, "episode_reward_min": -2522.9434303939342, "episode_reward_mean": -2522.9434303939342, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2522.9434303939342], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -1232.0205903053284, "episode_reward_min": -10908.07443112135, "episode_reward_mean": -3312.8474225395917, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4776.143215447664, -1538.0871258080006, -2892.340264469385, -3878.6737031936646, -2380.324663102627, -5139.413474321365, -2089.388751089573, -1756.2770865261555, -3033.3512295782566, -5993.542608618736, -6109.032047748566, -6869.7564360797405, -10825.58994564414, -2145.9747362434864, -1883.3590715527534, -4072.6438734531403, -3044.9872449934483, -3471.0367719233036, -3050.2990561425686, -3664.5497612953186, -3557.7002865970135, -1786.0297880470753, -5649.144830614328, -1595.4924975335598, -2286.4904969632626, -3272.072892576456, -2929.489174067974, -10908.07443112135, -2030.2589420676231, -1746.4014939963818, -3669.422261983156, -3944.4812617897987, -4765.490875452757, -5690.159771800041, -3829.462942659855, -3992.5584992170334, -2106.476280450821, -3692.445259064436, -4582.960243344307, -3663.8450583815575, -2888.327592730522, -5231.1795654296875, -4693.677779614925, -3209.86753231287, -3614.3478412032127, -2090.527687072754, -1268.2732663154602, -4628.615453839302, -1431.0943657457829, -2441.0344217717648, -1772.0715683996677, -3612.0697625279427, -2723.4624998271465, -3313.370371848345, -2273.708622455597, -5514.719771504402, -1615.9093982577324, -2600.510229855776, -2564.80074891448, -3593.0563925802708, -2436.2215316295624, -2063.7559131979942, -2595.476324260235, -2703.6227083802223, -3479.7001016438007, -3191.6583433151245, -1730.061730414629, -1959.1582789123058, -2428.0902916789055, -2307.524122953415, -3207.3285298645496, -1680.755121588707, -2393.5624644458294, -1957.0894793868065, -4515.1102214455605, -2841.948861718178, -3225.9735976159573, -4915.516079723835, -2613.7342024743557, -4217.990977525711, -2290.1539610624313, -1986.909726947546, -3034.9267904162407, -1861.9227911233902, -4193.827039986849, -3650.2852445542812, -5684.223174840212, -2423.189455896616, -3756.723200649023, -3048.485901027918, -2149.936839669943, -2744.936944872141, -1625.0117503404617, -3272.263624280691, -6341.457388073206, -3734.358869820833, -1232.0205903053284, -2443.306517213583, -2019.3329765498638, -1933.3373569846153], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.467717903366417, "mean_inference_ms": 4.434053894173946, "mean_action_processing_ms": 4.265696364308631, "mean_env_wait_ms": 3.0611406416340454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 917280, "timesteps_this_iter": 131040, "agent_timesteps_total": 917280, "timers": {"sample_time_ms": 36426.379, "sample_throughput": 3597.393, "load_time_ms": 26.2, "load_throughput": 5001437.991, "learn_time_ms": 15002.992, "learn_throughput": 8734.258, "update_time_ms": 2.35}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031249999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 400.145929863503, "policy_loss": -0.0003138748091535726, "vf_loss": 80.02931869670908, "vf_explained_var": -0.003773483858313612, "kl": 0.0013398437137593679, "entropy": -0.17851484414710794, "entropy_coeff": 0.001}}}, "num_steps_sampled": 917280, "num_agent_steps_sampled": 917280, "num_steps_trained": 917280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 917280}, "done": false, "episodes_total": 1760, "training_iteration": 7, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-26-36", "timestamp": 1691000796, "time_this_iter_s": 15.169152975082397, "time_total_s": 269.66986536979675, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 269.66986536979675, "timesteps_since_restore": 917280, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.813636363636363, "ram_util_percent": 73.90454545454547}}
{"evaluation": {"episode_reward_max": -4331.815249830484, "episode_reward_min": -4331.815249830484, "episode_reward_mean": -4331.815249830484, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4331.815249830484], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -905.5193240344524, "episode_reward_min": -13548.93692201376, "episode_reward_mean": -2707.8926078110935, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1533.3507824838161, -6777.374124586582, -3281.3588033020496, -1990.649449199438, -2043.9871872663498, -2978.1772114038467, -6147.87165004015, -3916.1964509785175, -1905.834333717823, -2806.3042114079, -2285.788849711418, -1498.1830333173275, -2993.829768180847, -2859.957122951746, -3806.0022765398026, -2213.3496736884117, -2507.5749316215515, -2342.78389531374, -2477.545183777809, -1544.5307132601738, -4002.5281915664673, -2438.682720273733, -3387.915450155735, -2189.5140204131603, -2771.829919397831, -1903.7749835848808, -2162.82516759634, -2969.6271933615208, -1519.0482555031776, -2446.6665995419025, -2733.586204826832, -2331.041354715824, -1839.6971318125725, -2035.2074223458767, -1738.2669080793858, -2435.589229375124, -2190.07507494092, -1775.2143090069294, -2796.9047841727734, -2199.1798308193684, -1902.0818728804588, -1853.6262224912643, -1899.8903196156025, -2524.539723187685, -2298.7870438992977, -10587.236531078815, -2232.4915502369404, -2314.8037361502647, -2126.741043806076, -1798.0733498632908, -2657.7300119102, -2125.5189774036407, -1847.3290756642818, -2018.3014038205147, -1992.4518336355686, -1532.5722650885582, -1860.1324443817139, -2162.980811804533, -1328.1422273218632, -3437.082270234823, -2327.22676512599, -1876.7333186864853, -1047.8764588236809, -2680.085882514715, -1980.43790730834, -2337.253353834152, -1315.7301503121853, -1885.8993165493011, -1948.9464212357998, -1317.6800278425217, -1823.3336257338524, -1359.3766035735607, -2791.2748301923275, -2906.6666624844074, -1560.7705546319485, -1974.3885359466076, -5876.57954031229, -1626.828504472971, -1781.2191526591778, -2446.818679869175, -3195.1334084272385, -1552.2132278084755, -2030.3366885483265, -1563.163038134575, -2077.375233054161, -2230.6046207249165, -1343.220588117838, -1643.7555824816227, -2981.1336171031, -4491.665645569563, -4502.146899461746, -1896.391338467598, -1617.2224031686783, -3464.6906015872955, -3592.759348332882, -2557.4332931041718, -5672.477682083845, -2831.8452637195587, -3065.5249098837376, -1955.820758253336, -2163.5690001547337, -4630.300293087959, -3978.3252395391464, -2088.6528843939304, -1373.3389366269112, -4258.25380307436, -2417.8295976519585, -13548.93692201376, -2913.4058914780617, -3073.1570738852024, -2273.2206800282, -2246.8434435129166, -4464.379102528095, -4692.082970649004, -2174.380450427532, -2472.3271367549896, -1663.4433072805405, -2064.922639876604, -3635.864008873701, -1648.6738530993462, -2437.4369201362133, -3362.469611376524, -3996.0153412520885, -13132.077407807112, -1469.8414094150066, -3771.7110315561295, -2188.980753660202, -4447.617079734802, -4551.2829547822475, -2039.645712941885, -2873.0727839767933, -1796.024533778429, -2588.2708111405373, -5459.211209535599, -3066.123806208372, -1814.0099742412567, -2845.47415971756, -2683.0039197206497, -1118.6586877405643, -1542.2470977306366, -2316.5836335122585, -2907.9097650051117, -2011.444841682911, -2795.8171352744102, -2800.918579787016, -3432.5349183380604, -1670.3546200692654, -1328.7457343935966, -2083.661497324705, -1267.9672329127789, -2756.791492253542, -1478.6385338902473, -6058.638441711664, -2184.017910629511, -2529.803522616625, -1793.816180884838, -1976.3828260302544, -3139.4247816205025, -2685.7520312964916, -2048.189028441906, -2501.092164903879, -1688.2743328809738, -3119.3702175319195, -3063.9965840280056, -3772.357966095209, -3978.339067339897, -3320.602678358555, -1935.8655069768429, -1625.3393076360226, -3819.810385376215, -1812.9002301692963, -2211.259729474783, -2494.8514412641525, -1916.2070323228836, -2876.681447684765, -1202.8031852841377, -3167.5222741663456, -7456.599567472935, -2068.7246802151203, -1511.6039605140686, -2159.9598156809807, -2192.1298389732838, -1375.5371892750263, -8473.309170514345, -2010.0847128033638, -1100.1142166554928, -1859.2270132899284, -1991.0927226543427, -1656.3766224384308, -2660.3482698500156, -2541.507320970297, -3123.967777788639, -3314.9658214449883, -2434.501995742321, -5036.360987007618, -2980.168134301901, -1605.5242673754692, -2415.4211913347244, -5768.148401647806, -2222.953566044569, -2540.8513203263283, -1842.8641594648361, -2444.5949974656105, -2407.82583206892, -3887.140069067478, -3888.2198201715946, -1449.1183422207832, -5825.982405841351, -5234.328224778175, -1911.6691276729107, -2788.463365674019, -1908.036464780569, -2616.132509380579, -1948.2235428392887, -5056.103734314442, -3011.120033532381, -2299.8792176544666, -2503.9363713264465, -2089.4826447963715, -1907.942554205656, -3957.316384255886, -4898.094510555267, -4751.018044829369, -2327.8004607260227, -4115.780683457851, -970.5766550600529, -2596.251954972744, -1783.8027269542217, -1978.4823699891567, -1858.0378403663635, -2167.9293135404587, -2176.9757660627365, -2769.2590069770813, -3196.2237151563168, -1923.7440489530563, -2627.9638890326023, -2516.6240625977516, -2076.162880808115, -3358.4652569592, -2011.1761819720268, -1537.1402405500412, -1660.8119251132011, -1493.616251707077, -2121.3387088775635, -2343.500239908695, -2354.906941384077, -1526.796339392662, -2111.2830445468426, -2174.5864167511463, -2742.0818409323692, -1961.7240507900715, -2435.368544459343, -4192.411212801933, -1553.0638793110847, -1976.4671113193035, -3468.761728346348, -1809.654931128025, -1457.1792190670967, -9173.072195917368, -2259.6228196918964, -2799.3534683585167, -1637.5138528645039, -2515.3736726641655, -1970.038938075304, -5818.029608339071, -1804.428595483303, -2836.502854973078, -6103.980701357126, -4476.44295540452, -1661.0765745937824, -2167.4584639668465, -1277.23728120327, -1659.2832376658916, -2115.263962417841, -2598.934380620718, -3210.3704127967358, -1316.5378901660442, -2023.0604862868786, -3456.7273639440536, -1527.5329389870167, -1356.7135440707207, -1419.0286198556423, -2177.5881830751896, -3040.9989619255066, -1535.840257614851, -2694.574013262987, -1997.6987001597881, -1387.7067538797855, -4557.049615979195, -1707.4172060191631, -3776.9328155219555, -2802.352724134922, -6732.080262541771, -5500.505613476038, -2893.586546689272, -2142.688044190407, -3309.5728096961975, -5625.143970429897, -3191.7672269046307, -1524.5477598905563, -4961.312272071838, -3321.103988021612, -3965.012555271387, -1672.0556132495403, -6435.098812878132, -2005.8261229097843, -2064.7596712112427, -1823.6743794083595, -3726.7653724253178, -3620.043983012438, -3365.4316618442535, -5184.281765520573, -1791.2180811166763, -2438.7299879193306, -1387.1548041403294, -2577.146829277277, -1580.0501501262188, -1664.0126434862614, -2521.931788235903, -3342.323974698782, -6075.02398276329, -2725.954642802477, -4603.114237308502, -1238.5807716846466, -3766.9027829766273, -1731.5564908385277, -2136.278021812439, -2612.817402869463, -1861.664751291275, -3045.5650531053543, -2414.880995064974, -2005.5938299000263, -3093.7988834679127, -1331.669358253479, -2214.83204716444, -1473.7129316329956, -1881.0800180733204, -1318.5570193231106, -3085.3217281103134, -1967.921493858099, -2305.8968378305435, -976.3107616007328, -2324.4691294133663, -1602.8978102207184, -3262.336918592453, -2555.0298009216785, -1378.7736670672894, -4742.474877357483, -2639.3129614293575, -1609.7239636480808, -2043.9255256056786, -1758.1469641029835, -2605.2352111637592, -2403.278828918934, -1242.119118720293, -1396.0305497348309, -4861.8572345376015, -1605.1870166659355, -1167.4134105145931, -1899.4514231681824, -5449.809596300125, -3474.809688180685, -1093.277359366417, -1943.4999654889107, -2050.528179228306, -3138.2483695447445, -1992.1427651643753, -2009.7985722124577, -2113.430026948452, -1998.488814920187, -2953.960958123207, -4380.0905530154705, -3083.943636626005, -2093.5698074400425, -2105.369065284729, -2040.6089369952679, -3014.089188605547, -1522.989807099104, -1562.7394089996815, -1789.6746042966843, -1787.0256606638432, -3172.6318088173866, -905.5193240344524, -1398.4701797962189, -3399.5310429632664, -2512.5707565546036, -2351.7454662323, -1998.6853418648243, -2452.525487869978, -1868.4572264552116, -2526.959933131933, -1254.3424113094807, -2269.621615499258, -4508.190083116293, -1663.6596077382565, -2156.4172299206257, -2378.027534097433, -1432.0748445689678, -3011.176548421383, -5793.972979813814, -2791.3399089574814, -2381.4577753841877, -3137.762722939253, -3858.918864995241, -1303.9138475060463, -4776.387555330992, -2985.9815315008163, -2179.7892142236233, -9513.577851235867, -4655.0706568062305, -3636.455080538988, -2573.6119741499424, -1629.5718861818314, -2690.347932457924, -3422.6789732575417, -2134.499071151018, -2469.116453498602, -1977.9255982935429, -2347.5807247161865, -3291.8351760208607, -2752.000891327858, -1915.2310457229614, -3177.8274369239807, -3750.6563283503056, -3158.2197199761868, -2238.3217166364193, -2431.4519154131413, -4055.6577399373055, -1810.989637106657, -2155.8216481804848, -3903.5049418509007, -1669.439480125904, -2114.576255351305, -5664.240376800299, -3659.029272913933, -3020.084260225296, -2555.3830965161324, -2800.1475115716457, -1317.3054757416248, -1925.0114883482456, -2392.012155354023, -1802.45991897583, -2198.7974255383015, -3847.494152545929, -2198.286935567856, -1383.8004548549652, -2214.58492359519, -1884.8428066968918, -2655.5723654925823, -2841.102064192295, -2260.8671661913395, -2293.8205826580524, -2110.014548510313, -7383.317786812782, -2661.4461106061935, -1650.0730093121529, -1393.9641275703907, -2216.12147167325, -2963.147340029478, -3291.088176995516, -1537.4392531514168, -983.2927766144276, -2186.5524609684944, -4046.122142970562, -3203.89852681756, -1972.2889150083065, -1765.0986979305744, -3091.7147186100483, -5672.3399248719215, -1900.918058425188, -2542.899316340685, -1784.53010648489, -2338.452148884535, -1663.6027361154556, -2080.811101704836, -2629.9197117090225, -1981.0880918204784, -2873.574024826288, -3573.324066221714, -2987.058205753565], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3712934120198135, "mean_inference_ms": 4.431998246712535, "mean_action_processing_ms": 4.172629770415937, "mean_env_wait_ms": 3.0598778234145714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1048320, "timesteps_this_iter": 131040, "agent_timesteps_total": 1048320, "timers": {"sample_time_ms": 36699.587, "sample_throughput": 3570.612, "load_time_ms": 26.306, "load_throughput": 4981383.727, "learn_time_ms": 14962.94, "learn_throughput": 8757.637, "update_time_ms": 2.357}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015624999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 399.55166820148423, "policy_loss": 0.0021447427628056488, "vf_loss": 79.90800143826392, "vf_explained_var": -0.007036355874871695, "kl": 0.0015167238147072973, "entropy": -0.18653166753416847, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1048320, "num_agent_steps_sampled": 1048320, "num_steps_trained": 1048320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1048320}, "done": false, "episodes_total": 2240, "training_iteration": 8, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-27-15", "timestamp": 1691000835, "time_this_iter_s": 38.34472346305847, "time_total_s": 308.0145888328552, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 308.0145888328552, "timesteps_since_restore": 1048320, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.39074074074073, "ram_util_percent": 73.44814814814814}}
{"evaluation": {"episode_reward_max": -3421.5889379382133, "episode_reward_min": -3421.5889379382133, "episode_reward_mean": -3421.5889379382133, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3421.5889379382133], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427956963727574, "mean_inference_ms": 3.754729044413614, "mean_action_processing_ms": 1.2411005244759503, "mean_env_wait_ms": 199.95160731012948, "mean_env_render_ms": 3.103456097448657}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -848.4428461790085, "episode_reward_min": -11283.023336678743, "episode_reward_mean": -2168.3762723018726, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3077.8685195446014, -2089.3314666152, -1358.7877010703087, -1692.1835752129555, -2213.3773879408836, -2325.5617266893387, -2687.4210210740566, -1863.5759734511375, -2395.2506436407566, -4400.018485665321, -1553.9650473296642, -1458.448365330696, -3014.836067467928, -1102.2002748847008, -2843.4434421658516, -4089.1567765176296, -1663.2696795463562, -1542.412568449974, -1379.148064225912, -1304.0543456673622, -4467.586191028357, -2298.00400274992, -1478.911335259676, -1590.4953057467937, -2092.734996944666, -1993.3047885894775, -1584.4254466891289, -2901.051030218601, -1690.3384693264961, -1646.8748196661472, -2240.774949193001, -1450.0124587118626, -3021.680429071188, -2200.8251179158688, -2286.5574214458466, -1376.0099633038044, -4892.790396600962, -2652.020764142275, -2752.435235619545, -1233.3087307214737, -3265.845809429884, -1351.7027125954628, -2580.4021978378296, -4657.936053574085, -1061.6993736624718, -2538.7236230671406, -2069.934354454279, -1686.6498272418976, -1254.7021240592003, -2577.047070235014, -2247.162676036358, -1303.761350005865, -1380.085798829794, -2344.6983737945557, -2705.866242259741, -1318.072285413742, -1403.6299257576466, -2412.026861578226, -1519.6694323718548, -1323.813119918108, -1409.6368995904922, -2621.306311905384, -1203.7660856544971, -2492.3701089322567, -2566.954376935959, -3318.4879341721535, -2421.12575930357, -1201.2448305487633, -1236.53801715374, -2059.924653530121, -2218.311707764864, -6322.541046440601, -1723.179774671793, -1196.7310695946217, -997.0095101892948, -2431.382667273283, -5715.7279424369335, -1486.8901643753052, -1222.779707878828, -2005.9041179418564, -1998.0052285790443, -1909.7940281629562, -4902.674548983574, -2791.853650033474, -2013.4847544133663, -3836.2045896053314, -2335.455326884985, -3819.818286627531, -4312.143029987812, -2496.656769514084, -1691.5141182243824, -7471.3892131745815, -2925.2348754704, -1628.7382888793945, -1994.9537453949451, -1055.4127288162708, -2138.695624291897, -1967.8358189165592, -2834.3232513666153, -2150.5832301974297, -1610.6526134312153, -1802.3965682089329, -2104.515486717224, -5252.055328249931, -1194.9337203800678, -2036.5008536279202, -4060.205486267805, -3706.9548938274384, -3226.1414803266525, -1726.4455104470253, -2467.409107476473, -1569.5828427672386, -2357.025794327259, -2253.8272099792957, -2430.3869934678078, -2926.3792813420296, -1470.8722674250603, -1405.3714216053486, -1345.7605826556683, -1122.0769010484219, -2039.087850034237, -1696.9730806052685, -1297.268778204918, -1772.6628862917423, -2078.3195097744465, -2681.916578024626, -6537.9481772482395, -1859.6524485945702, -2761.6185139119625, -1821.8983875513077, -1802.9512073099613, -1695.271043986082, -1960.0672665536404, -1743.264255642891, -2474.9430364072323, -1756.4982371330261, -2042.2561151385307, -1438.5459052026272, -1451.2049107849598, -2788.743045657873, -1544.2655519545078, -1832.4661208093166, -1111.465674817562, -1149.3134264945984, -1768.3739730417728, -2118.402465701103, -1745.7586717903614, -3418.307382553816, -1986.220171302557, -1300.5499583780766, -2136.6333008408546, -1793.5265674293041, -1588.2024550437927, -2290.537563562393, -2202.2867425978184, -2094.0905555188656, -1660.5311573445797, -4521.266675293446, -1901.8009346723557, -3326.7875276207924, -4808.652311295271, -1502.8590060472488, -1822.495835274458, -1251.590669542551, -2132.3191281855106, -1401.1404027044773, -1474.016349852085, -995.9460172653198, -1605.2916650772095, -1471.4894813001156, -1819.6256272792816, -3407.843299418688, -2532.757189363241, -2234.7901570796967, -1340.8636451661587, -1332.9121510088444, -5173.459750205278, -3920.591274291277, -1219.087160885334, -1225.6334739029408, -2644.28114387393, -2658.413645774126, -1890.8234922289848, -1051.28691264987, -1346.9545419812202, -1258.4185608625412, -1029.0051085352898, -1100.9366700947285, -2065.3713285326958, -2658.0783382356167, -1547.153846681118, -1552.5409238636494, -1910.3406104445457, -1684.1655366420746, -3210.7660152614117, -1456.473943889141, -1457.2121227681637, -3073.549981147051, -1771.8900025188923, -1440.0893749892712, -2776.417811602354, -1960.3293355107307, -1652.8923414349556, -2738.9039066433907, -1808.441076517105, -1452.9198146164417, -2146.2665584385395, -1821.3731744587421, -1371.2667948901653, -11283.023336678743, -2770.60092484951, -2861.8427391648293, -2598.367440164089, -1800.7058266103268, -9772.099267452955, -1428.6744385957718, -2028.683750987053, -1676.5994956195354, -1556.4166324138641, -4366.365520656109, -929.127998739481, -1506.9062858819962, -1861.9722089767456, -2245.3320078253746, -1882.760944545269, -952.1179372668266, -1059.0012455284595, -2155.4892121851444, -2179.509768784046, -1946.67255038023, -1303.6132059693336, -2198.4858758747578, -1447.1076184809208, -2208.8159914910793, -1310.3927247524261, -1359.7135396003723, -2047.205458432436, -2936.369187295437, -1720.7214823067188, -1277.055908471346, -1082.5699254870415, -1645.1162225306034, -1964.5168210566044, -1189.7587486505508, -1847.7722634375095, -1512.9927522540092, -1214.2973046898842, -1698.138351649046, -1362.1145539581776, -1640.4653337597847, -1786.3195920288563, -1316.8504929244518, -2306.9360893964767, -2210.2849159538746, -1507.166285276413, -2077.6759245097637, -2605.501543134451, -1509.0959786176682, -2409.702877551317, -1320.7978442311287, -1488.841496258974, -1880.9966103434563, -2303.5067054331303, -2364.6048699319363, -1677.2209929823875, -1387.8015549778938, -1916.6650684475899, -1450.959220379591, -1563.753017872572, -1897.9130103588104, -2362.2179102003574, -2776.492465466261, -1823.0734068751335, -1725.8273965716362, -4007.5894130170345, -1294.2058091163635, -1858.3767820596695, -1789.0390058457851, -1568.7153722643852, -1798.509298413992, -2086.1510626375675, -1071.5246700048447, -1349.7502520680428, -1394.5344783961773, -3277.0675728321075, -2232.44300827384, -3584.660025060177, -1321.8727356791496, -1173.5290758907795, -2276.4374055862427, -2373.670558333397, -2168.7020583748817, -3643.7551661729813, -1499.1632215380669, -1513.9824694097042, -4031.6923395991325, -2460.390348404646, -1933.1015850007534, -926.1806859374046, -5129.298998624086, -1549.439454317093, -1956.9016723930836, -1490.110503256321, -2368.1829793155193, -2603.4587503373623, -2838.9696456491947, -1715.1358557343483, -2344.323780298233, -3272.0614825189114, -2000.4636265933514, -2361.875295728445, -1938.4091767668724, -6906.469079762697, -1258.1670952141285, -1589.4178389012814, -1939.5339882671833, -4208.097379595041, -1536.0410278141499, -1238.6322745978832, -1682.2351396679878, -992.1770516335964, -1137.4630313515663, -1356.1173195838928, -2250.35753723979, -1840.5177077054977, -1688.7043082118034, -1738.2508118152618, -2063.0378466546535, -1071.8157397806644, -1879.6886909008026, -6110.742737591267, -2183.8662735819817, -2320.1260443925858, -4496.454774349928, -1509.9760566353798, -3674.192202657461, -5358.426430851221, -991.6943674981594, -1343.8972827196121, -1614.577396273613, -2524.493437796831, -2014.7968340814114, -1607.8650812506676, -2515.134774327278, -2748.8506503403187, -2239.047180712223, -2822.177636772394, -2597.7847846746445, -2249.8137168586254, -1693.1105358302593, -1872.2524781227112, -2257.820410490036, -1203.9130961596966, -1504.8090349137783, -1967.2376400828362, -1424.149736881256, -1724.885962575674, -1796.0440660715103, -2609.4489936232567, -2545.648457109928, -1244.1422544419765, -4302.430551856756, -1923.9448542892933, -1405.20799985528, -1271.4146082699299, -1344.5597567856312, -1009.2501890957355, -1157.9905247688293, -1349.6565424203873, -1110.6677230000496, -1462.7265248298645, -2212.779102951288, -1424.1181110143661, -1378.8786185383797, -2021.2120338380337, -1669.3855619132519, -1161.0784353911877, -4275.444029182196, -1901.457842886448, -1847.234178841114, -2029.1541978418827, -1287.450903147459, -1762.359571903944, -2770.0369372963905, -2692.0981356203556, -1242.8327113687992, -2776.043976098299, -1869.847508519888, -2591.255046516657, -1050.7919162809849, -4240.215940713882, -2733.644326746464, -1256.0040195286274, -7510.785412490368, -3573.0757526755333, -4034.19343277812, -3040.8530533909798, -2274.946317076683, -1523.5002201199532, -1637.5310557484627, -4395.589102208614, -1242.636338710785, -2030.764060050249, -2115.935588091612, -1832.8427436053753, -1816.6288596987724, -4489.474527388811, -1778.4816378057003, -1093.786427527666, -1504.2317438721657, -1919.9943297207355, -1830.8118249177933, -4973.129779219627, -1389.4890629649162, -6508.093071728945, -1097.976450920105, -1317.318557858467, -1974.789004266262, -1842.1736502349377, -1497.732289135456, -1544.020680963993, -1652.3925809264183, -1176.0628360509872, -848.4428461790085, -1657.997004210949, -4064.846336364746, -2553.6020667254925, -2387.6685911417007, -1450.8920613229275, -1750.8757664561272, -2397.1139613091946, -5093.773679196835, -1713.524584442377, -1735.4442552924156, -3170.7832660079002, -3575.143233716488, -1915.9826908409595, -1436.400801807642, -1800.7971728146076, -1603.0015940070152, -1899.5865523815155, -1258.7813695967197, -1791.0117697417736, -1482.579038888216, -1249.4091280400753, -1441.0713382065296, -1642.3559829294682, -1493.5415732264519, -1177.3671475946903, -1357.28071346879, -2607.89887624979, -1428.2365865409374, -2495.701245069504, -1811.4469556510448, -1677.5934862792492, -1278.3291637599468, -1112.0424524247646, -2070.9508657455444, -2831.7186155617237, -1229.670288592577, -2202.597094476223, -2156.7902495265007, -1255.4603264927864, -2275.6841721236706, -1951.651339828968, -1951.330428659916, -3671.3629394471645, -1924.874848663807, -1284.0898845791817, -1851.5338012874126, -1059.0365186333656, -2129.258241534233, -933.7144011557102, -1544.9352829754353, -1665.2743375003338, -1806.3458504080772, -1713.3967567384243, -1679.4988581240177, -2168.848634749651, -3598.4070537388325], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3763142695235375, "mean_inference_ms": 4.4393576922945535, "mean_action_processing_ms": 4.169504230704914, "mean_env_wait_ms": 3.0554267188647772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1179360, "timesteps_this_iter": 131040, "agent_timesteps_total": 1179360, "timers": {"sample_time_ms": 36900.86, "sample_throughput": 3551.137, "load_time_ms": 26.357, "load_throughput": 4971756.425, "learn_time_ms": 14944.32, "learn_throughput": 8768.549, "update_time_ms": 2.355}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812499999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 396.7180183621546, "policy_loss": 0.008976483808613605, "vf_loss": 79.33443954084936, "vf_explained_var": -0.007937477160525579, "kl": 0.0019323187663764809, "entropy": -0.18739401666601072, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1179360, "num_agent_steps_sampled": 1179360, "num_steps_trained": 1179360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1179360}, "done": false, "episodes_total": 2720, "training_iteration": 9, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-27-53", "timestamp": 1691000873, "time_this_iter_s": 38.59803128242493, "time_total_s": 346.61262011528015, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 346.61262011528015, "timesteps_since_restore": 1179360, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.99272727272727, "ram_util_percent": 73.66727272727276}}
{"evaluation": {"episode_reward_max": -1412.5277328193188, "episode_reward_min": -1412.5277328193188, "episode_reward_mean": -1412.5277328193188, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1412.5277328193188], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -848.4428461790085, "episode_reward_min": -7510.785412490368, "episode_reward_mean": -2142.379296661615, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2029.1541978418827, -1287.450903147459, -1762.359571903944, -2770.0369372963905, -2692.0981356203556, -1242.8327113687992, -2776.043976098299, -1869.847508519888, -2591.255046516657, -1050.7919162809849, -4240.215940713882, -2733.644326746464, -1256.0040195286274, -7510.785412490368, -3573.0757526755333, -4034.19343277812, -3040.8530533909798, -2274.946317076683, -1523.5002201199532, -1637.5310557484627, -4395.589102208614, -1242.636338710785, -2030.764060050249, -2115.935588091612, -1832.8427436053753, -1816.6288596987724, -4489.474527388811, -1778.4816378057003, -1093.786427527666, -1504.2317438721657, -1919.9943297207355, -1830.8118249177933, -4973.129779219627, -1389.4890629649162, -6508.093071728945, -1097.976450920105, -1317.318557858467, -1974.789004266262, -1842.1736502349377, -1497.732289135456, -1544.020680963993, -1652.3925809264183, -1176.0628360509872, -848.4428461790085, -1657.997004210949, -4064.846336364746, -2553.6020667254925, -2387.6685911417007, -1450.8920613229275, -1750.8757664561272, -2397.1139613091946, -5093.773679196835, -1713.524584442377, -1735.4442552924156, -3170.7832660079002, -3575.143233716488, -1915.9826908409595, -1436.400801807642, -1800.7971728146076, -1603.0015940070152, -1899.5865523815155, -1258.7813695967197, -1791.0117697417736, -1482.579038888216, -1249.4091280400753, -1441.0713382065296, -1642.3559829294682, -1493.5415732264519, -1177.3671475946903, -1357.28071346879, -2607.89887624979, -1428.2365865409374, -2495.701245069504, -1811.4469556510448, -1677.5934862792492, -1278.3291637599468, -1112.0424524247646, -2070.9508657455444, -2831.7186155617237, -1229.670288592577, -2202.597094476223, -2156.7902495265007, -1255.4603264927864, -2275.6841721236706, -1951.651339828968, -1951.330428659916, -3671.3629394471645, -1924.874848663807, -1284.0898845791817, -1851.5338012874126, -1059.0365186333656, -2129.258241534233, -933.7144011557102, -1544.9352829754353, -1665.2743375003338, -1806.3458504080772, -1713.3967567384243, -1679.4988581240177, -2168.848634749651, -3598.4070537388325], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43681545984531, "mean_inference_ms": 4.4211777050380245, "mean_action_processing_ms": 4.240363234443223, "mean_env_wait_ms": 3.0361214723223555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1310400, "timesteps_this_iter": 131040, "agent_timesteps_total": 1310400, "timers": {"sample_time_ms": 34718.618, "sample_throughput": 3774.344, "load_time_ms": 25.001, "load_throughput": 5241360.07, "learn_time_ms": 15024.328, "learn_throughput": 8721.855, "update_time_ms": 2.413}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906249999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 396.28528110445865, "policy_loss": -0.007272568114152167, "vf_loss": 79.26413676217466, "vf_explained_var": -0.0193614079533512, "kl": 0.001616614303045896, "entropy": -0.19286175232420685, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1310400, "num_agent_steps_sampled": 1310400, "num_steps_trained": 1310400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1310400}, "done": false, "episodes_total": 2720, "training_iteration": 10, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-29-36", "timestamp": 1691000976, "time_this_iter_s": 102.50318241119385, "time_total_s": 449.115802526474, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 449.115802526474, "timesteps_since_restore": 1310400, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.357142857142858, "ram_util_percent": 94.11224489795919}}
{"evaluation": {"episode_reward_max": -3054.2225607037544, "episode_reward_min": -3054.2225607037544, "episode_reward_mean": -3054.2225607037544, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3054.2225607037544], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -802.9929966926575, "episode_reward_min": -6290.893294811249, "episode_reward_mean": -1583.1412648957223, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1773.3702093958855, -2183.044168651104, -1568.4771431684494, -3737.9587501883507, -1163.0367676019669, -1498.2160764336586, -1068.1691414415836, -1939.8144383728504, -1880.365122884512, -1131.3097202181816, -2393.84127381444, -1393.1130390167236, -2010.0262457728386, -1047.6512193977833, -2028.8972148001194, -2161.9484315514565, -2422.2347259521484, -869.315592944622, -1827.7438607811928, -2033.5991116464138, -1813.367356568575, -1402.4710977971554, -1325.9272120296955, -2420.9657656252384, -1101.5477284789085, -1257.7437869608402, -2003.8535727262497, -1792.4510278105736, -1563.0657117962837, -1581.7594611644745, -1333.8221082687378, -1509.3190982341766, -1796.3643064796925, -1299.583421945572, -1665.4177980720997, -1572.2931115627289, -1194.9222886562347, -2110.3267714083195, -1147.0556084513664, -1563.2165275514126, -948.4620029628277, -1082.3001571297646, -2116.1883387565613, -1170.811906695366, -3658.0745292305946, -1326.5816433429718, -1130.02444973588, -1319.048754900694, -1247.5317826867104, -1596.7788121700287, -1513.1320531964302, -1600.9862751662731, -1944.642135888338, -1553.3374173641205, -826.2000150382519, -937.5685078501701, -1412.424046009779, -1355.764129281044, -1575.6092880368233, -1522.0594193339348, -1065.38710552454, -1251.1336106956005, -6030.352899998426, -1957.4368314445019, -1086.350984096527, -2524.6141847372055, -1353.0079101026058, -1259.769293218851, -1168.3970855176449, -1022.9986110627651, -1130.7399940788746, -1383.8079335987568, -990.1543203294277, -1397.880181491375, -802.9929966926575, -1205.768892943859, -2016.2607408165932, -1163.3856700956821, -990.8756622970104, -1071.877760142088, -2216.240072309971, -1423.0957656800747, -3322.8727198541164, -1248.2777965068817, -1853.9180563986301, -1171.3093076944351, -1015.1358962655067, -1786.9365666210651, -1239.6659888625145, -3292.8002624213696, -1282.1007299125195, -2165.2628545463085, -2393.140587180853, -1197.437423080206, -1605.2719477117062, -1224.362970083952, -1620.7926039397717, -1836.157510638237, -1195.0762210786343, -1202.237134963274, -1161.453650444746, -955.0972849726677, -1712.816976249218, -1061.3590240776539, -3019.501476973295, -1353.7929263710976, -1898.5472514033318, -1095.7611575722694, -1566.874175697565, -1091.5998634397984, -1343.3600203096867, -1375.8614802360535, -1869.349278151989, -1345.3830395936966, -1650.1913175284863, -1449.8616035580635, -1268.6590963602066, -1521.988422214985, -1516.649078041315, -1436.5486623346806, -2667.995333760977, -2216.327372074127, -1098.804209858179, -1711.6660956144333, -2177.7671797275543, -6290.893294811249, -1305.012628942728, -2052.5455162227154, -1523.8926477134228, -1179.3980496525764, -936.4944466948509, -1126.9038434624672, -1505.6144407391548, -1274.7374289929867, -1272.6378508508205, -818.4003353118896, -1076.8598780333996, -951.9080075025558, -1228.877875894308, -1239.17528373003, -1555.515619724989, -1487.811919093132, -1922.0366958379745, -1069.7801731228828, -1556.2730421721935, -1324.0131657719612, -1088.911375105381, -1067.610556036234, -1942.406471401453, -1160.546078801155, -2038.3947327435017, -1108.794566899538, -1515.7198068499565, -1185.666827082634, -1501.7327078580856, -1302.60708335042, -1702.5026962161064, -1213.9992792904377, -1723.5162905752659, -1071.2280898988247, -1612.8143826425076, -2098.868959635496, -962.0655736923218, -1093.3264844715595, -1910.7199897170067, -2051.83280184865, -1272.6958434283733, -1223.169131666422, -1537.9839887320995, -1202.8430121839046, -889.7598797380924, -1703.9692741334438, -1125.3359556794167, -849.7843303382397, -1805.9592744112015, -1203.6147481501102, -869.0162293612957, -2104.440933972597, -1178.809320062399, -1736.7386090755463, -1362.6498613357544, -5694.467141389847, -899.415206849575, -1206.4971241354942, -1172.6582197844982, -1801.0721604526043, -1728.5563841760159, -880.3100220263004, -1632.6627996265888, -1317.543753862381, -1374.3743634521961, -1629.8163467645645, -1622.0123816132545, -1972.9044607877731, -2724.3249283134937, -2080.697245746851, -1764.4498683810234, -1350.1194488108158, -1598.0396225452423, -1220.4012151658535, -2036.9793006181717, -909.9994849860668, -2109.153973966837, -2198.912834405899, -983.095356285572, -1740.635294020176, -1461.8494043648243, -1430.458022981882, -1412.4541237056255, -1589.12238997221, -1749.814110994339, -1432.0031351745129, -1195.059292525053, -1270.01072794199, -1296.888786971569, -1641.075361341238, -1456.7369245290756, -3034.741930216551, -1647.3970378041267, -4919.678135752678, -2862.6683197915554, -1431.479596376419, -1518.1247180104256, -2383.4240851700306, -1102.1799911558628, -1754.3331479132175, -1204.4448618590832, -2088.149363845587, -1389.4272051751614, -1133.2437164485455, -1395.9949222505093, -2039.4960259199142, -1187.770083963871, -1108.3329111635685, -1774.23310816288, -1279.5086589753628, -1344.6751179397106, -1219.5288234949112, -1262.505827486515, -2372.1411642432213, -1767.7785375118256, -1669.672733694315, -813.9877428412437, -1472.9489762187004, -991.1238420903683, -1052.414410352707, -1339.3901652395725, -1339.3927685916424, -1354.185577094555, -1300.9633404910564, -1361.9130214452744, -1479.63631606102, -1559.4752708375454, -1997.4393043220043, -1963.5513226389885, -1298.9105581641197, -1185.4335608184338, -1172.8185386061668, -1528.090108782053, -1043.6365575492382, -1177.2075117826462, -1847.0691795647144, -1262.1570226848125, -1325.5210161805153, -1068.0938342809677, -1258.7882736623287, -1562.2553920149803, -1496.925968259573, -1326.5604754984379, -1361.299577832222, -1177.2017854750156, -1469.3692761063576, -1203.0166538655758, -955.5758802890778, -1262.8885672986507, -1485.0760808587074, -1302.619104117155, -1646.4721440374851, -2048.546420007944, -806.2743845283985, -1501.653856664896, -1989.789427101612, -1700.5400137603283, -1073.784233957529, -1601.377099007368, -1446.8820416629314, -1294.3745851814747, -1567.481531828642, -1277.2833818495274, -1416.9668294489384, -1150.123050659895, -1075.6587154567242, -2479.7213910520077, -1202.3886780142784, -1771.262154430151, -1047.6226135194302, -1105.171366482973, -1382.6702470481396, -1133.0400700569153, -1808.8697039484978, -1924.2100644409657, -2120.8913421332836, -1487.3987807035446, -2623.8281386494637, -2931.5413596332073, -1786.8095618188381, -1730.1300466358662, -1795.2049759328365, -1632.4317794442177, -2347.8561305105686, -1243.5184254646301, -5252.946824580431, -1559.3444803357124, -2089.9845675230026, -1153.0620382726192, -1097.0329349339008, -2083.9822253882885, -1358.9921906292439, -1526.8254779875278, -3934.0915366709232, -2121.6529906988144, -1302.9586413502693, -1261.0053048431873, -1701.7833918631077, -1581.691590666771, -1406.5039630532265, -1099.6013324856758, -1358.7772156000137, -1283.5227246284485, -1005.6694364845753, -1791.0447871088982, -1224.9730483591557, -1478.663224130869, -2291.632813870907, -1050.8798810839653, -1906.909982740879, -1632.0992893278599, -1454.3938868641853, -1308.0516070723534, -1784.4243423342705, -1997.872730821371, -1467.728401184082, -1683.1496422588825, -974.1852905452251, -1200.1248236894608, -840.4758037626743, -1430.0178872346878, -1336.02637475729, -1449.0726964175701, -966.1359430551529, -1153.9158986508846, -1736.557647794485, -1862.041589319706, -1311.9521497189999, -2086.075989961624, -1134.3004500865936, -812.385401904583, -1451.3450454473495, -1124.1399221718311, -894.4987246394157, -1492.472108989954, -1522.685116648674, -1379.3241308033466, -1570.6125290989876, -2214.847371250391, -1269.098187983036, -1449.8528775274754, -1118.403400272131, -1193.527931958437, -1173.6945278942585, -1392.784060716629, -1773.4060710668564, -1983.9964543282986, -1741.4669102430344, -1394.0575534701347, -1586.2460910975933, -1203.6037891209126, -2162.1697746813297, -1456.9061152637005, -861.7537401020527, -1190.068366855383, -885.4926406145096, -1183.8605432510376, -835.0033253729343, -1972.5475174486637, -965.6432997584343, -1178.9736516177654, -2824.1337656974792, -1637.9201898872852, -1618.701581209898, -1172.6872061789036, -1478.9844901263714, -2314.107658803463, -1734.611626446247, -2220.56911149621, -1055.1886014044285, -1802.7638645768166, -1839.4958633184433, -1760.5954020023346, -1745.4115805923939, -2526.5981440246105, -1247.5550277531147, -1814.4778897762299, -2325.805716663599, -1555.0820996761322, -1616.1489260196686, -1220.3155512809753, -1259.0400483310223, -2206.528503149748, -1908.1095287203789, -1780.1343986690044, -1436.449963569641, -1345.6571303009987, -1383.4820555448532, -1532.5819327235222, -1125.3701230585575, -1096.901174634695, -1606.2562343776226, -5549.822723299265, -2354.076651930809, -1875.0433019399643, -1383.540746718645, -1379.2841402292252, -1422.206267029047, -2370.083007335663, -1328.5043072104454, -1827.413767516613, -2426.75315579772, -1382.7391649782658, -1940.1787842810154, -1776.8329337239265, -1546.0188426971436, -1365.6650910377502, -1312.171037554741, -2182.7812694609165, -1738.1140430867672, -4420.454385042191, -1153.694044560194, -941.561172991991, -1087.2558325529099, -1361.1345494687557, -1970.6483277082443, -2347.0962410867214, -1338.7934806644917, -1216.0843034684658, -2035.3281351327896, -1200.0629765689373, -1006.7574825882912, -1186.7150427997112, -2238.665865510702, -1352.4382188618183, -1904.3475415706635, -1393.6556942462921, -1502.6995345950127, -1461.8570627868176, -1679.2154205143452, -1690.2643830180168, -1062.7415538430214, -1091.1038664579391, -1818.3059032857418, -1543.1119150221348, -2047.4398829042912, -936.1787374019623, -1189.6316317021847, -1092.7263033688068, -2022.8108296692371, -1265.9191954135895, -972.2307812571526, -1288.8869770169258, -1201.8893272280693, -2102.4356959164143, -1367.2883217334747, -1385.365070194006, -1414.3954255878925, -1282.7083847224712, -1304.096404403448, -1183.982480853796, -1551.646710127592, -1325.5046859681606, -1748.1177102923393], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.371529786588866, "mean_inference_ms": 4.446423384715938, "mean_action_processing_ms": 4.166422322513801, "mean_env_wait_ms": 3.0483687367229226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1441440, "timesteps_this_iter": 131040, "agent_timesteps_total": 1441440, "timers": {"sample_time_ms": 44862.94, "sample_throughput": 2920.896, "load_time_ms": 21.894, "load_throughput": 5985279.102, "learn_time_ms": 15028.954, "learn_throughput": 8719.17, "update_time_ms": 2.372}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531249999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 393.0288195729779, "policy_loss": 0.004940357495858495, "vf_loss": 78.60062992273693, "vf_explained_var": -0.011362919136614783, "kl": 0.0014782792301458916, "entropy": -0.19497527059261088, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1441440, "num_agent_steps_sampled": 1441440, "num_steps_trained": 1441440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1441440}, "done": false, "episodes_total": 3200, "training_iteration": 11, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-30-15", "timestamp": 1691001015, "time_this_iter_s": 39.39362859725952, "time_total_s": 488.5094311237335, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 488.5094311237335, "timesteps_since_restore": 1441440, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.42857142857143, "ram_util_percent": 74.24464285714285}}
{"evaluation": {"episode_reward_max": -2473.370744884014, "episode_reward_min": -2473.370744884014, "episode_reward_mean": -2473.370744884014, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2473.370744884014], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -835.0033253729343, "episode_reward_min": -5549.822723299265, "episode_reward_mean": -1622.5173146086931, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1190.068366855383, -885.4926406145096, -1183.8605432510376, -835.0033253729343, -1972.5475174486637, -965.6432997584343, -1178.9736516177654, -2824.1337656974792, -1637.9201898872852, -1618.701581209898, -1172.6872061789036, -1478.9844901263714, -2314.107658803463, -1734.611626446247, -2220.56911149621, -1055.1886014044285, -1802.7638645768166, -1839.4958633184433, -1760.5954020023346, -1745.4115805923939, -2526.5981440246105, -1247.5550277531147, -1814.4778897762299, -2325.805716663599, -1555.0820996761322, -1616.1489260196686, -1220.3155512809753, -1259.0400483310223, -2206.528503149748, -1908.1095287203789, -1780.1343986690044, -1436.449963569641, -1345.6571303009987, -1383.4820555448532, -1532.5819327235222, -1125.3701230585575, -1096.901174634695, -1606.2562343776226, -5549.822723299265, -2354.076651930809, -1875.0433019399643, -1383.540746718645, -1379.2841402292252, -1422.206267029047, -2370.083007335663, -1328.5043072104454, -1827.413767516613, -2426.75315579772, -1382.7391649782658, -1940.1787842810154, -1776.8329337239265, -1546.0188426971436, -1365.6650910377502, -1312.171037554741, -2182.7812694609165, -1738.1140430867672, -4420.454385042191, -1153.694044560194, -941.561172991991, -1087.2558325529099, -1361.1345494687557, -1970.6483277082443, -2347.0962410867214, -1338.7934806644917, -1216.0843034684658, -2035.3281351327896, -1200.0629765689373, -1006.7574825882912, -1186.7150427997112, -2238.665865510702, -1352.4382188618183, -1904.3475415706635, -1393.6556942462921, -1502.6995345950127, -1461.8570627868176, -1679.2154205143452, -1690.2643830180168, -1062.7415538430214, -1091.1038664579391, -1818.3059032857418, -1543.1119150221348, -2047.4398829042912, -936.1787374019623, -1189.6316317021847, -1092.7263033688068, -2022.8108296692371, -1265.9191954135895, -972.2307812571526, -1288.8869770169258, -1201.8893272280693, -2102.4356959164143, -1367.2883217334747, -1385.365070194006, -1414.3954255878925, -1282.7083847224712, -1304.096404403448, -1183.982480853796, -1551.646710127592, -1325.5046859681606, -1748.1177102923393], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.439216551270321, "mean_inference_ms": 4.435012626142716, "mean_action_processing_ms": 4.242858321606136, "mean_env_wait_ms": 3.031260036549718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1572480, "timesteps_this_iter": 131040, "agent_timesteps_total": 1572480, "timers": {"sample_time_ms": 35747.664, "sample_throughput": 3665.694, "load_time_ms": 20.115, "load_throughput": 6514527.871, "learn_time_ms": 15084.812, "learn_throughput": 8686.883, "update_time_ms": 2.389}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765624999999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 384.67659393861925, "policy_loss": 0.000999583239100713, "vf_loss": 76.93412378782867, "vf_explained_var": -0.023099882414691335, "kl": 0.0011922890414773006, "entropy": -0.19697680051929206, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1572480, "num_agent_steps_sampled": 1572480, "num_steps_trained": 1572480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1572480}, "done": false, "episodes_total": 3200, "training_iteration": 12, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-30-31", "timestamp": 1691001031, "time_this_iter_s": 15.836824417114258, "time_total_s": 504.3462555408478, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 504.3462555408478, "timesteps_since_restore": 1572480, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.63478260869565, "ram_util_percent": 75.33913043478263}}
{"evaluation": {"episode_reward_max": -1363.2223054170609, "episode_reward_min": -1363.2223054170609, "episode_reward_mean": -1363.2223054170609, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1363.2223054170609], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -694.5004941821098, "episode_reward_min": -7706.21048900485, "episode_reward_mean": -1449.058402113306, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1089.7569588422775, -1257.4988789856434, -1963.1129252910614, -1525.0858278274536, -1486.249596774578, -1387.3230437934399, -933.429741114378, -1469.7917956113815, -962.1254099309444, -1843.6860896646976, -1213.780461102724, -969.6472995579243, -985.0424658358097, -1309.6459303796291, -1303.078215777874, -1164.2846690416336, -995.7039120793343, -897.9193025529385, -1780.9893304109573, -1305.3597432672977, -1530.1703088879585, -1579.3134970664978, -1842.1235388815403, -1169.3199543952942, -882.2669595479965, -966.7633824646473, -1944.9370274543762, -1136.6903611719608, -1283.38405752182, -1014.3575038611889, -1286.8033280074596, -1319.1210614740849, -1084.58201739192, -1470.127948075533, -1311.3873008787632, -951.1083706617355, -984.9029061198235, -945.8494551479816, -996.874512642622, -2130.5138692855835, -971.2736274003983, -1656.5590873658657, -1129.3104817271233, -4592.133760124445, -1797.277799129486, -5850.640274733305, -1677.1286499500275, -5459.26390349865, -1411.2244111299515, -1211.4336205422878, -1167.088929951191, -1596.3712156414986, -957.9727604091167, -1402.8942044079304, -1221.7522417008877, -1382.1949307620525, -1515.9531734585762, -1342.5744214951992, -1297.6019737124443, -952.0703794360161, -4845.222757279873, -1242.3059218525887, -2285.7526576817036, -1467.3804444372654, -1171.3310149908066, -1128.8430370688438, -1227.349703490734, -1376.1967734098434, -1096.2634304463863, -1831.9821432232857, -7706.21048900485, -2630.457916021347, -1598.7157348692417, -2486.892842143774, -1479.7700472176075, -1654.379356175661, -1523.271016329527, -1909.6135646998882, -1050.9272119700909, -1763.4688103497028, -1191.067709237337, -1466.5093188285828, -1581.9385395050049, -1504.5601583123207, -1574.6010985076427, -1051.1158230900764, -981.7124945223331, -1903.3873253762722, -1116.6881426274776, -1690.536985963583, -1406.4800193607807, -1199.5123237371445, -1516.0995363891125, -996.9122751951218, -2221.340953886509, -1304.2916640937328, -938.447932690382, -1164.4019044339657, -1407.9358922243118, -1440.4357547461987, -1411.769197165966, -1317.5435804724693, -2307.0109145641327, -1117.8475136756897, -1047.5912466943264, -1392.2555857896805, -1067.8252730071545, -1313.240316838026, -1265.2483348846436, -978.5530970096588, -1505.3966622054577, -1146.2887390553951, -1430.7728116512299, -1197.577251970768, -1144.6221872270107, -903.5985810160637, -1442.7278637886047, -1918.5460581183434, -991.6660878062248, -1250.2380658090115, -1997.411722689867, -991.3085136413574, -2081.2854376137257, -1560.6611230373383, -1092.7387901842594, -914.2276534438133, -1126.2273106575012, -1321.3616397678852, -1332.2331403493881, -1957.0746346116066, -1316.1472288370132, -1182.9787465333939, -901.099797308445, -1646.6957584023476, -1129.7183074355125, -2053.798969209194, -1439.3432315587997, -1378.2578318715096, -1164.6465720534325, -1777.8226068913937, -5273.27462336421, -1070.8130235373974, -763.2671173214912, -7453.2872023284435, -1250.771389991045, -1420.5629169642925, -1768.0811742842197, -960.1071644127369, -1492.432578444481, -1692.4660566449165, -1122.1907767355442, -1072.8873077630997, -1680.350206285715, -1204.4918870329857, -1015.891184002161, -2271.3101242780685, -987.0857700109482, -1222.7052158415318, -1977.5249342024326, -1878.3506911993027, -1158.2812370061874, -1290.2264506816864, -1289.6398688852787, -826.4147863388062, -1087.144879937172, -1302.2389346659184, -4142.380019158125, -1147.8571197092533, -1395.0966027975082, -917.0569753348827, -915.6231227219105, -816.2094588875771, -961.226182371378, -934.7599512934685, -1777.3095147907734, -4251.469119668007, -1505.8834358751774, -1310.551791459322, -1174.174132436514, -1373.8401834368706, -1287.767201781273, -2328.8516795635223, -1823.7166706323624, -1376.9120670855045, -1229.611465126276, -899.3904963731766, -1928.8810586333275, -694.5004941821098, -1167.8287100195885, -1228.4356520175934, -964.0841659903526, -764.9524673819542, -1438.6572396457195, -2116.583331823349, -1348.4606672525406, -1708.6115441024303, -1674.6188890337944, -1607.0600744783878, -1292.8260836303234, -812.173797339201, -1454.3878322839737, -964.3450335562229, -1223.3078773915768, -1425.8417900502682, -1179.996926665306, -1952.5787112116814, -1768.1081763505936, -1100.2811087071896, -1027.317479878664, -1386.277585029602, -1284.9887599050999, -1604.6464987397194, -1399.3955132365227, -947.1398946344852, -1490.1777046322823, -1207.9876625537872, -993.5542873740196, -1025.9112533330917, -1667.8340429067612, -1064.4808588027954, -1075.4254942536354, -1347.1045838296413, -1502.4952979683876, -923.6996451318264, -1587.7388327121735, -1362.9193105995655, -1286.1719871163368, -931.0198545455933, -1421.408865004778, -1150.7355726659298, -1194.6883078813553, -1351.7168961763382, -1261.4298993945122, -1702.5421551764011, -1094.994744092226, -1562.910177975893, -1100.769712150097, -1206.0591166615486, -1683.9127790927887, -1074.7391732931137, -1281.2435107529163, -2222.5275972485542, -1166.6503338217735, -1057.0345625579357, -1421.4751681685448, -888.1937916874886, -4489.327304333448, -996.3918543756008, -871.5478881299496, -1590.113143146038, -1485.9917987585068, -927.1328113973141, -1336.1133986711502, -1273.2382697761059, -1824.4874553382397, -1097.1506347358227, -1842.7641069293022, -986.6450280249119, -1241.9100067019463, -1024.007923513651, -1129.226964354515, -1340.1690317988396, -1535.957796484232, -1135.4314637184143, -1506.2430826425552, -1536.3545199632645, -1652.0443245768547, -815.5768579542637, -1096.8293750286102, -768.8400439918041, -1624.974103808403, -849.6578419208527, -2738.4582219719887, -1381.3980458974838, -982.3340626657009, -2032.2205920219421, -1129.1490417420864, -1063.2698477506638, -1916.9660963714123, -2201.548921495676, -1248.6703407168388, -2025.9412389099598, -1476.34329277277, -1139.6028385162354, -1392.8481450676918, -1083.519650220871, -1771.6222676932812, -1085.8155764043331, -958.7130849659443, -977.86897829175, -1235.0830383300781, -1268.8803847134113, -1411.032712727785, -1067.8232749700546, -1293.6145232021809, -1199.493300050497, -1464.4874895215034, -1273.0594265460968, -1512.7090190052986, -2377.02178516984, -1033.5139410197735, -1150.0297482609749, -1666.2583712339401, -1357.715001374483, -6046.0544090271, -1704.9471210837364, -1150.1539584100246, -904.2871211767197, -1209.9922780394554, -884.6478236019611, -1210.1082446873188, -1209.2704720795155, -1673.2199716866016, -1577.626353174448, -1278.0505928099155, -1321.8313751220703, -1087.0772527754307, -1067.2340671122074, -1230.7792540490627, -1184.8075824081898, -1561.3241545557976, -1945.2247219085693, -1253.6070547401905, -1852.146219432354, -914.5232230722904, -738.5771468579769, -1140.4326843619347, -1105.1319908201694, -1093.9865246117115, -1335.8781542479992, -928.5308665931225, -917.6567879915237, -1393.4191030859947, -888.0407917201519, -1174.0191205143929, -998.2901979982853, -1406.0364377498627, -1108.8111643493176, -1614.8474106490612, -1475.2011431753635, -1191.2585064768791, -2050.0959341824055, -1695.6394947767258, -832.5101977586746, -976.0740561783314, -826.6668993532658, -1288.8511866629124, -1713.4492282271385, -1447.9413388371468, -1703.8025177121162, -829.4071967303753, -903.42885607481, -1151.4708652496338, -1335.604852706194, -1159.2198577821255, -2014.104753792286, -1769.2097926437855, -1086.876005858183, -1037.270933419466, -1565.1531799137592, -1015.1667852699757, -1151.4321286678314, -723.6490208804607, -1159.2020084261894, -709.9521129131317, -1313.2287639677525, -1024.8259400129318, -1031.941289782524, -1684.0311129391193, -986.3304144442081, -1624.7018598616123, -1090.909857571125, -923.9260790348053, -2353.4787234961987, -1071.7154138982296, -1548.0245065689087, -1848.2811915576458, -1178.2244746387005, -1485.1842909753323, -1031.0902130007744, -1175.6448674499989, -1891.2776393592358, -2985.744263768196, -1270.7840929031372, -1317.2931340634823, -1105.5726995170116, -1858.3201980292797, -1382.562925696373, -977.1495680510998, -1022.1860141456127, -981.7787698805332, -1335.62481290102, -1119.5838487148285, -1107.5033587515354, -866.9836799800396, -841.0386086702347, -1199.6642935872078, -1291.9905107617378, -1174.4596970379353, -887.8809301257133, -1137.0665190517902, -1405.0612471997738, -1134.0171074867249, -1306.2189419865608, -911.8761569559574, -959.694146335125, -4869.356117725372, -1058.8199467658997, -1087.3440103530884, -1445.0279057323933, -1119.6924530565739, -1517.4023657739162, -1616.3051516711712, -1253.084822177887, -1372.767440468073, -1381.01411780715, -1007.3515014648438, -1592.1016557514668, -839.1147781312466, -1997.3329671919346, -1322.8714255094528, -898.9834102988243, -1104.9318057894707, -1504.6685418784618, -1346.2289585769176, -1432.3145346343517, -5097.669234961271, -1558.7943524718285, -1050.136997193098, -1218.9376900792122, -1559.213775753975, -1683.6889450252056, -1137.6049256324768, -2256.3544428646564, -1337.9882941246033, -2282.0520237982273, -1120.0750151872635, -1552.0682656764984, -1260.3941860198975, -945.8098061084747, -1184.6837918162346, -1232.5590905547142, -1118.0099392533302, -853.9273634254932, -1014.468955039978, -1467.754184603691, -4429.155153989792, -815.9573450088501, -1027.2984253764153, -1730.5930880606174, -1368.849629998207, -1565.3457728922367, -1195.4191413223743, -1509.3077780008316, -1985.75668284297, -974.282884657383, -2117.433843165636, -1390.9748902320862, -1655.7055670022964, -957.3177386522293, -1789.3096638023853, -1996.5806244015694, -1139.944684714079, -950.107569873333, -1366.3506610393524, -1010.3725892007351, -2938.3092238008976, -1253.3444420099258, -871.2113637328148, -1370.5429752469063, -828.5077939629555, -1058.2688328325748, -1420.381020963192, -1025.4403536319733, -1571.668439000845, -1859.1397606134415, -1376.6078135371208, -1107.1181026399136, -1908.4655724465847, -829.0133043825626], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.384370136285546, "mean_inference_ms": 4.461133010357334, "mean_action_processing_ms": 4.167080117925696, "mean_env_wait_ms": 3.0548320020030046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1703520, "timesteps_this_iter": 131040, "agent_timesteps_total": 1703520, "timers": {"sample_time_ms": 38197.816, "sample_throughput": 3430.563, "load_time_ms": 22.022, "load_throughput": 5950365.725, "learn_time_ms": 15219.395, "learn_throughput": 8610.067, "update_time_ms": 2.38}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812499999999e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 383.05046798406084, "policy_loss": 0.004670234260542752, "vf_loss": 76.605225046903, "vf_explained_var": -0.015181034055661985, "kl": 0.0015979497857001189, "entropy": -0.19992744185591257, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1703520, "num_agent_steps_sampled": 1703520, "num_steps_trained": 1703520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1703520}, "done": false, "episodes_total": 3680, "training_iteration": 13, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-31-11", "timestamp": 1691001071, "time_this_iter_s": 39.94700527191162, "time_total_s": 544.2932608127594, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 544.2932608127594, "timesteps_since_restore": 1703520, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 46.81403508771929, "ram_util_percent": 74.95087719298243}}
{"evaluation": {"episode_reward_max": -1904.1018081009388, "episode_reward_min": -1904.1018081009388, "episode_reward_mean": -1904.1018081009388, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1904.1018081009388], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -815.9573450088501, "episode_reward_min": -5097.669234961271, "episode_reward_mean": -1437.3996595579385, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1175.6448674499989, -1891.2776393592358, -2985.744263768196, -1270.7840929031372, -1317.2931340634823, -1105.5726995170116, -1858.3201980292797, -1382.562925696373, -977.1495680510998, -1022.1860141456127, -981.7787698805332, -1335.62481290102, -1119.5838487148285, -1107.5033587515354, -866.9836799800396, -841.0386086702347, -1199.6642935872078, -1291.9905107617378, -1174.4596970379353, -887.8809301257133, -1137.0665190517902, -1405.0612471997738, -1134.0171074867249, -1306.2189419865608, -911.8761569559574, -959.694146335125, -4869.356117725372, -1058.8199467658997, -1087.3440103530884, -1445.0279057323933, -1119.6924530565739, -1517.4023657739162, -1616.3051516711712, -1253.084822177887, -1372.767440468073, -1381.01411780715, -1007.3515014648438, -1592.1016557514668, -839.1147781312466, -1997.3329671919346, -1322.8714255094528, -898.9834102988243, -1104.9318057894707, -1504.6685418784618, -1346.2289585769176, -1432.3145346343517, -5097.669234961271, -1558.7943524718285, -1050.136997193098, -1218.9376900792122, -1559.213775753975, -1683.6889450252056, -1137.6049256324768, -2256.3544428646564, -1337.9882941246033, -2282.0520237982273, -1120.0750151872635, -1552.0682656764984, -1260.3941860198975, -945.8098061084747, -1184.6837918162346, -1232.5590905547142, -1118.0099392533302, -853.9273634254932, -1014.468955039978, -1467.754184603691, -4429.155153989792, -815.9573450088501, -1027.2984253764153, -1730.5930880606174, -1368.849629998207, -1565.3457728922367, -1195.4191413223743, -1509.3077780008316, -1985.75668284297, -974.282884657383, -2117.433843165636, -1390.9748902320862, -1655.7055670022964, -957.3177386522293, -1789.3096638023853, -1996.5806244015694, -1139.944684714079, -950.107569873333, -1366.3506610393524, -1010.3725892007351, -2938.3092238008976, -1253.3444420099258, -871.2113637328148, -1370.5429752469063, -828.5077939629555, -1058.2688328325748, -1420.381020963192, -1025.4403536319733, -1571.668439000845, -1859.1397606134415, -1376.6078135371208, -1107.1181026399136, -1908.4655724465847, -829.0133043825626], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.453309378671854, "mean_inference_ms": 4.453318244920328, "mean_action_processing_ms": 4.245327549928739, "mean_env_wait_ms": 3.0376722417846636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1834560, "timesteps_this_iter": 131040, "agent_timesteps_total": 1834560, "timers": {"sample_time_ms": 35981.527, "sample_throughput": 3641.869, "load_time_ms": 20.874, "load_throughput": 6277522.716, "learn_time_ms": 15183.231, "learn_throughput": 8630.574, "update_time_ms": 2.367}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4414062499999995e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 380.87375236962936, "policy_loss": 0.003912278363433654, "vf_loss": 76.17063515502493, "vf_explained_var": -0.020102004423790936, "kl": 0.0012750866952040117, "entropy": -0.2047843055592643, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1834560, "num_agent_steps_sampled": 1834560, "num_steps_trained": 1834560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1834560}, "done": false, "episodes_total": 3680, "training_iteration": 14, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-31-26", "timestamp": 1691001086, "time_this_iter_s": 15.241118669509888, "time_total_s": 559.5343794822693, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 559.5343794822693, "timesteps_since_restore": 1834560, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 14.671428571428569, "ram_util_percent": 74.32380952380952}}
{"evaluation": {"episode_reward_max": -2661.535626143217, "episode_reward_min": -2661.535626143217, "episode_reward_mean": -2661.535626143217, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2661.535626143217], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -637.5134914517403, "episode_reward_min": -7283.419168502092, "episode_reward_mean": -1246.4302167913565, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.40214702487, -1010.8478911221027, -1254.3981896042824, -943.076448738575, -1486.1909130811691, -5073.899177312851, -1700.9715823829174, -861.894881695509, -1210.3054039776325, -792.9162520170212, -1374.2075055837631, -2480.7716898322105, -1383.4111619591713, -1165.092965811491, -1099.146630436182, -1362.8862667679787, -863.6300358772278, -816.6518695354462, -1346.5680246055126, -1490.6636455059052, -1040.7210042476654, -1470.3549693226814, -1558.8610998392105, -1443.7874858379364, -1545.7330090403557, -1293.308708012104, -1074.6936374008656, -1219.5638263225555, -1050.491996228695, -1216.5722028315067, -1290.4328503012657, -1327.242155611515, -955.8998987078667, -1208.8046157956123, -1324.145232796669, -1201.5306447148323, -746.95176461339, -1084.839775055647, -1022.7326311469078, -1211.3427607119083, -1310.6839427649975, -1259.9809767007828, -2061.754976093769, -925.8565811514854, -974.1939952671528, -889.0214799940586, -1267.548856973648, -1353.5385263562202, -961.4598867297173, -936.2948162257671, -865.8851104676723, -1197.8572428524494, -1086.4055916368961, -817.4359846413136, -998.7898123562336, -1128.5192997157574, -1477.8877308368683, -1462.1731043159962, -995.1839870214462, -1394.9988070726395, -1747.0053058564663, -642.1718917191029, -1443.9990799725056, -889.9947764277458, -1905.7252715826035, -1079.9174449443817, -740.0857799649239, -1279.9112012982368, -1069.5763136148453, -1195.80385312438, -1087.2781242728233, -1267.7645367085934, -851.1272514164448, -1117.8501676619053, -1587.7408920228481, -1029.3120617866516, -1272.7740247547626, -1299.7755400240421, -1494.8380624353886, -963.4557082951069, -849.2862869501114, -1505.262158870697, -1364.130847364664, -1462.0127764642239, -1260.7934796512127, -1036.6189414858818, -886.7129601240158, -1216.0615504980087, -1077.2994874715805, -1059.566099524498, -1177.1717267632484, -1082.010733783245, -1210.4201208651066, -1127.3504059314728, -940.582051217556, -6746.084664404392, -1008.8552008569241, -1452.538970977068, -1151.2935954630375, -991.8120198249817, -843.065831720829, -1130.3497588336468, -798.5966168940067, -1208.333996772766, -904.3163791298866, -1253.8145102858543, -2066.5759784579277, -1410.8487004935741, -1222.9439469873905, -1151.2573517262936, -1050.4260986447334, -979.7234598696232, -960.5061793625355, -985.7341497838497, -1627.629889845848, -996.439672678709, -1315.1497457027435, -790.2497286200523, -1402.0904053747654, -1115.716937482357, -1089.1441094875336, -786.9025572538376, -1083.8619847297668, -1427.7625480890274, -1200.846805870533, -930.8987275958061, -1464.916084855795, -1403.3885198235512, -891.3289780914783, -1895.2128209471703, -1269.6102777719498, -1647.8642757833004, -951.498666703701, -1021.1260938644409, -1072.5653310716152, -906.0183811187744, -1004.9397057890892, -972.6277697980404, -1305.7568877339363, -1657.7634940743446, -1038.0756042897701, -1533.0537694096565, -797.5518110692501, -1351.687567770481, -1278.6618660390377, -1293.679350823164, -1862.2752752900124, -1376.0552578270435, -840.1823900938034, -1279.6086376607418, -1015.2706790864468, -1642.3763654530048, -829.0658495724201, -946.2746431529522, -1450.6018160581589, -1147.694570839405, -973.2745023965836, -1039.7063272893429, -1653.1504182219505, -1025.9557911753654, -975.0415865182877, -874.0002135038376, -874.1273409128189, -1171.157467275858, -881.7670364975929, -954.8777603805065, -1061.4201223254204, -869.1585356593132, -968.7470549941063, -1025.016580760479, -1073.975067526102, -1749.3010072112083, -1561.8666625022888, -1063.4522643387318, -4027.314141124487, -1513.4819711744785, -741.2473830282688, -1439.992253869772, -885.4011081159115, -1247.9828411340714, -734.576431363821, -1438.9872461557388, -989.20759126544, -922.8303137123585, -1450.740820467472, -1069.1733099222183, -1295.1314198374748, -1181.1036229729652, -1125.0905212461948, -904.3449364304543, -901.5920903384686, -1224.0787045061588, -1739.904757142067, -1121.3015828430653, -1189.4598211050034, -828.0692077279091, -916.094024926424, -1560.5181984305382, -1292.511102259159, -1434.4280368089676, -1062.1847341954708, -981.6564780771732, -941.1232783794403, -1167.4535944759846, -1107.5876852869987, -1409.4379422664642, -1346.4546163380146, -1667.577120989561, -1177.1772062778473, -1399.696944385767, -1016.9941716194153, -953.398180782795, -1307.1136100292206, -1319.3744057416916, -1236.1552287638187, -849.6624716818333, -1070.8959101438522, -844.0403318107128, -1407.3982654809952, -1308.2814245522022, -1454.1881282627583, -1027.4747691750526, -995.8341237902641, -1164.7314564287663, -1454.014354109764, -2113.110030978918, -1100.9402310550213, -1139.1914972364902, -1070.369724482298, -1138.610948830843, -1129.3758129775524, -1195.0469771921635, -1235.626706957817, -1252.9855459332466, -1495.9916603267193, -1003.8145287632942, -1559.781044960022, -1354.2552255392075, -754.9895219504833, -1176.4484049379826, -1053.3670548796654, -814.5112389326096, -1540.234117269516, -930.4820078313351, -972.3615640997887, -1117.5345495343208, -1329.2826181948185, -1325.8147712051868, -1310.3685542047024, -970.7818518877029, -1115.1778992414474, -920.195915043354, -1218.0954940617085, -1613.0795356333256, -758.1888387799263, -810.4574565291405, -1901.8886476159096, -1109.2442128062248, -1380.9306551516056, -1624.9225236177444, -944.2370833158493, -987.3780801892281, -1281.4174808561802, -1046.8002918362617, -1324.332093179226, -1254.047076791525, -1051.6310580074787, -1651.3948687314987, -931.8955513238907, -1027.9940609633923, -4802.868600189686, -1104.8817762434483, -1211.7627607285976, -1020.2657624483109, -867.5964049100876, -866.0047894120216, -811.9124178886414, -750.7710544466972, -1030.1254686415195, -941.4670012891293, -1158.3620711266994, -1372.7428730726242, -1157.8868684768677, -997.6181048154831, -1085.2937453091145, -891.3391408920288, -1088.2155559957027, -1111.606746584177, -1764.0536603331566, -1212.859375834465, -1404.4503619670868, -998.2112803161144, -936.5989895761013, -1087.8664043545723, -1421.074877023697, -1844.6333392262459, -1381.3226740658283, -1210.719928264618, -888.7060668170452, -891.2652607858181, -1112.9440940618515, -1001.5205179154873, -1040.1791909337044, -850.2428942620754, -1111.8478853106499, -982.1883438229561, -1053.5868706405163, -1156.766353070736, -2027.2891441881657, -1197.9496946036816, -1239.1451444327831, -932.8046333789825, -2292.8705036640167, -1043.0539847910404, -1623.3812855482101, -869.359286904335, -962.546606361866, -1691.745617032051, -1259.9737423360348, -777.6332211494446, -1058.547406643629, -1204.0824080705643, -882.0103715360165, -988.4107974767685, -877.8980977237225, -1276.6529439985752, -5260.115592896938, -1258.6480478346348, -1529.4725184738636, -872.8051625788212, -1323.3035681545734, -871.3621625304222, -1604.1785773932934, -1067.1199797391891, -1158.5494250953197, -968.7836419939995, -1282.993912100792, -1294.606237322092, -1371.2337270379066, -1765.8318111598492, -1034.1318744421005, -1531.2170523703098, -989.1717267036438, -1258.2203697562218, -779.3710026741028, -1116.5612002313137, -1150.7522023320198, -1591.7755233049393, -870.6733328402042, -858.3895052373409, -970.3820334076881, -1249.0514262616634, -1212.8830975592136, -1086.7882351279259, -1748.1814887225628, -953.442375689745, -940.5328750908375, -1313.7491108179092, -965.6548025012016, -1440.519778907299, -1183.41350248456, -948.1435469985008, -1437.7713440954685, -1127.1824546158314, -921.2124255895615, -849.1498770415783, -816.6304885745049, -1093.668189048767, -1333.844108313322, -3006.947311580181, -792.9567550122738, -2045.906945437193, -1698.1222205162048, -1047.8052247166634, -1127.883357077837, -1128.8532890677452, -1043.5088098943233, -1094.7528908252716, -1317.9233660697937, -889.2660744190216, -1373.8193569481373, -889.7271550297737, -7283.419168502092, -1078.634273916483, -1046.0348261594772, -1250.4624063670635, -1022.0272039473057, -1125.6850455105305, -1535.248209297657, -871.5636420845985, -991.7872761487961, -1571.1350400149822, -1375.0641221404076, -989.6376649141312, -1192.267137825489, -1239.001611739397, -1031.206741899252, -695.2487132549286, -729.4647423624992, -1140.5124147832394, -1132.6445413529873, -1070.8937159180641, -1212.267843067646, -1090.670079946518, -2709.2341143488884, -1155.5934236049652, -1581.2120371460915, -875.7269316911697, -945.5809672772884, -1800.545536607504, -1065.3127014040947, -1022.9385755956173, -1551.0070148408413, -896.2137749791145, -1606.5333196520805, -970.170471727848, -1220.4089936614037, -1095.1029214262962, -1253.1289865672588, -1119.244905948639, -974.0666413605213, -1784.2988685667515, -1084.2950944304466, -1212.9721488654613, -1001.7710627317429, -1398.039195895195, -1992.5998341739178, -945.6397005021572, -1333.3274043500423, -1492.7960689663887, -1044.4123548269272, -1516.3524527847767, -1019.6548654735088, -1852.6126946508884, -1234.9293808341026, -790.8807777762413, -1264.8128325343132, -1160.0044167637825, -1147.454772055149, -1192.5292594134808, -1092.4146935343742, -986.8241513967514, -1325.609807729721, -1352.1090105175972, -1226.1511493623257, -1403.9250687658787, -1288.125874787569, -1633.5566473901272, -1077.0200206637383, -1007.95858502388, -1279.066105633974, -1099.1435906887054, -2397.7163220643997, -824.8066259622574, -1403.3487223684788, -1018.1653411388397, -1161.8848303854465, -997.7733555436134, -637.5134914517403, -1407.9341151118279, -879.5627094507217, -1468.588379651308, -1015.548828035593, -1175.5403400659561, -940.2457092702389, -854.49085983634, -1189.9607738554478, -834.1474072039127, -1438.8659673333168, -1061.734256118536, -874.6212967932224, -879.4431244432926, -946.309870570898, -1236.159070700407, -3928.649842262268, -992.8531179726124, -1427.995736926794, -1491.495609909296, -874.3366888463497, -793.2150991559029], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.368408141996695, "mean_inference_ms": 4.454025892936651, "mean_action_processing_ms": 4.162692776257551, "mean_env_wait_ms": 3.048702543448601, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1965600, "timesteps_this_iter": 131040, "agent_timesteps_total": 1965600, "timers": {"sample_time_ms": 38304.414, "sample_throughput": 3421.016, "load_time_ms": 22.598, "load_throughput": 5798625.9, "learn_time_ms": 15157.124, "learn_throughput": 8645.44, "update_time_ms": 2.364}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2207031249999997e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 372.05865455593226, "policy_loss": 0.0035090188118039505, "vf_loss": 74.40801695683524, "vf_explained_var": -0.01828866588172092, "kl": 0.0012394517846978563, "entropy": -0.20646733630408523, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1965600, "num_agent_steps_sampled": 1965600, "num_steps_trained": 1965600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1965600}, "done": false, "episodes_total": 4160, "training_iteration": 15, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-32-05", "timestamp": 1691001125, "time_this_iter_s": 38.95370316505432, "time_total_s": 598.4880826473236, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 598.4880826473236, "timesteps_since_restore": 1965600, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.77499999999999, "ram_util_percent": 73.89107142857142}}
{"evaluation": {"episode_reward_max": -1724.783617734909, "episode_reward_min": -1724.783617734909, "episode_reward_mean": -1724.783617734909, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1724.783617734909], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -637.5134914517403, "episode_reward_min": -7283.419168502092, "episode_reward_mean": -1281.7463963449002, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1373.8193569481373, -889.7271550297737, -7283.419168502092, -1078.634273916483, -1046.0348261594772, -1250.4624063670635, -1022.0272039473057, -1125.6850455105305, -1535.248209297657, -871.5636420845985, -991.7872761487961, -1571.1350400149822, -1375.0641221404076, -989.6376649141312, -1192.267137825489, -1239.001611739397, -1031.206741899252, -695.2487132549286, -729.4647423624992, -1140.5124147832394, -1132.6445413529873, -1070.8937159180641, -1212.267843067646, -1090.670079946518, -2709.2341143488884, -1155.5934236049652, -1581.2120371460915, -875.7269316911697, -945.5809672772884, -1800.545536607504, -1065.3127014040947, -1022.9385755956173, -1551.0070148408413, -896.2137749791145, -1606.5333196520805, -970.170471727848, -1220.4089936614037, -1095.1029214262962, -1253.1289865672588, -1119.244905948639, -974.0666413605213, -1784.2988685667515, -1084.2950944304466, -1212.9721488654613, -1001.7710627317429, -1398.039195895195, -1992.5998341739178, -945.6397005021572, -1333.3274043500423, -1492.7960689663887, -1044.4123548269272, -1516.3524527847767, -1019.6548654735088, -1852.6126946508884, -1234.9293808341026, -790.8807777762413, -1264.8128325343132, -1160.0044167637825, -1147.454772055149, -1192.5292594134808, -1092.4146935343742, -986.8241513967514, -1325.609807729721, -1352.1090105175972, -1226.1511493623257, -1403.9250687658787, -1288.125874787569, -1633.5566473901272, -1077.0200206637383, -1007.95858502388, -1279.066105633974, -1099.1435906887054, -2397.7163220643997, -824.8066259622574, -1403.3487223684788, -1018.1653411388397, -1161.8848303854465, -997.7733555436134, -637.5134914517403, -1407.9341151118279, -879.5627094507217, -1468.588379651308, -1015.548828035593, -1175.5403400659561, -940.2457092702389, -854.49085983634, -1189.9607738554478, -834.1474072039127, -1438.8659673333168, -1061.734256118536, -874.6212967932224, -879.4431244432926, -946.309870570898, -1236.159070700407, -3928.649842262268, -992.8531179726124, -1427.995736926794, -1491.495609909296, -874.3366888463497, -793.2150991559029], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.440748105563993, "mean_inference_ms": 4.45640289251334, "mean_action_processing_ms": 4.2528665004818995, "mean_env_wait_ms": 3.0374743226192154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2096640, "timesteps_this_iter": 131040, "agent_timesteps_total": 2096640, "timers": {"sample_time_ms": 35905.934, "sample_throughput": 3649.536, "load_time_ms": 21.01, "load_throughput": 6236939.891, "learn_time_ms": 15211.51, "learn_throughput": 8614.529, "update_time_ms": 2.363}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.103515624999999e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 371.30121141288834, "policy_loss": 0.000457967432833816, "vf_loss": 74.25957647617572, "vf_explained_var": -0.006595596831331971, "kl": 0.0012294740424872005, "entropy": -0.20964777880885696, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2096640, "num_agent_steps_sampled": 2096640, "num_steps_trained": 2096640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2096640}, "done": false, "episodes_total": 4160, "training_iteration": 16, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-32-21", "timestamp": 1691001141, "time_this_iter_s": 15.370208263397217, "time_total_s": 613.8582909107208, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 613.8582909107208, "timesteps_since_restore": 2096640, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.995454545454544, "ram_util_percent": 74.63636363636364}}
{"evaluation": {"episode_reward_max": -931.2995125055313, "episode_reward_min": -931.2995125055313, "episode_reward_mean": -931.2995125055313, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-931.2995125055313], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -551.2348234057426, "episode_reward_min": -8087.699676781893, "episode_reward_mean": -1131.2196741542468, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-962.5871509313583, -871.5635117888451, -1083.6752558350563, -932.8862907290459, -968.3990728259087, -1282.5973604023457, -1197.0250218212605, -1377.366825670004, -1401.8177430927753, -630.7011381089687, -1086.5041969120502, -1321.7321671843529, -1113.0574905872345, -818.090059876442, -1128.126148313284, -804.9914098978043, -925.6937213242054, -1099.1174076497555, -835.5806879401207, -574.6123414933681, -1038.5977011024952, -954.2123216688633, -1051.0591809749603, -1081.799879103899, -1608.889973372221, -1160.725020647049, -1375.3425438702106, -825.3744835555553, -827.2643821537495, -863.8635890781879, -1087.1987482011318, -694.6929575502872, -1058.523274987936, -1165.1596857607365, -828.0791956484318, -907.6241316795349, -1008.3542849719524, -902.2015525698662, -1069.5627680122852, -1180.7933142185211, -831.1670545339584, -1201.495905727148, -1108.1634494662285, -827.3076464235783, -944.0257833003998, -955.8445406854153, -1117.2065286934376, -8087.699676781893, -726.7316977381706, -1164.9721120893955, -1406.9842659235, -1021.0504143834114, -1076.2384763658047, -780.7992325425148, -988.1133554577827, -1283.1908342838287, -926.5240494310856, -1036.3549217879772, -1847.914259403944, -798.5583958625793, -1235.0327622294426, -872.2922486066818, -740.1354664862156, -896.2606818974018, -959.2312606871128, -969.7559084296227, -816.1918512284756, -943.0333479046822, -1668.6923504769802, -1130.063076198101, -962.3545415997505, -831.7194221019745, -1513.5175561904907, -1081.9481843411922, -903.7421018779278, -983.5258537530899, -844.3083649277687, -878.9389000535011, -872.3624213039875, -1064.9496211111546, -799.9199682176113, -840.8533360660076, -1202.0960791409016, -877.1460742652416, -1281.677149951458, -823.3129974007607, -1168.951335221529, -1127.9083791971207, -872.4101949036121, -1277.3248456716537, -811.6546700000763, -831.8107201457024, -876.9838559031487, -795.1525648534298, -879.4012475311756, -779.9559541642666, -748.5385350286961, -1075.3566161990166, -1196.959457039833, -982.2577412426472, -743.9207770228386, -3975.146373182535, -893.6465738415718, -1541.0029484331608, -1006.53456646204, -1191.0302598178387, -1104.9390739798546, -1840.6234975159168, -860.9906840324402, -731.7732376158237, -1398.057726264, -911.8826225697994, -818.7348811626434, -1203.4239151477814, -772.8325126767159, -1054.1802127063274, -1017.7047205865383, -1355.9945020079613, -1267.8626735210419, -1200.8585419654846, -908.6149659454823, -793.557253330946, -1335.7455065846443, -1292.02616456151, -1459.7544594407082, -1010.0149691998959, -860.8040614128113, -842.1824294924736, -1015.3637066185474, -967.6120287775993, -1225.0889862179756, -770.9855384230614, -865.9647431075573, -1367.8399310410023, -1278.906580120325, -1260.5105542838573, -1040.4465614557266, -878.7042906880379, -1138.5951162576675, -1114.5356590151787, -728.8875322341919, -4697.915506452322, -1027.3730147182941, -1174.027277469635, -958.4874778389931, -1028.5913669466972, -885.748088479042, -936.0989879965782, -760.4524827599525, -2375.9558420181274, -814.916788905859, -903.8847933411598, -818.0528391599655, -817.3955582678318, -1226.1498233377934, -1014.8083681464195, -1294.9912353754044, -772.7740196585655, -1264.4161095023155, -914.4166820943356, -1071.891587227583, -965.0606096088886, -1340.6114956438541, -1217.2575350403786, -1040.884727269411, -984.8298535048962, -1931.0176948606968, -1473.3189130425453, -1043.173850506544, -1735.3992910683155, -1327.054120361805, -851.5709508061409, -935.6858884394169, -1054.1130848526955, -839.8609589338303, -833.2021612226963, -897.9025984108448, -1017.4472577273846, -1256.4076714515686, -1728.4573591649532, -978.667411595583, -551.2348234057426, -756.9554850161076, -1036.5949018001556, -919.7405286133289, -857.3696858584881, -916.1713726222515, -1026.020343631506, -903.928947865963, -1214.3983955979347, -850.6183722913265, -1504.3201789557934, -1061.1995351016521, -897.7609457671642, -1261.2045119702816, -948.7772217988968, -830.5006902515888, -1092.2389810681343, -1060.2195298671722, -1333.310916930437, -839.256952047348, -891.7583640217781, -697.771066814661, -1044.6450792849064, -1875.0829020440578, -739.7880337834358, -1023.877927094698, -807.7265253067017, -1254.738549977541, -1064.0162910223007, -853.5719253718853, -1002.154104501009, -892.9152125120163, -1127.0011628568172, -1060.4413503110409, -1197.394021242857, -1383.6428770422935, -788.1624226570129, -997.1822708547115, -1012.4508375525475, -933.9981845617294, -868.9136839210987, -798.7427273392677, -1330.349505096674, -1215.6542491614819, -1275.1761914491653, -894.4317310452461, -895.9704226851463, -1488.9253228604794, -1252.2434778511524, -990.8941981196404, -908.1448611319065, -799.5789594650269, -812.9837113320827, -816.8424106240273, -1872.6230074763298, -1008.1665571331978, -926.6169078946114, -1548.700466066599, -1039.7467623353004, -983.639223575592, -1535.6347821056843, -1673.986478805542, -920.8875143229961, -877.6828566491604, -1051.4920775294304, -780.4521001577377, -968.5183201730251, -1465.507220864296, -1160.1412112116814, -1144.9287220835686, -1007.3521567881107, -2068.9891045987606, -969.3107756078243, -962.5248821079731, -872.2076577842236, -945.517900288105, -1146.3943220973015, -928.6623719036579, -1270.926279246807, -860.3166405260563, -787.6646148860455, -717.7491336166859, -968.7130243778229, -1059.0402511060238, -955.7498770058155, -953.534866720438, -975.1192435324192, -1716.8952820003033, -1172.0426295995712, -991.970337510109, -1285.7677576839924, -842.0670692920685, -865.8272450566292, -1142.2419891655445, -952.2439478933811, -877.9735108911991, -1942.9927441179752, -943.1830724477768, -1004.7487890720367, -893.7674975395203, -703.3841905295849, -959.9401929676533, -897.8580124080181, -1177.1411246657372, -874.6874926388264, -767.6047061383724, -1012.1383319795132, -5597.101383894682, -1186.9599338173866, -2413.2200576364994, -1057.4420142769814, -995.6865423321724, -782.8397014141083, -1823.074809461832, -1292.7892491221428, -1105.9980732500553, -1127.4510880410671, -1220.6038728058338, -1025.2482893168926, -869.0667076706886, -761.5462690889835, -1111.5222464501858, -1489.944094479084, -1656.937997162342, -1365.751417040825, -2774.1195959746838, -1196.6080659627914, -838.392850548029, -821.1950887441635, -1176.5755053162575, -839.6326466202736, -1172.0755429267883, -1140.7516725957394, -987.9584635794163, -1386.990460306406, -878.9228716790676, -731.5979582667351, -831.5754801630974, -792.2114502489567, -1113.5088984072208, -993.0014963746071, -1005.5291639566422, -1037.6658865511417, -867.8748108148575, -893.6741776168346, -952.7257135212421, -1133.3336998522282, -1458.5260586738586, -681.5998421311378, -1179.2277464270592, -1144.3750047683716, -901.438153475523, -4191.310981661081, -816.2760162949562, -849.5514684021473, -1810.0137309730053, -1122.650305479765, -1179.1079305410385, -787.6783490777016, -1033.2774026095867, -960.0676624178886, -1059.3565498888493, -832.7079539597034, -898.2836132347584, -739.1426497399807, -1086.9966025650501, -786.9039016664028, -1535.3463404774666, -1235.7350534498692, -1291.5482271909714, -1140.269359409809, -974.5507515668869, -1060.062361806631, -2225.0227650403976, -750.6190659701824, -916.0035040676594, -778.9503245651722, -1085.1254820525646, -1502.1022835075855, -1681.8870639801025, -1141.6546863615513, -725.236299186945, -847.5002681314945, -826.8273134231567, -1388.8773468732834, -796.5087205767632, -731.1976376473904, -1333.4182472229004, -1787.654575496912, -6892.084696680307, -802.6244165897369, -1429.7408706843853, -4851.454085946083, -725.3950673639774, -837.4923629462719, -1145.1524922549725, -1096.8975458741188, -941.082810997963, -683.2813389599323, -824.080862313509, -977.7046622037888, -1116.9514051675797, -860.3249662816525, -747.0643104016781, -1005.0035955011845, -995.9584816098213, -934.6380140781403, -1061.2841938436031, -1231.6700384020805, -1166.2788725793362, -854.9431879520416, -959.0855693817139, -844.5566172301769, -784.6172724366188, -786.3598548173904, -1238.3230832219124, -847.5180494189262, -889.7440221011639, -815.0615542531013, -951.000745087862, -1042.0330604612827, -756.5242681503296, -730.615201562643, -899.0280809700489, -1193.9453919231892, -1382.7412498891354, -775.6909784376621, -1093.5165794491768, -1180.2074474692345, -910.654558122158, -899.6266291737556, -1085.1046815514565, -786.3461506664753, -1235.8984653651714, -879.5836572051048, -1111.661739140749, -1693.6999310553074, -1613.772149413824, -1094.3669902980328, -1004.8084078729153, -7546.558907717466, -1302.1895633637905, -1184.5677290856838, -806.9658313989639, -984.7745810747147, -887.8217842876911, -1305.8115529716015, -1265.9060288071632, -746.5047023296356, -792.1641345620155, -1113.0241886675358, -1282.3138232827187, -1688.9820684790611, -827.8143738508224, -1284.2948006689548, -890.3657057285309, -1071.7955081164837, -915.2851286828518, -801.2748924195766, -766.2688681781292, -881.959779381752, -867.3421224057674, -1663.4375465512276, -1043.5824655890465, -848.7052230238914, -821.2954247891903, -933.7635945677757, -804.5096301734447, -857.4805028438568, -1457.9490030407906, -669.3300941884518, -669.5588675737381, -870.4549781680107, -1099.6984802484512, -853.4599629044533, -917.666734546423, -1083.4615111351013, -1074.9223794937134, -1326.0362516641617, -991.6233391463757, -1037.656338840723, -983.8494979143143, -1230.3055175244808, -989.542399674654, -907.4673189520836, -1164.053275257349, -856.188243329525, -1064.7306773662567, -1222.7133302688599, -727.6993176043034, -1130.468860089779, -716.3879490792751, -821.9928302764893, -959.5601303875446, -1777.4460111558437, -761.7093911468983, -896.3869584798813, -960.3648702502251, -982.0701238811016], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3648184103081915, "mean_inference_ms": 4.456475720727485, "mean_action_processing_ms": 4.16135991326188, "mean_env_wait_ms": 3.0464913767941764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2227680, "timesteps_this_iter": 131040, "agent_timesteps_total": 2227680, "timers": {"sample_time_ms": 38345.743, "sample_throughput": 3417.328, "load_time_ms": 22.67, "load_throughput": 5780342.938, "learn_time_ms": 15243.79, "learn_throughput": 8596.287, "update_time_ms": 2.38}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0517578124999993e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 365.09653108396463, "policy_loss": -0.0002495195823308368, "vf_loss": 73.01934170466598, "vf_explained_var": -0.0011615673060058266, "kl": 0.001761713741391007, "entropy": -0.21534312356223342, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2227680, "num_agent_steps_sampled": 2227680, "num_steps_trained": 2227680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2227680}, "done": false, "episodes_total": 4640, "training_iteration": 17, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-33-00", "timestamp": 1691001180, "time_this_iter_s": 39.38389325141907, "time_total_s": 653.2421841621399, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 653.2421841621399, "timesteps_since_restore": 2227680, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.93035714285715, "ram_util_percent": 74.40892857142856}}
{"evaluation": {"episode_reward_max": -1522.3090813457966, "episode_reward_min": -1522.3090813457966, "episode_reward_mean": -1522.3090813457966, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1522.3090813457966], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.327288636199007, "mean_inference_ms": 3.7504266668390205, "mean_action_processing_ms": 1.2383973086392368, "mean_env_wait_ms": 196.38694154394494, "mean_env_render_ms": 3.029353849656813}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -588.2327842116356, "episode_reward_min": -4661.539143294096, "episode_reward_mean": -972.2286968410637, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-774.5917644202709, -1026.2530946433544, -1423.4664511680603, -851.9466557502747, -905.4144198894501, -1523.88638189435, -1137.935662984848, -1080.0841262340546, -801.0691150724888, -848.7217837274075, -704.5266354084015, -666.0276735126972, -676.4873197376728, -943.6423589885235, -1025.7628382444382, -1027.7142165601254, -875.290501832962, -942.9254224598408, -844.8762939870358, -753.9332486689091, -968.3574000000954, -700.3306421637535, -1117.9409626424313, -1155.4745770692825, -890.456071138382, -822.5708134174347, -790.3256463110447, -868.2832767367363, -825.8337600231171, -1682.4262674450874, -752.808330476284, -827.4887402355671, -839.562662422657, -1057.7763557732105, -753.3168906867504, -735.5543011724949, -782.2057746946812, -1167.4517478048801, -1051.9773828089237, -721.4455237090588, -811.3811255395412, -800.189840734005, -1243.9950968623161, -770.4559513032436, -927.7118778824806, -732.9886797070503, -753.9075579345226, -1085.483692675829, -1039.139466702938, -753.0265985429287, -965.0182656049728, -870.7785619795322, -2457.244511425495, -1094.823773354292, -1125.5872280597687, -956.2085273563862, -1020.208111256361, -1005.7992378473282, -838.1761363148689, -694.0238777399063, -961.6953769922256, -750.9873860478401, -1023.4578525722027, -845.0696755051613, -1252.4389338195324, -970.2676067352295, -816.8002676069736, -1489.874850332737, -1123.4076422452927, -1222.5917402505875, -773.4487211704254, -939.626828700304, -3780.898007005453, -791.1654694676399, -786.4889633953571, -890.2516772449017, -726.6091866195202, -1291.6510711610317, -845.7624761462212, -885.1347925961018, -829.4965842068195, -778.8221257030964, -919.176242440939, -853.2154451608658, -840.595921009779, -671.9706965684891, -822.001672834158, -716.285497456789, -823.8295969963074, -896.8527472615242, -1035.5692467689514, -811.9703840315342, -1003.4055040478706, -1002.6265898048878, -1103.5166622698307, -1417.887620806694, -765.2940811514854, -713.0342756807804, -725.9060010015965, -1619.1459964215755, -1125.073632657528, -1336.635434627533, -1169.028761267662, -838.7661662697792, -780.3372387886047, -793.9238688051701, -1209.8475535809994, -925.5716587603092, -793.8350928127766, -1145.6465376019478, -1065.7366496920586, -1069.827607423067, -886.1749222576618, -825.6273379027843, -979.2781249880791, -696.3228742182255, -863.8783610165119, -858.7232197523117, -797.7822590172291, -940.7057183384895, -656.0339193046093, -657.2546229660511, -2544.704283207655, -784.1607075631618, -791.2224415540695, -651.0580579042435, -821.6619786918163, -964.1326397955418, -1074.9534702301025, -952.6205077767372, -983.2651551663876, -708.1882819533348, -1515.2565459609032, -913.5274907052517, -838.4902422726154, -743.4800761044025, -881.0017568171024, -758.9652695655823, -871.4652065336704, -713.7556730210781, -856.1068486869335, -1024.7358830869198, -1027.746714681387, -923.0121840536594, -800.1470604240894, -978.4475488960743, -798.947217643261, -854.7084607481956, -712.6975895166397, -911.3549935519695, -756.4719982743263, -700.3303093314171, -876.4561513364315, -682.9273318946362, -2899.0674488842487, -688.836110830307, -918.0348930060863, -990.1281561553478, -779.9416156113148, -832.6102541983128, -796.9879025220871, -732.2953182756901, -864.8292493522167, -875.385614335537, -829.078995525837, -1396.5903648734093, -766.0644253790379, -786.2077295482159, -1070.1650823950768, -751.3270414471626, -783.0517863631248, -704.0853841900826, -932.4599360227585, -792.8916638791561, -948.3266215324402, -893.7366069257259, -959.2100486755371, -902.5237738192081, -857.3035960495472, -689.2694348096848, -862.6443962156773, -983.2257565557957, -892.6715235710144, -721.6849318742752, -724.9186579883099, -1016.7348675429821, -1146.50390920043, -891.1825834810734, -873.2037234604359, -902.8189749121666, -957.987386405468, -760.0458136796951, -1101.7425867021084, -815.5410941243172, -706.6088283360004, -712.0128632485867, -1014.1284405887127, -696.7061306238174, -1389.0202263891697, -767.0788153111935, -1282.5134594142437, -826.8392460048199, -755.9511830806732, -1077.9641943871975, -773.3474764227867, -939.2340980768204, -1254.9056296646595, -962.1088534891605, -709.1355585455894, -791.0810835957527, -780.0966553986073, -1027.604642212391, -1404.4016984701157, -892.088333517313, -859.5326271355152, -823.9597847163677, -1086.6845670342445, -1330.7375725209713, -1608.661402106285, -1171.2305848896503, -784.6960179507732, -770.479624658823, -870.6111105978489, -896.3598572015762, -1192.3508951067924, -1616.0435057282448, -1010.0629913508892, -1113.986106455326, -831.1273956298828, -857.7606280744076, -645.9533880352974, -737.3234430253506, -1261.0801794528961, -1250.5065428316593, -1099.1055264770985, -857.5530698001385, -1152.1122577488422, -926.4780071973801, -740.2255758047104, -920.6724855601788, -734.6583933234215, -883.575307905674, -717.8743868470192, -1172.224267244339, -839.1953133642673, -939.7995824813843, -979.454515337944, -1525.0761843323708, -1396.9339121580124, -1314.1937935352325, -756.5679654181004, -943.4639331996441, -723.9272912144661, -969.4617454707623, -712.9260263442993, -852.9766233861446, -898.2486568391323, -731.6944851577282, -1111.766435623169, -868.5288037359715, -787.9219486415386, -780.8882985711098, -777.1119081377983, -1261.9533879756927, -874.232497304678, -1040.9038207828999, -614.4449774324894, -857.4745053648949, -845.6134255230427, -1003.6554126143456, -1334.9839980602264, -896.0028398633003, -844.0460274219513, -951.4474534988403, -1105.932990372181, -926.5285304784775, -905.2849672138691, -756.595317542553, -1072.2412725687027, -882.4287652075291, -1119.0795862078667, -987.335830271244, -1344.6592662632465, -732.0002187490463, -714.2062056064606, -860.6858622431755, -866.524876087904, -905.9727919697762, -931.5603080391884, -837.516576975584, -671.0106399357319, -1130.7338122725487, -852.2907092869282, -976.4294956922531, -836.9971262216568, -978.6708646118641, -1416.2185851037502, -801.1850018501282, -727.334846496582, -872.34394800663, -874.3370632529259, -1187.317415446043, -1062.7663749456406, -789.5437152683735, -877.3777801394463, -1607.3875157535076, -777.4214033484459, -830.9949699044228, -825.2171431481838, -817.6905871033669, -921.5895355939865, -928.8450198769569, -922.0505921244621, -850.4202469587326, -712.4578382372856, -828.5693189203739, -848.9502740502357, -826.0820356607437, -1019.072595089674, -980.4841018915176, -825.1474300920963, -716.169055044651, -869.3485273718834, -771.8887498676777, -887.974595695734, -999.572182238102, -1009.4769803583622, -1036.2851150631905, -834.83507797122, -934.9287150800228, -1682.446493268013, -964.0324208140373, -1322.67555642128, -764.1787166595459, -822.9586006700993, -1192.9403013288975, -860.1182432174683, -818.727004647255, -789.9373880326748, -1192.8341635763645, -1175.2827967107296, -642.9832003116608, -723.2675971984863, -840.1847683489323, -1108.3661106824875, -1167.4822653830051, -747.5541736185551, -828.9980222284794, -934.3803860545158, -765.6917134821415, -928.7472370862961, -941.0805301070213, -729.7433266937733, -926.9724605083466, -4096.589741587639, -769.8178193867207, -1000.3897949755192, -837.3054822981358, -827.7880047261715, -752.8384718894958, -1210.0602324604988, -825.9578635692596, -848.2336125075817, -1039.2636646032333, -901.5082750320435, -653.9369187653065, -1314.1804739236832, -1629.6161119043827, -890.4428468346596, -4187.464834541082, -1036.9807696640491, -894.5963186919689, -940.8586220443249, -702.0941366255283, -817.5323140323162, -708.3666350543499, -930.4131551980972, -1051.5941741764545, -1309.797136992216, -868.2014855146408, -757.967392206192, -894.2469125688076, -1017.6835101246834, -724.932862341404, -835.3423565924168, -2347.27313503623, -926.177441984415, -990.0449377596378, -789.0709945857525, -946.0266335010529, -1016.0076312422752, -861.0877518057823, -880.3420486450195, -1171.6085608899593, -4661.539143294096, -1384.5749559402466, -951.275032132864, -836.1021168529987, -681.3049410283566, -1285.884025245905, -752.8030375242233, -732.9814843535423, -895.2137459516525, -1456.5953155755997, -788.4946700334549, -1085.7315662503242, -767.8059200048447, -908.4221870303154, -823.6533520519733, -588.2327842116356, -783.6281078457832, -779.1031539142132, -964.2529720962048, -901.5346939861774, -816.1192752420902, -860.4216284751892, -1006.9737458229065, -893.4425149261951, -958.2082703411579, -823.4453817307949, -972.1232558190823, -765.5042896270752, -904.9745044410229, -678.0263351798058, -903.3436233103275, -1021.7033324837685, -1039.839793741703, -863.6848970651627, -864.5642490983009, -686.7106998860836, -1162.1091685295105, -890.0773258507252, -933.0376789569855, -766.2905676960945, -915.805980682373, -921.207397788763, -725.460325717926, -686.5225377082825, -810.3906517624855, -909.1695975959301, -3102.095018297434, -955.822312682867, -795.9036019742489, -824.2959396243095, -1031.7857033908367, -766.8232336938381, -978.5762079358101, -995.4902695417404, -755.6726435422897, -994.8005289435387, -939.5114319622517, -662.2176966369152, -986.5907863974571, -709.4557533562183, -828.992564201355, -812.7980458438396, -681.6876483261585, -996.7341089248657, -975.1655023992062, -797.6976789236069, -970.381797760725, -1105.9508927166462, -1352.3687503039837, -1768.9267246425152, -923.7877779901028, -1507.2699781656265, -716.5537277460098, -993.6233519911766, -794.7522968649864, -681.4998176693916, -1083.9266885221004, -956.1382268369198, -804.5718302428722, -1048.2655204832554, -1334.0752080976963, -884.608979344368, -693.5676085054874, -999.688981950283, -1079.9201512932777, -1053.0941517949104], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.365782482597111, "mean_inference_ms": 4.4554175736343415, "mean_action_processing_ms": 4.1586076274766315, "mean_env_wait_ms": 3.0392594006115585, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2358720, "timesteps_this_iter": 131040, "agent_timesteps_total": 2358720, "timers": {"sample_time_ms": 38386.373, "sample_throughput": 3413.711, "load_time_ms": 22.782, "load_throughput": 5751947.55, "learn_time_ms": 15267.188, "learn_throughput": 8583.113, "update_time_ms": 2.366}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789062499997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 359.7107595924934, "policy_loss": 0.006524504283698551, "vf_loss": 71.93541010648119, "vf_explained_var": 0.006929103298426529, "kl": 0.0018222087082610796, "entropy": -0.218939427807126, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2358720, "num_agent_steps_sampled": 2358720, "num_steps_trained": 2358720, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2358720}, "done": false, "episodes_total": 5120, "training_iteration": 18, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-33-39", "timestamp": 1691001219, "time_this_iter_s": 38.64100480079651, "time_total_s": 691.8831889629364, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 691.8831889629364, "timesteps_since_restore": 2358720, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.62545454545453, "ram_util_percent": 74.77636363636363}}
{"evaluation": {"episode_reward_max": -1071.8909907341003, "episode_reward_min": -1071.8909907341003, "episode_reward_mean": -1071.8909907341003, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071.8909907341003], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -588.2327842116356, "episode_reward_min": -4661.539143294096, "episode_reward_mean": -993.111915436089, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.967392206192, -894.2469125688076, -1017.6835101246834, -724.932862341404, -835.3423565924168, -2347.27313503623, -926.177441984415, -990.0449377596378, -789.0709945857525, -946.0266335010529, -1016.0076312422752, -861.0877518057823, -880.3420486450195, -1171.6085608899593, -4661.539143294096, -1384.5749559402466, -951.275032132864, -836.1021168529987, -681.3049410283566, -1285.884025245905, -752.8030375242233, -732.9814843535423, -895.2137459516525, -1456.5953155755997, -788.4946700334549, -1085.7315662503242, -767.8059200048447, -908.4221870303154, -823.6533520519733, -588.2327842116356, -783.6281078457832, -779.1031539142132, -964.2529720962048, -901.5346939861774, -816.1192752420902, -860.4216284751892, -1006.9737458229065, -893.4425149261951, -958.2082703411579, -823.4453817307949, -972.1232558190823, -765.5042896270752, -904.9745044410229, -678.0263351798058, -903.3436233103275, -1021.7033324837685, -1039.839793741703, -863.6848970651627, -864.5642490983009, -686.7106998860836, -1162.1091685295105, -890.0773258507252, -933.0376789569855, -766.2905676960945, -915.805980682373, -921.207397788763, -725.460325717926, -686.5225377082825, -810.3906517624855, -909.1695975959301, -3102.095018297434, -955.822312682867, -795.9036019742489, -824.2959396243095, -1031.7857033908367, -766.8232336938381, -978.5762079358101, -995.4902695417404, -755.6726435422897, -994.8005289435387, -939.5114319622517, -662.2176966369152, -986.5907863974571, -709.4557533562183, -828.992564201355, -812.7980458438396, -681.6876483261585, -996.7341089248657, -975.1655023992062, -797.6976789236069, -970.381797760725, -1105.9508927166462, -1352.3687503039837, -1768.9267246425152, -923.7877779901028, -1507.2699781656265, -716.5537277460098, -993.6233519911766, -794.7522968649864, -681.4998176693916, -1083.9266885221004, -956.1382268369198, -804.5718302428722, -1048.2655204832554, -1334.0752080976963, -884.608979344368, -693.5676085054874, -999.688981950283, -1079.9201512932777, -1053.0941517949104], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.44114564189588, "mean_inference_ms": 4.4633334158005304, "mean_action_processing_ms": 4.253061834834165, "mean_env_wait_ms": 3.0309562506862973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2489760, "timesteps_this_iter": 131040, "agent_timesteps_total": 2489760, "timers": {"sample_time_ms": 36054.198, "sample_throughput": 3634.528, "load_time_ms": 21.374, "load_throughput": 6130775.778, "learn_time_ms": 15357.864, "learn_throughput": 8532.437, "update_time_ms": 2.349}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394531249998e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 349.24980244364536, "policy_loss": 0.005173416849336531, "vf_loss": 69.84456907976485, "vf_explained_var": 0.013086786300050742, "kl": 0.001503017980114667, "entropy": -0.21976877751636675, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2489760, "num_agent_steps_sampled": 2489760, "num_steps_trained": 2489760, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2489760}, "done": false, "episodes_total": 5120, "training_iteration": 19, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-35-21", "timestamp": 1691001321, "time_this_iter_s": 102.24326276779175, "time_total_s": 794.1264517307281, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 794.1264517307281, "timesteps_since_restore": 2489760, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.945890410958903, "ram_util_percent": 94.61643835616438}}
{"evaluation": {"episode_reward_max": -844.8395365178585, "episode_reward_min": -844.8395365178585, "episode_reward_mean": -844.8395365178585, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-844.8395365178585], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -530.5165240764618, "episode_reward_min": -4512.831827789545, "episode_reward_mean": -883.065089917276, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-868.1547219753265, -866.2379569113255, -798.0311576426029, -861.5563527941704, -835.9989451766014, -4168.314678996801, -1291.5197950601578, -645.7213513255119, -750.2503762245178, -1335.2070902884007, -927.6522013545036, -796.4734713435173, -752.0487075746059, -852.6827861666679, -849.4789203107357, -1156.7575809657574, -1202.2049761116505, -1005.0861119627953, -868.9648760259151, -804.142235815525, -1097.8320297002792, -691.245448589325, -853.6921095252037, -873.259497821331, -881.2948766350746, -1280.3033414781094, -764.7378348708153, -682.5711871087551, -847.6134474277496, -711.2874262332916, -770.2291068434715, -676.2502234578133, -794.1047208607197, -821.557477414608, -730.7257370650768, -780.4636471569538, -803.946687579155, -895.9241327047348, -780.549832969904, -1212.429347038269, -835.5052777528763, -779.7138857245445, -1307.6027778983116, -718.5712786912918, -2371.832896232605, -993.934777200222, -833.3117802739143, -1485.0014416575432, -4512.831827789545, -866.2094633579254, -659.6962550878525, -720.6381663680077, -649.3177095353603, -660.7106086611748, -838.7594758570194, -716.8256745636463, -724.3489020466805, -1423.9797021448612, -822.8582516312599, -888.624498039484, -809.7087677419186, -806.7985952496529, -670.6561154425144, -986.5327996313572, -934.4390190243721, -671.7309412956238, -715.2374818325043, -828.3717428743839, -853.1747400462627, -684.354161053896, -642.5442792475224, -862.3139669001102, -913.7459843754768, -708.4129740893841, -832.778696924448, -623.3462345898151, -879.2195412516594, -1015.8323602676392, -827.7587760686874, -724.8149045705795, -642.1642333865166, -706.2459664940834, -775.6903510987759, -895.1100236773491, -894.3185439109802, -963.8313510417938, -717.7464152872562, -942.7164834439754, -806.2776551544666, -690.9067912697792, -839.1016747653484, -632.4429570138454, -700.7378496229649, -727.7172550857067, -696.1628370583057, -1083.3918981552124, -631.4919186234474, -767.4674951434135, -780.4234008491039, -858.4006085693836, -818.6702374815941, -774.7740885019302, -718.4883655309677, -810.8658767938614, -645.0815830528736, -741.6712170243263, -702.0100730061531, -1531.7751837968826, -762.3781539201736, -634.7566103637218, -797.8382025361061, -711.3346374928951, -871.1260125041008, -880.8187175691128, -1052.3781417012215, -735.5955643057823, -804.1678310036659, -784.9234371483326, -879.0898782014847, -725.7713930904865, -677.7788255214691, -682.0515815019608, -619.709992647171, -822.0615090429783, -918.6362110674381, -730.8638570606709, -756.5285035967827, -3555.272358953953, -782.5889360010624, -741.0920754373074, -606.7005231082439, -658.8879839777946, -774.4275758862495, -718.6250856816769, -822.93914103508, -738.4960714578629, -809.3461552262306, -926.2926807701588, -883.503190100193, -712.2994267940521, -646.847919344902, -1037.0734465420246, -706.848519474268, -757.5514098703861, -656.0953774154186, -839.5984754562378, -723.796638906002, -947.4294295310974, -787.3581410646439, -1167.0434139370918, -727.4866322278976, -681.7438571155071, -754.0110499858856, -1030.653347492218, -808.7157814800739, -761.530612796545, -921.9587416350842, -659.0745178461075, -596.9660948216915, -725.5506316721439, -1470.8761904239655, -904.3110286593437, -1247.0085150003433, -761.27418795228, -566.3782530725002, -1129.968091160059, -823.6770077645779, -684.9485073983669, -931.9457234740257, -877.9901912808418, -530.5165240764618, -757.0462636947632, -692.7637161314487, -1907.3702349066734, -877.0314727127552, -609.9295823574066, -880.061508089304, -862.0089187324047, -800.1421043872833, -903.6399067342281, -1741.8589140474796, -855.5989454984665, -738.8353485763073, -795.2370513677597, -732.0905467569828, -668.234679877758, -867.6907480359077, -814.0895684659481, -869.7483402788639, -947.4245021045208, -726.2664197683334, -1060.3721413314342, -608.2431043684483, -753.7540186345577, -817.103418558836, -1135.2276119291782, -814.0256224274635, -831.3036844134331, -947.7909698188305, -843.1669618487358, -817.4442086815834, -775.3413139879704, -1045.1042625904083, -815.3578507304192, -676.5761180818081, -862.3747178018093, -786.8079309463501, -886.8338279724121, -880.9701387286186, -971.29634937644, -693.1115415692329, -691.5939164757729, -733.2209389209747, -710.0424365997314, -937.8819540441036, -925.7389399111271, -1050.1417725086212, -3120.340973764658, -988.7167385518551, -654.8431506752968, -938.7413065135479, -784.6036378443241, -667.539737612009, -689.5026515722275, -935.1904264092445, -882.221207857132, -839.1351545751095, -936.6075540482998, -884.327371776104, -906.8164534270763, -796.0928669571877, -1048.706982910633, -694.7812913358212, -768.0659420788288, -830.1340944766998, -732.5362059175968, -1024.132762312889, -827.6436702907085, -1032.498750537634, -1014.858738809824, -1008.1125041246414, -737.7111821472645, -643.0220420658588, -781.4978759288788, -684.1065155565739, -941.3028472363949, -677.1367719471455, -995.0424743294716, -1205.0312657356262, -890.1715345084667, -540.2568475008011, -718.7655986845493, -770.7081515192986, -1260.728265017271, -907.7820168435574, -717.3819401562214, -821.6947364211082, -1002.6351345181465, -692.8358615338802, -972.0150336325169, -632.3668750226498, -909.6845645308495, -950.2840366661549, -722.8720974326134, -1123.1221680045128, -857.5307518541813, -1064.4924023747444, -811.1652747690678, -842.288263887167, -783.8446227610111, -1022.7360508441925, -940.9740749299526, -867.897599041462, -969.6659200191498, -766.9710135161877, -749.9015328586102, -682.6139491796494, -774.4404447376728, -700.3784915208817, -856.8505364060402, -757.093605786562, -802.8818500339985, -721.6641900241375, -845.1490533351898, -1018.0254920125008, -773.8058099448681, -917.5332314968109, -795.8562251031399, -712.4512946307659, -1041.4476825892925, -717.3222369551659, -622.8788188099861, -653.7234881222248, -759.2096303105354, -1472.5615985393524, -740.582731962204, -719.2310656905174, -771.6161658763885, -969.1536193490028, -777.6602911055088, -918.004845649004, -703.5792312324047, -820.3214311003685, -691.5700316131115, -677.7170105576515, -901.8412404954433, -672.6254121661186, -1031.6915731728077, -744.1907244026661, -1500.9274203181267, -712.0070886611938, -698.664443641901, -739.3808272480965, -738.451314240694, -845.9442443549633, -759.0221872329712, -806.8890461027622, -833.6060440540314, -882.9130212962627, -868.9420915842056], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356274012332721, "mean_inference_ms": 4.450882696255325, "mean_action_processing_ms": 4.156342517706728, "mean_env_wait_ms": 3.0368160479658086, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2620800, "timesteps_this_iter": 131040, "agent_timesteps_total": 2620800, "timers": {"sample_time_ms": 47114.984, "sample_throughput": 2781.281, "load_time_ms": 23.239, "load_throughput": 5638839.119, "learn_time_ms": 15274.097, "learn_throughput": 8579.231, "update_time_ms": 2.277}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697265624999e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 340.3452778836602, "policy_loss": -0.0020299309246204593, "vf_loss": 68.07086444157426, "vf_explained_var": 0.0011033170112144989, "kl": 0.0017191386900793006, "entropy": -0.2225181710869608, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2620800, "num_agent_steps_sampled": 2620800, "num_steps_trained": 2620800, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2620800}, "done": false, "episodes_total": 5440, "training_iteration": 20, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-36-00", "timestamp": 1691001360, "time_this_iter_s": 38.587857484817505, "time_total_s": 832.7143092155457, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 832.7143092155457, "timesteps_since_restore": 2620800, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.101818181818174, "ram_util_percent": 74.14363636363635}}
{"evaluation": {"episode_reward_max": -1178.5072126090527, "episode_reward_min": -1178.5072126090527, "episode_reward_mean": -1178.5072126090527, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1178.5072126090527], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -540.2568475008011, "episode_reward_min": -1500.9274203181267, "episode_reward_mean": -843.7029338783026, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.7413065135479, -784.6036378443241, -667.539737612009, -689.5026515722275, -935.1904264092445, -882.221207857132, -839.1351545751095, -936.6075540482998, -884.327371776104, -906.8164534270763, -796.0928669571877, -1048.706982910633, -694.7812913358212, -768.0659420788288, -830.1340944766998, -732.5362059175968, -1024.132762312889, -827.6436702907085, -1032.498750537634, -1014.858738809824, -1008.1125041246414, -737.7111821472645, -643.0220420658588, -781.4978759288788, -684.1065155565739, -941.3028472363949, -677.1367719471455, -995.0424743294716, -1205.0312657356262, -890.1715345084667, -540.2568475008011, -718.7655986845493, -770.7081515192986, -1260.728265017271, -907.7820168435574, -717.3819401562214, -821.6947364211082, -1002.6351345181465, -692.8358615338802, -972.0150336325169, -632.3668750226498, -909.6845645308495, -950.2840366661549, -722.8720974326134, -1123.1221680045128, -857.5307518541813, -1064.4924023747444, -811.1652747690678, -842.288263887167, -783.8446227610111, -1022.7360508441925, -940.9740749299526, -867.897599041462, -969.6659200191498, -766.9710135161877, -749.9015328586102, -682.6139491796494, -774.4404447376728, -700.3784915208817, -856.8505364060402, -757.093605786562, -802.8818500339985, -721.6641900241375, -845.1490533351898, -1018.0254920125008, -773.8058099448681, -917.5332314968109, -795.8562251031399, -712.4512946307659, -1041.4476825892925, -717.3222369551659, -622.8788188099861, -653.7234881222248, -759.2096303105354, -1472.5615985393524, -740.582731962204, -719.2310656905174, -771.6161658763885, -969.1536193490028, -777.6602911055088, -918.004845649004, -703.5792312324047, -820.3214311003685, -691.5700316131115, -677.7170105576515, -901.8412404954433, -672.6254121661186, -1031.6915731728077, -744.1907244026661, -1500.9274203181267, -712.0070886611938, -698.664443641901, -739.3808272480965, -738.451314240694, -845.9442443549633, -759.0221872329712, -806.8890461027622, -833.6060440540314, -882.9130212962627, -868.9420915842056], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405850537796296, "mean_inference_ms": 4.456248400460082, "mean_action_processing_ms": 4.214403189798462, "mean_env_wait_ms": 3.0365621805504865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2751840, "timesteps_this_iter": 131040, "agent_timesteps_total": 2751840, "timers": {"sample_time_ms": 36013.93, "sample_throughput": 3638.592, "load_time_ms": 21.776, "load_throughput": 6017671.246, "learn_time_ms": 15224.032, "learn_throughput": 8607.444, "update_time_ms": 2.296}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486328124996e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 324.2103404667772, "policy_loss": 0.0029179945324927987, "vf_loss": 64.83891958147821, "vf_explained_var": -0.013019695076891172, "kl": 0.00198476506018674, "entropy": -0.2316969340954203, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2751840, "num_agent_steps_sampled": 2751840, "num_steps_trained": 2751840, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2751840}, "done": false, "episodes_total": 5440, "training_iteration": 21, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-36-15", "timestamp": 1691001375, "time_this_iter_s": 15.216896057128906, "time_total_s": 847.9312052726746, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 847.9312052726746, "timesteps_since_restore": 2751840, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.336363636363636, "ram_util_percent": 74.0772727272727}}
{"evaluation": {"episode_reward_max": -812.491546690464, "episode_reward_min": -812.491546690464, "episode_reward_mean": -812.491546690464, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.491546690464], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -494.51012659072876, "episode_reward_min": -5758.440868854523, "episode_reward_mean": -823.1646876731887, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-643.7094210386276, -1251.280550867319, -862.6508654952049, -1042.4893698692322, -632.9255166649818, -791.2695264220238, -831.9359517991543, -770.0199288129807, -847.233116954565, -744.0296514332294, -710.131754130125, -1034.068161815405, -774.5953493118286, -876.5352850854397, -689.548238158226, -960.6289781033993, -974.0942682027817, -5624.364320337772, -871.6208150088787, -880.3912397027016, -875.3386205732822, -657.0377185344696, -1185.083784610033, -740.0122818350792, -719.6110493540764, -1017.4638508856297, -629.6571507751942, -648.5860100388527, -811.7760155797005, -717.7496424019337, -678.9616232216358, -986.5818916261196, -827.6949461698532, -780.3339550495148, -621.7204827368259, -646.7004332840443, -595.6456492841244, -904.9679274857044, -906.7167291343212, -825.529150813818, -623.1740011572838, -765.0718462467194, -607.6660852134228, -600.2749044597149, -856.5124405920506, -671.0481031537056, -744.2447841465473, -825.8025200664997, -773.5706616640091, -863.5885091125965, -702.1576998531818, -774.93468734622, -717.1272310912609, -654.1880687177181, -602.3180719316006, -602.8556572198868, -787.5186758041382, -886.5383073091507, -645.3956410288811, -985.4099114537239, -661.1366203725338, -751.4023895859718, -670.1230603456497, -559.1315823495388, -636.2616046965122, -667.9775612950325, -724.9655683636665, -1037.6839215159416, -1073.2426435351372, -730.5621921718121, -646.0591827332973, -1214.0459780097008, -785.2004428505898, -902.920244038105, -685.6253347992897, -718.4894078969955, -1106.036411255598, -1093.492041349411, -895.962725520134, -596.2490118741989, -836.9240548312664, -561.2938365638256, -727.5205523967743, -651.9942052364349, -588.4592860937119, -905.3315573632717, -671.6218036711216, -810.0898484289646, -674.3893782794476, -956.2292136847973, -641.3725224137306, -927.541590154171, -664.8585944473743, -749.4188597500324, -775.3316127061844, -730.6992968916893, -644.2520012259483, -770.3657308518887, -731.053836196661, -958.9848617017269, -757.7073994874954, -788.1509523391724, -2008.3753612041473, -803.3350368440151, -833.8347376585007, -989.4682042002678, -699.4299945831299, -844.565031349659, -970.8362326920033, -992.2034427821636, -969.6360623240471, -619.4160678088665, -787.0001535415649, -636.8456536531448, -858.6916407942772, -737.4931690394878, -857.9283748865128, -828.6814169883728, -847.9466947615147, -752.5618591308594, -978.7693292796612, -734.8361812531948, -625.8140307068825, -742.1544382572174, -854.6864983439445, -816.9936710596085, -1070.5255998969078, -923.7345361411572, -1232.1135835945606, -614.0220811069012, -760.7053077220917, -836.0777359604836, -663.3743715286255, -984.0471952855587, -642.0100724995136, -743.2188399136066, -684.1275528669357, -814.5003000199795, -1121.47165620327, -825.450256973505, -594.535318672657, -723.3200341463089, -552.2927746772766, -621.8076075911522, -798.6283642351627, -647.8760378956795, -735.706431388855, -902.0971074402332, -676.7445513308048, -786.0095561742783, -716.7295632660389, -793.410441160202, -698.9412809312344, -763.3529859185219, -719.7763750553131, -625.7400389909744, -695.5471361279488, -713.0151796936989, -624.8268246948719, -681.6376666426659, -613.8830983042717, -893.9460495710373, -703.5816217064857, -668.8169146180153, -864.4764066040516, -750.9078915715218, -730.6242654919624, -748.1404910981655, -789.7911340594292, -1030.8572925627232, -680.2531591653824, -597.6377533376217, -859.0121704041958, -841.3570489883423, -802.5972867310047, -675.2004482448101, -923.6449384689331, -593.074266910553, -709.0578368008137, -781.5118028819561, -1141.2391289174557, -786.1321410238743, -619.382957726717, -727.4388514757156, -697.4749048352242, -1142.5671342909336, -658.8836390376091, -620.1461717486382, -753.4408856332302, -740.7344327867031, -779.1463540494442, -800.4029266238213, -1118.0126776695251, -667.454636067152, -871.2935916483402, -687.8801428079605, -996.4953870773315, -751.955760627985, -1002.7443438768387, -784.8502649962902, -867.7074221074581, -701.4897076487541, -921.6741313040257, -623.0423894822598, -787.3872015178204, -1189.4654422998428, -1668.22428637743, -895.7204778492451, -817.0896081328392, -982.7254831492901, -951.1821927428246, -823.9815576672554, -743.7658376693726, -751.4329651296139, -739.0283155739307, -653.7575190365314, -833.8971271812916, -2146.859619319439, -788.7558331787586, -689.1536689698696, -656.3551943898201, -733.2441502213478, -788.3401704728603, -1121.6314962804317, -887.4345409870148, -791.2432133853436, -913.6441513001919, -685.9095190167427, -540.3534805774689, -775.6437921822071, -877.0083328485489, -1013.3949456214905, -624.2552551031113, -866.98392111063, -664.2621607780457, -1050.987878024578, -755.5963464677334, -960.0598990023136, -968.4736505746841, -632.0253674387932, -494.51012659072876, -761.7215457856655, -952.2916938662529, -789.4032507538795, -988.4114382565022, -836.489727139473, -725.6636527478695, -763.4472388327122, -706.1648057699203, -606.7663622200489, -675.9874081909657, -877.0691281557083, -1187.350025653839, -664.4868911504745, -643.7417663037777, -795.61622351408, -902.7004545629025, -598.0259152948856, -645.2597158253193, -690.9310962557793, -758.8805305063725, -668.9189163148403, -651.7905124425888, -795.5081959366798, -623.9514235854149, -707.0367109179497, -562.1952796280384, -915.8117288351059, -619.0147733390331, -843.689963132143, -638.8130157291889, -782.2892759740353, -620.4974347054958, -878.5844407975674, -748.5321861803532, -780.3520984649658, -682.2244267761707, -876.2672642469406, -898.7886234521866, -616.9124441146851, -657.1263773143291, -861.7184333503246, -628.2768133580685, -675.0816715657711, -648.1024602651596, -1164.1910165250301, -872.2455529868603, -643.281318962574, -3857.810252815485, -1254.5771129727364, -796.1353712677956, -1853.3164666593075, -737.6977488696575, -1063.8836351037025, -749.8597444593906, -891.1044456064701, -651.0038417577744, -711.9931436479092, -762.807193338871, -994.8901303708553, -698.2630228102207, -650.4007644951344, -1228.778499364853, -894.5885433554649, -719.6200529336929, -939.12287068367, -535.4311879873276, -644.4698661863804, -835.0271653234959, -878.8563397526741, -708.4140414893627, -850.5573316216469, -912.8945993185043, -723.3519913554192, -1005.800404727459, -703.5004611313343, -5758.440868854523, -715.1855872869492, -785.3976167440414, -895.2820293009281, -797.4405411183834, -642.4599215984344, -589.289866656065, -614.4785771667957, -605.9828230440617, -541.8683384656906, -650.7190722227097, -642.0297765135765, -627.4482165575027, -763.2335018515587, -697.9332548677921, -558.7331164181232, -837.965229600668, -1021.2016765773296, -658.8306080698967, -634.2939061820507, -798.9300586283207, -823.7243115603924, -983.131925702095, -685.3778792023659, -1018.2013731300831, -1200.2095879912376, -723.2449654340744, -653.9764632284641, -783.2205035090446, -568.8867313563824, -858.3345414996147, -693.6498129665852, -973.1252113878727, -708.2066816091537, -740.0984462797642, -663.1739905774593, -811.5540809035301, -676.2616040110588, -672.379571557045, -585.8608942627907, -720.6456706821918, -566.6328291296959, -716.4199441373348, -687.4000008404255, -560.2247194945812, -654.6137497723103, -947.3518885970116, -733.344605922699, -728.3770043253899, -621.032114982605, -748.6048808991909, -741.0965154767036, -1046.725808918476, -695.1859444379807, -978.3792375922203, -617.3392716050148, -663.001210808754, -906.1812236607075, -833.6759624779224, -992.6304963827133, -667.0196674466133, -621.8607773184776, -734.6268903315067, -679.5914239287376, -584.7781339883804, -873.4624161422253, -700.4281696081161, -859.9897731244564, -718.2660585939884, -805.1045735478401, -730.6289013922215, -1009.476833999157, -862.1908853948116, -720.5526495873928, -957.268104583025, -663.3178754448891, -919.0308761894703, -1093.2881245613098, -1358.455058336258, -904.5739212632179, -702.0276959240437, -664.6319397389889, -1096.5550529360771, -783.5337472558022, -775.7043831944466, -939.2285426557064, -800.0935379564762, -699.9258731901646, -754.1391604244709, -672.8200347721577, -1183.6697111725807, -896.4673530459404, -1027.370303452015, -1043.941904693842, -638.5242520570755, -654.4087640345097, -744.9546355307102, -782.7235914468765, -788.9823962152004, -4278.27268025279, -626.3073385059834, -720.5261367559433, -901.0454173982143, -652.4304359853268, -1039.2566126585007, -631.9380587339401, -811.7361675202847, -872.8034458458424, -718.7886158525944, -704.7984066307545, -1051.4493820369244, -841.5247483253479, -727.7263584136963, -944.1894731223583, -750.4360682666302, -759.1364621818066, -705.0413323938847, -735.3944236636162, -869.8787985742092, -660.471966445446, -1140.300875455141, -685.788234680891, -798.5976881980896, -735.8379198312759, -744.9569997489452, -770.2784902453423, -595.1947591304779, -635.5797969698906, -599.9790322780609, -590.7522175312042, -591.1495764255524, -588.390703111887, -799.3114430010319, -778.504141420126, -648.30201369524, -708.8678770959377, -562.9692340791225, -907.569404989481, -890.7182010710239, -861.8748136162758, -982.9471339285374, -679.3364191949368, -682.8958474695683, -619.601880967617, -710.4123843610287, -831.1979086399078, -778.2044550180435, -686.912530630827, -635.458921790123, -617.6301257610321, -694.2199801802635, -802.9570387005806, -744.7656410634518, -797.7661936581135, -743.3604291975498, -663.5339814126492, -710.1941492855549, -609.4664399623871, -623.8822773993015, -702.1098707020283, -662.7596154510975, -556.9749018847942, -777.0875761508942, -626.4187430739403], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.370906597473799, "mean_inference_ms": 4.45657496130141, "mean_action_processing_ms": 4.1570771999420595, "mean_env_wait_ms": 3.037159411035215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2882880, "timesteps_this_iter": 131040, "agent_timesteps_total": 2882880, "timers": {"sample_time_ms": 38386.557, "sample_throughput": 3413.695, "load_time_ms": 22.558, "load_throughput": 5809093.751, "learn_time_ms": 15214.257, "learn_throughput": 8612.974, "update_time_ms": 2.287}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743164062498e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 303.41618944509906, "policy_loss": 0.00283184373145245, "vf_loss": 60.68017785267163, "vf_explained_var": -0.006746428734940013, "kl": 0.0013276783237296881, "entropy": -0.22924093552280925, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2882880, "num_agent_steps_sampled": 2882880, "num_steps_trained": 2882880, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2882880}, "done": false, "episodes_total": 5920, "training_iteration": 22, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-36-55", "timestamp": 1691001415, "time_this_iter_s": 40.00045442581177, "time_total_s": 887.9316596984863, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 887.9316596984863, "timesteps_since_restore": 2882880, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 45.38947368421053, "ram_util_percent": 74.77192982456138}}
{"evaluation": {"episode_reward_max": -800.5044235885143, "episode_reward_min": -800.5044235885143, "episode_reward_mean": -800.5044235885143, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800.5044235885143], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -556.9749018847942, "episode_reward_min": -4278.27268025279, "episode_reward_mean": -809.8868543347717, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-584.7781339883804, -873.4624161422253, -700.4281696081161, -859.9897731244564, -718.2660585939884, -805.1045735478401, -730.6289013922215, -1009.476833999157, -862.1908853948116, -720.5526495873928, -957.268104583025, -663.3178754448891, -919.0308761894703, -1093.2881245613098, -1358.455058336258, -904.5739212632179, -702.0276959240437, -664.6319397389889, -1096.5550529360771, -783.5337472558022, -775.7043831944466, -939.2285426557064, -800.0935379564762, -699.9258731901646, -754.1391604244709, -672.8200347721577, -1183.6697111725807, -896.4673530459404, -1027.370303452015, -1043.941904693842, -638.5242520570755, -654.4087640345097, -744.9546355307102, -782.7235914468765, -788.9823962152004, -4278.27268025279, -626.3073385059834, -720.5261367559433, -901.0454173982143, -652.4304359853268, -1039.2566126585007, -631.9380587339401, -811.7361675202847, -872.8034458458424, -718.7886158525944, -704.7984066307545, -1051.4493820369244, -841.5247483253479, -727.7263584136963, -944.1894731223583, -750.4360682666302, -759.1364621818066, -705.0413323938847, -735.3944236636162, -869.8787985742092, -660.471966445446, -1140.300875455141, -685.788234680891, -798.5976881980896, -735.8379198312759, -744.9569997489452, -770.2784902453423, -595.1947591304779, -635.5797969698906, -599.9790322780609, -590.7522175312042, -591.1495764255524, -588.390703111887, -799.3114430010319, -778.504141420126, -648.30201369524, -708.8678770959377, -562.9692340791225, -907.569404989481, -890.7182010710239, -861.8748136162758, -982.9471339285374, -679.3364191949368, -682.8958474695683, -619.601880967617, -710.4123843610287, -831.1979086399078, -778.2044550180435, -686.912530630827, -635.458921790123, -617.6301257610321, -694.2199801802635, -802.9570387005806, -744.7656410634518, -797.7661936581135, -743.3604291975498, -663.5339814126492, -710.1941492855549, -609.4664399623871, -623.8822773993015, -702.1098707020283, -662.7596154510975, -556.9749018847942, -777.0875761508942, -626.4187430739403], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.447392371939092, "mean_inference_ms": 4.4727214302564, "mean_action_processing_ms": 4.259671661604275, "mean_env_wait_ms": 3.0354082752529883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3013920, "timesteps_this_iter": 131040, "agent_timesteps_total": 3013920, "timers": {"sample_time_ms": 35978.231, "sample_throughput": 3642.202, "load_time_ms": 20.797, "load_throughput": 6300817.792, "learn_time_ms": 15215.817, "learn_throughput": 8612.091, "update_time_ms": 2.283}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.768371582031249e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 295.34704654598846, "policy_loss": 0.006337986376861671, "vf_loss": 59.06283359459224, "vf_explained_var": -0.020086973798744995, "kl": 0.0020650643961212856, "entropy": -0.2387205722030773, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3013920, "num_agent_steps_sampled": 3013920, "num_steps_trained": 3013920, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3013920}, "done": false, "episodes_total": 5920, "training_iteration": 23, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-37-11", "timestamp": 1691001431, "time_this_iter_s": 15.942375659942627, "time_total_s": 903.874035358429, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 903.874035358429, "timesteps_since_restore": 3013920, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 15.608695652173912, "ram_util_percent": 75.4913043478261}}
{"evaluation": {"episode_reward_max": -754.6027927994728, "episode_reward_min": -754.6027927994728, "episode_reward_mean": -754.6027927994728, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-754.6027927994728], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -406.02384865283966, "episode_reward_min": -6977.691163688898, "episode_reward_mean": -727.8567778033515, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-729.8877275586128, -620.3951522707939, -787.4683414399624, -684.6127589643002, -765.3547150790691, -703.8047207891941, -643.4688790738583, -689.8405755758286, -628.0045203566551, -760.0316928327084, -790.7203648388386, -747.0195576250553, -921.6068104207516, -887.7958486676216, -778.1726254820824, -755.1313427388668, -992.0237255096436, -727.565072119236, -735.1551226377487, -589.9980018734932, -716.9300453960896, -863.9678339958191, -686.6630308926105, -980.8746321499348, -745.3140417039394, -1265.9339636564255, -625.8869446218014, -690.2448564171791, -716.7755905389786, -644.1699768006802, -654.342944920063, -966.525543242693, -658.1831482946873, -606.137496560812, -2793.274313658476, -655.6333988308907, -586.5220503211021, -677.3226878345013, -699.3828361332417, -669.4300175011158, -706.053919583559, -595.2912813425064, -600.8003239631653, -582.8282749056816, -1068.7029325664043, -674.6000807285309, -1701.1855464577675, -650.2291855216026, -728.3324407041073, -615.4521432518959, -678.1379503905773, -586.6984195113182, -528.804903447628, -679.344126701355, -907.4249651432037, -595.3855149745941, -595.8559956252575, -911.5444283187389, -692.4163503944874, -731.3748852610588, -747.1848557889462, -871.0058350563049, -690.80528652668, -774.1676562428474, -557.8404894173145, -598.9267642498016, -689.3050535321236, -614.820304185152, -584.168214648962, -649.0159605741501, -664.7773295342922, -665.940518528223, -608.9523678719997, -406.02384865283966, -726.9282383918762, -605.3259916007519, -815.7553789615631, -608.0100373625755, -711.5701882839203, -726.6269114911556, -676.2062936723232, -719.1038705706596, -661.9346086382866, -677.9837215542793, -730.5121508836746, -666.529249817133, -673.2921792268753, -572.6191375851631, -650.6305915117264, -763.4794862568378, -765.0051681995392, -718.2006994485855, -603.4140807688236, -6977.691163688898, -585.2415455877781, -802.5169310569763, -658.8852717578411, -712.9261511266232, -734.5837396085262, -632.9934014678001, -603.9398399889469, -685.2857674658298, -668.0908262729645, -916.1710033416748, -650.3931603431702, -855.054593116045, -898.4579831957817, -792.7754095196724, -1044.750057965517, -775.9692324697971, -505.1761466562748, -760.9567610025406, -726.6333701312542, -631.7591864168644, -636.5690858364105, -666.9360116422176, -678.1964452564716, -610.0372978746891, -808.6400452256203, -1267.7678072154522, -571.4713452458382, -643.7089964449406, -658.416317731142, -623.1628193855286, -684.6652957499027, -874.6096415221691, -849.2491943240166, -769.0157728791237, -864.436515301466, -578.6512707471848, -664.866380751133, -676.6938181519508, -712.1028524041176, -541.0703109800816, -852.571007847786, -843.5207706391811, -782.3088560700417, -612.8865499794483, -743.1715038716793, -698.2785360217094, -684.5141948759556, -652.42083132267, -745.401129424572, -590.6411774456501, -3981.2448708713055, -785.219067543745, -634.9718681871891, -571.2446636855602, -562.3191921114922, -591.0827969610691, -601.1081274151802, -597.1726624369621, -599.4755592048168, -804.223441183567, -540.7598908245564, -554.6722155511379, -584.9312607645988, -780.5770208537579, -710.4002304971218, -725.8219945728779, -709.2924485504627, -624.7021615505219, -604.1202367544174, -619.8709948956966, -727.2929663062096, -623.236785531044, -733.5801081359386, -855.1175233721733, -545.65055295825, -898.8368619680405, -725.1486054360867, -671.6185526847839, -676.8526109457016, -832.6570271849632, -473.0513613522053, -700.5737615227699, -678.2456978559494, -726.7846251428127, -542.8218175172806, -500.7875151336193, -585.9309584200382, -560.5778900980949, -630.5993219017982, -648.9271474182606, -500.3392471075058, -955.5510032773018, -501.5535629093647, -765.3130938112736, -698.9795427620411, -780.5572915971279, -585.280134499073, -658.2767042517662, -759.4195260107517, -670.6477429568768, -848.3060657680035, -717.5227726399899, -640.0481960177422, -652.9144859313965, -618.1715333163738, -887.5331029891968, -747.1212529838085, -818.5790410935879, -602.7176430225372, -974.136610686779, -642.00135871768, -692.7446201741695, -864.9876765906811, -628.2891465127468, -894.3696257174015, -765.9816961884499, -848.2108847796917, -683.9367971718311, -518.6776486933231, -627.7202530503273, -735.9084312319756, -901.2662203609943, -834.974404245615, -728.7691515684128, -738.4019604325294, -725.7664683759212, -610.3951158225536, -1047.2229852676392, -700.307368516922, -634.5203987061977, -596.5687192678452, -684.4917446672916, -553.5137173235416, -698.9273813664913, -541.9733263254166, -664.623191267252, -613.2439037263393, -651.9527116715908, -903.0831884145737, -735.3457140028477, -764.5038778483868, -699.8486707806587, -565.8046887814999, -625.1573742032051, -1056.753309339285, -629.3518751561642, -530.1019529998302, -616.603651881218, -787.8165524601936, -735.0368229448795, -591.7167288959026, -690.9929423034191, -659.8791107535362, -562.3253569602966, -842.7577154934406, -634.5619315505028, -549.3457901775837, -944.1679985821247, -535.2093347609043, -801.0597739517689, -619.7196111679077, -1095.9623548090458, -827.1702950596809, -998.861569404602, -654.4402192831039, -820.8201024532318, -586.9093468487263, -873.4724520146847, -713.4847989976406, -882.1469721794128, -583.8571102619171, -728.705668926239, -705.0549049377441, -606.0691598951817, -706.0150350630283, -776.9404623806477, -524.5632921159267, -653.0722595453262, -621.358481913805, -487.0050049126148, -1485.7009759247303, -509.7186218202114, -892.8178592920303, -555.2738737165928, -723.4404025673866, -1330.5025043487549, -561.6835239827633, -551.0956100821495, -529.781416863203, -713.7842761278152, -591.4354245662689, -646.0464935898781, -614.4868071079254, -744.7045198380947, -724.4214786291122, -646.867248237133, -586.2204822003841, -746.0877795517445, -737.6124461591244, -828.1164652109146, -761.3399125337601, -682.9174853861332, -935.4559732377529, -781.1982181370258, -675.5618358552456, -795.091379314661, -687.6050361692905, -580.4412404596806, -524.2624103724957, -886.0019647479057, -731.6106638610363, -688.5566694140434, -685.0130401849747, -692.1263850927353, -904.6232410371304, -712.7586913108826, -711.0891716182232, -812.373877197504, -671.3211394250393, -983.7882237136364, -792.8418258428574, -629.402964681387, -634.7837166786194, -750.6853220164776, -623.2608072459698, -643.1849887371063, -573.7687866389751, -587.3548657894135, -754.8621896207333, -689.319794178009, -852.2034993469715, -664.3914406001568, -693.8315926790237, -651.0731156468391, -607.1512298285961, -635.5562396347523, -654.3983539640903, -622.4533162117004, -615.8396206200123, -665.9720692336559, -619.8935923278332, -643.8508494198322, -659.2554553151131, -650.3857709169388, -746.8409630358219, -744.5280422866344, -795.7331441342831, -605.8178145289421, -729.2612969279289, -715.8935042023659, -591.3354896903038, -636.3921315968037, -789.7200072705746, -596.3310530483723, -745.2178934514523, -712.0637919306755, -866.0390808582306, -632.2633603811264, -725.7105666100979, -681.2233876287937, -600.3890205621719, -796.0499591529369, -626.5311362743378, -595.1717746257782, -895.9957023561001, -563.6374515891075, -752.3282773792744, -585.8268141448498, -609.4762659072876, -662.2422563433647, -793.8808301091194, -693.4221242666245, -518.48205691576, -764.3843808472157, -751.9217984080315, -683.3904785811901, -562.6517857909203, -749.8791900575161, -596.8411848545074, -625.7170772850513, -750.3025739192963, -673.0114739239216, -806.3441023230553, -836.5249655246735, -683.026608467102, -737.0339192152023, -757.0602316260338, -634.0514842271805, -543.4279941320419, -609.1049829423428, -732.0511741042137, -790.1212804913521, -653.5868856310844, -608.0706572830677, -640.7840608656406, -1407.75754404068, -669.1541632115841, -723.2823036909103, -750.47074842453, -853.1500331759453, -754.1241424977779, -774.5315403342247, -608.1630285382271, -839.6637591421604, -545.076721072197, -591.143611997366, -800.2747981250286, -838.6141909062862, -763.6488120555878, -766.7707731425762, -894.3639333844185, -591.7830258607864, -634.3949894011021, -967.5213643014431, -694.9587366580963, -617.9060923457146, -574.2073030173779, -723.0319213569164, -585.6519018113613, -721.2298191487789, -729.9154253900051, -701.3090397715569, -650.8494388461113, -661.4235986471176, -700.3011548221111, -612.100188344717, -608.4582558870316, -588.8497505486012, -658.4204464554787, -579.8576943278313, -723.327089458704, -734.6367522776127, -650.8547918796539, -753.0895366966724, -567.0871440768242, -687.4392331540585, -635.3197879493237, -644.3702853024006, -1139.7316036522388, -685.9219348728657, -626.1069179773331, -495.32748606801033, -691.700775384903, -651.3822398483753, -577.720545142889, -682.0341892242432, -607.7049904763699, -614.7610928714275, -701.7395534515381, -588.6799689531326, -587.0413452088833, -707.8880788087845, -661.8402190208435, -581.657849997282, -629.273833066225, -837.6713861227036, -779.0568262636662, -636.483174353838, -690.4562146961689, -587.726942807436, -744.544880092144, -598.0677586197853, -745.6762092113495, -661.7649899721146, -655.8280253410339, -669.186311006546, -586.77446231246, -632.0036425888538, -602.0071198344231, -690.6303316056728, -710.8605017960072, -860.0144928991795, -649.5936456024647, -623.8709233105183, -575.3179050385952, -705.2172323465347, -598.9357767701149, -771.250679820776, -616.8738609552383, -757.4468006789684, -689.7257786691189, -954.6025530099869, -599.1699266731739, -537.204245775938, -637.1065414249897, -685.8333541452885], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.375818354082891, "mean_inference_ms": 4.468438338204169, "mean_action_processing_ms": 4.159246091021607, "mean_env_wait_ms": 3.0402008914643424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3144960, "timesteps_this_iter": 131040, "agent_timesteps_total": 3144960, "timers": {"sample_time_ms": 38393.579, "sample_throughput": 3413.071, "load_time_ms": 22.564, "load_throughput": 5807589.894, "learn_time_ms": 15267.346, "learn_throughput": 8583.024, "update_time_ms": 2.289}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841857910156245e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 283.5731748528297, "policy_loss": 0.004464839231795321, "vf_loss": 56.7099307412315, "vf_explained_var": -0.04464597973345001, "kl": 0.0014980050709438178, "entropy": -0.24035295141747348, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3144960, "num_agent_steps_sampled": 3144960, "num_steps_trained": 3144960, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3144960}, "done": false, "episodes_total": 6400, "training_iteration": 24, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-37-51", "timestamp": 1691001471, "time_this_iter_s": 39.93689727783203, "time_total_s": 943.810932636261, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 943.810932636261, "timesteps_since_restore": 3144960, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 46.93684210526316, "ram_util_percent": 74.99999999999999}}
{"evaluation": {"episode_reward_max": -642.6018079221249, "episode_reward_min": -642.6018079221249, "episode_reward_mean": -642.6018079221249, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-642.6018079221249], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -452.92299422621727, "episode_reward_min": -6516.710610687733, "episode_reward_mean": -733.3549774697361, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.3653735518456, -864.9328152835369, -592.2145659029484, -637.1988103687763, -654.4124604463577, -652.0601553320885, -663.5540115237236, -609.9480356872082, -662.5344061553478, -831.9301465451717, -533.8080455958843, -636.2646913230419, -660.9358289241791, -934.8926879167557, -688.6368371546268, -635.8335366249084, -757.1681320369244, -654.0850019454956, -563.7253231704235, -598.3257074654102, -633.3374587595463, -606.1145836412907, -597.6925265491009, -549.3081658482552, -585.0357889533043, -1214.5296813845634, -737.1719893217087, -1197.9284427762032, -1166.7074493169785, -1402.622323423624, -761.9593036174774, -821.0227763652802, -616.5715297460556, -808.3534087836742, -717.9443723261356, -1413.5585007071495, -514.8251315057278, -723.5812976360321, -665.0612120330334, -807.6938353180885, -689.0339532792568, -606.1921559274197, -796.815801769495, -564.8506511747837, -680.3614022731781, -581.0613639652729, -599.7828463315964, -665.3734502494335, -722.1030788123608, -583.8745755553246, -932.0500768721104, -979.1520246863365, -1101.0858917832375, -903.4563181996346, -594.3728252351284, -739.1576855480671, -651.3548422157764, -623.6634106636047, -1056.1510469019413, -675.4158143997192, -672.9218568503857, -614.8538762629032, -662.1651583611965, -850.0570094287395, -708.3079800307751, -619.9741842448711, -491.23394295573235, -588.1058285534382, -614.2060018181801, -1300.3758045732975, -831.6968722343445, -694.1573330163956, -845.6132853329182, -760.7109168767929, -707.4702291786671, -1048.5145045220852, -604.189675629139, -747.0771162807941, -1062.4539413750172, -497.32146863639355, -480.9407553970814, -664.352360278368, -859.1726938784122, -503.5988366007805, -602.8884085714817, -655.3952026069164, -752.3223205506802, -732.2886787354946, -732.8505781590939, -5776.68634480238, -686.0663829743862, -573.793306440115, -514.2469162046909, -587.226297557354, -581.9557147622108, -585.1803747713566, -857.3943904042244, -660.2987448871136, -576.2920669019222, -835.8078536391258, -566.3432514965534, -1202.6018514633179, -599.7869281470776, -1316.7018139064312, -574.9388789236546, -531.2828738987446, -679.5351140201092, -625.8360067605972, -540.8879856467247, -628.4598403275013, -570.3501206338406, -572.9512912034988, -560.33629950881, -785.5785204172134, -912.7597528994083, -701.778650522232, -529.7072601914406, -680.9109637141228, -589.198094278574, -774.9380871355534, -656.3498871922493, -620.5447215139866, -1001.0677081942558, -740.555533349514, -617.2137812077999, -551.077809125185, -668.9219654202461, -583.8079672455788, -717.6083886027336, -755.4762583971024, -733.1386132240295, -768.6402652263641, -827.0820685327053, -602.4024367630482, -598.4344419836998, -557.3499478697777, -627.4270704090595, -681.1582976877689, -1263.873733073473, -648.9239217340946, -1241.483739733696, -903.7354937195778, -634.2581477761269, -1049.3917026221752, -863.6582641601562, -616.4733156859875, -983.1460812389851, -644.4143469929695, -636.2684119641781, -552.3935082554817, -718.9819603264332, -566.6813594400883, -908.0725671947002, -769.0943456292152, -558.660892367363, -530.0443578064442, -578.4882836341858, -653.9713429808617, -523.9641528725624, -765.2278288304806, -672.9700964689255, -698.5648263096809, -691.1955482065678, -620.7365729808807, -669.8736320137978, -698.8995576500893, -575.9795468151569, -647.9893434345722, -751.4735304117203, -785.5389393866062, -732.5023729205132, -639.3242241740227, -524.5426582098007, -757.7853793501854, -785.6086404323578, -533.7050114572048, -686.3585948646069, -699.8336889445782, -558.4533956646919, -641.1886960268021, -1378.1493571400642, -561.520275592804, -772.3016169965267, -650.5036143362522, -619.9748544991016, -722.6878966093063, -545.4274357557297, -510.53393906354904, -747.2400839030743, -504.32799196243286, -545.6243089139462, -816.581140846014, -508.2524612545967, -595.1953280866146, -547.6208210289478, -782.3887312412262, -1282.634442359209, -713.3855939507484, -966.6246879696846, -885.4676914215088, -802.8853915631771, -607.293401658535, -639.2298786044121, -596.8867819309235, -641.8971875607967, -619.9930770099163, -886.9571669697762, -1137.6417221426964, -731.4001123905182, -469.59580463171005, -614.0058441162109, -641.56692096591, -635.5388568043709, -782.2162264585495, -648.506306707859, -677.9244866073132, -601.2494254112244, -640.6501183211803, -792.6405272483826, -740.3589263856411, -691.4036910533905, -559.6870089769363, -582.9972490668297, -747.5070212185383, -640.3819778561592, -606.0103340446949, -1002.7475017011166, -806.6750221550465, -612.900337845087, -678.1953396201134, -599.2659157812595, -548.5739210546017, -1939.3911209702492, -716.5469479560852, -737.5111973583698, -798.0895231068134, -530.5145587027073, -647.7542533278465, -753.415520131588, -770.4998078942299, -552.8679178953171, -656.9770446419716, -609.1010234355927, -627.0221821665764, -601.4629709124565, -644.6423344910145, -635.8388161659241, -553.4549857079983, -769.6215197443962, -653.0692871510983, -526.2506095468998, -543.8516482114792, -670.4875229597092, -657.2334857285023, -798.9403068423271, -612.7850095927715, -537.7086480855942, -651.052744269371, -499.6881823539734, -670.7904424965382, -634.4227834641933, -671.1838380396366, -690.4947267174721, -479.57161659002304, -677.3953708410263, -727.5284550189972, -1071.5913493931293, -572.0256969630718, -858.7240583002567, -758.0016338229179, -593.8763003647327, -588.5909539759159, -617.4604801535606, -679.2652265131474, -632.8951852023602, -634.1806021332741, -711.9367477297783, -728.2302418649197, -715.8973063826561, -685.4274421334267, -739.170975446701, -533.9233647584915, -867.7241066098213, -750.475928157568, -726.2727136313915, -614.4265093803406, -626.1271503567696, -604.5418166518211, -484.6044279038906, -512.9733637273312, -603.6589109003544, -600.9832358956337, -464.2938761115074, -718.9002947211266, -751.3009020090103, -703.8297288715839, -742.9387559890747, -679.0619001686573, -639.2770482897758, -627.9951048791409, -708.4538168609142, -589.1780227720737, -520.0719829797745, -605.2306405305862, -746.5332442522049, -713.804323554039, -674.304953366518, -666.059544891119, -692.139523088932, -520.0288280248642, -2197.0287812948227, -760.1027907133102, -611.5969704985619, -532.4409383237362, -779.2451548576355, -618.5353408157825, -496.8857710659504, -1207.0795975327492, -989.0746586024761, -586.1491197943687, -552.9756615161896, -592.5513124167919, -629.3939914703369, -1420.9611154198647, -707.9522224068642, -830.9182301461697, -555.6295931637287, -761.2445366382599, -690.040508300066, -559.4509595632553, -680.8231094181538, -682.10433614254, -511.62956672906876, -697.5220327973366, -637.3968748748302, -630.2521957755089, -811.1607956886292, -642.6097032129765, -816.6831462979317, -621.822589725256, -667.9720834493637, -659.1699546277523, -682.1846052110195, -572.2434026002884, -769.4354593157768, -571.8142644762993, -688.1873477399349, -594.6464650332928, -555.4322283565998, -818.0291328132153, -679.4947708845139, -814.9187163710594, -794.599634706974, -703.4177602529526, -934.3431041836739, -605.9206422567368, -649.337522983551, -664.0869933664799, -552.5749404430389, -603.6852627396584, -674.8348776996136, -1137.348338842392, -573.5585654377937, -608.6679320335388, -751.7428959012032, -708.2986382544041, -555.7351506948471, -704.8707216978073, -876.9412806928158, -621.0673391222954, -689.438468426466, -900.6455039680004, -822.1242782175541, -652.3536498844624, -745.3856242001057, -720.4458980560303, -547.8888634443283, -458.4652834534645, -819.5169135928154, -726.530471175909, -676.1675581037998, -610.213697463274, -567.945467799902, -706.7156152129173, -452.92299422621727, -680.5898965895176, -648.5422837138176, -602.7807116508484, -713.247561365366, -638.9366671741009, -603.3284938335419, -1212.634656459093, -632.3792773783207, -789.290783315897, -725.2792068123817, -2321.0156829357147, -1032.063786238432, -592.5111708641052, -579.7764629721642, -655.8161825239658, -624.0780130624771, -666.6191599965096, -670.3470897376537, -626.5303498804569, -628.7002220749855, -675.1942859590054, -716.2828622758389, -586.6879014372826, -575.6002516746521, -728.056862950325, -619.0344948768616, -594.7776302695274, -608.3829788267612, -588.3268057107925, -676.4929801523685, -567.3710795342922, -793.9478720128536, -670.2134639918804, -562.0926293730736, -615.3276554048061, -939.626165241003, -498.76105615496635, -534.7287335395813, -577.3367531001568, -553.7125915884972, -758.6505782306194, -763.0760550796986, -596.0063169598579, -770.0209847390652, -6516.710610687733, -767.0355451703072, -728.9613104760647, -740.6737198233604, -632.5936872065067, -577.7604165375233, -951.7243390977383, -727.7518246173859, -519.1185990273952, -637.2003243863583, -498.7967178821564, -625.2673137784004, -602.094914317131, -1190.1332458257675, -680.1725950241089, -617.0185479819775, -849.5891119837761, -667.0550461411476, -556.5687430202961, -700.5778322815895, -844.5972680747509, -592.6578359603882, -691.3116356134415, -594.5856350064278, -759.6781649887562, -951.7907700538635, -2577.8134266138077, -1057.3694611787796, -642.2418696880341, -600.0970467627048, -525.982803016901, -560.1906945705414, -872.1756246685982, -576.1992889642715, -690.2784679234028, -724.6800857484341, -811.2604580521584, -645.2626768350601, -797.2719528079033, -593.4316917657852, -1469.0486285686493, -719.750441879034, -642.2725205719471, -645.3177161514759, -674.9772611558437, -566.757214307785, -601.6288675963879, -669.5143893361092, -632.2295866012573, -631.4445534646511, -645.0342090725899], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3882932829325245, "mean_inference_ms": 4.482677638828195, "mean_action_processing_ms": 4.162084667145903, "mean_env_wait_ms": 3.045203813369727, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3276000, "timesteps_this_iter": 131040, "agent_timesteps_total": 3276000, "timers": {"sample_time_ms": 38527.517, "sample_throughput": 3401.205, "load_time_ms": 21.749, "load_throughput": 6025138.796, "learn_time_ms": 15285.409, "learn_throughput": 8572.882, "update_time_ms": 2.264}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920928955078122e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 286.1755985892729, "policy_loss": -0.0006283187582637985, "vf_loss": 57.23550346675312, "vf_explained_var": -0.02268731668858545, "kl": 0.0017768200918761713, "entropy": -0.24526171893629123, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3276000, "num_agent_steps_sampled": 3276000, "num_steps_trained": 3276000, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3276000}, "done": false, "episodes_total": 6880, "training_iteration": 25, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-38-31", "timestamp": 1691001511, "time_this_iter_s": 39.926807165145874, "time_total_s": 983.7377398014069, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 983.7377398014069, "timesteps_since_restore": 3276000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 46.97192982456141, "ram_util_percent": 75.24912280701753}}
{"evaluation": {"episode_reward_max": -875.455150693655, "episode_reward_min": -875.455150693655, "episode_reward_mean": -875.455150693655, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-875.455150693655], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -452.92299422621727, "episode_reward_min": -6516.710610687733, "episode_reward_mean": -780.2179867273569, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-676.1675581037998, -610.213697463274, -567.945467799902, -706.7156152129173, -452.92299422621727, -680.5898965895176, -648.5422837138176, -602.7807116508484, -713.247561365366, -638.9366671741009, -603.3284938335419, -1212.634656459093, -632.3792773783207, -789.290783315897, -725.2792068123817, -2321.0156829357147, -1032.063786238432, -592.5111708641052, -579.7764629721642, -655.8161825239658, -624.0780130624771, -666.6191599965096, -670.3470897376537, -626.5303498804569, -628.7002220749855, -675.1942859590054, -716.2828622758389, -586.6879014372826, -575.6002516746521, -728.056862950325, -619.0344948768616, -594.7776302695274, -608.3829788267612, -588.3268057107925, -676.4929801523685, -567.3710795342922, -793.9478720128536, -670.2134639918804, -562.0926293730736, -615.3276554048061, -939.626165241003, -498.76105615496635, -534.7287335395813, -577.3367531001568, -553.7125915884972, -758.6505782306194, -763.0760550796986, -596.0063169598579, -770.0209847390652, -6516.710610687733, -767.0355451703072, -728.9613104760647, -740.6737198233604, -632.5936872065067, -577.7604165375233, -951.7243390977383, -727.7518246173859, -519.1185990273952, -637.2003243863583, -498.7967178821564, -625.2673137784004, -602.094914317131, -1190.1332458257675, -680.1725950241089, -617.0185479819775, -849.5891119837761, -667.0550461411476, -556.5687430202961, -700.5778322815895, -844.5972680747509, -592.6578359603882, -691.3116356134415, -594.5856350064278, -759.6781649887562, -951.7907700538635, -2577.8134266138077, -1057.3694611787796, -642.2418696880341, -600.0970467627048, -525.982803016901, -560.1906945705414, -872.1756246685982, -576.1992889642715, -690.2784679234028, -724.6800857484341, -811.2604580521584, -645.2626768350601, -797.2719528079033, -593.4316917657852, -1469.0486285686493, -719.750441879034, -642.2725205719471, -645.3177161514759, -674.9772611558437, -566.757214307785, -601.6288675963879, -669.5143893361092, -632.2295866012573, -631.4445534646511, -645.0342090725899], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.463171777934372, "mean_inference_ms": 4.494921700551961, "mean_action_processing_ms": 4.261351727253842, "mean_env_wait_ms": 3.039169022465062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3407040, "timesteps_this_iter": 131040, "agent_timesteps_total": 3407040, "timers": {"sample_time_ms": 38543.125, "sample_throughput": 3399.828, "load_time_ms": 21.757, "load_throughput": 6022827.946, "learn_time_ms": 15294.682, "learn_throughput": 8567.684, "update_time_ms": 2.273}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.960464477539061e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 284.5552882223401, "policy_loss": -0.00020205429330122729, "vf_loss": 56.911010933606, "vf_explained_var": -0.024292466888291005, "kl": 0.0015212092305555286, "entropy": -0.24961493778506488, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3407040, "num_agent_steps_sampled": 3407040, "num_steps_trained": 3407040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3407040}, "done": false, "episodes_total": 6880, "training_iteration": 26, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-38-46", "timestamp": 1691001526, "time_this_iter_s": 15.445672273635864, "time_total_s": 999.1834120750427, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 999.1834120750427, "timesteps_since_restore": 3407040, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.32727272727273, "ram_util_percent": 75.5181818181818}}
{"evaluation": {"episode_reward_max": -793.6685166954994, "episode_reward_min": -793.6685166954994, "episode_reward_mean": -793.6685166954994, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.6685166954994], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2494874569195895, "mean_inference_ms": 3.7471250563284144, "mean_action_processing_ms": 1.2376637239602308, "mean_env_wait_ms": 195.04694252471617, "mean_env_render_ms": 2.9938122497090967}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -418.23629000782967, "episode_reward_min": -1805.795882254839, "episode_reward_mean": -649.8769252185709, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-674.2022657990456, -708.3412753641605, -565.351532459259, -572.0969163179398, -610.6325565576553, -1342.823702543974, -604.363498032093, -584.3145109117031, -701.5830098390579, -646.9246921539307, -594.7259159982204, -1250.965197712183, -648.0547537207603, -556.3072890043259, -543.6534503698349, -688.8098766505718, -519.3882343173027, -747.9221930801868, -524.4383466541767, -674.4606006145477, -716.7220913469791, -808.4322897791862, -624.4879744648933, -866.6302905976772, -735.5564071238041, -616.944654405117, -595.3986928462982, -525.9939068853855, -577.4267862737179, -701.5356865525246, -782.60970890522, -901.8545458316803, -561.003180295229, -555.8850691318512, -492.85194754600525, -625.4396941959858, -573.1811794638634, -592.9414429366589, -536.4036633372307, -689.0637509524822, -554.0911032259464, -684.7513101100922, -731.3874843120575, -528.6642375290394, -498.6867495775223, -556.915094345808, -728.7802806794643, -518.1383214890957, -774.3844177126884, -708.1430880725384, -662.3718934953213, -492.28971403837204, -592.6705274581909, -751.0699327290058, -664.878878057003, -550.9422504007816, -769.135246783495, -638.5357327461243, -483.5774280130863, -482.9098464846611, -728.2567405104637, -579.0197698771954, -527.1146714687347, -737.2559835016727, -705.9897999763489, -448.5669322311878, -523.3804410398006, -508.1336997449398, -706.148461163044, -642.0229037106037, -612.8864651322365, -655.4070862233639, -507.65982735157013, -713.8834894895554, -646.8037783801556, -527.7535864114761, -659.5974346101284, -729.8472581803799, -543.0165583789349, -711.9413736462593, -472.94841024279594, -493.2193955183029, -704.2761659920216, -778.3249818682671, -621.4468418359756, -507.3791373372078, -553.2416839897633, -490.94384437799454, -601.200902402401, -585.7716221809387, -922.6643023490906, -733.6027586460114, -520.4140692651272, -775.3311078548431, -516.4939875602722, -542.7228737175465, -667.7964396476746, -711.6212826669216, -714.5580435395241, -565.0288612246513, -855.625092715025, -793.0479227602482, -742.0905349254608, -592.6770170331001, -747.2671373188496, -994.2449250221252, -797.723996847868, -717.4705002307892, -579.0835220813751, -654.1621794402599, -613.0087884366512, -559.7480618059635, -586.9677651822567, -836.0443448126316, -738.059193521738, -542.7040807902813, -852.1178185045719, -617.5181092321873, -969.4108269512653, -647.7634735703468, -629.2207601070404, -766.4909929931164, -812.3941514194012, -703.7352092266083, -651.9459803700447, -594.8875150084496, -547.9368433952332, -763.8987129926682, -797.9929229617119, -658.4517985284328, -568.8587611913681, -589.4794792532921, -658.4098945856094, -641.4714442491531, -635.7852040231228, -907.0239621698856, -1066.0234900414944, -505.2689540684223, -481.69075933098793, -649.1442823410034, -540.7356935441494, -786.6343131363392, -561.3652129769325, -573.765753865242, -637.1717437505722, -523.0016740560532, -508.58229237794876, -505.54212164878845, -526.0188077092171, -418.23629000782967, -715.8609545230865, -578.5803898870945, -664.27798807621, -560.838775485754, -602.2731612026691, -614.2095066606998, -700.8872079849243, -524.5834967792034, -527.5716102719307, -507.4856461584568, -804.8180978000164, -497.3310481607914, -483.04567781090736, -564.1634181141853, -1171.1576854288578, -508.4438216984272, -493.96613892912865, -610.5200278759003, -671.606674104929, -649.2297519147396, -640.7563297748566, -649.9527424275875, -576.3350313305855, -661.9773046374321, -568.6046591103077, -543.944609194994, -782.1059817671776, -634.079507380724, -1504.170641452074, -574.2984831929207, -675.4077181518078, -525.4493579864502, -598.8937779068947, -654.0941252708435, -511.7763601541519, -1665.2305676341057, -789.5112212300301, -608.3412556946278, -483.7396023571491, -868.1195900142193, -727.9111110568047, -544.1567484140396, -491.75809904932976, -564.994722366333, -604.962090075016, -586.7133438587189, -660.1798833608627, -617.8341205120087, -486.20939791202545, -705.0868611037731, -850.0629584491253, -574.5498741269112, -1078.1715780198574, -511.1110592484474, -585.5325442254543, -597.0018494725227, -661.35528627038, -580.1906100809574, -742.6638034582138, -668.0260204970837, -641.1684046089649, -551.2025173306465, -682.2050623297691, -701.4773160815239, -619.870530128479, -729.2235215902328, -573.7810351848602, -687.0122359097004, -679.1905774772167, -688.1299688220024, -494.7960585951805, -566.9402073323727, -644.219259172678, -516.4307859241962, -615.3595785200596, -628.0868352353573, -821.8595736026764, -511.5287769138813, -567.7841731905937, -598.46001085639, -555.2970955073833, -587.9982717335224, -458.5099285542965, -570.5113677978516, -543.5254792869091, -687.8569854199886, -557.6316046714783, -506.5456887483597, -600.6857961118221, -766.9070529639721, -561.4699129462242, -592.6012800633907, -575.5595923662186, -484.8627213835716, -638.0189030170441, -673.347025513649, -683.7929970920086, -661.1260176897049, -542.2125900387764, -567.5343148112297, -743.9373601078987, -632.600309073925, -664.0078127384186, -647.9649316966534, -580.7968417108059, -625.4976342320442, -625.2372308969498, -491.6429236829281, -673.9507919847965, -480.97834184765816, -526.4096338450909, -567.2666225135326, -662.1316679120064, -787.8032363653183, -593.8605996668339, -789.9424970149994, -658.2109071314335, -521.8486725091934, -519.1114802360535, -916.9043178856373, -532.1895567327738, -701.4200261235237, -748.704509973526, -760.9624275267124, -670.3002280592918, -552.7555913329124, -732.2120772004128, -662.9469238519669, -485.1052144765854, -786.3533847928047, -632.1086112260818, -547.7194338142872, -556.5481714606285, -500.20154428482056, -734.6762536764145, -473.8826506137848, -688.7904861867428, -536.5673714280128, -632.5691594183445, -596.9399489462376, -619.7538432478905, -698.7744324505329, -859.0438056886196, -739.3536946177483, -719.8655526340008, -570.7266430258751, -875.7779923975468, -865.1973542869091, -570.6217917501926, -541.4533574581146, -1805.795882254839, -508.72634494304657, -673.2399432659149, -638.908016204834, -643.146958053112, -815.8969103097916, -570.8660887479782, -862.8445923626423, -660.392272144556, -844.5912719368935, -589.8811962604523, -586.3810928463936, -517.2226504087448, -608.204070597887, -717.3977871239185, -913.4731038212776, -632.5021375417709, -624.9704878926277, -620.9115552306175, -635.6601859331131, -709.8419497311115, -603.8433099985123, -613.5829204916954, -566.4576809108257, -705.5804072320461, -657.6951938867569, -598.8717717826366, -565.4422179460526, -586.4283384680748, -489.2648824453354, -728.6907087266445, -559.4837278723717, -677.6563308238983, -779.8355168998241, -568.8934826552868, -517.3561681807041, -508.97242549061775, -535.57312682271, -965.5056853294373, -669.2032319009304, -564.8163971602917, -658.7573716342449, -668.1422393321991, -728.0461073517799, -560.9566816091537, -798.1445434987545, -816.5784332454205, -655.2475134432316, -620.990414083004, -613.8835375607014, -531.0153160691261, -578.8084310591221, -541.9679090082645, -596.813647121191, -662.8239477574825, -508.7904272079468, -758.1592161357403, -757.4052242636681, -535.3059611320496, -640.7219603955746, -643.4815164208412, -699.9043174386024, -738.1971953809261, -691.6037303209305, -669.0770211219788, -717.0631151795387, -590.4702361226082, -584.9387398064137, -487.70274272561073, -514.6343261599541, -1452.189776867628, -527.0490763187408, -578.8629787564278, -615.274113804102, -638.9684460163116, -743.9146524965763, -562.6515291035175, -895.7770154774189, -486.16464552283287, -470.08721858263016, -627.4741754233837, -556.3105994164944, -791.1184817552567, -523.2965386807919, -1289.1357207894325, -651.6312599778175, -675.2665055692196, -644.9825675189495, -528.3218759894371, -596.1632336378098, -541.1864393353462, -649.3349000513554, -543.0216439068317, -722.8642778396606, -671.2220785021782, -698.7273393571377, -527.0487847924232, -632.5764408111572, -723.632472127676, -628.9228593409061, -570.1763219833374, -642.6044438481331, -559.9889070391655, -564.7674312591553, -681.4255990386009, -647.6514727771282, -697.3198710083961, -668.3097046017647, -472.5566519498825, -891.6387771070004, -579.6725597679615, -859.5089796483517, -789.1018532514572, -691.8180569410324, -711.5039140582085, -583.4614750444889, -665.5443624258041, -1160.14158898592, -670.4988830983639, -513.8253699243069, -570.873953461647, -752.3674441277981, -539.6665773391724, -519.6631189882755, -677.1939798891544, -655.3892698585987, -637.356871753931, -887.7738172113895, -577.5045663118362, -578.8372550308704, -494.60062143206596, -639.9616433680058, -552.5411021113396, -726.5382083058357, -600.5612777173519, -505.70520853996277, -518.7409426271915, -545.8380204737186, -648.000294148922, -695.8126044273376, -618.1046386659145, -567.2203614711761, -758.2900125682354, -736.8899447321892, -701.9420568645, -687.824355006218, -466.4432926476002, -535.6488778293133, -567.5585399568081, -492.5142067372799, -602.9218239784241, -670.7359712719917, -558.5872560441494, -596.7218700647354, -678.9387577474117, -745.3471474945545, -804.5287572145462, -860.5624121129513, -730.5738659501076, -506.05047458410263, -627.5841712355614, -471.3774209022522, -1275.480092704296, -589.1686757206917, -539.7384148836136, -622.2960214912891, -576.9584487378597, -630.8433783352375, -670.1811084151268, -672.9151058793068, -515.5406505167484, -824.1353506743908, -572.0751549303532, -505.02949103713036, -490.57905665040016, -554.3835283517838, -521.0823152959347, -610.70742431283, -599.418472379446, -632.6862882971764], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.38245023458962, "mean_inference_ms": 4.480787772049989, "mean_action_processing_ms": 4.160928730289839, "mean_env_wait_ms": 3.0428376193516717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3538080, "timesteps_this_iter": 131040, "agent_timesteps_total": 3538080, "timers": {"sample_time_ms": 38524.296, "sample_throughput": 3401.49, "load_time_ms": 21.649, "load_throughput": 6052901.294, "learn_time_ms": 15300.994, "learn_throughput": 8564.15, "update_time_ms": 2.263}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322387695306e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 288.44146452070606, "policy_loss": 0.0033865399953717772, "vf_loss": 57.68465658071648, "vf_explained_var": -0.04631725754789127, "kl": 0.0015234784093299952, "entropy": -0.25039307094816665, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3538080, "num_agent_steps_sampled": 3538080, "num_steps_trained": 3538080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3538080}, "done": false, "episodes_total": 7360, "training_iteration": 27, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-39-25", "timestamp": 1691001565, "time_this_iter_s": 39.165098667144775, "time_total_s": 1038.3485107421875, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1038.3485107421875, "timesteps_since_restore": 3538080, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 46.81071428571429, "ram_util_percent": 75.55535714285715}}
{"evaluation": {"episode_reward_max": -506.1556624174118, "episode_reward_min": -506.1556624174118, "episode_reward_mean": -506.1556624174118, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-506.1556624174118], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -466.4432926476002, "episode_reward_min": -1289.1357207894325, "episode_reward_mean": -645.5826638939976, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-627.4741754233837, -556.3105994164944, -791.1184817552567, -523.2965386807919, -1289.1357207894325, -651.6312599778175, -675.2665055692196, -644.9825675189495, -528.3218759894371, -596.1632336378098, -541.1864393353462, -649.3349000513554, -543.0216439068317, -722.8642778396606, -671.2220785021782, -698.7273393571377, -527.0487847924232, -632.5764408111572, -723.632472127676, -628.9228593409061, -570.1763219833374, -642.6044438481331, -559.9889070391655, -564.7674312591553, -681.4255990386009, -647.6514727771282, -697.3198710083961, -668.3097046017647, -472.5566519498825, -891.6387771070004, -579.6725597679615, -859.5089796483517, -789.1018532514572, -691.8180569410324, -711.5039140582085, -583.4614750444889, -665.5443624258041, -1160.14158898592, -670.4988830983639, -513.8253699243069, -570.873953461647, -752.3674441277981, -539.6665773391724, -519.6631189882755, -677.1939798891544, -655.3892698585987, -637.356871753931, -887.7738172113895, -577.5045663118362, -578.8372550308704, -494.60062143206596, -639.9616433680058, -552.5411021113396, -726.5382083058357, -600.5612777173519, -505.70520853996277, -518.7409426271915, -545.8380204737186, -648.000294148922, -695.8126044273376, -618.1046386659145, -567.2203614711761, -758.2900125682354, -736.8899447321892, -701.9420568645, -687.824355006218, -466.4432926476002, -535.6488778293133, -567.5585399568081, -492.5142067372799, -602.9218239784241, -670.7359712719917, -558.5872560441494, -596.7218700647354, -678.9387577474117, -745.3471474945545, -804.5287572145462, -860.5624121129513, -730.5738659501076, -506.05047458410263, -627.5841712355614, -471.3774209022522, -1275.480092704296, -589.1686757206917, -539.7384148836136, -622.2960214912891, -576.9584487378597, -630.8433783352375, -670.1811084151268, -672.9151058793068, -515.5406505167484, -824.1353506743908, -572.0751549303532, -505.02949103713036, -490.57905665040016, -554.3835283517838, -521.0823152959347, -610.70742431283, -599.418472379446, -632.6862882971764], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.455785032106057, "mean_inference_ms": 4.495963859124189, "mean_action_processing_ms": 4.263319043420939, "mean_env_wait_ms": 3.0393148057014696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3669120, "timesteps_this_iter": 131040, "agent_timesteps_total": 3669120, "timers": {"sample_time_ms": 36190.091, "sample_throughput": 3620.881, "load_time_ms": 20.245, "load_throughput": 6472555.678, "learn_time_ms": 15408.982, "learn_throughput": 8504.131, "update_time_ms": 2.384}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161193847653e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 278.1286455761504, "policy_loss": -0.005351735318091464, "vf_loss": 55.63082640316324, "vf_explained_var": -0.028145783050085908, "kl": 0.0018629404598526577, "entropy": -0.2552916094340304, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3669120, "num_agent_steps_sampled": 3669120, "num_steps_trained": 3669120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3669120}, "done": false, "episodes_total": 7360, "training_iteration": 28, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-42-31", "timestamp": 1691001751, "time_this_iter_s": 185.42479801177979, "time_total_s": 1223.7733087539673, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1223.7733087539673, "timesteps_since_restore": 3669120, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 46.667716535433065, "ram_util_percent": 97.33149606299212}}
{"evaluation": {"episode_reward_max": -581.073855817318, "episode_reward_min": -581.073855817318, "episode_reward_mean": -581.073855817318, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-581.073855817318], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -397.5021650195122, "episode_reward_min": -1581.0480903685093, "episode_reward_mean": -601.3999121524394, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-607.417464107275, -532.0726419091225, -586.7528967559338, -731.9903565049171, -701.2062824964523, -491.1837802529335, -438.2163388133049, -583.3142432868481, -498.7345659136772, -588.4723561108112, -604.4991385638714, -549.4019527733326, -517.7445425391197, -713.7167101502419, -745.5825537443161, -518.4945551455021, -490.4348998069763, -695.6926213800907, -510.05287408828735, -597.8168378472328, -618.5466084480286, -689.532765686512, -543.5718962550163, -783.548552364111, -715.7875838577747, -470.11911422014236, -650.3589607775211, -544.8815135657787, -809.4267955124378, -633.6228464841843, -655.8428562879562, -552.9799653291702, -579.8592585027218, -720.0953485071659, -933.9045831859112, -511.84178602695465, -599.6912462115288, -549.0112026035786, -544.8446746766567, -543.2592080235481, -586.8521751761436, -652.831375002861, -494.0740447938442, -658.6217204332352, -684.0147827267647, -522.7182419300079, -529.0515611469746, -525.482704102993, -548.8263486027718, -612.2364124059677, -781.0607035160065, -677.4530057013035, -581.235453248024, -541.4839942455292, -592.7391835451126, -671.4768268167973, -601.6253021657467, -476.10534712672234, -493.6636399924755, -577.9194243848324, -823.8261637985706, -559.2611874043941, -590.905399531126, -603.5423517227173, -568.7075705528259, -494.6922772526741, -617.8036195635796, -573.7260137498379, -497.7730875611305, -604.7258380651474, -665.2841540277004, -676.451274484396, -491.0065151453018, -605.8873631358147, -431.48496448993683, -626.049364387989, -490.8197992146015, -590.7984539866447, -492.3314993083477, -519.2288389801979, -543.1426948308945, -592.3543881773949, -572.2429208159447, -598.0517730712891, -616.9227094054222, -624.4627320766449, -559.0204796791077, -754.8970142900944, -774.1898526251316, -568.1871690750122, -524.7080890834332, -615.1867936551571, -630.2807816267014, -638.967937707901, -484.13054448366165, -533.562467187643, -609.9558126330376, -657.2647843062878, -559.7334612905979, -466.449508279562, -499.5394977927208, -619.3073104918003, -564.6258957982063, -621.1059868335724, -1122.2981960773468, -644.8321211338043, -642.2156814932823, -595.5767078995705, -614.3846696615219, -555.0804823935032, -650.9638908207417, -475.16471567749977, -805.5441826581955, -754.337394297123, -685.3582431674004, -613.3293565511703, -689.6505562663078, -533.4039228260517, -867.8402141332626, -659.0922880470753, -600.1361492276192, -607.3586142063141, -530.9571172297001, -491.0964123606682, -721.4160218536854, -563.4052184820175, -575.9765710234642, -579.6291118860245, -516.6390173733234, -589.4169682860374, -545.8515881896019, -771.2596267461777, -612.6282360851765, -517.0620469450951, -751.3827882409096, -673.3419603705406, -481.30681642889977, -622.9631432592869, -556.0458132326603, -485.8301393687725, -539.3874967098236, -644.2128976583481, -560.9129227101803, -538.7545454800129, -499.0131925046444, -681.4072643816471, -589.0144426524639, -461.9449242949486, -539.7829827964306, -580.1919369101524, -517.9085752665997, -525.6220173239708, -609.0034944415092, -608.8994629979134, -579.0362380743027, -583.8279469013214, -535.9709143936634, -624.9419771432877, -542.8927078545094, -707.8509173989296, -657.1769754290581, -492.66464003920555, -485.6217207312584, -525.655887901783, -706.5845634043217, -551.7927820384502, -768.8955921530724, -664.0873382687569, -552.7786568701267, -552.0612090229988, -525.1957257091999, -778.9999240040779, -509.4752130508423, -808.4003196656704, -456.8240930736065, -573.6650041639805, -707.2201310694218, -632.3616823256016, -840.7213618457317, -681.0485137701035, -484.9418950676918, -1358.939752459526, -585.6765406131744, -700.0559138059616, -761.8048355579376, -610.0464842617512, -724.5961635410786, -755.779921233654, -641.4434737861156, -521.8510971069336, -951.4116351902485, -625.6320034563541, -558.7251680493355, -542.1339466869831, -530.3411099612713, -598.0892286300659, -731.5563871562481, -547.6776841878891, -562.6919218599796, -562.6347761750221, -498.4058672785759, -596.3742525577545, -484.82821947336197, -599.2902567386627, -540.2737999260426, -667.4292834401131, -479.07311487197876, -488.13746574521065, -589.1220790445805, -525.4454669654369, -755.9201034009457, -764.268070846796, -528.9418637752533, -480.02061635255814, -529.8584171235561, -499.0535917878151, -518.7641461491585, -668.125381320715, -582.7332969009876, -517.332679271698, -943.4929569363594, -506.8668131530285, -519.0652951002121, -690.2963615357876, -753.7519388794899, -678.7627906799316, -701.3446859717369, -487.1818102002144, -584.0096095204353, -568.5454136133194, -617.1257413029671, -594.6681488156319, -440.11688607931137, -564.3987656533718, -686.6441634595394, -498.6583653688431, -932.5299271941185, -482.0149556994438, -397.5021650195122, -489.6684769690037, -430.6928849220276, -525.3639761805534, -700.3417422771454, -554.2458072602749, -504.5786322951317, -595.6031191945076, -589.5320785939693, -658.3962528705597, -597.9440644085407, -1581.0480903685093, -611.1285298466682, -524.1450755298138, -533.7235695123672, -505.7873945534229, -550.9465017020702, -564.2167794406414, -625.3936728537083, -560.1561431288719, -547.5445174276829, -614.4699691236019, -841.2030254602432, -500.65313297510147, -586.8514536619186, -733.2633728384972, -772.6603918671608, -515.7620757818222, -595.201190829277, -621.8834403753281, -696.9952039718628, -795.1643068790436, -786.1253510117531, -601.6917578876019, -530.7471179962158, -447.3036503493786, -682.2728528678417, -547.1551884710789, -596.3808797597885, -585.5564199388027, -446.12743481993675, -583.8120870292187, -486.941978007555, -621.1831677854061, -577.7491391599178, -492.8070561885834, -609.5586518645287, -607.6310865879059, -543.4379367232323, -511.38849517703056, -621.0309346020222, -608.3539323806763, -401.126023709774, -523.3144230246544, -486.55011808872223, -774.0488826930523, -541.5280697345734, -608.1576217710972, -557.1282812058926, -617.2556197941303, -615.1171563267708, -555.1065382659435, -697.2023049592972, -730.3822066485882, -543.5036315023899, -610.647826641798, -538.9193619191647, -600.5327471494675, -513.1094963550568, -490.58812552690506, -1457.995820581913, -486.737178504467, -533.2427526712418, -657.0534646213055, -563.2169625461102, -583.3742048442364, -509.27555882930756, -556.7521412372589, -589.2508615255356, -864.0683019161224, -680.2414100468159, -642.4981409907341, -541.1677566468716, -467.5996839404106, -539.7618807256222, -543.1522941589355, -580.7812291383743, -564.9348347485065, -581.0323115289211, -503.4899855852127, -582.2261247336864, -624.9262647628784, -540.4781003296375, -538.6220690310001, -1360.2665892243385, -648.3254798352718, -512.7247268259525, -705.3789825737476, -583.3971246778965, -551.9103007614613, -607.2186553776264, -539.172116369009, -674.3359879553318, -517.0510377585888, -603.8492792546749, -565.3029855489731, -519.5688670873642, -582.4397471249104, -680.7260520160198, -498.912762761116, -546.797000259161, -534.160692512989, -494.19130632281303, -559.5199770629406, -686.8709244132042, -549.5896333754063, -547.5159682035446, -777.6981254518032, -587.1630646586418, -547.681329280138, -564.6477157473564, -514.2972576320171, -624.9207703471184, -539.6401434242725, -663.6328082978725, -531.0121657848358, -565.0530327260494, -565.5618910491467, -585.4990597069263, -548.3477528989315, -672.7108795642853, -513.4409769177437, -560.2983873486519, -542.0001583099365, -726.9916254878044, -791.0319994091988, -492.259592294693, -555.3478697538376, -552.0658338963985, -510.1408669054508, -656.6524365246296, -535.6366109251976, -466.6108222603798, -707.8062436282635, -615.8810666799545, -601.6715163588524, -588.9792398512363, -546.8721126019955, -572.2845518290997, -435.96582835912704, -468.5441730618477, -434.6848903000355, -495.71445828676224, -600.7252528369427, -506.5423809289932, -536.9216929674149, -554.2255282998085, -553.751094698906, -585.2042791843414, -516.4137617349625, -531.5736288130283, -527.2584748566151, -498.7534337043762, -488.2627304792404, -573.556647926569, -603.1573851704597, -551.7088533341885, -541.7926878929138, -634.0746231973171, -681.2338849306107, -582.3866502642632, -723.1247592866421, -592.6282442510128, -581.6006632745266, -582.5125730931759, -488.24482437968254, -488.0570329427719, -633.0308142900467, -656.7337482869625, -594.0894637107849, -499.89778488874435, -497.5578432381153, -675.6358420550823, -421.3206969499588, -599.5974863469601, -528.0264716744423, -510.29588374495506, -627.224269092083, -471.305160343647, -444.9762559533119, -764.6295535266399, -508.6138801276684, -780.9181626141071, -410.5795298218727, -547.5801055431366, -561.5849573612213, -732.3310517370701, -788.8057310283184, -515.8487510085106, -803.4937098026276, -544.4840975105762, -735.4779669046402, -578.4599106013775, -548.2902044951916, -647.5031850636005, -465.84304490685463, -496.81348979473114, -853.8318349421024, -1030.0448528826237, -495.8267866373062, -523.8582954704762, -594.3008402884007, -572.9256010353565, -671.3093455135822, -537.0212870836258, -633.933236092329, -651.9490998983383, -502.3348714709282, -784.3627342283726, -574.1880561709404, -649.8837178647518, -625.3580898046494, -461.395577698946, -656.7491385340691, -525.8620152771473, -906.005499124527, -560.7666567862034, -664.9930142462254, -565.4471971094608, -662.9473322629929, -498.1762877702713, -607.2214953303337, -652.0277647078037, -624.0835748016834, -650.1689062416553, -402.8486897647381, -752.8102857768536, -571.6887392103672, -519.2970150411129, -594.365418612957, -537.3661242127419, -689.4752452373505], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.382054727640854, "mean_inference_ms": 4.4840723491652215, "mean_action_processing_ms": 4.1604174183714635, "mean_env_wait_ms": 3.043392946786294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3800160, "timesteps_this_iter": 131040, "agent_timesteps_total": 3800160, "timers": {"sample_time_ms": 55576.252, "sample_throughput": 2357.842, "load_time_ms": 22.118, "load_throughput": 5924497.916, "learn_time_ms": 15333.314, "learn_throughput": 8546.098, "update_time_ms": 2.419}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580596923826e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 276.1492685684861, "policy_loss": -0.0008783638483808681, "vf_loss": 55.23047263989739, "vf_explained_var": 0.004470058239489046, "kl": 0.001765699033883336, "entropy": -0.2601787558486385, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3800160, "num_agent_steps_sampled": 3800160, "num_steps_trained": 3800160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3800160}, "done": false, "episodes_total": 7840, "training_iteration": 29, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-43-10", "timestamp": 1691001790, "time_this_iter_s": 38.876261711120605, "time_total_s": 1262.649570465088, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1262.649570465088, "timesteps_since_restore": 3800160, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 47.012727272727275, "ram_util_percent": 70.82909090909092}}
{"evaluation": {"episode_reward_max": -547.207173794508, "episode_reward_min": -547.207173794508, "episode_reward_mean": -547.207173794508, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-547.207173794508], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -402.8486897647381, "episode_reward_min": -1030.0448528826237, "episode_reward_mean": -588.5449967122078, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-466.6108222603798, -707.8062436282635, -615.8810666799545, -601.6715163588524, -588.9792398512363, -546.8721126019955, -572.2845518290997, -435.96582835912704, -468.5441730618477, -434.6848903000355, -495.71445828676224, -600.7252528369427, -506.5423809289932, -536.9216929674149, -554.2255282998085, -553.751094698906, -585.2042791843414, -516.4137617349625, -531.5736288130283, -527.2584748566151, -498.7534337043762, -488.2627304792404, -573.556647926569, -603.1573851704597, -551.7088533341885, -541.7926878929138, -634.0746231973171, -681.2338849306107, -582.3866502642632, -723.1247592866421, -592.6282442510128, -581.6006632745266, -582.5125730931759, -488.24482437968254, -488.0570329427719, -633.0308142900467, -656.7337482869625, -594.0894637107849, -499.89778488874435, -497.5578432381153, -675.6358420550823, -421.3206969499588, -599.5974863469601, -528.0264716744423, -510.29588374495506, -627.224269092083, -471.305160343647, -444.9762559533119, -764.6295535266399, -508.6138801276684, -780.9181626141071, -410.5795298218727, -547.5801055431366, -561.5849573612213, -732.3310517370701, -788.8057310283184, -515.8487510085106, -803.4937098026276, -544.4840975105762, -735.4779669046402, -578.4599106013775, -548.2902044951916, -647.5031850636005, -465.84304490685463, -496.81348979473114, -853.8318349421024, -1030.0448528826237, -495.8267866373062, -523.8582954704762, -594.3008402884007, -572.9256010353565, -671.3093455135822, -537.0212870836258, -633.933236092329, -651.9490998983383, -502.3348714709282, -784.3627342283726, -574.1880561709404, -649.8837178647518, -625.3580898046494, -461.395577698946, -656.7491385340691, -525.8620152771473, -906.005499124527, -560.7666567862034, -664.9930142462254, -565.4471971094608, -662.9473322629929, -498.1762877702713, -607.2214953303337, -652.0277647078037, -624.0835748016834, -650.1689062416553, -402.8486897647381, -752.8102857768536, -571.6887392103672, -519.2970150411129, -594.365418612957, -537.3661242127419, -689.4752452373505], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.455103252948579, "mean_inference_ms": 4.497471470999073, "mean_action_processing_ms": 4.261965368105435, "mean_env_wait_ms": 3.039115850975436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3931200, "timesteps_this_iter": 131040, "agent_timesteps_total": 3931200, "timers": {"sample_time_ms": 44529.374, "sample_throughput": 2942.777, "load_time_ms": 20.278, "load_throughput": 6462312.257, "learn_time_ms": 15375.077, "learn_throughput": 8522.884, "update_time_ms": 2.449}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.725290298461913e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 269.6487502134309, "policy_loss": 0.0017868243271072948, "vf_loss": 53.927699571014735, "vf_explained_var": 0.06319910715130495, "kl": 0.001835983548660539, "entropy": -0.26440965023732954, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3931200, "num_agent_steps_sampled": 3931200, "num_steps_trained": 3931200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3931200}, "done": false, "episodes_total": 7840, "training_iteration": 30, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-43-25", "timestamp": 1691001805, "time_this_iter_s": 15.553021430969238, "time_total_s": 1278.2025918960571, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1278.2025918960571, "timesteps_since_restore": 3931200, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 16.23181818181818, "ram_util_percent": 70.60000000000001}}
{"evaluation": {"episode_reward_max": -593.6991704106331, "episode_reward_min": -593.6991704106331, "episode_reward_mean": -593.6991704106331, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.6991704106331], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -376.4153898358345, "episode_reward_min": -1496.1896222531796, "episode_reward_mean": -580.6996675652762, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-629.7946932017803, -525.3343788683414, -526.2329819202423, -512.9780517816544, -564.9238284528255, -768.4363331794739, -508.56114238500595, -670.9191968739033, -512.741403222084, -456.93538850545883, -569.5464718639851, -590.3504611849785, -545.2782273590565, -613.7256882190704, -535.4030564129353, -594.8292346894741, -507.3808867633343, -529.9202398955822, -494.7916719019413, -514.3079312741756, -519.4404620826244, -824.7711313068867, -676.7533894479275, -453.6333184540272, -468.9355158805847, -494.0614503324032, -558.477567076683, -560.2500273883343, -527.8925707042217, -610.449626237154, -658.2294828891754, -436.3992211818695, -512.2383309900761, -454.20211866497993, -727.3064441084862, -581.8555013239384, -554.5645994544029, -576.1438520252705, -479.85780158638954, -410.6345980167389, -523.3773173689842, -566.2205855250359, -492.8760370314121, -453.3923000693321, -606.2376956641674, -580.099433451891, -590.379393607378, -553.0495091080666, -757.4855969548225, -548.5098511576653, -631.366931438446, -629.0051868855953, -602.5266060829163, -543.2889075577259, -559.9739269912243, -548.807127058506, -594.648050814867, -670.3126961886883, -554.912598669529, -464.67477571964264, -1143.9381921589375, -560.1823538243771, -403.9101482331753, -656.1736329495907, -580.1032935082912, -501.112948089838, -673.0524307191372, -446.2568479180336, -527.8134659230709, -619.0693425238132, -508.7929903268814, -545.737496316433, -652.4548361897469, -548.7050241827965, -523.7708177268505, -700.6750474274158, -663.4083509147167, -662.6227649450302, -574.3150742053986, -586.8206112980843, -646.985274285078, -574.1919655799866, -812.8218881189823, -669.5788238048553, -686.1990757286549, -530.614951968193, -527.495652616024, -716.3660826981068, -434.42723485827446, -422.8568590581417, -840.3784806728363, -486.53284323215485, -453.22140192985535, -569.2606003582478, -591.6349851191044, -628.0330318510532, -636.3631416857243, -686.4078063964844, -571.8493776619434, -650.0309666395187, -520.5661758184433, -496.27383863925934, -642.9810620844364, -695.8680853545666, -529.2452202737331, -561.0710067749023, -583.3129236102104, -427.2386583983898, -438.1823835670948, -576.4057262539864, -527.3367902636528, -587.1016071140766, -445.3214961886406, -548.0257357656956, -508.6874466240406, -575.7604795694351, -540.1208634674549, -534.3924996554852, -528.7596421539783, -657.3128434419632, -523.7729968428612, -711.6391622722149, -441.8310579061508, -499.27130460739136, -523.6644982993603, -500.3149414360523, -529.242251008749, -525.8213848471642, -566.0645335316658, -495.3866741657257, -521.0066692829132, -621.8417252004147, -516.6372091472149, -893.0528769493103, -875.0073912739754, -717.3520823717117, -768.8705413937569, -589.656725525856, -536.8684863448143, -631.3072183728218, -532.7360434830189, -634.3490098416805, -575.6917862892151, -495.6904432475567, -633.5781093239784, -592.0184854269028, -558.890535980463, -485.6649566888809, -393.81106036901474, -483.2044355273247, -489.82671016454697, -557.954853117466, -507.19011384248734, -594.1904960274696, -514.5776905417442, -654.3746597468853, -434.26850470900536, -587.8373987674713, -516.3122695982456, -469.59366649389267, -577.407353669405, -566.318249642849, -508.72115978598595, -684.2752024829388, -594.9161993861198, -864.9973630607128, -597.442302852869, -602.2396399974823, -604.8279554247856, -508.02419796586037, -499.6251204609871, -542.0433763861656, -960.4532287120819, -521.8242457807064, -566.9304810166359, -506.57984441518784, -719.5983147025108, -567.2869712412357, -498.8935889005661, -603.5093712508678, -576.4596762955189, -536.2659516334534, -608.7818954586983, -437.8203674852848, -993.3454143702984, -544.0301012694836, -585.5443894267082, -596.5150770545006, -504.04401513934135, -484.71693059802055, -485.00319650769234, -489.63137236237526, -699.1194165349007, -620.1122587919235, -1475.0738028287888, -603.4191774129868, -447.8254963159561, -575.9146640300751, -1148.3315571248531, -470.9734551310539, -573.9001823961735, -562.8188644945621, -640.6862554252148, -536.0975057482719, -698.2303290367126, -515.269650220871, -548.8943259716034, -597.7510806024075, -448.9054874777794, -549.6270042657852, -572.1516688168049, -692.7621872127056, -926.2624118924141, -610.5563536286354, -483.5017622113228, -473.4784401655197, -532.5833992063999, -699.9919528067112, -592.6005260944366, -505.40562453866005, -452.19342267513275, -508.28183364868164, -566.9826381802559, -537.663794696331, -604.459586083889, -547.0505269169807, -455.8997404873371, -560.1368182897568, -639.7172060906887, -459.28440353274345, -568.0987705886364, -472.9918591082096, -545.1516415476799, -495.09978291392326, -477.11078402400017, -1423.5074580013752, -433.23933932185173, -541.6611748039722, -643.3754082918167, -547.044230312109, -489.2416165173054, -599.4869669377804, -554.6484601199627, -446.2509400844574, -549.4278226792812, -574.7553339898586, -440.1263790130615, -573.8465714454651, -431.7820709645748, -634.586266130209, -538.4988947808743, -475.94984605908394, -650.4255847036839, -489.20835027098656, -480.9816758930683, -603.7278489470482, -477.2888348996639, -541.1364160776138, -546.0499292314053, -569.7611077129841, -468.07780370116234, -508.4721004962921, -598.8401481211185, -459.39768242836, -472.28796607255936, -654.4074024260044, -688.3610885441303, -625.0186817348003, -599.6209953427315, -528.1533960402012, -446.4501404762268, -476.89628905057907, -474.1693297922611, -617.4323154389858, -595.6118941605091, -524.6902701258659, -699.2407858073711, -559.281319975853, -661.49145424366, -512.0069182813168, -525.1804437935352, -710.8588261008263, -551.4455259442329, -535.4294703304768, -513.181108802557, -499.8292478621006, -689.5630040466785, -866.8450777828693, -454.25017461180687, -624.011301189661, -669.1028442680836, -665.2207219004631, -498.87582927942276, -500.12519347667694, -757.1204115450382, -563.9230763018131, -521.3995069563389, -475.8042318224907, -544.1968887150288, -578.5462547242641, -555.7889403104782, -676.7972927689552, -1207.2839241325855, -460.91984021663666, -564.185097515583, -406.50515991449356, -589.4069286584854, -579.9640428721905, -571.9663336277008, -800.4090668857098, -613.1015093922615, -521.0526538789272, -559.5825622677803, -497.45414155721664, -627.2722327709198, -438.28433433175087, -812.3145239055157, -1430.790362417698, -559.5851720571518, -605.1918847858906, -486.0509826540947, -508.3276122510433, -628.8489529192448, -506.0548711717129, -507.5988459587097, -982.9273248612881, -565.658708691597, -678.8797688782215, -722.0325500071049, -712.1184092760086, -677.8774638772011, -609.165852278471, -651.8841401934624, -667.9308860003948, -597.8329301476479, -545.9428716003895, -732.7902793586254, -502.3043901324272, -479.06675827503204, -439.84179824590683, -507.4392754137516, -666.3325500190258, -667.4862635731697, -522.5719410777092, -611.2160006165504, -636.5686082541943, -552.1282371580601, -656.1693191230297, -560.6448296308517, -704.1261969208717, -572.7689832746983, -733.9584856629372, -609.8673160374165, -599.2269712686539, -1012.5596963465214, -740.4334793388844, -598.2142404317856, -546.7684991955757, -562.1445414721966, -558.7136199772358, -625.5962274372578, -555.5657944381237, -514.4024356901646, -667.0932233035564, -473.9696376025677, -590.7278995811939, -540.3555190861225, -482.7888994216919, -623.6958965957165, -823.964919179678, -549.6955480873585, -576.5073101222515, -584.2018914222717, -515.740263313055, -736.1254505813122, -524.832545787096, -545.2562496960163, -530.1328120827675, -584.4507581591606, -541.8448820114136, -490.0237292647362, -550.6568737924099, -496.67520093917847, -451.2369401752949, -969.300695925951, -560.3175303637981, -601.5822450816631, -692.05834582448, -520.4495539963245, -531.2685838639736, -462.68166521191597, -436.10480883717537, -594.6487158536911, -491.201307117939, -509.5985453426838, -560.1539613902569, -537.1614182293415, -542.4358435571194, -485.86575922369957, -562.4539538025856, -616.2961331605911, -699.5290072858334, -427.6183811724186, -603.1402621567249, -446.037633985281, -547.3913569748402, -574.3284821510315, -532.4281286895275, -714.792023986578, -584.5501657426357, -548.7699191570282, -489.1686125099659, -493.68630370497704, -537.5396962463856, -538.7615574896336, -476.67018672823906, -511.8192945718765, -528.1164709627628, -479.2320160269737, -729.8453209996223, -500.14784011244774, -531.1102132499218, -480.1696372330189, -519.2606873214245, -669.6021665334702, -675.6088627278805, -491.0857530236244, -642.3337369859219, -518.0785609483719, -403.80600968003273, -442.37087827920914, -591.3034224510193, -479.28914126753807, -545.4306291341782, -513.714523345232, -376.4153898358345, -503.9151826798916, -419.9764670729637, -465.70838791131973, -600.3263490498066, -1496.1896222531796, -469.49190697073936, -630.1957560479641, -710.7824242711067, -562.0163294374943, -497.30384570360184, -599.0870819985867, -470.456346988678, -613.5220963656902, -629.2697640359402, -421.6501350700855, -721.4350642859936, -602.6744781434536, -673.6280582249165, -555.0313438177109, -518.2016069591045, -837.9968938827515, -512.4760442376137, -582.3057665228844, -624.5543074011803, -415.723502188921, -665.8785089254379, -538.4185594022274, -712.6103906035423, -466.60189232230186, -518.8021187484264, -503.4352480173111, -604.486793577671, -496.5267436802387, -501.77435609698296, -480.26604276895523, -520.4149880111217, -690.7700203955173, -442.01609617471695, -521.2707413136959, -480.2604450881481, -525.1399247050285, -518.5632325410843, -479.97163301706314, -572.7110154628754], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.386909074705821, "mean_inference_ms": 4.489623886694088, "mean_action_processing_ms": 4.162556405805924, "mean_env_wait_ms": 3.044035483027019, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4062240, "timesteps_this_iter": 131040, "agent_timesteps_total": 4062240, "timers": {"sample_time_ms": 46974.786, "sample_throughput": 2789.582, "load_time_ms": 21.155, "load_throughput": 6194189.638, "learn_time_ms": 15377.32, "learn_throughput": 8521.641, "update_time_ms": 2.505}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451492309566e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 264.8448231041186, "policy_loss": 7.063862239708858e-05, "vf_loss": 52.96862542757424, "vf_explained_var": 0.06494320870300348, "kl": 0.0015852707698114329, "entropy": -0.2693473622469919, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4062240, "num_agent_steps_sampled": 4062240, "num_steps_trained": 4062240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4062240}, "done": false, "episodes_total": 8320, "training_iteration": 31, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-44-05", "timestamp": 1691001845, "time_this_iter_s": 39.30957579612732, "time_total_s": 1317.5121676921844, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1317.5121676921844, "timesteps_since_restore": 4062240, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 46.58571428571428, "ram_util_percent": 71.06607142857142}}
{"evaluation": {"episode_reward_max": -639.704870223999, "episode_reward_min": -639.704870223999, "episode_reward_mean": -639.704870223999, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.704870223999], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -376.4153898358345, "episode_reward_min": -1496.1896222531796, "episode_reward_mean": -558.791615960002, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-490.0237292647362, -550.6568737924099, -496.67520093917847, -451.2369401752949, -969.300695925951, -560.3175303637981, -601.5822450816631, -692.05834582448, -520.4495539963245, -531.2685838639736, -462.68166521191597, -436.10480883717537, -594.6487158536911, -491.201307117939, -509.5985453426838, -560.1539613902569, -537.1614182293415, -542.4358435571194, -485.86575922369957, -562.4539538025856, -616.2961331605911, -699.5290072858334, -427.6183811724186, -603.1402621567249, -446.037633985281, -547.3913569748402, -574.3284821510315, -532.4281286895275, -714.792023986578, -584.5501657426357, -548.7699191570282, -489.1686125099659, -493.68630370497704, -537.5396962463856, -538.7615574896336, -476.67018672823906, -511.8192945718765, -528.1164709627628, -479.2320160269737, -729.8453209996223, -500.14784011244774, -531.1102132499218, -480.1696372330189, -519.2606873214245, -669.6021665334702, -675.6088627278805, -491.0857530236244, -642.3337369859219, -518.0785609483719, -403.80600968003273, -442.37087827920914, -591.3034224510193, -479.28914126753807, -545.4306291341782, -513.714523345232, -376.4153898358345, -503.9151826798916, -419.9764670729637, -465.70838791131973, -600.3263490498066, -1496.1896222531796, -469.49190697073936, -630.1957560479641, -710.7824242711067, -562.0163294374943, -497.30384570360184, -599.0870819985867, -470.456346988678, -613.5220963656902, -629.2697640359402, -421.6501350700855, -721.4350642859936, -602.6744781434536, -673.6280582249165, -555.0313438177109, -518.2016069591045, -837.9968938827515, -512.4760442376137, -582.3057665228844, -624.5543074011803, -415.723502188921, -665.8785089254379, -538.4185594022274, -712.6103906035423, -466.60189232230186, -518.8021187484264, -503.4352480173111, -604.486793577671, -496.5267436802387, -501.77435609698296, -480.26604276895523, -520.4149880111217, -690.7700203955173, -442.01609617471695, -521.2707413136959, -480.2604450881481, -525.1399247050285, -518.5632325410843, -479.97163301706314, -572.7110154628754], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.459701599434896, "mean_inference_ms": 4.503250490673496, "mean_action_processing_ms": 4.264100599581859, "mean_env_wait_ms": 3.039119740763088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4193280, "timesteps_this_iter": 131040, "agent_timesteps_total": 4193280, "timers": {"sample_time_ms": 44545.095, "sample_throughput": 2941.738, "load_time_ms": 20.165, "load_throughput": 6498514.317, "learn_time_ms": 15321.754, "learn_throughput": 8552.546, "update_time_ms": 2.526}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225746154783e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 257.94434101613626, "policy_loss": 0.002508601566455402, "vf_loss": 51.58608476235448, "vf_explained_var": 0.09661069341457873, "kl": 0.0018972133106458598, "entropy": -0.27551491184687527, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4193280, "num_agent_steps_sampled": 4193280, "num_steps_trained": 4193280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4193280}, "done": false, "episodes_total": 8320, "training_iteration": 32, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-44-20", "timestamp": 1691001860, "time_this_iter_s": 15.096331119537354, "time_total_s": 1332.6084988117218, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1332.6084988117218, "timesteps_since_restore": 4193280, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 14.136363636363633, "ram_util_percent": 70.2590909090909}}
{"evaluation": {"episode_reward_max": -497.0467639565468, "episode_reward_min": -497.0467639565468, "episode_reward_mean": -497.0467639565468, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-497.0467639565468], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -362.9908994436264, "episode_reward_min": -9586.87547877431, "episode_reward_mean": -602.8954535939731, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-659.8325193822384, -622.8761380314827, -656.0699800848961, -492.59382915496826, -699.6502846181393, -595.534131616354, -1045.4819530546665, -658.0717807710171, -9586.87547877431, -537.523788869381, -474.81671166419983, -584.0999009013176, -643.9072167277336, -543.8659716248512, -449.7378409206867, -646.7902978360653, -552.8275960981846, -645.3381655812263, -466.8645563721657, -646.59461581707, -582.3619571626186, -526.4649828076363, -513.5946896970272, -703.8412048220634, -551.0678347349167, -525.8487035036087, -562.097353041172, -534.5416420996189, -531.3470455408096, -682.2123903036118, -672.2363725304604, -787.2586095333099, -544.1559280455112, -546.2087906002998, -708.2491019368172, -477.3896735012531, -490.95632418990135, -477.9914210140705, -477.4190728068352, -419.8707799911499, -570.6306749880314, -562.3539741039276, -497.4430478811264, -574.5385009646416, -636.58419662714, -436.49432530999184, -557.1954645812511, -490.7555431127548, -556.6331129074097, -488.61419332027435, -593.7061755955219, -524.865551173687, -441.389771848917, -475.19103986024857, -427.5856209695339, -539.8168487548828, -773.9764282107353, -510.3985472023487, -501.99051094055176, -626.9162670075893, -466.70272049307823, -603.1412295401096, -445.98696234822273, -689.9707266688347, -545.7323233783245, -442.05665877461433, -485.3438254892826, -468.534870326519, -524.1265036463737, -473.56867557764053, -636.9299115240574, -458.45060205459595, -459.61917224526405, -533.6433145403862, -425.7775364816189, -438.92077323794365, -581.9708379507065, -1507.9604740738869, -7736.871746599674, -477.4132219552994, -555.0837579965591, -501.7026200890541, -511.61639112234116, -504.6055514216423, -578.1186292171478, -486.0869083702564, -462.2804895043373, -446.52018797397614, -463.1228996515274, -505.54586389660835, -499.7409891486168, -627.140858232975, -596.2959387898445, -398.6974218785763, -395.90736055374146, -529.8958052396774, -607.3377128243446, -639.8447932302952, -546.7121893465519, -472.93766555190086, -460.0750249028206, -667.3980378210545, -523.4177694916725, -468.9079792201519, -421.7310793995857, -461.05934605002403, -539.6603360176086, -530.7154633104801, -551.9786430597305, -494.33982315659523, -649.8486766815186, -595.3673300147057, -532.6926665604115, -628.8346049785614, -453.33930599689484, -506.9906822144985, -664.6612621247768, -446.97475707530975, -492.1829972565174, -610.9265094101429, -580.3111909329891, -423.72698879241943, -669.6231560409069, -485.0863162577152, -427.34454345703125, -431.7704360485077, -470.02370220422745, -477.57197710871696, -453.80927860736847, -672.4916887581348, -757.241872638464, -560.8680931925774, -480.1944788992405, -607.5931257903576, -501.81335934996605, -472.53079029917717, -534.6126534640789, -473.97025790810585, -534.7848799228668, -489.77705895900726, -409.50988391041756, -466.7663814127445, -602.5200762748718, -700.994495421648, -420.6570189297199, -393.79951933026314, -539.1616312563419, -482.18431344628334, -484.6652250289917, -523.0688663721085, -558.4815165102482, -449.71672281622887, -538.0780173838139, -458.29794150590897, -401.3526844084263, -510.930381834507, -453.13707035779953, -455.8333213031292, -463.1019931435585, -506.90386214852333, -486.5230445563793, -519.3031481802464, -604.6662712693214, -565.5207798779011, -536.4864408969879, -1379.7025429010391, -635.4237106442451, -596.0130449235439, -604.451442360878, -447.31202563643456, -480.67967307567596, -539.0815489292145, -540.5959287583828, -516.7431433796883, -586.1423656642437, -602.6864575743675, -556.5993519425392, -487.09107288718224, -499.93117663264275, -541.3408808112144, -637.7677718102932, -479.9733214378357, -550.128353446722, -583.6104860305786, -467.43416169285774, -1123.901121288538, -527.5872659981251, -465.29133439064026, -555.8674143254757, -432.6393069177866, -610.6281482577324, -496.4996962547302, -622.2874277830124, -562.3530519902706, -516.8182317316532, -482.3746292889118, -485.87996605038643, -544.251145362854, -588.1074624955654, -530.156511515379, -712.7339607179165, -503.595729380846, -488.062097877264, -516.460859566927, -665.2626133561134, -465.39060539007187, -515.2092328369617, -599.5359038114548, -577.8681141138077, -405.0605135858059, -582.6180527210236, -597.1525980830193, -540.0963975191116, -518.8410842418671, -571.9517008364201, -526.2295769155025, -442.4585520327091, -473.90135684609413, -754.4298666715622, -529.892294049263, -510.38126093149185, -502.49371603131294, -527.1406680643559, -536.2530063092709, -424.9269317686558, -419.9677015841007, -748.9760985672474, -410.91734436154366, -449.3206825554371, -500.70622619986534, -692.1625229716301, -584.5625167787075, -488.5640255510807, -536.408560693264, -430.1456180214882, -461.2673319578171, -585.653772443533, -552.3461525440216, -439.8657918572426, -552.195474177599, -466.46425807476044, -544.3007084131241, -479.1989926993847, -557.9945261180401, -586.6181555390358, -535.7765254676342, -591.5982732176781, -474.1538815796375, -550.9799667000771, -467.75852331519127, -466.5318616628647, -570.7601367533207, -627.0667093992233, -362.9908994436264, -535.1801562011242, -465.204192340374, -602.3257317245007, -503.88704147934914, -464.02667757868767, -474.6200323700905, -379.46784368157387, -483.0503202676773, -478.8640850484371, -609.4202504456043, -463.25333532691, -536.8771175742149, -525.1055459976196, -502.13385939598083, -596.7373663783073, -566.821437895298, -552.8725805878639, -537.907354414463, -428.184896081686, -500.30900597572327, -442.1443282067776, -483.51631090044975, -450.58060932159424, -649.082661151886, -481.7132942080498, -472.301592618227, -527.754193931818, -546.8497968316078, -639.1845259070396, -633.5245815217495, -463.5991670191288, -463.64743861556053, -404.8229839205742, -486.1946663558483, -490.8732570409775, -477.54933002591133, -568.5002571642399, -519.8087613880634, -435.91288381814957, -572.2275649905205, -448.453169465065, -549.4877896010876, -603.5888724625111, -538.8165199160576, -569.0379401743412, -634.2922384440899, -472.13039749860764, -485.2611456513405, -494.1562229394913, -571.0843431055546, -877.7157989144325, -529.2252189218998, -491.97934168577194, -1270.8118031024933, -508.58163529634476, -498.60630586743355, -491.57028499245644, -537.4618219435215, -641.8037188649178, -555.1630635857582, -504.46703267097473, -487.8799059987068, -461.3405593633652, -491.79165226221085, -595.6227933466434, -528.6689560711384, -573.2404119074345, -526.1397531330585, -605.1637641787529, -427.8337676823139, -583.6388493478298, -557.137403100729, -430.9538881778717, -664.3459576070309, -572.9872346520424, -420.09297865629196, -488.96969109773636, -624.6389755308628, -517.4146124720573, -464.1150299310684, -435.70933493971825, -542.085522711277, -560.7249583899975, -441.45377826690674, -497.74600633978844, -544.4257552027702, -402.3245816528797, -465.86197245121, -544.6956778466702, -545.1351957321167, -636.4823670089245, -567.9963968098164, -544.5744044482708, -510.5217527747154, -523.9375850260258, -435.4293229877949, -550.2488254010677, -777.3794516921043, -483.1606042087078, -550.6425130069256, -556.9369554817677, -476.3671438395977, -514.3724250495434, -497.156352519989, -557.0420424640179, -538.9916521012783, -524.4804953038692, -497.8037185072899, -482.88267409801483, -612.5383786857128, -499.8221634924412, -490.864688962698, -462.3773396015167, -458.1217960715294, -598.43718329072, -525.8069791793823, -464.8736768960953, -610.6234982311726, -703.1599338650703, -510.8133539259434, -543.6843672990799, -543.1985312402248, -577.2932739257812, -678.8876925706863, -621.2594210207462, -503.88999378681183, -435.10590213537216, -496.01114535331726, -477.5978960096836, -510.8016908764839, -488.4553522467613, -529.5832784771919, -495.9629856348038, -686.6738550961018, -406.8892520070076, -652.4300926029682, -479.0984460711479, -531.587311476469, -655.9738894999027, -691.4034169912338, -516.8287127315998, -621.2330985963345, -567.1061522960663, -494.6650849878788, -533.6965682208538, -618.9691109061241, -464.5905921757221, -646.2201323211193, -532.6481184959412, -627.5263220071793, -651.7917051017284, -471.84516820311546, -728.9232595860958, -562.4119353294373, -924.6051033735275, -565.2887505590916, -677.8680047094822, -418.7761303782463, -518.3484222888947, -468.8232429623604, -457.67902758717537, -580.4850477874279, -523.575714558363, -398.6824288368225, -620.8598645031452, -514.8728955388069, -492.30603766441345, -520.8861980736256, -487.77145847678185, -496.6559932231903, -429.604386895895, -581.4504696130753, -541.1391071081161, -490.4662709236145, -514.9623328149319, -494.2848693430424, -508.86425840854645, -421.0878751575947, -539.3991269767284, -1148.8007706403732, -542.8095861673355, -677.8963297605515, -518.6314649581909, -1155.6340126395226, -502.998487085104, -493.3769207894802, -997.8116690218449, -442.984374076128, -559.2608173191547, -434.09361043572426, -478.6556401848793, -706.5750879645348, -642.9412352740765, -637.6681348383427, -456.1221650838852, -443.8064205646515, -523.7934557795525, -530.4690179526806, -508.79763597249985, -1236.8528235256672, -6592.154518038034, -607.7019928991795, -492.443247795105, -454.7827329337597, -473.5149479210377, -548.673408895731, -533.2495396435261, -565.8423344194889, -476.7867906987667, -561.6521192789078, -603.5885680913925, -616.4959338307381, -4341.120439916849, -577.7313865125179, -464.1099872291088, -515.2605447173119, -442.85609167814255, -622.018098950386, -583.305223852396, -577.288941025734, -544.0309945940971, -1791.345355719328, -443.7783236503601, -473.1651689708233, -534.0946877896786, -542.2211596667767], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.381562754708432, "mean_inference_ms": 4.486835784126142, "mean_action_processing_ms": 4.1610584176299845, "mean_env_wait_ms": 3.041313792921073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4324320, "timesteps_this_iter": 131040, "agent_timesteps_total": 4324320, "timers": {"sample_time_ms": 46808.783, "sample_throughput": 2799.475, "load_time_ms": 21.683, "load_throughput": 6043476.976, "learn_time_ms": 15259.216, "learn_throughput": 8587.597, "update_time_ms": 2.535}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566128730773915e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 238.48488998666747, "policy_loss": -0.004224871868352998, "vf_loss": 47.700924193132735, "vf_explained_var": 0.08710594341746368, "kl": 0.001715119813940867, "entropy": -0.27953147247273435, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4324320, "num_agent_steps_sampled": 4324320, "num_steps_trained": 4324320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4324320}, "done": false, "episodes_total": 8800, "training_iteration": 33, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-44-58", "timestamp": 1691001898, "time_this_iter_s": 38.54379391670227, "time_total_s": 1371.152292728424, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1371.152292728424, "timesteps_since_restore": 4324320, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 44.69636363636364, "ram_util_percent": 69.98545454545452}}
{"evaluation": {"episode_reward_max": -521.4363169372082, "episode_reward_min": -521.4363169372082, "episode_reward_mean": -521.4363169372082, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-521.4363169372082], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -376.4199324250221, "episode_reward_min": -7521.817055761814, "episode_reward_mean": -573.2620034908875, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.8216582536697, -471.57495349645615, -505.54982191324234, -535.6005081534386, -521.1225054562092, -488.65652140975, -503.75980484485626, -479.8932265341282, -542.5151733160019, -512.4506270885468, -472.62647408246994, -743.5298090279102, -425.5296494960785, -558.5360860228539, -426.91321951150894, -454.20193603634834, -575.934158116579, -495.0553375482559, -490.8743804395199, -563.4090014696121, -484.36310493946075, -527.3369882106781, -526.7392193675041, -493.01292634010315, -679.1335636079311, -462.7180044054985, -619.1989598870277, -532.5086136758327, -468.9647452533245, -474.8672457039356, -541.8717650473118, -1364.3311271369457, -532.1690300107002, -533.6657298505306, -466.889699190855, -401.0148850083351, -604.1998324692249, -486.38174080848694, -537.9445399343967, -497.7675924003124, -616.9559382498264, -498.3813447058201, -2778.011764973402, -485.22377490997314, -601.4845733344555, -1595.919712305069, -552.7393561303616, -417.7127156853676, -444.12106490135193, -402.9942056238651, -566.1442646086216, -603.0376338362694, -538.6970431804657, -585.6594738960266, -440.64344623684883, -490.37345001101494, -551.6234941482544, -489.23905608057976, -517.5009812414646, -465.53491109609604, -513.8104020357132, -511.5737012922764, -461.7079146206379, -574.2098657786846, -489.51878249645233, -576.6224960684776, -539.2499658465385, -647.5528775453568, -507.1139215826988, -521.7254596352577, -539.6331568062305, -547.9039390683174, -449.44289752840996, -568.405018299818, -580.2314141988754, -443.1712123155594, -445.95226058363914, -535.2487301528454, -513.4937928020954, -533.4737732708454, -618.648409485817, -483.98950454592705, -484.5659227669239, -586.5228016674519, -484.670445561409, -562.5450750887394, -620.7731049060822, -604.699539899826, -498.81155413389206, -521.1898398697376, -467.0471421778202, -563.4524945020676, -523.8198970556259, -645.1581700444221, -657.9089910686016, -482.601370036602, -439.25822535157204, -526.6743923723698, -498.1594428420067, -414.755892008543, -437.48227259516716, -711.2974518835545, -421.3129504621029, -578.27022087574, -469.1926371753216, -488.82819613814354, -449.5609065890312, -485.13743925094604, -517.8772361576557, -475.7532821893692, -515.7727431356907, -523.182225883007, -708.1693681180477, -414.16090297698975, -710.703590720892, -601.7622084617615, -720.9885986745358, -644.9824318289757, -504.9422329068184, -468.68864065408707, -522.9240706861019, -473.00555923581123, -547.4019836187363, -544.5022509992123, -523.6118634045124, -1001.0020008683205, -523.9313490986824, -581.657932549715, -460.6457920074463, -629.5863032639027, -461.19218251109123, -459.1034659445286, -449.1848622262478, -448.0958676934242, -479.5938730239868, -441.5667457282543, -505.793215662241, -543.1451642215252, -449.0217108428478, -443.89618879556656, -570.3969322144985, -656.2579326033592, -449.0197024047375, -585.9287458360195, -598.4247032403946, -606.5366988480091, -725.2720936834812, -604.1039037108421, -609.8156733512878, -488.0395571887493, -489.46615302562714, -505.04088777303696, -517.6577651798725, -447.96914833784103, -471.03141713142395, -460.7608004808426, -467.02994042634964, -522.6567964851856, -545.911405980587, -475.52800688147545, -565.0653443038464, -691.1728695631027, -519.2187210917473, -445.913297444582, -497.91187930107117, -498.6511640250683, -560.731224745512, -380.5847008526325, -509.37751314044, -422.53739935159683, -430.10803812742233, -376.4199324250221, -652.5846339762211, -514.6978839337826, -614.5762938261032, -436.2953678369522, -569.1351926326752, -585.1651572585106, -433.49423709511757, -472.85228502750397, -474.2275956571102, -560.7365429401398, -521.2238827943802, -479.75580552220345, -494.44650223851204, -585.4254007637501, -481.4651947617531, -516.0923653841019, -543.9717535674572, -528.7678178548813, -737.263223618269, -447.4344377219677, -604.4102903008461, -500.6540307700634, -579.737701445818, -552.2681037187576, -504.5605629980564, -552.3231725990772, -1517.525899797678, -488.24674794077873, -573.3416527509689, -643.8677288591862, -582.9634403884411, -482.03132048249245, -493.7378989458084, -502.3002660870552, -490.3507315814495, -479.27662658691406, -540.3152670264244, -610.8445217013359, -620.7999289929867, -445.34442859888077, -484.2848726809025, -490.55920457839966, -576.8932288587093, -551.8983092308044, -486.75889897346497, -586.9090427458286, -592.2869520485401, -434.3440668582916, -586.2424319386482, -477.9948662221432, -461.34746021032333, -456.5277970135212, -464.338442504406, -457.57020807266235, -590.2925960719585, -439.2214502990246, -433.5745141506195, -468.37716326117516, -714.0657858848572, -503.48220881819725, -568.317949295044, -727.4953989088535, -575.1269662678242, -479.0437537431717, -550.9844642877579, -541.2598279416561, -491.0565093755722, -691.0849988758564, -500.2249280810356, -489.0295481085777, -464.87877237796783, -587.514717489481, -614.4864540994167, -476.5355681180954, -589.0293696820736, -519.7798691689968, -564.0618779659271, -561.1879689693451, -617.3758469223976, -479.9930020272732, -489.5058142244816, -456.963343501091, -617.5584169626236, -557.7101914584637, -574.4188129901886, -557.7184749245644, -504.573814868927, -500.31306833028793, -1637.9294849336147, -524.1474039554596, -445.0773406922817, -632.2948393523693, -580.7609347105026, -487.1282271742821, -550.9551339745522, -497.01740431785583, -676.6187865436077, -511.8327406048775, -489.55105102062225, -567.0580220520496, -535.0829921960831, -563.9617790579796, -657.4628301560879, -549.4727079570293, -564.1061167418957, -495.56696754693985, -584.5443298518658, -698.2885475754738, -520.8812159001827, -513.1442172825336, -450.0752258002758, -585.4585288167, -556.7929407954216, -634.2611034214497, -601.2292294800282, -515.3913562297821, -550.3108117878437, -480.565383374691, -480.9736760854721, -508.9907656311989, -466.82571414113045, -559.2608348429203, -465.83606803417206, -469.653136909008, -503.1922726035118, -578.0655427277088, -441.7108199298382, -397.5513427257538, -600.3829247057438, -488.51677814126015, -484.71681877970695, -454.7114338874817, -454.52278369665146, -584.6166366636753, -561.4377491474152, -407.53389370441437, -440.7758960723877, -483.3040463626385, -405.82546573877335, -408.46349850296974, -704.1130556762218, -388.42607882618904, -524.3641086220741, -648.7675078213215, -493.9124104678631, -502.0018262267113, -490.81334894895554, -476.7422588169575, -615.9019714593887, -535.0219411849976, -487.1563748717308, -735.4130895137787, -534.3280497193336, -1545.9278548955917, -481.24884420633316, -515.5533134639263, -385.70539036393166, -474.40865874290466, -514.5688274800777, -475.58891224861145, -525.8928345143795, -609.731865644455, -609.7361217141151, -549.682237803936, -517.6207793653011, -519.1378425359726, -498.6731852591038, -461.3852927982807, -489.30283629894257, -536.5880472958088, -557.8478744328022, -455.6840446591377, -456.388558357954, -444.6207532584667, -485.94992312788963, -494.6503132879734, -1570.245531797409, -462.8499399125576, -503.2056742012501, -669.940162986517, -513.0187962949276, -718.9014167487621, -513.3910336792469, -641.2300372719765, -568.1610750555992, -495.60609620809555, -451.44851988554, -617.1952741742134, -565.9362717568874, -504.0759451389313, -520.0846008062363, -539.1715448498726, -477.1334514915943, -560.6503476202488, -594.0682319700718, -470.60395646095276, -544.5344495773315, -786.3420923650265, -489.044509857893, -535.1868166923523, -480.1640716791153, -497.8604551553726, -672.0096080899239, -509.6534499824047, -511.14029613137245, -444.2147526741028, -518.4507639110088, -510.80270770192146, -496.102819532156, -697.4788795113564, -425.5061582326889, -552.6913322210312, -530.5508114993572, -514.0538972914219, -708.984510987997, -419.32450875639915, -488.2397574186325, -500.98783123493195, -500.4182296693325, -558.067644149065, -628.9019093215466, -464.81641963124275, -615.3658772706985, -445.08029237389565, -509.4278861284256, -421.18907061219215, -464.50253015756607, -513.225980848074, -578.3464905619621, -7263.120200663805, -446.1349463760853, -431.1486234366894, -417.19004157185555, -484.9433827698231, -555.5531418919563, -594.2974913716316, -571.7743319869041, -453.72818118333817, -427.30474281311035, -463.95609444379807, -583.0341356992722, -454.82081723213196, -492.20131516456604, -495.7389617264271, -391.34708347916603, -399.8620557487011, -504.78818199038506, -537.6303686201572, -592.2550245523453, -556.5011059343815, -559.7656107544899, -450.5623820722103, -472.91771841049194, -434.77300783991814, -477.7933941781521, -534.7777866721153, -441.6012179553509, -584.167747169733, -647.1305280029774, -502.39214247465134, -635.2838724851608, -556.109834253788, -573.2136346101761, -624.4616703391075, -458.76397985219955, -548.9841347634792, -685.0780243873596, -603.476249396801, -631.6347434818745, -7521.817055761814, -433.8409750163555, -579.3860693573952, -545.3878163993359, -503.6236480772495, -575.5177394747734, -530.43470749259, -516.654582709074, -629.7538286745548, -470.10274478793144, -444.88154804706573, -673.6081024110317, -535.9002056419849, -507.94751262664795, -432.9461250603199, -464.4397097826004, -448.23977395892143, -447.59381729364395, -486.8655855059624, -586.4685623645782, -532.1596874892712, -462.2954013943672, -502.199775069952, -531.7615879774094, -524.2547053694725, -391.9642929136753, -535.7412356138229, -389.58191522955894, -544.1666822731495, -643.2669152915478, -584.2724704146385, -498.48570412397385, -622.215918213129, -511.9221544265747, -667.1733455955982, -421.50998279452324, -635.8125702738762, -717.8556506931782, -517.1112949550152], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.374479234744623, "mean_inference_ms": 4.482623041627876, "mean_action_processing_ms": 4.159118253071841, "mean_env_wait_ms": 3.039922984737497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4455360, "timesteps_this_iter": 131040, "agent_timesteps_total": 4455360, "timers": {"sample_time_ms": 46689.949, "sample_throughput": 2806.6, "load_time_ms": 21.304, "load_throughput": 6150892.339, "learn_time_ms": 15207.391, "learn_throughput": 8616.863, "update_time_ms": 2.555}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064365386958e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 240.50110127153508, "policy_loss": 0.0006908798703634506, "vf_loss": 48.09924498253826, "vf_explained_var": 0.10078182581505041, "kl": 0.0020152592242019015, "entropy": -0.28500243054709556, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4455360, "num_agent_steps_sampled": 4455360, "num_steps_trained": 4455360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4455360}, "done": false, "episodes_total": 9280, "training_iteration": 34, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-45-37", "timestamp": 1691001937, "time_this_iter_s": 38.83218789100647, "time_total_s": 1409.9844806194305, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1409.9844806194305, "timesteps_since_restore": 4455360, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 43.87818181818182, "ram_util_percent": 70.16909090909093}}
{"evaluation": {"episode_reward_max": -636.6892384588718, "episode_reward_min": -636.6892384588718, "episode_reward_mean": -636.6892384588718, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-636.6892384588718], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -389.58191522955894, "episode_reward_min": -7521.817055761814, "episode_reward_mean": -661.4264214572311, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-496.102819532156, -697.4788795113564, -425.5061582326889, -552.6913322210312, -530.5508114993572, -514.0538972914219, -708.984510987997, -419.32450875639915, -488.2397574186325, -500.98783123493195, -500.4182296693325, -558.067644149065, -628.9019093215466, -464.81641963124275, -615.3658772706985, -445.08029237389565, -509.4278861284256, -421.18907061219215, -464.50253015756607, -513.225980848074, -578.3464905619621, -7263.120200663805, -446.1349463760853, -431.1486234366894, -417.19004157185555, -484.9433827698231, -555.5531418919563, -594.2974913716316, -571.7743319869041, -453.72818118333817, -427.30474281311035, -463.95609444379807, -583.0341356992722, -454.82081723213196, -492.20131516456604, -495.7389617264271, -391.34708347916603, -399.8620557487011, -504.78818199038506, -537.6303686201572, -592.2550245523453, -556.5011059343815, -559.7656107544899, -450.5623820722103, -472.91771841049194, -434.77300783991814, -477.7933941781521, -534.7777866721153, -441.6012179553509, -584.167747169733, -647.1305280029774, -502.39214247465134, -635.2838724851608, -556.109834253788, -573.2136346101761, -624.4616703391075, -458.76397985219955, -548.9841347634792, -685.0780243873596, -603.476249396801, -631.6347434818745, -7521.817055761814, -433.8409750163555, -579.3860693573952, -545.3878163993359, -503.6236480772495, -575.5177394747734, -530.43470749259, -516.654582709074, -629.7538286745548, -470.10274478793144, -444.88154804706573, -673.6081024110317, -535.9002056419849, -507.94751262664795, -432.9461250603199, -464.4397097826004, -448.23977395892143, -447.59381729364395, -486.8655855059624, -586.4685623645782, -532.1596874892712, -462.2954013943672, -502.199775069952, -531.7615879774094, -524.2547053694725, -391.9642929136753, -535.7412356138229, -389.58191522955894, -544.1666822731495, -643.2669152915478, -584.2724704146385, -498.48570412397385, -622.215918213129, -511.9221544265747, -667.1733455955982, -421.50998279452324, -635.8125702738762, -717.8556506931782, -517.1112949550152], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.447382651557267, "mean_inference_ms": 4.496759267500283, "mean_action_processing_ms": 4.261578646364752, "mean_env_wait_ms": 3.0352863758328574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4586400, "timesteps_this_iter": 131040, "agent_timesteps_total": 4586400, "timers": {"sample_time_ms": 44194.721, "sample_throughput": 2965.06, "load_time_ms": 20.245, "load_throughput": 6472852.962, "learn_time_ms": 15168.183, "learn_throughput": 8639.136, "update_time_ms": 2.583}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532182693479e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 239.95178161626674, "policy_loss": 0.0021275955261018976, "vf_loss": 47.987935623387706, "vf_explained_var": 0.08649269387286196, "kl": 0.0018462453861170078, "entropy": -0.29404905844332924, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4586400, "num_agent_steps_sampled": 4586400, "num_steps_trained": 4586400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4586400}, "done": false, "episodes_total": 9280, "training_iteration": 35, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-45-52", "timestamp": 1691001952, "time_this_iter_s": 15.094018697738647, "time_total_s": 1425.0784993171692, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1425.0784993171692, "timesteps_since_restore": 4586400, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 14.372727272727273, "ram_util_percent": 70.35454545454547}}
{"evaluation": {"episode_reward_max": -580.0281308591366, "episode_reward_min": -580.0281308591366, "episode_reward_mean": -580.0281308591366, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-580.0281308591366], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.36869875780646, "mean_inference_ms": 5.658695305781863, "mean_action_processing_ms": 1.2837619200043533, "mean_env_wait_ms": 233.77037238979386, "mean_env_render_ms": 3.0568584926363114}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -356.39066031575203, "episode_reward_min": -4001.03612986207, "episode_reward_mean": -528.1586878682486, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-539.1003013551235, -380.8097399175167, -516.4624003171921, -1110.2337591052055, -584.2463606595993, -661.4050673544407, -468.5455612838268, -513.9423306584358, -502.28391057252884, -496.75968608260155, -475.4442732334137, -433.0514675974846, -594.9948828816414, -837.799939841032, -581.6162358224392, -426.786979585886, -482.3837864100933, -447.9050796031952, -588.3216861784458, -551.3153109848499, -456.6983861029148, -391.2576713860035, -510.00434747338295, -1413.1441342532635, -580.7580685317516, -437.37784710526466, -590.0651347637177, -485.71998620033264, -528.9089076519012, -430.32590839266777, -501.5577403604984, -541.8558479249477, -547.4806664586067, -424.69549626111984, -465.6055345237255, -462.7852891087532, -427.10453256964684, -497.9573333263397, -468.1271787881851, -480.9613393843174, -437.01927024126053, -540.0362378954887, -448.2081510126591, -415.67151191830635, -427.4108659029007, -605.0748237073421, -503.6027601957321, -614.0662478506565, -598.8438163995743, -438.6845330297947, -562.7685622870922, -458.39931294322014, -713.1452855467796, -758.8483397364616, -488.559877038002, -436.8273669183254, -483.48676776885986, -480.01316741108894, -454.42065730690956, -398.0104634463787, -504.4405642747879, -518.0731489956379, -478.8864021897316, -631.014903485775, -504.18557688593864, -497.7596566081047, -508.62420240044594, -546.080534696579, -610.2692872285843, -430.448562592268, -524.9969201385975, -411.4882915318012, -442.2616802453995, -470.4761121869087, -370.54639133810997, -414.0400269329548, -482.06749281287193, -535.5488814711571, -556.1805241405964, -468.27447417378426, -395.7050304412842, -553.3975042104721, -507.0942003428936, -487.5387192964554, -497.6645130813122, -568.7849233150482, -399.0853001475334, -466.9334447979927, -497.674643188715, -554.912928044796, -542.1827096045017, -550.8966994583607, -553.8379453718662, -457.899506598711, -477.84418746829033, -470.8555243611336, -437.058209836483, -565.3298529982567, -472.15758898854256, -440.38381642103195, -545.1995921432972, -509.66239592432976, -528.5102617144585, -526.4325883388519, -395.60568314790726, -499.9505838751793, -496.8598120510578, -449.72630590200424, -491.65915834903717, -422.85235047340393, -489.5296908915043, -622.9164609313011, -514.6387667059898, -403.18246975541115, -422.0214836001396, -4001.03612986207, -436.66558054089546, -498.52089819312096, -471.74595361948013, -577.9111957848072, -462.3293699622154, -715.8728669285774, -562.6607508659363, -529.2324733436108, -744.6438996195793, -578.7153431475163, -482.58927899599075, -562.7113921940327, -488.36923161149025, -417.37659883499146, -480.3841414451599, -479.99436047673225, -465.27541199326515, -1707.8490211069584, -549.7915224730968, -578.0992888510227, -468.9021337032318, -472.7312570512295, -423.63007059693336, -444.1611513197422, -541.7831011712551, -464.0926214456558, -469.4985283315182, -468.9577777981758, -740.057269692421, -438.38874569535255, -543.0515993535519, -502.9639813005924, -487.4055298268795, -447.2075001299381, -493.22414591908455, -644.6862426996231, -494.257708966732, -588.4641951620579, -506.651950776577, -708.0021366178989, -503.8126201033592, -465.5537615418434, -471.05015644431114, -479.3030388355255, -501.24496856331825, -389.9357875585556, -580.9151520133018, -580.3622537851334, -483.9005994796753, -435.4023731648922, -481.3060121834278, -367.1245462298393, -477.5151048004627, -687.4759186208248, -468.467551022768, -457.9006133079529, -728.8814615607262, -492.6050160229206, -658.2596741616726, -537.6724755167961, -700.5518913567066, -459.70976489782333, -510.47500213980675, -497.59351921081543, -584.2227626144886, -527.3791281282902, -1562.6684875786304, -463.71134462952614, -495.24598771333694, -575.7407954633236, -464.9067410826683, -493.34633725881577, -412.1890090703964, -481.7414649426937, -356.39066031575203, -512.6625909209251, -486.71306067705154, -409.04379481077194, -604.7240652441978, -431.47380617260933, -628.3082013428211, -502.4534155726433, -460.8896702826023, -413.84717509150505, -619.8641538619995, -365.16405150294304, -512.976930052042, -431.0449680685997, -586.7858298420906, -485.80275386571884, -436.4010977447033, -531.8458638489246, -402.17736595869064, -399.9231902062893, -528.0751213729382, -470.9551263451576, -529.9486294388771, -478.61544477939606, -597.303788214922, -497.451426923275, -525.2611100375652, -563.538441836834, -603.2727054655552, -1248.1724887490273, -491.6317167580128, -459.5603888332844, -1350.7774350941181, -539.5167581737041, -544.2624396979809, -452.68771556019783, -467.6140409708023, -422.77062767744064, -444.78709441423416, -433.31544455885887, -1045.8425522744656, -489.98248490691185, -441.5329787135124, -521.8836185932159, -531.7681249380112, -579.0192987024784, -434.4022732973099, -472.7727941572666, -440.0120419859886, -530.8796105086803, -434.143252402544, -585.7017718553543, -477.05790957808495, -398.5197974741459, -517.4181673526764, -426.8902627825737, -452.5915838778019, -453.4613721072674, -431.1987021267414, -562.9474261105061, -423.9192522764206, -390.8251233994961, -542.6582327783108, -492.58634197711945, -415.08008286356926, -439.76416286826134, -547.3480388522148, -562.7143329381943, -484.64023354649544, -586.0298978984356, -525.4977049231529, -458.688718020916, -488.43270444869995, -435.17304733395576, -468.05330777168274, -513.9185397922993, -575.9413133561611, -486.42790535092354, -517.8737079501152, -567.6779204905033, -433.3437471985817, -459.43700417876244, -472.92251494526863, -616.5618178546429, -487.9709347486496, -441.12131291627884, -384.3431952893734, -402.25969725847244, -452.4537852704525, -531.2864121496677, -519.8280552327633, -594.5422351062298, -531.42666426301, -660.4506978392601, -519.3484708964825, -408.8203068971634, -459.6334915757179, -523.3110074102879, -566.7120152711868, -611.7667486071587, -471.7570329606533, -581.4282686114311, -396.865272551775, -982.5684219300747, -467.0189396440983, -631.0078897178173, -558.5080599188805, -479.9329567849636, -472.04468566179276, -477.15463241934776, -533.9089515805244, -416.76877558231354, -512.15233284235, -512.6493144333363, -509.2154839038849, -640.0161417126656, -495.2469672560692, -574.8775763213634, -472.5095836818218, -617.6109073162079, -566.086708933115, -451.84084606170654, -536.623383462429, -499.97593998908997, -791.7293680310249, -492.80196237564087, -510.74965116381645, -540.9972110390663, -499.2105701267719, -562.4613442122936, -429.1070354282856, -417.6422528028488, -428.85914397239685, -460.1129108071327, -410.38672682642937, -496.35677593946457, -597.5874896943569, -509.36967438459396, -434.4634526669979, -426.0190810263157, -613.3697588145733, -551.6865687966347, -415.0294349491596, -539.5496245324612, -548.4427417218685, -564.8479447364807, -479.3296425938606, -459.75864589214325, -588.2085062265396, -501.53858411312103, -389.72715932130814, -417.56713432073593, -556.549970805645, -407.764338940382, -477.0925119817257, -514.0387471914291, -507.7447159290314, -409.3242458701134, -484.88771933317184, -487.20004138350487, -622.2418262660503, -379.1716560125351, -438.9010780751705, -484.25657737255096, -423.4096646308899, -473.456536591053, -397.608387619257, -479.56240752339363, -480.4270552098751, -482.1987624466419, -496.4636951982975, -519.8827054053545, -546.8953354656696, -477.2867483496666, -503.1685543358326, -438.5184999406338, -487.6115252673626, -470.9111856520176, -446.1839288175106, -558.8044680058956, -523.198312163353, -522.0618933141232, -422.38589242100716, -377.6988408565521, -549.6397959589958, -506.7092391848564, -618.2940195500851, -560.2191310822964, -454.15341567993164, -486.0551464855671, -471.46002382040024, -1864.689536690712, -403.11046105623245, -566.3197009861469, -1167.0875570178032, -493.4907858967781, -415.7475003898144, -500.2082102894783, -510.15195339918137, -498.2370509803295, -550.1802176237106, -485.8199183046818, -488.044061422348, -427.1801030933857, -581.2657316029072, -399.6751680076122, -546.96905118227, -568.8222417235374, -402.4843866825104, -479.41163632273674, -425.5930191874504, -529.7503520548344, -542.539155036211, -422.6339523792267, -360.06998667120934, -500.49392637610435, -534.7045741975307, -579.6799710690975, -431.7643927335739, -515.2344713509083, -478.02789464592934, -492.05458188056946, -566.9918754398823, -568.865729957819, -409.23976105451584, -436.75390380620956, -451.1526018679142, -744.6259161829948, -419.4990113377571, -505.7734382748604, -406.57157334685326, -522.4532373547554, -565.4640058875084, -423.75239220261574, -516.7035496532917, -432.8537018597126, -555.1856152713299, -547.390465170145, -616.452203720808, -448.0552962422371, -582.2864363491535, -520.6744740307331, -592.7424509227276, -499.2595394849777, -466.220149487257, -488.75698456168175, -518.8833585977554, -421.0099142193794, -591.9320731461048, -431.00866082310677, -409.78797951340675, -597.3369088470936, -465.40922155976295, -458.62915936112404, -526.7493693232536, -471.9804331958294, -417.2856976389885, -458.1213592886925, -419.79542818665504, -423.0102810561657, -567.6333869099617, -561.5424098372459, -607.5474275052547, -472.145174741745, -412.7492443919182, -468.5574679374695, -628.4165293872356, -548.8125055730343, -489.83060279488564, -428.8142066895962, -449.6997619867325, -486.7320716381073, -601.2207972407341, -491.39042723178864, -1062.9640963971615, -425.0234601199627, -433.0981548130512, -469.90244591236115, -424.0073924958706, -840.4390244781971, -471.28768014907837, -798.3731926381588, -531.9803626537323, -438.4656307697296, -654.4429810643196, -509.7726060152054, -555.5797763764858, -469.70329663157463, -470.7375594675541, -511.6391336321831], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.368593795938052, "mean_inference_ms": 4.479635719710767, "mean_action_processing_ms": 4.158090692858171, "mean_env_wait_ms": 3.0371406522239917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4717440, "timesteps_this_iter": 131040, "agent_timesteps_total": 4717440, "timers": {"sample_time_ms": 46478.25, "sample_throughput": 2819.383, "load_time_ms": 21.319, "load_throughput": 6146696.238, "learn_time_ms": 15138.748, "learn_throughput": 8655.934, "update_time_ms": 2.565}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207660913467394e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 237.18834123338686, "policy_loss": 0.002091096046498669, "vf_loss": 47.43528658002081, "vf_explained_var": 0.08276820652801076, "kl": 0.0017217399469169113, "entropy": -0.29126653758855703, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4717440, "num_agent_steps_sampled": 4717440, "num_steps_trained": 4717440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4717440}, "done": false, "episodes_total": 9760, "training_iteration": 36, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-46-31", "timestamp": 1691001991, "time_this_iter_s": 38.40517258644104, "time_total_s": 1463.4836719036102, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1463.4836719036102, "timesteps_since_restore": 4717440, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 44.058181818181815, "ram_util_percent": 70.18000000000002}}
{"evaluation": {"episode_reward_max": -535.5229087471962, "episode_reward_min": -535.5229087471962, "episode_reward_mean": -535.5229087471962, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.5229087471962], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314905354996673, "mean_inference_ms": 5.278058073035434, "mean_action_processing_ms": 1.275251503707599, "mean_env_wait_ms": 225.66611430302757, "mean_env_render_ms": 3.030390035910685}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -360.06998667120934, "episode_reward_min": -1864.689536690712, "episode_reward_mean": -528.1407453978062, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-471.46002382040024, -1864.689536690712, -403.11046105623245, -566.3197009861469, -1167.0875570178032, -493.4907858967781, -415.7475003898144, -500.2082102894783, -510.15195339918137, -498.2370509803295, -550.1802176237106, -485.8199183046818, -488.044061422348, -427.1801030933857, -581.2657316029072, -399.6751680076122, -546.96905118227, -568.8222417235374, -402.4843866825104, -479.41163632273674, -425.5930191874504, -529.7503520548344, -542.539155036211, -422.6339523792267, -360.06998667120934, -500.49392637610435, -534.7045741975307, -579.6799710690975, -431.7643927335739, -515.2344713509083, -478.02789464592934, -492.05458188056946, -566.9918754398823, -568.865729957819, -409.23976105451584, -436.75390380620956, -451.1526018679142, -744.6259161829948, -419.4990113377571, -505.7734382748604, -406.57157334685326, -522.4532373547554, -565.4640058875084, -423.75239220261574, -516.7035496532917, -432.8537018597126, -555.1856152713299, -547.390465170145, -616.452203720808, -448.0552962422371, -582.2864363491535, -520.6744740307331, -592.7424509227276, -499.2595394849777, -466.220149487257, -488.75698456168175, -518.8833585977554, -421.0099142193794, -591.9320731461048, -431.00866082310677, -409.78797951340675, -597.3369088470936, -465.40922155976295, -458.62915936112404, -526.7493693232536, -471.9804331958294, -417.2856976389885, -458.1213592886925, -419.79542818665504, -423.0102810561657, -567.6333869099617, -561.5424098372459, -607.5474275052547, -472.145174741745, -412.7492443919182, -468.5574679374695, -628.4165293872356, -548.8125055730343, -489.83060279488564, -428.8142066895962, -449.6997619867325, -486.7320716381073, -601.2207972407341, -491.39042723178864, -1062.9640963971615, -425.0234601199627, -433.0981548130512, -469.90244591236115, -424.0073924958706, -840.4390244781971, -471.28768014907837, -798.3731926381588, -531.9803626537323, -438.4656307697296, -654.4429810643196, -509.7726060152054, -555.5797763764858, -469.70329663157463, -470.7375594675541, -511.6391336321831], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.442022697380613, "mean_inference_ms": 4.4931931237887195, "mean_action_processing_ms": 4.260012320400507, "mean_env_wait_ms": 3.0319678365870377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4848480, "timesteps_this_iter": 131040, "agent_timesteps_total": 4848480, "timers": {"sample_time_ms": 44091.977, "sample_throughput": 2971.969, "load_time_ms": 19.79, "load_throughput": 6621436.373, "learn_time_ms": 15210.994, "learn_throughput": 8614.822, "update_time_ms": 2.623}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830456733697e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 234.67094162799486, "policy_loss": 0.0007613996797377075, "vf_loss": 46.9331239201262, "vf_explained_var": 0.122491588195165, "kl": 0.0017916281380245002, "entropy": -0.3037799349501996, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4848480, "num_agent_steps_sampled": 4848480, "num_steps_trained": 4848480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4848480}, "done": false, "episodes_total": 9760, "training_iteration": 37, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-48-13", "timestamp": 1691002093, "time_this_iter_s": 102.64620780944824, "time_total_s": 1566.1298797130585, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1566.1298797130585, "timesteps_since_restore": 4848480, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.21917808219178, "ram_util_percent": 90.23287671232876}}
{"evaluation": {"episode_reward_max": -418.74848434329033, "episode_reward_min": -418.74848434329033, "episode_reward_mean": -418.74848434329033, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-418.74848434329033], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314905354996673, "mean_inference_ms": 5.278058073035434, "mean_action_processing_ms": 1.275251503707599, "mean_env_wait_ms": 225.66611430302757, "mean_env_render_ms": 3.030390035910685}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -351.15685617923737, "episode_reward_min": -4096.70945584774, "episode_reward_mean": -506.07583901487914, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-355.3338075578213, -582.9127895832062, -708.1120370328426, -457.87830129265785, -394.44164976477623, -484.573281288147, -426.420691549778, -443.42203667759895, -573.8377996385098, -525.955806106329, -449.82424131035805, -453.0978564918041, -416.694642752409, -421.3070230782032, -432.49320724606514, -437.27999928593636, -469.1200394630432, -505.3500000834465, -432.26927331089973, -464.1467797458172, -413.64485386013985, -426.44398841261864, -453.3375118970871, -444.42124781012535, -563.1945156157017, -509.53104117512703, -420.35411205887794, -523.869520097971, -575.7704688310623, -580.1255647242069, -992.1174195408821, -403.2511183619499, -447.60126477479935, -503.2045429944992, -642.9768867492676, -529.495752364397, -448.4506114423275, -378.8533926308155, -511.9992210865021, -548.5050321817398, -353.3775213956833, -478.36809679865837, -716.0850936770439, -458.29898822307587, -607.1766872704029, -431.04497784376144, -412.99073135852814, -383.8477692604065, -508.45125326514244, -478.2732996940613, -455.4409953057766, -551.9655717015266, -447.2083541750908, -410.5915659070015, -407.13021832704544, -591.3792203366756, -524.8444894850254, -532.4335331320763, -431.8747664988041, -501.42178043723106, -574.5185644328594, -420.96435084939003, -623.8196646869183, -462.0176248848438, -562.2062209546566, -518.6507892012596, -543.199390411377, -508.8508774340153, -679.3300079405308, -538.0734241604805, -428.639950633049, -529.0211318433285, -477.4695224761963, -496.33485370874405, -455.2799526453018, -401.22183352708817, -452.29897743463516, -409.4572907090187, -489.2418273985386, -438.43236142396927, -433.3059405684471, -462.9066008925438, -468.21527475118637, -635.109222471714, -546.3447530865669, -463.3827837407589, -517.4240924715996, -506.7374278008938, -440.82916310429573, -458.6455928385258, -409.5781052708626, -424.77874305844307, -404.10581117868423, -488.1527501642704, -429.7888653576374, -936.4119078814983, -480.59377205371857, -483.0815740227699, -577.3456989228725, -458.84522038698196, -438.4728530347347, -505.1423998475075, -484.6238408982754, -500.5254050195217, -619.3950212597847, -427.80371856689453, -956.7981509566307, -448.4434126317501, -761.465628951788, -423.0645409822464, -587.846611559391, -385.33655872941017, -430.97460359334946, -519.8731277287006, -564.4709548950195, -642.9633087515831, -501.1665950715542, -399.9731401205063, -452.35035413503647, -426.3322584629059, -497.2600349187851, -417.8510381579399, -579.2694056034088, -396.5628389120102, -484.92337906360626, -453.53230971097946, -440.2084372639656, -449.7147714495659, -583.0086778402328, -493.5320915877819, -425.5431904196739, -411.31210446357727, -511.4281922876835, -529.9046031832695, -592.0278374552727, -535.4905525445938, -451.6869038939476, -475.0539892911911, -435.2670009434223, -425.65836745500565, -432.7201565504074, -407.4121105372906, -744.5930902659893, -409.03913685679436, -503.03497913479805, -451.2067432105541, -400.1442292332649, -507.73117032647133, -469.9216235280037, -594.3434643447399, -405.45377123355865, -447.9317920804024, -485.16389152407646, -512.0910666882992, -453.81307342648506, -374.95591270923615, -407.9384967684746, -446.5056221783161, -481.78490710258484, -493.52243706583977, -496.733221411705, -463.81625550985336, -391.5151119530201, -590.7165385782719, -446.6663298010826, -422.88856422901154, -483.64891880750656, -492.7368264198303, -406.58991158008575, -409.2870360016823, -1323.9064462184906, -409.8689115345478, -479.3349976837635, -451.28233712911606, -567.1440250277519, -554.641258507967, -465.2344816029072, -1159.7883657813072, -386.2249022722244, -492.45442938804626, -459.0048872232437, -461.87819799780846, -443.67332822084427, -601.4542002677917, -596.916433185339, -421.2152521908283, -2292.872688829899, -456.8814479112625, -514.8693706989288, -524.9834860861301, -447.48071134090424, -498.5150579214096, -479.9200657904148, -472.0661815404892, -427.54072830080986, -456.4647280871868, -508.62421932816505, -518.2536298036575, -451.20922008156776, -430.3483445942402, -373.37510591745377, -571.9533593952656, -440.0011101961136, -374.59966558218, -431.8106717467308, -543.4014168381691, -399.7037681043148, -487.72991251945496, -383.67830061912537, -399.9258217513561, -481.78191140294075, -403.48258981108665, -632.2434222102165, -427.62143352627754, -385.00417816638947, -375.1931647658348, -729.7993023693562, -407.95686691999435, -467.9176685512066, -548.2566556334496, -512.7548305988312, -442.7755933701992, -628.3104729652405, -436.95288103818893, -404.26187241077423, -500.6331640481949, -420.0109985470772, -433.37091824412346, -454.7780581712723, -435.89681988954544, -464.1792278289795, -392.72208574414253, -489.3534147143364, -533.7091494500637, -506.2267500758171, -501.20527681708336, -392.5270994603634, -407.5528793632984, -376.8766066431999, -412.12915578484535, -514.133393496275, -501.45606204867363, -433.4598453938961, -475.52587869763374, -406.19234335422516, -546.8380289375782, -465.02466082572937, -449.24707132577896, -900.5264274477959, -427.95876345038414, -456.2903970479965, -455.93841284513474, -429.5234976410866, -374.3679618835449, -440.4811162650585, -502.4664462208748, -564.3584220707417, -586.0352670252323, -422.2752024233341, -444.6233550608158, -410.05485075712204, -423.1915682554245, -406.4790198504925, -425.0642643272877, -425.45583748817444, -373.5393290221691, -452.4008746147156, -547.9670432209969, -506.8126803934574, -456.5133807361126, -369.05214697122574, -501.2483357787132, -557.9382020235062, -499.10762348771095, -398.2737345099449, -426.0655789077282, -452.09520840644836, -497.3383244276047, -452.695208504796, -558.4618108868599, -548.3727211654186, -512.0912883579731, -521.3541513681412, -451.937848508358, -479.20686280727386, -393.4406224191189, -451.65406930446625, -471.6537485718727, -421.302143484354, -503.2305780351162, -482.301476418972, -384.08576130867004, -576.6995584666729, -4096.70945584774, -392.68002420663834, -438.49519741535187, -425.5171232223511, -468.447212934494, -431.0224475264549, -544.3744355738163, -513.8306351900101, -506.3381866514683, -483.75672030448914, -432.4358862936497, -418.64172291755676, -381.83938881754875, -608.0953457653522, -674.2449994683266, -824.8790638148785, -547.5509690642357, -469.3862408399582, -436.08040872216225, -472.4452468752861, -433.19562315940857, -507.48066142201424, -428.5435137748718, -531.8626558184624, -616.6101528704166, -542.8501588106155, -491.9775940775871, -400.8180277943611, -472.69162023067474, -527.4834756553173, -417.42528039216995, -451.50349763035774, -504.0135282278061, -520.4089904427528, -481.3291062116623, -706.6169904470444, -568.141082316637, -500.1578445136547, -471.40215024352074, -551.4881934821606, -351.15685617923737, -422.4559391438961, -433.8206729590893, -428.31462571024895, -418.99627217650414, -567.1191402375698, -451.72382310032845, -397.0569859445095, -456.1690053343773, -470.5394735634327, -533.6303890347481, -557.186963737011, -558.4946475625038, -460.8640213906765, -531.4218424856663, -498.05624186992645, -412.39144825935364, -464.86972960829735, -493.2605455815792, -501.1145154237747, -442.8124181628227, -549.7010114192963, -527.7469301819801, -463.8667729496956, -494.30359774827957, -505.38957491517067, -583.6213025450706, -453.8053894340992, -441.29301404953003, -479.2147938609123, -486.72702518105507, -436.35240718722343, -388.2200030386448, -523.4913221895695, -441.7680473923683, -394.82095941901207, -492.51050266623497, -579.8330971598625, -445.3998618423939, -464.29272881150246, -464.83921894431114, -536.1185620725155, -395.4365300834179, -593.1245691180229, -440.54099842906, -443.41867461800575, -545.604783654213, -394.1174276769161, -518.2790240347385, -586.0200502276421, -777.1321298480034, -387.73353284597397, -387.3073059916496, -460.9534885287285, -432.2299563884735, -551.1186176240444, -398.36395731568336, -434.56228655576706, -607.5394294261932, -404.18810242414474, -483.4817298948765, -425.505030721426, -460.94922840595245, -416.9642699956894, -359.56389236450195, -507.8751296699047, -392.0332654416561, -491.7583127319813, -374.7457363307476, -535.1181253194809, -416.9573832154274, -473.0160982608795, -429.73059806227684, -608.623516857624, -1757.4473256468773, -471.4465388059616, -486.6081539988518, -437.43691927194595, -1613.0323698818684, -464.87686359882355, -406.4037162065506, -476.5761072933674, -445.5806597173214, -549.3978712260723, -438.3075365424156, -514.1489323675632, -430.4699890613556, -684.0372847914696, -459.3525533378124, -488.8939271271229, -513.6800560057163, -469.56432458758354, -499.4920908510685, -504.4748084247112, -481.1031086742878, -453.3142019212246, -438.7891952395439, -426.67366018891335, -419.5193467140198, -436.62757354974747, -392.1091236770153, -506.735920637846, -524.3715023398399, -556.2292906343937, -472.7949142754078, -425.32131963968277, -554.061334580183, -424.26207718253136, -500.82068449258804, -655.543958991766, -438.4808572232723, -948.9894171655178, -443.48701426386833, -542.8117414712906, -790.7868230640888, -516.2746528089046, -451.5991219878197, -497.9598488807678, -859.7359354197979, -767.0715727508068, -405.6878659129143, -427.91582557559013, -609.2556995153427, -461.5228754580021, -555.7120005786419, -433.9324139356613, -521.7858387827873, -504.3687835931778, -438.6450842618942, -472.7301876246929, -511.96252754330635, -392.33369740843773, -439.33072808384895, -505.39858815073967, -446.8656224012375, -466.7420699894428, -522.77635627985, -468.26179894804955, -557.8632986843586, -469.610432356596, -587.5282619893551, -444.74109652638435, -557.1783411502838, -530.8405774533749, -535.603219807148, -495.1544399559498, -416.29206371307373], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.365001192058062, "mean_inference_ms": 4.476499527723498, "mean_action_processing_ms": 4.156790857991177, "mean_env_wait_ms": 3.0365819448432303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4979520, "timesteps_this_iter": 131040, "agent_timesteps_total": 4979520, "timers": {"sample_time_ms": 55124.879, "sample_throughput": 2377.148, "load_time_ms": 21.041, "load_throughput": 6227858.557, "learn_time_ms": 15091.708, "learn_throughput": 8682.914, "update_time_ms": 2.509}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915228366849e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 232.92644361705558, "policy_loss": 0.002493902335881708, "vf_loss": 46.58248945803625, "vf_explained_var": 0.06906612500494953, "kl": 0.001668226605067564, "entropy": -0.3060931332115631, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4979520, "num_agent_steps_sampled": 4979520, "num_steps_trained": 4979520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4979520}, "done": false, "episodes_total": 10240, "training_iteration": 38, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-48-52", "timestamp": 1691002132, "time_this_iter_s": 38.390724658966064, "time_total_s": 1604.5206043720245, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1604.5206043720245, "timesteps_since_restore": 4979520, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 44.850909090909084, "ram_util_percent": 68.75999999999999}}
{"evaluation": {"episode_reward_max": -346.8512113392353, "episode_reward_min": -346.8512113392353, "episode_reward_mean": -346.8512113392353, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346.8512113392353], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314905354996673, "mean_inference_ms": 5.278058073035434, "mean_action_processing_ms": 1.275251503707599, "mean_env_wait_ms": 225.66611430302757, "mean_env_render_ms": 3.030390035910685}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -359.56389236450195, "episode_reward_min": -1757.4473256468773, "episode_reward_mean": -519.3260954836011, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-394.1174276769161, -518.2790240347385, -586.0200502276421, -777.1321298480034, -387.73353284597397, -387.3073059916496, -460.9534885287285, -432.2299563884735, -551.1186176240444, -398.36395731568336, -434.56228655576706, -607.5394294261932, -404.18810242414474, -483.4817298948765, -425.505030721426, -460.94922840595245, -416.9642699956894, -359.56389236450195, -507.8751296699047, -392.0332654416561, -491.7583127319813, -374.7457363307476, -535.1181253194809, -416.9573832154274, -473.0160982608795, -429.73059806227684, -608.623516857624, -1757.4473256468773, -471.4465388059616, -486.6081539988518, -437.43691927194595, -1613.0323698818684, -464.87686359882355, -406.4037162065506, -476.5761072933674, -445.5806597173214, -549.3978712260723, -438.3075365424156, -514.1489323675632, -430.4699890613556, -684.0372847914696, -459.3525533378124, -488.8939271271229, -513.6800560057163, -469.56432458758354, -499.4920908510685, -504.4748084247112, -481.1031086742878, -453.3142019212246, -438.7891952395439, -426.67366018891335, -419.5193467140198, -436.62757354974747, -392.1091236770153, -506.735920637846, -524.3715023398399, -556.2292906343937, -472.7949142754078, -425.32131963968277, -554.061334580183, -424.26207718253136, -500.82068449258804, -655.543958991766, -438.4808572232723, -948.9894171655178, -443.48701426386833, -542.8117414712906, -790.7868230640888, -516.2746528089046, -451.5991219878197, -497.9598488807678, -859.7359354197979, -767.0715727508068, -405.6878659129143, -427.91582557559013, -609.2556995153427, -461.5228754580021, -555.7120005786419, -433.9324139356613, -521.7858387827873, -504.3687835931778, -438.6450842618942, -472.7301876246929, -511.96252754330635, -392.33369740843773, -439.33072808384895, -505.39858815073967, -446.8656224012375, -466.7420699894428, -522.77635627985, -468.26179894804955, -557.8632986843586, -469.610432356596, -587.5282619893551, -444.74109652638435, -557.1783411502838, -530.8405774533749, -535.603219807148, -495.1544399559498, -416.29206371307373], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.438696312486811, "mean_inference_ms": 4.488888469230775, "mean_action_processing_ms": 4.257374433232184, "mean_env_wait_ms": 3.03118128864823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5110560, "timesteps_this_iter": 131040, "agent_timesteps_total": 5110560, "timers": {"sample_time_ms": 35725.669, "sample_throughput": 3667.951, "load_time_ms": 19.15, "load_throughput": 6842830.203, "learn_time_ms": 15086.046, "learn_throughput": 8686.172, "update_time_ms": 2.475}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957614183424e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 226.09057242275836, "policy_loss": -0.004499641735670258, "vf_loss": 45.222300444025294, "vf_explained_var": 0.11391545335451762, "kl": 0.0015373080769615535, "entropy": -0.31443220366286545, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5110560, "num_agent_steps_sampled": 5110560, "num_steps_trained": 5110560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5110560}, "done": false, "episodes_total": 10240, "training_iteration": 39, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-49-07", "timestamp": 1691002147, "time_this_iter_s": 15.106835842132568, "time_total_s": 1619.627440214157, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1619.627440214157, "timesteps_since_restore": 5110560, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 14.438095238095238, "ram_util_percent": 69.1142857142857}}
{"evaluation": {"episode_reward_max": -426.3878052532673, "episode_reward_min": -426.3878052532673, "episode_reward_mean": -426.3878052532673, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.3878052532673], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314905354996673, "mean_inference_ms": 5.278058073035434, "mean_action_processing_ms": 1.275251503707599, "mean_env_wait_ms": 225.66611430302757, "mean_env_render_ms": 3.030390035910685}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -317.0581588149071, "episode_reward_min": -4098.468428820372, "episode_reward_mean": -473.97196245668454, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-396.2349987626076, -355.04025730490685, -453.671375900507, -443.478476524353, -510.7618097066879, -497.1823629438877, -497.3132154941559, -565.4214260876179, -421.360522210598, -365.72652342915535, -435.5597617328167, -499.7775821983814, -487.375519156456, -1581.8615466952324, -395.28690642118454, -416.2507485449314, -320.3369069099426, -389.3762784898281, -469.8872721493244, -507.4346943795681, -379.11755135655403, -531.949561804533, -409.26526138186455, -425.14304941892624, -488.77085506916046, -383.12227696180344, -348.97059723734856, -532.6650153398514, -574.018274128437, -4098.468428820372, -425.481652200222, -421.95985731482506, -613.6521991491318, -380.4711929857731, -483.53226163983345, -840.1258015334606, -507.1627880334854, -435.2025574147701, -453.5871202647686, -461.4505657851696, -424.64909130334854, -437.7018201947212, -392.73928838968277, -749.3560692071915, -412.3431625366211, -422.8837193250656, -423.0415416955948, -367.22459387779236, -453.1256087720394, -470.9059339463711, -412.88586047291756, -450.7567282319069, -444.7234628498554, -370.9190093278885, -420.02848383784294, -586.8549644351006, -438.59037786722183, -419.08831655979156, -524.0683459639549, -442.6162773966789, -372.45271280407906, -446.0847533047199, -386.0233037471771, -400.97292548418045, -444.67385882139206, -466.72418960928917, -513.0901596546173, -569.8223029077053, -424.6046877503395, -436.23595041036606, -363.76340398192406, -481.6309452354908, -442.62370908260345, -379.3142630159855, -443.1239105463028, -377.25660356879234, -464.70575976371765, -333.6108884215355, -395.00600346922874, -467.08970072865486, -505.13757115602493, -395.2705877125263, -455.8002774119377, -395.81316566467285, -390.0177254676819, -492.21874648332596, -393.69014528393745, -348.9361496567726, -360.381937623024, -394.4322266280651, -464.0927494466305, -379.0093005299568, -412.5419772565365, -328.9349148571491, -385.01059368252754, -513.7316916286945, -457.9463057219982, -402.64505609869957, -409.5810735821724, -440.7747428417206, -380.87419241666794, -438.41999873518944, -525.2532958388329, -430.7323688864708, -380.449922978878, -426.1625612974167, -458.5679130256176, -411.75616881251335, -666.0340302586555, -363.76737228035927, -336.37227243185043, -3828.1390323638916, -494.8035000860691, -611.5351682007313, -387.5806398689747, -402.3443936109543, -435.12714073061943, -485.1849261522293, -539.7933567166328, -467.2436157166958, -396.25464594364166, -413.8506373465061, -400.5423838198185, -378.35122472047806, -533.7206380069256, -472.72091433405876, -408.5042430460453, -457.8407259583473, -404.84323114156723, -446.1022175550461, -410.5535199046135, -409.099413394928, -389.38929626345634, -440.4523602128029, -377.6040632426739, -357.1558695733547, -353.5672444701195, -454.5458420217037, -485.09381034970284, -509.1953002512455, -397.18845441937447, -459.3116258084774, -419.43951457738876, -448.3793465793133, -473.79471680521965, -595.1319658756256, -462.75499764084816, -676.9417028725147, -623.7949514091015, -565.2677716612816, -513.9633777439594, -553.9965462088585, -468.9116728901863, -480.9859885573387, -439.05171501636505, -454.16095033288, -362.42886286973953, -381.4876754283905, -437.1112750470638, -471.0399079024792, -608.3112488389015, -398.12688541412354, -448.3440685272217, -474.0833922326565, -459.52723252773285, -486.7237786054611, -569.0840246975422, -460.3890000283718, -397.9254560768604, -472.20349511504173, -358.8163211643696, -471.9114198386669, -413.20139449834824, -385.8483516275883, -438.05915305018425, -494.73399779200554, -556.3832559883595, -442.5032256245613, -390.7809913158417, -398.9893982708454, -317.0581588149071, -370.37866669893265, -486.7161691188812, -444.224118411541, -629.749931126833, -537.7717736363411, -401.8114765882492, -446.3737100958824, -426.7242698967457, -439.79624047875404, -504.4723938405514, -580.6034484505653, -419.2766157090664, -407.2346411347389, -523.8349979221821, -452.98324260115623, -631.6271675527096, -435.28977233171463, -441.283249348402, -347.28673696517944, -390.08028265833855, -421.16425588727, -374.1252543926239, -385.8034180700779, -467.68302699923515, -467.573193103075, -513.9137685894966, -429.4463061988354, -466.5934244990349, -533.2082489132881, -452.6812418997288, -478.21688240766525, -388.801707059145, -434.7613317370415, -433.4418879747391, -382.43893456459045, -515.8759716451168, -427.2170624136925, -349.33186545968056, -480.4408051073551, -352.123580545187, -388.120643645525, -377.585933893919, -411.94222632050514, -486.59717589616776, -449.3110199570656, -500.2163126170635, -434.839877396822, -372.3708811402321, -413.8706034719944, -445.9634999036789, -397.2406978905201, -454.6274094283581, -431.9651195406914, -530.2710276842117, -351.1838988363743, -398.8613404929638, -475.220967233181, -363.6396225988865, -436.2581495344639, -653.017367452383, -382.65484803915024, -431.5998504459858, -469.5677736699581, -479.92602506279945, -413.37593799829483, -398.02277222275734, -526.5105249285698, -504.38512113690376, -420.1530957520008, -498.0170278251171, -391.70740896463394, -334.22214064002037, -522.4332203269005, -661.2885948419571, -408.197507083416, -395.5046475827694, -426.1168281137943, -460.8117353618145, -508.49337550997734, -531.2525404691696, -478.5212489068508, -419.43520137667656, -476.01179948449135, -512.8249597251415, -359.9887869358063, -346.7048274874687, -407.626002907753, -476.5733720064163, -493.54814994335175, -438.3542433679104, -484.78892159461975, -396.224244594574, -459.7144353091717, -498.71835365891457, -389.87498223781586, -401.2581057548523, -467.76379442214966, -488.2802093923092, -438.41267788410187, -375.6466257274151, -532.9629065394402, -457.25941213965416, -441.6035535633564, -527.6108581721783, -438.0321059525013, -469.8026657998562, -489.5826069712639, -345.84540820121765, -368.4645044505596, -624.2522740662098, -374.55602207779884, -392.96607822179794, -451.56830379366875, -369.73184740543365, -481.47672283649445, -532.0151395499706, -395.83331298828125, -444.61793369054794, -480.24723890423775, -399.25316593050957, -376.289865732193, -453.31369385123253, -484.11320981383324, -381.6023573577404, -410.081826120615, -526.6980181634426, -477.9815939068794, -407.3813604712486, -558.9069572389126, -439.3311945796013, -420.9797253906727, -517.5092695653439, -459.0774604380131, -529.662103831768, -456.83149406313896, -426.32949617505074, -369.170863956213, -447.5359999239445, -390.1612668633461], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.360034981299046, "mean_inference_ms": 4.472480276884021, "mean_action_processing_ms": 4.155053357409643, "mean_env_wait_ms": 3.0350011091816937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5241600, "timesteps_this_iter": 131040, "agent_timesteps_total": 5241600, "timers": {"sample_time_ms": 38061.829, "sample_throughput": 3442.819, "load_time_ms": 20.387, "load_throughput": 6427721.338, "learn_time_ms": 15058.456, "learn_throughput": 8702.087, "update_time_ms": 2.444}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.637978807091712e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 202.31776146764267, "policy_loss": -0.0006729978137370179, "vf_loss": 40.46390199490345, "vf_explained_var": 0.12027131699319381, "kl": 0.0015047706683845622, "entropy": -0.32391414345378944, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5241600, "num_agent_steps_sampled": 5241600, "num_steps_trained": 5241600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5241600}, "done": false, "episodes_total": 10560, "training_iteration": 40, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-49-46", "timestamp": 1691002186, "time_this_iter_s": 38.73490881919861, "time_total_s": 1658.3623490333557, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1658.3623490333557, "timesteps_since_restore": 5241600, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 43.1875, "ram_util_percent": 68.93928571428572}}
{"evaluation": {"episode_reward_max": -506.8039399087429, "episode_reward_min": -506.8039399087429, "episode_reward_mean": -506.8039399087429, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-506.8039399087429], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314905354996673, "mean_inference_ms": 5.278058073035434, "mean_action_processing_ms": 1.275251503707599, "mean_env_wait_ms": 225.66611430302757, "mean_env_render_ms": 3.030390035910685}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -305.51659855246544, "episode_reward_min": -5345.24516043067, "episode_reward_mean": -481.33858381106205, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-565.9348624944687, -343.9094843864441, -414.43095871806145, -452.142848610878, -426.19482892751694, -326.7180767953396, -456.2995613515377, -462.9270720779896, -415.79536667466164, -393.7823021709919, -376.58908358216286, -426.8425625562668, -500.2861748635769, -396.16129019856453, -432.5074155330658, -480.2173801660538, -500.2661054432392, -491.9284659922123, -388.0061804652214, -383.03420954942703, -461.9747928380966, -438.18703481554985, -357.9008577764034, -454.96893310546875, -414.4489204287529, -427.00883212685585, -564.8853215873241, -428.7078124284744, -472.1945371925831, -424.6528659760952, -585.8317361474037, -383.26223689317703, -695.228234320879, -595.2041507065296, -457.31093645095825, -534.7928819060326, -358.6666145324707, -441.61180025339127, -435.9569970071316, -378.76914408802986, -437.8483304679394, -381.304332703352, -624.9913866519928, -425.05427595973015, -393.3047101199627, -526.0833499729633, -491.6468819975853, -437.6923674941063, -451.1247703433037, -527.9100160002708, -434.3084812760353, -392.1165938973427, -353.482210367918, -408.64063063263893, -404.7473831176758, -356.1815760433674, -416.2349724471569, -440.9668673276901, -467.8099673986435, -551.8419544398785, -388.1434255242348, -465.9743478298187, -467.43467861413956, -510.65762174129486, -338.63367560505867, -446.9935848414898, -1132.3533190488815, -533.1359112262726, -438.717900544405, -483.5154101252556, -469.7950491607189, -506.26967230439186, -496.60467940568924, -454.9140858054161, -491.24800223112106, -543.7303636670113, -464.6584415137768, -731.7118700742722, -1054.3124497234821, -474.13138753175735, -418.4273405969143, -446.63137114048004, -444.2946265041828, -442.014250934124, -456.5740042924881, -381.4271166920662, -545.2930163145065, -348.21358969807625, -399.9551029205322, -383.9472799003124, -411.65468418598175, -490.5296927392483, -374.41339483857155, -510.5175626575947, -459.0300307571888, -494.4971859753132, -402.9486035108566, -607.2433077692986, -379.76333114504814, -467.61411184072495, -535.9107790291309, -400.1538190841675, -430.6456300318241, -420.2505573928356, -361.3334471285343, -408.40257769823074, -420.05866757035255, -417.9477046430111, -425.43713787198067, -395.7401226758957, -421.13764065504074, -435.2801570594311, -400.3157945871353, -439.59125608205795, -404.2900661230087, -3324.758773803711, -432.5570636689663, -370.5169138610363, -403.8371476531029, -546.7329250574112, -427.30148980021477, -539.141028046608, -458.1715262234211, -466.18380734324455, -539.5993800163269, -334.8979184925556, -367.45880833268166, -412.0353170633316, -378.6239541172981, -482.44001561403275, -431.8390293121338, -435.08421471714973, -485.65900751948357, -449.3072118163109, -431.93841379880905, -382.5659592449665, -569.315152078867, -387.83644500374794, -507.5323241055012, -475.9553271532059, -495.1939876973629, -568.0798173546791, -318.4625945985317, -400.2643109858036, -330.63550463318825, -494.4953857064247, -437.3777840733528, -432.4497721195221, -462.9407905936241, -413.8485232591629, -507.9785654246807, -1011.9914458692074, -382.20716682076454, -434.88429260253906, -376.4236182272434, -427.74402087926865, -404.8728457093239, -434.1017988026142, -461.5136326253414, -366.20689538121223, -505.81301748752594, -462.290012717247, -480.3891515135765, -330.68061596155167, -415.478687107563, -463.24849113821983, -490.56665375828743, -451.2259427011013, -408.0212015211582, -383.2515521645546, -382.1594412922859, -413.15152686834335, -452.2892522215843, -337.412988781929, -336.58126720786095, -466.4492873251438, -484.8287550508976, -506.74603632092476, -399.59239995479584, -439.677384018898, -384.37222519516945, -410.34108647704124, -392.00190368294716, -424.03724935650826, -444.10782411694527, -426.9400666356087, -391.1215150654316, -471.18696159124374, -722.5834047198296, -500.03695344924927, -396.4578758776188, -473.527322947979, -373.49565437436104, -430.2943449616432, -330.5376431643963, -431.0500972867012, -525.4567915797234, -503.7784269154072, -421.71874499320984, -384.19379752874374, -367.64277788996696, -544.8424815535545, -396.6338148713112, -498.72681176662445, -348.8236473798752, -370.09840101003647, -380.7626360952854, -374.95739910006523, -458.4613339006901, -428.64584785699844, -473.8839501440525, -417.08612564206123, -329.54407781362534, -424.63937520980835, -500.28425791859627, -499.16364735364914, -522.8752106130123, -524.2869006991386, -484.94562980532646, -457.76323840022087, -437.66015404462814, -471.5277529656887, -503.1221608221531, -590.0466394722462, -552.8866464197636, -494.68235859274864, -417.2263113260269, -444.6190633177757, -475.3005280792713, -428.9843236207962, -552.6173431277275, -395.30321046710014, -438.4342986345291, -335.48034459352493, -351.009167522192, -410.6440224349499, -407.94866240024567, -405.05047699809074, -431.208755671978, -380.2551292479038, -455.3594053387642, -1049.1993135809898, -413.47019559144974, -326.6067331135273, -478.25611928105354, -419.7879092991352, -471.92369163036346, -546.2515617907047, -401.295470893383, -343.021903604269, -531.4706973433495, -392.46487233042717, -450.7530626654625, -1113.5330623984337, -387.0621668994427, -413.6809248626232, -429.25843155384064, -380.05392184853554, -463.27411183714867, -413.1752065420151, -574.0116241872311, -536.2825172543526, -365.0109062194824, -1933.9426071941853, -393.9422201514244, -438.825423181057, -425.67463487386703, -362.7779819369316, -575.0810392796993, -515.2406526207924, -444.4459025859833, -441.4958865940571, -426.41425612568855, -363.6811717450619, -460.76426166296005, -419.2984737455845, -347.7739327251911, -466.7833184301853, -379.62974721193314, -426.1588961482048, -404.83174708485603, -377.3490807414055, -366.60889595746994, -500.1389594078064, -456.3903252482414, -387.9652190208435, -472.726016163826, -534.5793182849884, -396.71537932753563, -444.995243281126, -477.60115772485733, -381.25630408525467, -466.0647712945938, -421.52430135011673, -467.92833295464516, -462.9024824798107, -466.5387727022171, -423.90332674980164, -401.87975043058395, -357.38547825813293, -351.7900574505329, -435.9477373957634, -585.4536800682545, -402.79790475964546, -483.63307094573975, -412.0137333869934, -385.5621764063835, -432.5085352361202, -461.97222024202347, -475.6139396429062, -362.5970484316349, -409.63345488905907, -388.2006456851959, -423.37024480104446, -404.4216404259205, -442.3975400030613, -308.79130470752716, -668.404509395361, -343.099874317646, -364.8117199540138, -328.6595268547535, -507.95513930916786, -963.1040641069412, -428.00291204452515, -5345.24516043067, -473.05131751298904, -478.673627525568, -476.45806908607483, -429.3089085817337, -487.23942348361015, -466.7252514362335, -516.9399153590202, -385.27716812491417, -478.6041572391987, -3921.3473411500454, -477.4615743458271, -461.6079098880291, -460.2876543998718, -439.90587639808655, -380.6525249481201, -453.67090037465096, -460.8357781469822, -381.4624418914318, -433.78906589746475, -420.4549592733383, -422.71333652734756, -425.55957475304604, -431.3849574327469, -387.86680433154106, -461.4331077635288, -408.19645300507545, -354.9650761783123, -452.947813808918, -385.3119413256645, -699.9158639907837, -454.22830361127853, -382.1999174952507, -540.6236467063427, -435.65664756298065, -480.0974127948284, -393.75171399116516, -386.62026315927505, -532.6501650214195, -354.2065281867981, -469.7408622801304, -391.7936504781246, -391.1568118929863, -523.0519610345364, -527.4860578477383, -476.78590643405914, -505.0870086848736, -480.6603660285473, -400.99033311009407, -377.5692412853241, -511.99608996510506, -490.3416182398796, -470.4576293230057, -601.3731046319008, -556.9927054941654, -414.8420465886593, -477.3273058831692, -408.29931193590164, -405.29020887613297, -492.2751986384392, -403.5748168826103, -468.59557977318764, -496.10612908005714, -1707.149201989174, -518.6105889678001, -573.2987351119518, -386.4470944702625, -550.8110433518887, -366.43055963516235, -406.3139791190624, -501.74659061431885, -444.93039259314537, -492.9119256734848, -370.89923641085625, -536.399226039648, -449.26917284727097, -305.51659855246544, -426.60729855298996, -415.2029778063297, -360.3922800719738, -358.84975957870483, -421.91229206323624, -349.06758803129196, -420.06292966008186, -386.9662451148033, -392.02614390850067, -427.6619424521923, -620.5988547503948, -516.7220202386379, -399.27044945955276, -353.25957027077675, -542.2672757804394, -473.6314498782158, -476.0693766772747, -393.66422802209854, -479.19571328163147, -487.2135861515999, -373.2354733347893, -552.4177166223526, -359.05773517489433, -370.73652189970016, -436.18180480599403, -552.0360989868641, -472.34481301903725, -479.10561937093735, -446.84795251488686, -464.6074340939522, -405.46340200304985, -478.6663928627968, -491.0566882789135, -453.27467665076256, -443.9627110660076, -506.510217577219, -416.89507097005844, -433.89116898179054, -441.3149564862251, -442.5913297533989, -540.175646841526, -372.6165558695793, -367.3814783990383, -539.6525318622589, -513.3085699081421, -515.9973312318325, -594.1078761219978, -456.0798797905445, -375.2692520916462, -435.8791515529156, -610.1211472451687, -538.4716830849648, -406.24016055464745, -448.2736061811447, -431.17245772480965, -395.91204196214676, -468.1440281569958, -419.46223440766335, -474.867199242115, -457.81888338923454, -502.1763724684715, -392.0733293890953, -347.85279056429863, -420.84338024258614, -449.57460364699364, -389.2800644338131, -432.1482282578945, -444.6347577869892, -423.6212841272354, -408.27294221520424, -526.1670012176037, -373.0417646765709, -380.07900685071945, -526.9554264247417, -392.1230207979679, -523.0044474601746, -617.9291909635067, -403.7350051999092, -496.8163831830025], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.359490628883141, "mean_inference_ms": 4.469657280633063, "mean_action_processing_ms": 4.153904770897394, "mean_env_wait_ms": 3.031221285519946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5372640, "timesteps_this_iter": 131040, "agent_timesteps_total": 5372640, "timers": {"sample_time_ms": 37958.195, "sample_throughput": 3452.219, "load_time_ms": 21.444, "load_throughput": 6110912.667, "learn_time_ms": 15057.901, "learn_throughput": 8702.408, "update_time_ms": 2.365}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.818989403545856e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 205.96192799038658, "policy_loss": 0.0017475808094455081, "vf_loss": 41.19031018766451, "vf_explained_var": 0.059165878855626644, "kl": 0.002200555986821598, "entropy": -0.3286907774893614, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5372640, "num_agent_steps_sampled": 5372640, "num_steps_trained": 5372640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5372640}, "done": false, "episodes_total": 11040, "training_iteration": 41, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-50-24", "timestamp": 1691002224, "time_this_iter_s": 38.53638243675232, "time_total_s": 1696.898731470108, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1696.898731470108, "timesteps_since_restore": 5372640, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 44.15090909090909, "ram_util_percent": 69.0018181818182}}
{"evaluation": {"episode_reward_max": -420.1898531615734, "episode_reward_min": -420.1898531615734, "episode_reward_mean": -420.1898531615734, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.1898531615734], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314905354996673, "mean_inference_ms": 5.278058073035434, "mean_action_processing_ms": 1.275251503707599, "mean_env_wait_ms": 225.66611430302757, "mean_env_render_ms": 3.030390035910685}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -305.51659855246544, "episode_reward_min": -1707.149201989174, "episode_reward_mean": -462.943233781755, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-477.3273058831692, -408.29931193590164, -405.29020887613297, -492.2751986384392, -403.5748168826103, -468.59557977318764, -496.10612908005714, -1707.149201989174, -518.6105889678001, -573.2987351119518, -386.4470944702625, -550.8110433518887, -366.43055963516235, -406.3139791190624, -501.74659061431885, -444.93039259314537, -492.9119256734848, -370.89923641085625, -536.399226039648, -449.26917284727097, -305.51659855246544, -426.60729855298996, -415.2029778063297, -360.3922800719738, -358.84975957870483, -421.91229206323624, -349.06758803129196, -420.06292966008186, -386.9662451148033, -392.02614390850067, -427.6619424521923, -620.5988547503948, -516.7220202386379, -399.27044945955276, -353.25957027077675, -542.2672757804394, -473.6314498782158, -476.0693766772747, -393.66422802209854, -479.19571328163147, -487.2135861515999, -373.2354733347893, -552.4177166223526, -359.05773517489433, -370.73652189970016, -436.18180480599403, -552.0360989868641, -472.34481301903725, -479.10561937093735, -446.84795251488686, -464.6074340939522, -405.46340200304985, -478.6663928627968, -491.0566882789135, -453.27467665076256, -443.9627110660076, -506.510217577219, -416.89507097005844, -433.89116898179054, -441.3149564862251, -442.5913297533989, -540.175646841526, -372.6165558695793, -367.3814783990383, -539.6525318622589, -513.3085699081421, -515.9973312318325, -594.1078761219978, -456.0798797905445, -375.2692520916462, -435.8791515529156, -610.1211472451687, -538.4716830849648, -406.24016055464745, -448.2736061811447, -431.17245772480965, -395.91204196214676, -468.1440281569958, -419.46223440766335, -474.867199242115, -457.81888338923454, -502.1763724684715, -392.0733293890953, -347.85279056429863, -420.84338024258614, -449.57460364699364, -389.2800644338131, -432.1482282578945, -444.6347577869892, -423.6212841272354, -408.27294221520424, -526.1670012176037, -373.0417646765709, -380.07900685071945, -526.9554264247417, -392.1230207979679, -523.0044474601746, -617.9291909635067, -403.7350051999092, -496.8163831830025], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43296528394718, "mean_inference_ms": 4.48354593376043, "mean_action_processing_ms": 4.256505830551629, "mean_env_wait_ms": 3.0281208478802353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5503680, "timesteps_this_iter": 131040, "agent_timesteps_total": 5503680, "timers": {"sample_time_ms": 37964.099, "sample_throughput": 3451.682, "load_time_ms": 21.441, "load_throughput": 6111612.566, "learn_time_ms": 15069.519, "learn_throughput": 8695.699, "update_time_ms": 2.35}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.09494701772928e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 200.02874769681432, "policy_loss": 0.0015581485500995005, "vf_loss": 40.003853818421724, "vf_explained_var": 0.10010198367539272, "kl": 0.0021949908122383594, "entropy": -0.3384897939620479, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5503680, "num_agent_steps_sampled": 5503680, "num_steps_trained": 5503680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5503680}, "done": false, "episodes_total": 11040, "training_iteration": 42, "trial_id": "7980c_00000", "experiment_id": "c86ebc85668e42fa8ca8b9807f939205", "date": "2023-08-02_18-50-40", "timestamp": 1691002240, "time_this_iter_s": 15.26668405532837, "time_total_s": 1712.1654155254364, "pid": 236, "hostname": "56343b833234", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.5, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1712.1654155254364, "timesteps_since_restore": 5503680, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 14.281818181818183, "ram_util_percent": 69.35909090909091}}
