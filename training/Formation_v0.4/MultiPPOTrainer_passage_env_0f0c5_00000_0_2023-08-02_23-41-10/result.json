{"episode_reward_max": -1824.281589716673, "episode_reward_min": -16069.958076007664, "episode_reward_mean": -5278.99276642552, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6255.832676842809, -2511.762163426727, -4424.889816492796, -8242.877573750913, -4615.531674906611, -4731.497973114252, -7989.8868530243635, -3069.0905856117606, -6043.846704080701, -6467.766655582935, -4185.085957832634, -3472.5286504030228, -9024.349287942052, -6899.179319545627, -5143.855753943324, -2545.6341837123036, -5329.608080301434, -6624.328543536365, -6033.158753313124, -7113.402941010892, -3061.776373192668, -5665.754448696971, -6418.369357667863, -3310.332836806774, -2923.790840204805, -3236.4475700967014, -2723.8208850957453, -6539.481585904956, -3689.241950392723, -4691.24063231796, -4172.291230592877, -6895.527791917324, -6143.06078986451, -8141.570216756314, -5912.600671900436, -2269.4604377672076, -10460.108847126365, -3974.1860197857022, -5864.118238821626, -3556.078340128064, -4239.850823044777, -4919.088876031339, -4673.353064440191, -10640.009845353663, -2461.1377791166306, -5608.780753791332, -8498.914424836636, -2528.3767843693495, -4673.776890866458, -10919.908257104456, -11445.207322150469, -9936.990170687437, -4326.678692936897, -2714.0841576159, -5556.377856165171, -2971.7557477355003, -4059.988225750625, -4170.124619431794, -4249.33436319232, -7233.494898214936, -4398.608342804015, -7104.120250120759, -2560.874858997762, -5320.191794916987, -4256.268963798881, -2295.7678820751607, -5607.381066702306, -3046.3824952468276, -3764.870472818613, -3224.4862643927336, -8489.817159634084, -6331.111343547702, -3697.7082183286548, -3439.329909350723, -4251.661562681198, -5219.926060862839, -4365.665355410427, -6674.340475127101, -3257.1333508640528, -5364.9543947167695, -4817.886418998241, -6813.384698227048, -9335.33770994842, -3239.3205063790083, -4278.43620480597, -8691.519026901573, -3836.6433838903904, -5270.1968459784985, -3397.2527112811804, -4010.6195754408836, -3637.283819720149, -7073.329967463389, -2241.18606197834, -5812.466878451407, -7148.512750141323, -4076.427623860538, -6129.521852832288, -3188.7145920544863, -8139.951742038131, -4761.374645769596, -2949.0498358905315, -4634.418169721961, -2583.686525352299, -3340.020128056407, -5982.200937882066, -5851.085496805608, -7029.758971396834, -3911.3826756589115, -16069.958076007664, -2769.7163984030485, -5326.472026504576, -2958.2212721966207, -3420.4074516370893, -5212.213115464896, -10117.420955970883, -5296.576913100667, -10310.629444852471, -8171.301334122196, -7997.27533069253, -6873.1862138435245, -4186.821596927941, -4513.7825864851475, -3487.1074263136834, -5054.953128643334, -4253.430013790727, -6152.770637437701, -3717.377590343356, -5532.034100443125, -4433.047953695059, -6044.868398718536, -6839.555969953537, -4845.426735922694, -6278.721926301718, -2774.542380899191, -5129.803270950913, -4713.110617622733, -4979.891238246113, -3432.9166444838047, -6879.811836451292, -2454.5550794005394, -4771.169492460787, -3796.1693633422256, -2979.6841455101967, -3263.4718560278416, -3706.6213204413652, -3363.469013348222, -4807.545016562566, -4134.3600361049175, -5297.792758017778, -4153.781770333648, -9372.708697266877, -5164.073336059228, -3648.603005055338, -11287.652909711003, -3115.61926920712, -3438.3926867097616, -5281.386931329966, -3183.268510118127, -7350.902358558029, -4212.348523303866, -4972.119763746858, -3134.9518840759993, -3592.871152177453, -13812.340930491686, -4517.112572468817, -9022.23076710105, -7047.716714479029, -5368.423366822302, -7773.8712636344135, -2949.7186898440123, -2961.615939669311, -8537.785809516907, -9067.711265459657, -5721.591922700405, -3246.2445402145386, -3886.3286713026464, -4058.2149548232555, -7314.627095632255, -7374.430714549497, -4531.45123232156, -12212.20099297911, -1824.281589716673, -4046.6036552116275, -3148.5423495173454, -7187.22419468686, -9533.672632724047, -4535.182292200625, -3278.789329484105, -3116.0677179405466, -6995.296465553343, -3117.3208274394274, -5931.9269260540605, -7055.810025013983, -3026.3138623833656, -6958.928016796708, -3221.621478252113, -4771.02392234467, -4108.1328668780625, -3524.053545884788, -4875.090887069702, -4803.8734396304935, -4927.446056822315, -2078.217307418585, -3487.3259870931506, -3306.5360366031528, -3743.5380229447037, -11306.392508253455, -4380.970915198326, -7890.243910610676, -3972.827034458518, -4102.724854156375, -7277.803831636906, -4998.12717333436, -3627.80624063313, -4590.323455899954, -5515.735438305885, -8727.447228960693, -11697.380455568433, -4727.363961797208, -4031.037836819887, -3279.538457803428, -2967.3095198087394, -4933.0039543658495, -4728.778725117445, -7646.4327087290585, -5397.378338776529, -10728.715493634343, -4207.766568094492, -4548.0287302061915, -6007.818846385926, -10522.9437193349, -9482.227162741125, -4266.049997508526, -3623.95865457505, -7464.668310634792, -3012.177577700466, -6020.051144301891, -3078.056433029473, -2873.514417912811, -3246.910242140293, -3717.5919301882386, -4985.0282177478075, -3596.759650476277, -4531.99150178954, -8386.53952908516, -4856.204299654812, -2914.692875549197, -4451.667961731553, -6728.972573548555, -3788.0299456194043, -5774.126381620765, -4936.353189378977, -6982.754877623171, -7200.734245378524, -7236.835059702396, -8188.169436991215, -4058.8869853392243, -2132.0630088821054, -4413.474698357284, -4213.051964208484, -4388.771951120347, -4107.058091893792, -8534.783499978483, -4510.426632076502, -3416.4895055405796, -8183.062840729952, -3068.1587961912155, -7538.104441080242, -2792.374926816672, -2794.502942249179, -7780.682508528233, -6007.333436563611, -4106.208071846515, -6564.4953092336655, -3014.442839115858, -9052.742578923702, -5101.127272665501, -4246.255679313093, -6651.89218261838, -7528.122699737549, -6520.518864162266, -9188.71262320131, -6550.421720772982, -4158.573130108416, -2148.732132509351, -2011.6595497503877, -5233.693623393774, -2721.6822983548045, -4121.021590590477, -4361.209676280618, -3752.794662579894, -5914.1926028728485, -10974.55482660234, -3178.1817639172077, -8448.22531272471, -5758.119069501758, -6793.210063343868, -5073.042285073549, -4384.5565588623285, -5264.298467129469, -3632.756138727069, -4972.0924441069365, -6611.3234935849905, -7958.639860741794, -2676.0358193442225, -11140.981570377946, -3263.5364467315376, -3565.401775121689, -6987.5937195420265, -4293.037880707532, -4958.1217439472675, -6062.243227206171, -5268.491883896291, -3037.293586589396, -2547.303915310651, -2341.006887346506, -3591.4112020879984, -2365.3817398175597, -3872.092511624098, -4897.575109548867], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3477476011340395, "mean_inference_ms": 4.4252929412590465, "mean_action_processing_ms": 4.2048472611971235, "mean_env_wait_ms": 3.2090135363576833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 131040, "timesteps_this_iter": 131040, "agent_timesteps_total": 131040, "timers": {"sample_time_ms": 24228.412, "sample_throughput": 5408.526, "load_time_ms": 29.949, "load_throughput": 4375410.745, "learn_time_ms": 14415.77, "learn_throughput": 9090.045, "update_time_ms": 2.37}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.19999999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 466.4486800658825, "policy_loss": -0.00455769942878665, "vf_loss": 93.29412345476048, "vf_explained_var": -0.0003109250658301897, "kl": 4.674084671668365e-05, "entropy": -0.16243897840434077, "entropy_coeff": 0.001}}}, "num_steps_sampled": 131040, "num_agent_steps_sampled": 131040, "num_steps_trained": 131040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 131040}, "done": false, "episodes_total": 320, "training_iteration": 1, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-41-54", "timestamp": 1691019714, "time_this_iter_s": 38.644471645355225, "time_total_s": 38.644471645355225, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38.644471645355225, "timesteps_since_restore": 131040, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.51964285714286, "ram_util_percent": 47.90357142857142}}
{"episode_reward_max": -1618.3299243934453, "episode_reward_min": -15334.430035412312, "episode_reward_mean": -5276.739097228669, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5003.155842650682, -3611.6976089552045, -1903.3036722261459, -3106.778546757996, -5618.1423460599035, -3306.9099928215146, -5240.936348179355, -14607.260485604405, -3937.5117292404175, -5894.222809717059, -5655.2053989209235, -3604.5672546438873, -7373.0016427487135, -8852.66236732155, -3773.0155916437507, -5737.674515992403, -4884.647400423884, -4222.548162817955, -9388.239290937781, -5024.791200749576, -8597.812026746571, -4857.6042256727815, -4183.688760831952, -4326.280451435596, -12755.808687239885, -7609.158928081393, -6681.889792684466, -2332.372018404305, -5780.460500493646, -4250.124348446727, -2013.4960639029741, -3807.844422340393, -4407.411747857928, -5252.977527573705, -5232.77252247557, -8037.987547876313, -5993.588226474822, -5003.607358425856, -3664.8525345027447, -3169.0520423203707, -5364.1915818713605, -8616.626826517284, -4223.42414188385, -4554.356954701245, -2458.7259455919266, -4657.611058272421, -2750.2626524865627, -4623.55239585042, -5109.5219290703535, -7106.145258665085, -3218.430512174964, -2921.3958518877625, -7101.497375994921, -4538.521196011454, -4798.927870437503, -4740.929233536124, -9433.111285030842, -3127.9197501689196, -5818.700974225998, -4147.337499804795, -4843.560324879363, -7390.4834170416, -6244.825140435249, -4714.081100488082, -5610.251976430416, -5937.821005411446, -2684.497474577278, -3211.3872151225805, -4574.224376961589, -4146.514836132526, -7745.228115227073, -2857.6314096301794, -2290.7957675457, -6316.207499306649, -3921.2489104419947, -5547.517980888486, -2766.499283373356, -5892.214723333716, -3784.8508996143937, -4423.310750856996, -9411.242974683642, -3627.759518057108, -3285.410238698125, -3437.8194432482123, -7629.800745919347, -2284.319935411215, -2696.333908945322, -3222.976191416383, -6972.908340265974, -5825.487995073199, -3749.5755176991224, -2829.5245184004307, -5914.973006404936, -3622.3276106864214, -3882.30503622815, -4508.766220577061, -5099.528089545667, -4872.570170029998, -4128.546739701182, -4496.324645161629, -2520.512396212667, -3656.7272527106106, -3637.758514136076, -6334.3157018925995, -3238.4914346709847, -4220.167124122381, -8535.137710638344, -4807.253289490938, -4319.688390597701, -7064.805073425174, -5227.831740170717, -4496.872713021934, -5859.129899010062, -4889.476150257047, -2821.1160071641207, -8309.012299284339, -4466.633494406939, -3692.702907308936, -4068.7058812379837, -3668.745595321059, -7451.011017382145, -5994.187745776027, -2274.273233162239, -4425.040583498776, -6457.475527353585, -8210.073277711868, -3040.823540791869, -4270.749566480517, -4770.709305346012, -3281.937183097005, -5997.409545265138, -8078.513563871384, -3522.8304658792913, -2977.4156104698777, -8716.680400345474, -3003.6700951829553, -5672.3884127140045, -4042.2215551659465, -5432.420689351857, -4007.1354923546314, -3390.3505580425262, -3928.067984685302, -3728.448942422867, -4343.718424886465, -4766.578601136804, -3286.6358623979613, -2259.459542699158, -4858.298744540662, -4211.302235245705, -5847.167919468135, -9843.992231950164, -2545.446336477995, -3568.258380897343, -4079.4687692821026, -3967.770395308733, -4321.4856908768415, -7790.96132812649, -5120.242160204798, -7781.935419075191, -5992.421330474317, -5094.968673110008, -4459.426939550787, -3243.8119449429214, -6902.503007538617, -5124.166721634567, -2596.96894428879, -4043.778348684311, -6705.888325944543, -5072.361109729856, -7429.9817135334015, -6830.637038365006, -4356.258472695947, -4107.82746797055, -4662.8812936246395, -5653.448340177536, -1949.926368638873, -8258.345633469522, -4927.809728354216, -7606.734789149836, -3464.72585439682, -4506.998762696981, -5972.273650765419, -3490.9389448314905, -6247.386169791222, -3918.804747700691, -3812.1848426908255, -3158.4564951583743, -7110.942655812949, -9591.479927033186, -4057.7753711789846, -6175.380575723946, -4186.764629423618, -4803.4811879098415, -4540.395688138902, -5581.107918787748, -4431.132894899696, -4084.454192597419, -15334.430035412312, -4624.650263875723, -5032.047655850649, -2570.6139644533396, -4831.846174120903, -5822.455395311117, -5971.467523962259, -3779.141711574048, -7183.7110997941345, -6644.780322432518, -7478.0726849883795, -2778.1872412785888, -7806.611931741238, -7890.427488416433, -7479.8265458494425, -4775.729364931583, -8423.48836249113, -6170.561914369464, -1618.3299243934453, -3208.537703961134, -5426.450522184372, -6522.457811042666, -4142.9526846930385, -8092.5727166980505, -4282.669445991516, -4058.035789653659, -8216.28692309931, -3715.179332461208, -4053.666438682005, -3991.614165455103, -2774.1475853845477, -3609.288583442569, -5548.393295437098, -6784.023161888123, -3627.4199007749557, -7365.3213420286775, -5303.947760552168, -2074.379742562771, -4595.623266495764, -4568.3512146398425, -4027.9215720295906, -5902.41802868247, -9758.849348567426, -4820.4783875495195, -4277.95729637146, -4160.369027480483, -5358.290731221437, -8252.774061404169, -4290.721663936973, -7591.234286725521, -6464.8894520998, -2769.0426508560777, -3954.280744805932, -8800.355490759015, -4356.9040363729, -4205.868532437831, -2431.7688299566507, -6232.105113193393, -4721.831438049674, -4446.808626830578, -5794.774019651115, -6092.719950810075, -5764.787100367248, -5030.4762029238045, -4399.810103897005, -9202.381896264851, -6518.687386706471, -4671.154670216143, -6315.75226508081, -3575.4017551094294, -6390.91536398232, -5230.973513808101, -3156.516097396612, -3859.836593836546, -3325.7341841310263, -8762.90017234534, -5261.610355257988, -5188.8102995194495, -9092.936399161816, -9399.499896407127, -8310.328393310308, -4064.973302617669, -7437.494273908436, -4626.756576422602, -2458.9961004555225, -5341.342689175159, -3506.803224310279, -4097.6639285087585, -3345.0000487109646, -5597.280317284167, -6331.723018847406, -7598.39333806932, -4896.930947173387, -4978.804656505585, -7800.010834552348, -6129.177282318473, -5032.933780316263, -5148.180952586234, -3976.881983719766, -7650.467938140035, -8732.600986160338, -4813.856519006193, -3310.802370980382, -4102.736899746582, -4463.290088541806, -3162.0826724246144, -3884.7568016573787, -4709.85343791917, -4443.719235427678, -3264.4379060566425, -9713.5967983827, -6104.458533339202, -8189.037501081824, -6068.874594196677, -10249.302752375603, -6016.093092292547, -3803.9014683440328, -6246.168516486883, -4284.909655481577, -3808.6941890120506, -3544.6424212902784, -5366.3428857252, -4600.694356773049, -6008.144418939948, -4649.28053368628, -6062.392010033131, -5119.306670915335, -4910.662420555949, -2770.4371909573674, -4622.642599388957, -4715.2024228051305, -6952.900521367788, -6281.785260863602, -8981.995809726417, -2765.8968999758363, -7477.699254333973, -3785.8153936862946, -6230.257855344564, -3750.200578570366, -7296.059141486883, -4299.371673673391, -4947.049884669483, -5941.676115293056, -10653.013551726937, -5859.201376922429, -5608.782066822052, -7016.970695018768, -3818.5575651824474, -4307.849576845765, -3984.2007452063262, -3837.838164962828, -4902.255583748221, -5193.559996932745, -5247.140542678535, -4334.971686027944, -3572.9452593550086, -4362.440779756755, -6325.088281981647, -4038.4102340796962, -5268.43696719408, -5990.9432688727975, -7138.418564025313, -5394.984826922417, -2536.8813228458166, -2987.195057630539, -2928.012207902968, -4009.265929866582, -6107.302967078984, -3609.0094721987844, -5515.317502856255, -3145.9713639505208, -4859.0291333422065, -5290.443301104009, -3755.6295494437218, -4625.624635905027, -4664.350217476487, -4230.615077242255, -5588.08726734668, -4741.892522446811, -10699.475546523929, -11575.085220813751, -2040.4882857948542, -13446.676483124495, -3208.5211942344904, -6650.407901406288, -6897.90037766844, -4196.5632771626115, -4510.795437186956, -4098.286923993379, -4067.357753071934, -6915.273357678205, -3323.887375563383, -3713.330169379711, -9598.231076814234, -7774.2574300691485, -5760.115859523416, -13769.039330774918, -5807.537057235837, -3535.460806839168, -4697.322327584028, -3622.26715195179, -10050.223819098435, -4004.785691782832, -5793.139560941607, -3719.5231224000454, -4463.367666423321, -5868.55349894613, -6169.844003692269, -5143.8346625342965, -3511.730828896165, -7001.630702115595, -2600.404376041144, -4340.077105233446, -5949.857540072873, -6387.450625153258, -4023.9939002916217, -6865.263540610671, -8673.332924563438, -4819.267555266619, -6780.7712271511555, -5553.4480638206005, -8563.425809167325, -3689.3959345519543, -2610.8085111789405, -7001.1900194734335, -3502.2420745994896, -5718.363926418126, -7707.950624249876, -3042.5423759520054, -8674.485741581768, -3617.649199694395, -10396.031562112272, -2151.0468219071627, -4555.457034476101, -3829.627225639764, -4466.618988290429, -7070.23181180656, -7460.940309405327, -7406.018840618432, -7641.653419755399, -6109.095955759287, -3461.412620935589, -6108.638905256987, -3367.9067857414484, -3545.1978962421417, -6148.138431832194, -3026.2464737296104, -3648.377326540649, -2577.813368227333, -2802.916906826198, -6651.672483325005, -3295.9927216395736, -3752.597780019045, -3855.461843818426, -5496.1093291938305, -7082.153825003654, -3133.529867555946, -7417.407084345818, -9412.064698010683, -2973.032182894647, -3459.5915744379163, -4620.194367170334, -3726.407194070518, -5484.171107813716, -5858.557417109609, -4097.624510496855, -4200.940009787679, -7581.23284855485, -7990.8012836277485, -4500.7929442077875, -5500.261277213693, -5485.330031938851, -4538.557621467859, -3927.6435311585665, -8603.686783015728, -11970.877392845228, -8109.9568526782095, -4295.836211811751, -6551.246709421277, -5749.715451806784, -9784.019284248352, -2691.338758058846, -7558.722396563739], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405723254868063, "mean_inference_ms": 4.427315073245749, "mean_action_processing_ms": 4.207029565273589, "mean_env_wait_ms": 3.219470280451829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 262080, "timesteps_this_iter": 131040, "agent_timesteps_total": 262080, "timers": {"sample_time_ms": 31495.237, "sample_throughput": 4160.629, "load_time_ms": 29.653, "load_throughput": 4419103.64, "learn_time_ms": 14336.124, "learn_throughput": 9140.546, "update_time_ms": 2.25}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.09999999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 466.3082536817722, "policy_loss": 0.0027314254171493264, "vf_loss": 93.2586908921546, "vf_explained_var": -0.002028639491740948, "kl": 0.0006675169482673727, "entropy": -0.1631920552915997, "entropy_coeff": 0.001}}}, "num_steps_sampled": 262080, "num_agent_steps_sampled": 262080, "num_steps_trained": 262080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 262080}, "done": false, "episodes_total": 800, "training_iteration": 2, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-42-33", "timestamp": 1691019753, "time_this_iter_s": 38.600077867507935, "time_total_s": 77.24454951286316, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.24454951286316, "timesteps_since_restore": 262080, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.65636363636364, "ram_util_percent": 49.918181818181836}}
{"episode_reward_max": -2151.0468219071627, "episode_reward_min": -13769.039330774918, "episode_reward_mean": -5531.260075004562, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3208.5211942344904, -6650.407901406288, -6897.90037766844, -4196.5632771626115, -4510.795437186956, -4098.286923993379, -4067.357753071934, -6915.273357678205, -3323.887375563383, -3713.330169379711, -9598.231076814234, -7774.2574300691485, -5760.115859523416, -13769.039330774918, -5807.537057235837, -3535.460806839168, -4697.322327584028, -3622.26715195179, -10050.223819098435, -4004.785691782832, -5793.139560941607, -3719.5231224000454, -4463.367666423321, -5868.55349894613, -6169.844003692269, -5143.8346625342965, -3511.730828896165, -7001.630702115595, -2600.404376041144, -4340.077105233446, -5949.857540072873, -6387.450625153258, -4023.9939002916217, -6865.263540610671, -8673.332924563438, -4819.267555266619, -6780.7712271511555, -5553.4480638206005, -8563.425809167325, -3689.3959345519543, -2610.8085111789405, -7001.1900194734335, -3502.2420745994896, -5718.363926418126, -7707.950624249876, -3042.5423759520054, -8674.485741581768, -3617.649199694395, -10396.031562112272, -2151.0468219071627, -4555.457034476101, -3829.627225639764, -4466.618988290429, -7070.23181180656, -7460.940309405327, -7406.018840618432, -7641.653419755399, -6109.095955759287, -3461.412620935589, -6108.638905256987, -3367.9067857414484, -3545.1978962421417, -6148.138431832194, -3026.2464737296104, -3648.377326540649, -2577.813368227333, -2802.916906826198, -6651.672483325005, -3295.9927216395736, -3752.597780019045, -3855.461843818426, -5496.1093291938305, -7082.153825003654, -3133.529867555946, -7417.407084345818, -9412.064698010683, -2973.032182894647, -3459.5915744379163, -4620.194367170334, -3726.407194070518, -5484.171107813716, -5858.557417109609, -4097.624510496855, -4200.940009787679, -7581.23284855485, -7990.8012836277485, -4500.7929442077875, -5500.261277213693, -5485.330031938851, -4538.557621467859, -3927.6435311585665, -8603.686783015728, -11970.877392845228, -8109.9568526782095, -4295.836211811751, -6551.246709421277, -5749.715451806784, -9784.019284248352, -2691.338758058846, -7558.722396563739], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.365889136422101, "mean_inference_ms": 4.399395172349621, "mean_action_processing_ms": 4.130847978706502, "mean_env_wait_ms": 3.1791385456822474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 393120, "timesteps_this_iter": 131040, "agent_timesteps_total": 393120, "timers": {"sample_time_ms": 25855.582, "sample_throughput": 5068.151, "load_time_ms": 24.028, "load_throughput": 5453749.433, "learn_time_ms": 14366.479, "learn_throughput": 9121.233, "update_time_ms": 2.314}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04999999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 463.33416720325573, "policy_loss": -0.007044451004948282, "vf_loss": 92.67364253109074, "vf_explained_var": -0.0023689625724669424, "kl": 0.001457986970578978, "entropy": -0.16394369512475948, "entropy_coeff": 0.001}}}, "num_steps_sampled": 393120, "num_agent_steps_sampled": 393120, "num_steps_trained": 393120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 393120}, "done": false, "episodes_total": 800, "training_iteration": 3, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-42-47", "timestamp": 1691019767, "time_this_iter_s": 14.71030306816101, "time_total_s": 91.95485258102417, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 91.95485258102417, "timesteps_since_restore": 393120, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.061904761904762, "ram_util_percent": 50.39999999999999}}
{"episode_reward_max": -1388.4754733890295, "episode_reward_min": -13718.16498862207, "episode_reward_mean": -4453.324355117506, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5667.883632957935, -5257.825764164329, -2868.413005426526, -3339.880215421319, -6361.484523013234, -2828.1041064709425, -7209.0243623405695, -6918.359309442341, -3389.967569068074, -2527.47475220263, -4153.6501690633595, -2451.827266126871, -5134.743012264371, -2718.850368089974, -3612.6382502559572, -3926.135461822152, -4694.200022548437, -4979.894395805895, -4477.56215660274, -6982.663706274703, -4912.990357339382, -4012.930593162775, -4672.499955400825, -3262.7436543572694, -4425.668263651431, -5803.623458545655, -4668.923375301063, -6995.01401989162, -4318.885814294219, -3364.124921441078, -4500.760636374354, -5184.298701945692, -5143.867219559848, -4615.897233456373, -9935.449730850756, -4337.251541107893, -4018.3461290448904, -4040.889282392338, -3304.8971650227904, -3627.5830086022615, -3702.610745385289, -2532.071871355176, -4189.25356759876, -2002.2855651006103, -2192.41675812006, -3282.838156707585, -2045.3914766907692, -2468.107862390578, -2804.803849041462, -5934.472079128027, -2776.9976214915514, -7614.745769940317, -13026.644979462028, -3584.007909566164, -2282.848844559863, -4394.808303907514, -4790.087033584714, -3494.592706218362, -2458.1065235957503, -2334.688667625189, -3528.5448813289404, -2681.361661672592, -9944.735196534544, -2774.48938655667, -1435.2094528451562, -7810.765109181404, -5652.004217669368, -2843.9275933355093, -3191.086954532191, -6313.682129783556, -6810.124954581261, -4611.930020838976, -3766.0127417594194, -3158.7724760640413, -2888.326020807028, -9467.025126352906, -1901.1293799132109, -1964.0743397772312, -3592.8622475862503, -3549.354204460513, -3589.710346378386, -2033.8730960935354, -5392.217004597187, -5503.267719894648, -3818.0264791212976, -2508.1280353069305, -2868.1074748989195, -3274.7461095899343, -5935.365096129477, -3964.756838992238, -4581.586172115058, -4053.3831302560866, -6743.183458968997, -4142.224196836352, -2475.674025915563, -2842.036721728742, -4789.088022232056, -6085.153041899204, -3191.011924177408, -8348.721208304167, -5573.040452480316, -4359.966562837362, -3349.93921546638, -5475.466054942459, -5968.253793716431, -2921.0616107955575, -5099.562347695231, -7818.315927900374, -2598.6999478191137, -5366.192227467895, -8285.622012045234, -4611.845558829606, -4117.607268528547, -2706.2911469191313, -11512.604252964258, -4417.096033735201, -4736.809620887041, -3493.313220113516, -7913.87382312119, -5458.725021868944, -4215.533251807094, -3152.9214979857206, -3592.397493299097, -5928.686434149742, -2831.427026875317, -3634.973063837737, -4031.718825308606, -5621.353258281946, -3194.290297344327, -2590.710024394095, -9196.703554768115, -2393.9555194973946, -4264.95165233314, -5060.120482310653, -2778.248072717339, -2537.802989989519, -6116.343883838505, -5028.585406681523, -2343.6043408960104, -6821.514091581106, -2925.0817741006613, -3242.0556218363345, -5043.058388311416, -5616.892827197909, -8690.061796046793, -4651.736221961677, -2625.2248764932156, -3207.126403942704, -2921.3362766951323, -10344.00366269797, -11562.535097721964, -4193.918586708605, -3815.5629301071167, -6357.033490523696, -3846.064893618226, -2602.653663886711, -1732.7881194725633, -8595.627912342548, -5635.076088860631, -2529.8026864062995, -4772.712102331221, -5789.465861476958, -2866.654760979116, -6030.851959109306, -5593.103337425739, -4134.3399165049195, -2582.270252171904, -4173.035738565028, -4048.676341570914, -5945.10559194535, -3862.7569619342685, -3301.2671512775123, -3799.873801186681, -4347.707988888025, -4791.564539939165, -4200.039423679002, -4778.118882678449, -2934.8836388774216, -3663.9617097750306, -8156.625083118677, -6510.65916788578, -3911.2891677245498, -6114.758031338453, -2777.380581393838, -4236.246515028179, -4246.097390331328, -4916.357169821858, -3590.624460399151, -3161.662697046995, -6587.32906922698, -4693.554772719741, -5089.515186667442, -4117.926956489682, -4238.598694536835, -3407.233372025192, -3782.7609552890062, -4657.8350694179535, -4797.677662417293, -2161.5385660007596, -6765.283445224166, -3909.3977678865194, -4605.816641457379, -3358.7092714980245, -6600.02464851737, -5137.81953907758, -4146.120972588658, -5367.186105132103, -5851.307237908244, -3223.845027655363, -2436.4905940517783, -5253.060200892389, -3932.2271094694734, -6463.133924536407, -3746.5781158693135, -5644.966770857573, -2101.2594936415553, -4355.608134459704, -3270.240630738437, -2952.459636926651, -3977.4840814992785, -5104.8017228245735, -10358.114852264524, -3946.5862830355763, -4146.84540887177, -3773.1648312807083, -3835.6051625311375, -2930.0324998945, -2161.136631976813, -4252.875287622213, -8355.887958422303, -5253.401908673346, -1980.7866092175245, -3497.5970105975866, -3720.001022543758, -3011.2873687781394, -4847.227562516928, -2653.91768816486, -2091.0754110962152, -3313.074553783983, -5981.084474399686, -3288.050473205745, -4219.814387355, -2466.353364944458, -4684.529648259282, -6431.8029441311955, -4728.913679944351, -1899.6417109519243, -3291.478148072958, -3134.1809449866414, -3901.574045624584, -2662.51828866452, -2143.688957579434, -2846.2703101560473, -5420.751171775162, -2990.295024678111, -2425.1568221002817, -5148.767018288374, -3639.0173437595367, -3923.1972074732184, -2800.824975386262, -2814.4054160322994, -2687.6046726703644, -2998.2747913450003, -6034.406924918294, -2157.312604404986, -3037.3196735978127, -4384.208531007171, -3932.4850860498846, -3449.911624804139, -2805.505503123626, -9918.453772082925, -4222.316863119602, -5194.352529615164, -4564.953680908307, -2754.9930145442486, -3313.9821646288037, -1943.1499126404524, -4236.429998114705, -6771.109389115125, -3194.805113501847, -5303.1013619713485, -11380.512809492648, -3154.3189718723297, -2509.9907847866416, -6502.636663176119, -5772.5690945237875, -3010.402915932238, -8474.550473749638, -7652.950210798532, -5757.35225665383, -13156.816354114562, -5112.70643197, -12865.031444385648, -4197.023719586432, -9923.990825280547, -6071.279183901846, -3178.197633370757, -4253.165696762502, -4684.732888370752, -5887.097872130573, -5493.840402662754, -5637.997557522729, -3042.8382023647428, -4156.827906129882, -1992.0683521926403, -6503.738870829344, -4073.6758404821157, -3543.8099596090615, -4005.1591237559915, -3734.044372484088, -4336.93899422884, -3530.4595750570297, -6681.896136857569, -2455.7528610005975, -3464.871165830642, -8186.249520786107, -3317.3980343937874, -3695.040612395853, -2966.360590266064, -5397.031410556287, -4454.388197626919, -2599.1184734404087, -4545.283392727375, -3677.201619312167, -6913.7251794599, -3428.2292759418488, -3716.5404364690185, -8289.604694321752, -3238.044737186283, -3658.7701146416366, -4920.958405852318, -3497.626308172941, -3241.9318910669535, -2669.4594386592507, -3811.1217683553696, -3605.7315543293953, -5053.2525550778955, -1388.4754733890295, -4480.561931181699, -2742.7969772294164, -6410.152219265699, -2500.3517481945455, -5042.544221974909, -5163.621137306094, -2431.9536150470376, -5360.459507271647, -2330.198645029217, -4959.71189538762, -5453.2098755687475, -2073.2335907667875, -4295.176137472503, -4457.334507912397, -4385.991296499968, -1965.6208230741322, -2388.010570317507, -3835.426464743912, -3393.7209605127573, -2488.330364242196, -2329.908087104559, -4213.24849550426, -2421.6225319951773, -5589.364212810993, -6603.39007396996, -6270.803450137377, -5188.171556726098, -4776.633655667305, -3754.256966046989, -3025.4719498232007, -3240.2265531793237, -4171.652354620397, -2216.5663638245314, -2341.9081669151783, -3420.130679771304, -5479.928735226393, -6208.317727923393, -4857.144693437964, -4511.62851922214, -2845.4228532277048, -2372.1054690629244, -5143.090588375926, -2866.746257469058, -2168.768428232521, -3573.7232233285904, -3953.2341156452894, -3986.182279318571, -7502.502387955785, -2803.3158126473427, -5358.155641257763, -13718.16498862207, -5562.880595728755, -7265.610485598445, -5868.965957839042, -6460.671831771731, -4472.281888619065, -4920.64852617681, -4239.937861919403, -3908.666815470904, -3024.8025866001844, -5571.686937168241, -3068.1269430965185, -3969.7840441316366, -5036.339848481119, -5539.086460182443, -5740.527435079217, -9438.101642817259, -4087.3539579696953, -2930.7020433731377, -2709.3369220495224, -5810.435315411538, -3008.227328389883, -4456.298519998789, -6015.190450012684, -4236.879544600844, -2818.864838641137, -6180.145736865699, -6964.648722670972, -2940.451398715377, -5443.636321097612, -2537.2693789564073, -3113.0782559514046, -8941.917712286115, -2978.9343920350075, -3447.596141576767, -3158.825204049237, -4190.639859054238, -2267.6007145941257, -3709.02913043648, -4356.0442309603095, -7053.417948156595, -3093.897784454748, -5400.045835176483, -2210.9620388932526, -3554.5282149091363, -3886.383374929428, -7850.742530543357, -3385.3675558269024, -3858.2602499574423, -4103.414348565042, -2774.0907537676394, -5517.975676968694, -3263.991144359112, -2693.5060501396656, -2984.844586879015, -3119.4550527483225, -4559.024476446211, -3607.304160013795, -4968.234436020255, -5086.722546797246, -4469.641914188862, -4580.60043643415, -3068.575943131, -5451.358338624239, -5335.109684467316, -4995.246061645448, -2441.1325538158417, -2630.7059815116227, -7203.439132466912, -3385.209750458598, -2965.7718264609575, -8995.436045825481, -8188.759951591492, -2415.7962205410004, -4166.753904014826, -4071.914806008339, -2833.2416163384914, -4544.882297663949, -4562.270106986165, -2985.362286178395, -4686.883834153414, -4650.4699344448745, -3614.94750200212, -3815.8151211701334, -3487.3686341792345, -2210.621024161577, -2902.616352684796, -4938.000426843762, -6909.524221129715, -6603.94869402051, -4547.767942205071, -4338.1932091116905], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.38471399256173, "mean_inference_ms": 4.436120683526414, "mean_action_processing_ms": 4.202814172023111, "mean_env_wait_ms": 3.2261938927620544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 524160, "timesteps_this_iter": 131040, "agent_timesteps_total": 524160, "timers": {"sample_time_ms": 29005.401, "sample_throughput": 4517.779, "load_time_ms": 26.314, "load_throughput": 4979832.256, "learn_time_ms": 14366.12, "learn_throughput": 9121.461, "update_time_ms": 2.297}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.024999999999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 462.8777177109236, "policy_loss": 0.010888293728531019, "vf_loss": 92.56446491091054, "vf_explained_var": -0.0009181025207683605, "kl": 0.0011419621421394864, "entropy": -0.16311644813493162, "entropy_coeff": 0.001}}}, "num_steps_sampled": 524160, "num_agent_steps_sampled": 524160, "num_steps_trained": 524160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 524160}, "done": false, "episodes_total": 1280, "training_iteration": 4, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-43-26", "timestamp": 1691019806, "time_this_iter_s": 38.40085005760193, "time_total_s": 130.3557026386261, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 130.3557026386261, "timesteps_since_restore": 524160, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.72363636363637, "ram_util_percent": 50.35636363636365}}
{"evaluation": {"episode_reward_max": -6050.377343073487, "episode_reward_min": -6050.377343073487, "episode_reward_mean": -6050.377343073487, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6050.377343073487], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -2168.768428232521, "episode_reward_min": -13718.16498862207, "episode_reward_mean": -4512.915536348671, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2866.746257469058, -2168.768428232521, -3573.7232233285904, -3953.2341156452894, -3986.182279318571, -7502.502387955785, -2803.3158126473427, -5358.155641257763, -13718.16498862207, -5562.880595728755, -7265.610485598445, -5868.965957839042, -6460.671831771731, -4472.281888619065, -4920.64852617681, -4239.937861919403, -3908.666815470904, -3024.8025866001844, -5571.686937168241, -3068.1269430965185, -3969.7840441316366, -5036.339848481119, -5539.086460182443, -5740.527435079217, -9438.101642817259, -4087.3539579696953, -2930.7020433731377, -2709.3369220495224, -5810.435315411538, -3008.227328389883, -4456.298519998789, -6015.190450012684, -4236.879544600844, -2818.864838641137, -6180.145736865699, -6964.648722670972, -2940.451398715377, -5443.636321097612, -2537.2693789564073, -3113.0782559514046, -8941.917712286115, -2978.9343920350075, -3447.596141576767, -3158.825204049237, -4190.639859054238, -2267.6007145941257, -3709.02913043648, -4356.0442309603095, -7053.417948156595, -3093.897784454748, -5400.045835176483, -2210.9620388932526, -3554.5282149091363, -3886.383374929428, -7850.742530543357, -3385.3675558269024, -3858.2602499574423, -4103.414348565042, -2774.0907537676394, -5517.975676968694, -3263.991144359112, -2693.5060501396656, -2984.844586879015, -3119.4550527483225, -4559.024476446211, -3607.304160013795, -4968.234436020255, -5086.722546797246, -4469.641914188862, -4580.60043643415, -3068.575943131, -5451.358338624239, -5335.109684467316, -4995.246061645448, -2441.1325538158417, -2630.7059815116227, -7203.439132466912, -3385.209750458598, -2965.7718264609575, -8995.436045825481, -8188.759951591492, -2415.7962205410004, -4166.753904014826, -4071.914806008339, -2833.2416163384914, -4544.882297663949, -4562.270106986165, -2985.362286178395, -4686.883834153414, -4650.4699344448745, -3614.94750200212, -3815.8151211701334, -3487.3686341792345, -2210.621024161577, -2902.616352684796, -4938.000426843762, -6909.524221129715, -6603.94869402051, -4547.767942205071, -4338.1932091116905], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3584375868238725, "mean_inference_ms": 4.416567271348948, "mean_action_processing_ms": 4.146171278635953, "mean_env_wait_ms": 3.19472578794794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 655200, "timesteps_this_iter": 131040, "agent_timesteps_total": 655200, "timers": {"sample_time_ms": 26137.346, "sample_throughput": 5013.516, "load_time_ms": 23.643, "load_throughput": 5542473.445, "learn_time_ms": 14464.216, "learn_throughput": 9059.599, "update_time_ms": 2.291}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012499999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 462.98150231814856, "policy_loss": 0.009664790465201622, "vf_loss": 92.5864486694336, "vf_explained_var": -0.0007166333736911897, "kl": 0.0016406425262390765, "entropy": -0.16820969416569637, "entropy_coeff": 0.001}}}, "num_steps_sampled": 655200, "num_agent_steps_sampled": 655200, "num_steps_trained": 655200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 655200}, "done": false, "episodes_total": 1280, "training_iteration": 5, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-45-11", "timestamp": 1691019911, "time_this_iter_s": 104.73156309127808, "time_total_s": 235.08726572990417, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 235.08726572990417, "timesteps_since_restore": 655200, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.65302013422819, "ram_util_percent": 67.5006711409396}}
{"episode_reward_max": -1182.6284685730934, "episode_reward_min": -10565.660808637738, "episode_reward_mean": -3272.960589501376, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4537.963249981403, -4789.457354042679, -3071.768122114241, -3550.651148159057, -3207.8421617150307, -3039.9382196217775, -3247.2000203579664, -3034.222844481468, -3168.2126352805644, -4359.5942177549005, -2442.220920279622, -2368.2865640968084, -2325.744565989822, -6162.942148387432, -4052.7889081574976, -3529.9006259664893, -4302.516256019473, -3302.335945252329, -1960.7268087044358, -8372.961731404066, -4773.28065004386, -4388.117530673742, -2611.4241856113076, -4892.036245342344, -2181.339162863791, -3292.7905304580927, -4068.278632134199, -5527.663831658661, -2379.819904819131, -2846.1356175765395, -4419.524481534958, -3181.7456460520625, -3247.766511529684, -2172.0532749071717, -3930.3796256519854, -2488.98367151618, -2782.9115085974336, -2805.242096826434, -1723.3982399851084, -2305.9834396075457, -3820.6412332952023, -2531.395546492189, -2440.2293372899294, -5833.010559979826, -2669.309836424887, -2761.989508152008, -1871.8653508797288, -2603.5925353672355, -3327.8995445519686, -4555.2021629065275, -3150.6356412768364, -2827.4513598531485, -1656.4376435130835, -2142.852619752288, -1654.6755025684834, -2687.447153773159, -2543.1081628501415, -2014.1318035274744, -3402.53937754035, -2618.7296988721937, -1833.3984449356794, -3379.446613177657, -2042.2471033260226, -2113.8006996773183, -1888.8189836740494, -3361.7720177695155, -3321.5571425259113, -2727.6585358530283, -4253.095308378339, -1675.3167143315077, -2463.039464764297, -4363.957451067865, -2474.016859009862, -2724.0318050533533, -3970.5682286806405, -2048.557291172445, -2629.412455622107, -3180.649134926498, -2205.572996892035, -1402.4605084881186, -7887.611688628793, -2297.364701844752, -3005.339687772095, -1960.3145530484617, -3409.7353245802224, -2987.1680562756956, -4325.416988492012, -1465.3931654598564, -1938.7041922919452, -3957.7944992631674, -3110.661738358438, -1860.491825684905, -1916.45492836833, -2578.599102936685, -2630.949814736843, -10565.660808637738, -2931.6627881117165, -2924.6388598270714, -5692.089242635295, -1835.0769980289042, -3266.9187000356615, -4462.809030324221, -4671.384704567492, -3081.6417413800955, -3644.957397416234, -2961.443632081151, -2434.439913202077, -2051.025904752314, -3122.121649429202, -1939.2791748195887, -4288.943768657744, -3718.5512763783336, -2937.6064201444387, -9504.734312452376, -3851.9456724226475, -3583.252220541239, -5916.4089479371905, -2427.889195173979, -2509.0168097652495, -4018.812323912978, -3442.1892563551664, -1481.3175591155887, -2875.29591492936, -3776.762233376503, -6440.1111361682415, -2203.342930212617, -6202.524819895625, -3620.9043441712856, -1805.5232057124376, -3407.0262029394507, -7411.377768307924, -3994.3698499575257, -2326.8214577287436, -1835.3988357186317, -3135.6386757716537, -5907.265005649999, -1801.7229350358248, -2668.262206705287, -1652.871597159654, -3489.1813686070964, -2748.9982674811035, -2430.3547852635384, -2852.033142639324, -2709.264862552285, -2247.6247161328793, -5256.498507708311, -4080.4542615413666, -2802.114568129182, -6592.5026807151735, -2138.314688593149, -3980.5896355211735, -2151.530878327787, -4037.9795377478004, -2271.2541260942817, -3387.1084377467632, -1896.6831589527428, -4230.954226857051, -2108.320321880281, -1849.5211764872074, -3870.0070315226912, -1608.7501178830862, -2221.20592680946, -2172.122818157077, -4633.887766845524, -3772.3373268544674, -2209.2843565642834, -3104.942152634263, -8615.018233362585, -2416.411955617368, -2351.120474368334, -3505.248457815498, -1606.7968329638243, -4887.234579905868, -2158.703755661845, -2487.098244383931, -2479.4373522661626, -1589.3315017819405, -1182.6284685730934, -3509.833051994443, -6637.028277873993, -2060.5761669054627, -4777.4729365333915, -3491.2232192084193, -3018.083553241566, -1735.5128508359194, -5719.306575655937, -3526.8106367886066, -5717.031408548355, -1824.5671053528786, -2595.244082050398, -1674.3288569003344, -2146.956163480878, -4935.501233145595, -3112.477282613516, -2400.631220161915, -3448.9450503736734, -3859.6903192084283, -2245.4371380507946, -3288.371810257435, -8724.564011767507, -5555.391157068312, -2686.807851076126, -2945.5756176114082, -2418.27456831187, -3055.726699952036, -5851.089138761163, -7593.166327569634, -5281.94101466611, -2815.531548317522, -5234.610017001629, -9722.361259527504, -3809.8476611226797, -4711.831422433257, -3933.648635376245, -4182.630202695727, -3622.9062467366457, -2309.816084690392, -3346.918134763837, -5322.26862771064, -8653.401286628097, -3080.8601549919695, -6181.054002866149, -2698.3520674854517, -3058.4727998897433, -4164.309329010546, -4174.178681530058, -4613.548089876771, -2363.9130082521588, -1946.0856248140335, -3213.8851860314608, -3196.676953405142, -2495.227859377861, -2852.522263355553, -3171.330036856234, -2702.90131136775, -2875.7952854186296, -1784.7993461042643, -1985.1583157479763, -3597.789235850796, -1467.5231170356274, -1780.5840833634138, -3376.6496306732297, -2293.528086915612, -3093.5679931119084, -2393.4221625477076, -5914.8850229121745, -1708.8846987113357, -3179.382620200515, -2194.9683796232566, -3948.5395078510046, -2060.363148123026, -2289.9784329235554, -2411.9260532557964, -1780.0772080272436, -2541.672513321042, -1745.9781836643815, -1561.5742715485394, -1576.8227405287325, -2867.3982287682593, -3620.899650618434, -5112.664720609784, -4798.400326043367, -2373.342636331916, -1746.6531114801764, -2341.1186845600605, -1847.8311347290874, -2271.686906784773, -3817.0181632339954, -1197.25610563159, -2807.7533044815063, -2500.2568369731307, -4428.38990342617, -3379.7216072678566, -4566.170477554202, -7424.395089894533, -2477.258623354137, -3129.1984683573246, -3153.722568243742, -3128.9185743406415, -7572.802223894745, -2146.087045993656, -4868.294451445341, -2408.0080767422915, -1708.1133511066437, -1924.0276151187718, -2084.1854280531406, -2117.2514298558235, -5947.718759462237, -3499.373945631087, -5094.586056016386, -3312.6840654877014, -2519.6333127841353, -3225.0473634535447, -5967.999687060714, -2073.3768158107996, -7446.587638694793, -6902.227865979075, -6645.259051438421, -4453.324612572789, -2824.3050860092044, -4449.058357335627, -5395.86776182428, -3813.017537601292, -2271.49947206676, -5945.794433359057, -3818.242840692401, -2030.468587949872, -2097.2365880459547, -6757.8495707809925, -2529.357820045203, -3504.999497503042, -2172.1818781532347, -2925.858912218362, -3226.9796861596406, -6119.060750953853, -3856.049674971029, -3055.9568689912558, -4015.253663033247, -2528.36018743366, -3575.0235030949116, -1990.135448910296, -2468.185409218073, -2130.5743311941624, -2491.152649179101, -1605.4398899972439, -3746.585744559765, -2404.4003100544214, -3333.440557989292, -2001.3308215215802, -2169.973519049585, -2646.094301775098, -2586.7459530234337, -2562.631476804614, -2631.8066473454237, -2511.2339535802603, -3641.3048955723643, -5917.678718842566, -2892.9302998818457, -6478.162285961211, -3260.970294728875, -3512.9966379478574, -2217.792769677937, -2375.9918783009052, -2929.144682213664, -4243.223676837981, -1670.8677374832332, -2460.2511138543487, -2892.154321461916, -6023.454789571464, -2638.3179159667343, -2677.66329613328, -2879.4883213341236, -2348.051650365349, -3963.6424793824553, -4564.518738374114, -2005.6972069814801, -2941.361842751503, -2026.3902519270778, -2434.290567651391, -2573.550748191774, -1286.2165679074824, -2209.9199854135513, -2591.5903919115663, -2035.3047993555665, -2106.353804089129, -3162.1317041516304, -2183.184142474085, -3030.0125356167555, -2492.541381932795, -2843.6507179513574, -5349.239239562303, -2467.448478579521, -3371.719837486744, -2329.5744086951017, -2808.146047553979, -1641.5834363028407, -1934.4583635926247, -2081.0289014577866, -2251.545499444008, -1501.673271652311, -1464.969274573028, -3462.8037634734064, -2408.7194436900318, -1854.669785246253, -3441.2217156086117, -4290.68360953778, -2811.3294522464275, -3747.7112586200237, -2198.72796344012, -2657.6861289441586, -1851.6894441097975, -4915.420831032097, -4252.681793421507, -4219.005080297589, -3253.843521602452, -4253.721376396716, -7666.813191510737, -2723.4875528514385, -2159.4723800867796, -7262.741604149342, -5555.409543640912, -5818.719003625214, -4291.783667773008, -2225.6477292254567, -3070.0570937544107, -4202.208149969578, -4352.557376123965, -2238.600339218974, -3426.1643690764904, -2184.204403081909, -4359.913039647043, -1855.0257171876729, -2479.2736292034388, -3356.9292329773307, -4818.26697036624, -4994.7650426626205, -3184.258054781705, -1239.3824790343642, -1604.7935871630907, -2057.7679368183017, -1620.9742201566696, -4200.545770034194, -2632.758031517267, -2366.3941149115562, -2949.9336033016443, -2272.71513697505, -1568.8144066743553, -2591.5991753935814, -3191.5404084399343, -1741.0267736427486, -2935.8440333008766, -1422.3896364495158, -2298.3398282527924, -3062.852403536439, -3317.610272973776, -2227.9544964432716, -4795.7166343182325, -3004.6857545413077, -3526.971011042595, -2331.804263148457, -3104.831498980522, -2789.104320485145, -3722.3801490291953, -1218.689270451665, -2396.002502411604, -2249.9675597697496, -1619.9085669368505, -3176.7516762018204, -1688.193431608379, -2366.9604284241796, -2426.4006462544203, -1365.2766561433673, -2631.0502059310675, -3472.7028965353966, -1852.7753479629755, -4858.4897287115455, -2275.2397141233087, -4484.450665265322, -3016.397306330502, -2065.130589004606, -1575.9429274834692, -2237.382791195065, -2559.3133905529976, -6703.843359801918, -2649.746819834225, -2214.9349493831396, -1318.1994035877287, -5569.846091791987, -4120.424000624567, -3581.1152303293347, -3499.522541195154, -3293.2669613258913, -4725.188467361033, -1684.9892177730799, -2143.7124381810427, -2915.8251822553575, -2089.6234777029604, -8027.649748723954, -3500.5838999450207, -2414.570310458541], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408298852617649, "mean_inference_ms": 4.471283597495934, "mean_action_processing_ms": 4.206340143097317, "mean_env_wait_ms": 3.2456978564610295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 786240, "timesteps_this_iter": 131040, "agent_timesteps_total": 786240, "timers": {"sample_time_ms": 43288.719, "sample_throughput": 3027.117, "load_time_ms": 24.656, "load_throughput": 5314641.244, "learn_time_ms": 14512.14, "learn_throughput": 9029.681, "update_time_ms": 2.301}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.006249999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 455.9418820590126, "policy_loss": 0.007504881599406199, "vf_loss": 91.18069514066087, "vf_explained_var": 0.00014864116586664673, "kl": 0.0014144495725832797, "entropy": -0.16926133082545358, "entropy_coeff": 0.001}}}, "num_steps_sampled": 786240, "num_agent_steps_sampled": 786240, "num_steps_trained": 786240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 786240}, "done": false, "episodes_total": 1760, "training_iteration": 6, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-45-50", "timestamp": 1691019950, "time_this_iter_s": 39.32777166366577, "time_total_s": 274.41503739356995, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 274.41503739356995, "timesteps_since_restore": 786240, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 46.044642857142854, "ram_util_percent": 53.42678571428571}}
{"episode_reward_max": -1218.689270451665, "episode_reward_min": -8027.649748723954, "episode_reward_mean": -3118.799808812924, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1464.969274573028, -3462.8037634734064, -2408.7194436900318, -1854.669785246253, -3441.2217156086117, -4290.68360953778, -2811.3294522464275, -3747.7112586200237, -2198.72796344012, -2657.6861289441586, -1851.6894441097975, -4915.420831032097, -4252.681793421507, -4219.005080297589, -3253.843521602452, -4253.721376396716, -7666.813191510737, -2723.4875528514385, -2159.4723800867796, -7262.741604149342, -5555.409543640912, -5818.719003625214, -4291.783667773008, -2225.6477292254567, -3070.0570937544107, -4202.208149969578, -4352.557376123965, -2238.600339218974, -3426.1643690764904, -2184.204403081909, -4359.913039647043, -1855.0257171876729, -2479.2736292034388, -3356.9292329773307, -4818.26697036624, -4994.7650426626205, -3184.258054781705, -1239.3824790343642, -1604.7935871630907, -2057.7679368183017, -1620.9742201566696, -4200.545770034194, -2632.758031517267, -2366.3941149115562, -2949.9336033016443, -2272.71513697505, -1568.8144066743553, -2591.5991753935814, -3191.5404084399343, -1741.0267736427486, -2935.8440333008766, -1422.3896364495158, -2298.3398282527924, -3062.852403536439, -3317.610272973776, -2227.9544964432716, -4795.7166343182325, -3004.6857545413077, -3526.971011042595, -2331.804263148457, -3104.831498980522, -2789.104320485145, -3722.3801490291953, -1218.689270451665, -2396.002502411604, -2249.9675597697496, -1619.9085669368505, -3176.7516762018204, -1688.193431608379, -2366.9604284241796, -2426.4006462544203, -1365.2766561433673, -2631.0502059310675, -3472.7028965353966, -1852.7753479629755, -4858.4897287115455, -2275.2397141233087, -4484.450665265322, -3016.397306330502, -2065.130589004606, -1575.9429274834692, -2237.382791195065, -2559.3133905529976, -6703.843359801918, -2649.746819834225, -2214.9349493831396, -1318.1994035877287, -5569.846091791987, -4120.424000624567, -3581.1152303293347, -3499.522541195154, -3293.2669613258913, -4725.188467361033, -1684.9892177730799, -2143.7124381810427, -2915.8251822553575, -2089.6234777029604, -8027.649748723954, -3500.5838999450207, -2414.570310458541], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.397534413808405, "mean_inference_ms": 4.465743347298947, "mean_action_processing_ms": 4.162330899218123, "mean_env_wait_ms": 3.226935975234395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 917280, "timesteps_this_iter": 131040, "agent_timesteps_total": 917280, "timers": {"sample_time_ms": 39251.479, "sample_throughput": 3338.473, "load_time_ms": 22.97, "load_throughput": 5704918.168, "learn_time_ms": 14565.944, "learn_throughput": 8996.327, "update_time_ms": 2.291}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031249999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 454.02510676986884, "policy_loss": -0.0032612669283357365, "vf_loss": 90.80810006801373, "vf_explained_var": 0.0016333888081239544, "kl": 0.002015820667786043, "entropy": -0.17765416773737117, "entropy_coeff": 0.001}}}, "num_steps_sampled": 917280, "num_agent_steps_sampled": 917280, "num_steps_trained": 917280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 917280}, "done": false, "episodes_total": 1760, "training_iteration": 7, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-46-05", "timestamp": 1691019965, "time_this_iter_s": 15.130133867263794, "time_total_s": 289.54517126083374, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 289.54517126083374, "timesteps_since_restore": 917280, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.836363636363636, "ram_util_percent": 54.0}}
{"episode_reward_max": -801.5893338248134, "episode_reward_min": -11355.863615784794, "episode_reward_mean": -2270.599588691185, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2835.858727745712, -1669.5887649804354, -2736.957743488252, -3631.469838179648, -1400.1677046567202, -1543.596258148551, -2102.3423629552126, -9433.005541577935, -3111.515114620328, -2324.252693966031, -2566.5468526668847, -1485.1051711142063, -1918.7726596929133, -2931.1088654845953, -3195.433944247663, -2423.943884052336, -2483.377931430936, -5159.889581337571, -2505.867903254926, -3260.810750834644, -1870.0016583595425, -2355.9042707681656, -4046.636707648635, -1632.5678083635867, -2301.2292770445347, -3438.254617497325, -1843.604434043169, -3018.686971768737, -2853.4221582692116, -5142.345290288329, -2028.7054799571633, -1506.0858567729592, -1359.6739890873432, -1869.135638229549, -1928.6644480526447, -1563.352529346943, -1432.916047990322, -2294.7291774712503, -2223.4871943742037, -1342.8083535134792, -1627.6531045287848, -2092.606309622526, -1661.5810815393925, -1959.1896860571578, -2132.1332181170583, -2249.2294622585177, -1339.5417106598616, -1498.931466832757, -1416.2462848424911, -2169.2953820824623, -969.9148537218571, -2170.671574369073, -2099.403237428516, -1193.9848559629172, -1008.6812864094973, -2140.6980259865522, -1436.5280095599592, -1357.4201120883226, -1657.3782413452864, -2440.5207977741957, -1839.6588126197457, -1644.2881619632244, -1265.2864509373903, -1694.178311318159, -1829.529109224677, -2776.374507471919, -1237.8696773201227, -1690.9543352276087, -2167.23635661602, -1665.3890929818153, -1734.0218667741865, -1301.5214811116457, -1917.9077527150512, -1976.2860742881894, -1893.7674803994596, -4056.8222395703197, -1571.4881541579962, -1959.5430503413081, -2971.638368189335, -1115.6477201078087, -1500.0697716847062, -1557.8720331341028, -2864.413481220603, -3753.657621219754, -1653.214435979724, -2197.080944404006, -1656.953557394445, -3075.561829611659, -1494.5135317444801, -3137.392710968852, -2696.8133932948112, -1532.494546495378, -3997.7600067332387, -1744.4549350887537, -1994.7518038544804, -1453.5220264978707, -2661.323315449059, -2980.7890596464276, -3686.7514879070222, -5644.7148948684335, -2819.4541718810797, -3797.953744372353, -2520.869653452188, -2467.1280860602856, -1604.6907494813204, -4611.668293714523, -2533.1002790927887, -1736.3172280229628, -1468.5794796310365, -1777.5512921512127, -3308.641487315297, -1288.3891256004572, -3388.398326009512, -1888.1862238049507, -1957.027063820511, -4879.312609530985, -3113.5069707464427, -4877.331414483488, -2780.3239932358265, -2011.9048195928335, -1895.5706319380552, -2399.2757784686983, -2599.4781260080636, -2335.110282510519, -1812.3279053121805, -1559.082544406876, -1961.004890408367, -2162.0600479096174, -2530.6626267433167, -1581.3503189906478, -1989.4231679737568, -1349.269206687808, -1334.9954908266664, -1574.5350889116526, -1681.2982088774443, -955.2026381921023, -3083.2527246400714, -1914.870031952858, -1323.3903740383685, -2768.5496794730425, -1483.144375924021, -1474.4824779629707, -1391.0602950677276, -2168.8027963470668, -2701.426761288196, -2062.0482307970524, -1653.2274331785738, -1263.1080815009773, -1866.609749082476, -2109.001126639545, -1353.9176898114383, -2161.036369238049, -1209.2019212022424, -1210.7918943464756, -1896.3405283875763, -1496.0361233651638, -1459.785751119256, -2536.4182002320886, -2660.2174417078495, -1739.044442385435, -1433.8616574704647, -1583.767029620707, -1425.5672531574965, -1942.2455834150314, -1274.9534158110619, -2039.4438433274627, -1549.6357557922602, -1902.7712712138891, -3308.8042600154877, -3513.2013438753784, -2375.0089605897665, -1615.38294493407, -1586.3181065693498, -2324.8701328337193, -2345.0898333080113, -2214.0792165845633, -1590.0227458104491, -1031.6117130368948, -2342.8291450440884, -1401.032188743353, -2154.4277669265866, -1541.6842855662107, -1126.1751153878868, -1409.664106540382, -1883.1478987038136, -4173.277907401323, -2234.8301606476307, -3346.656305961311, -929.0599667876959, -1164.8440116159618, -1266.539146244526, -2065.0699397958815, -3639.9790006130934, -2893.0208726003766, -2366.029551461339, -1910.067012630403, -1767.7556387037039, -2357.82128444314, -1598.801204442978, -4120.831292027608, -2186.7369770109653, -1727.5550647452474, -2638.356807783246, -3604.157537107356, -2471.919258520007, -2601.7050525695086, -4807.271373711526, -1503.3558118343353, -11355.863615784794, -1634.3787212595344, -3785.6286775693297, -4231.209571752697, -3345.4257716368884, -3533.2896812707186, -1756.207548694685, -2303.8747558146715, -1493.6459996178746, -2586.051162039861, -3045.1333321779966, -3370.8506722878665, -2863.2692162916064, -3685.4408686459064, -2159.4757392555475, -1471.75823430717, -1369.7858935445547, -2307.0944679155946, -4667.245323091745, -2120.6746476069093, -3701.105945184827, -1509.9658834189177, -1614.6121757030487, -1405.5891400277615, -3434.7580132335424, -1485.1209280192852, -1527.0022487193346, -1392.2384215965867, -1471.7733647152781, -1280.787773925811, -1787.307108297944, -1328.0495645925403, -1345.8309086039662, -1160.1556972116232, -2366.3665165379643, -2361.703263528645, -1794.7086600661278, -4073.568211570382, -1470.9476783238351, -920.082248730585, -2279.779394738376, -1136.3371972590685, -2523.3113873898983, -1610.1509355306625, -1456.3931583240628, -1470.2194045186043, -1197.8472489267588, -1523.893120676279, -1193.4487194418907, -1672.3164963498712, -1438.4725094139576, -2903.36257211864, -1789.1191143132746, -1494.386354573071, -1152.7722752988338, -1311.2453573718667, -3270.859972447157, -2633.5458731502295, -2487.208687737584, -2022.6865874230862, -3483.357058122754, -1278.7645679339767, -2838.1383879706264, -1568.2703004181385, -1629.365060403943, -884.3447166010737, -1629.4974788874388, -1259.8829384297132, -1374.4545123055577, -1445.654490813613, -2628.8964360132813, -2775.3762807548046, -3394.3926294595003, -1613.2492971532047, -1762.1310661882162, -2506.4516624063253, -1628.6350409761071, -1838.7111658267677, -1243.4182609021664, -1169.6354341171682, -1652.0834450796247, -8209.669554173946, -2115.0664763376117, -2261.1535583138466, -2773.76441321522, -2734.101722203195, -2627.86800904572, -3078.2803543135524, -1923.9525139033794, -1804.2016869410872, -3043.388235166669, -2865.2919642925262, -3429.274880632758, -2527.416551562026, -3578.5959154367447, -2235.784985460341, -2812.233156822622, -2733.3695239424706, -5157.9273293577135, -4929.722321122885, -4816.733847379684, -1405.2717838287354, -2890.203628793359, -6564.1470060274005, -2240.985307022929, -4916.702105887234, -1197.3180767893791, -5220.333190724254, -1887.442373143509, -1805.9855753779411, -3093.352320872247, -2410.3231433928013, -1557.5408658832312, -1369.4387558847666, -2227.2098255306482, -1637.397665221244, -2364.0134350657463, -1123.294177904725, -1721.881906196475, -2906.8320890441537, -1607.7330130338669, -2003.7848681360483, -1915.002296358347, -2153.716237410903, -1584.0165014341474, -2648.156856968999, -1625.1717102229595, -1329.7997488826513, -922.8422462642193, -951.6120125167072, -1452.661462686956, -1950.2030509188771, -1644.4320424981415, -2611.1973674446344, -1746.5624010935426, -1876.519705593586, -1744.5288858227432, -934.4634870029986, -1290.3281866461039, -1963.7289602085948, -1579.8542044311762, -1362.1476832181215, -2141.3268503285944, -3790.5302422717214, -1884.9067018032074, -1643.0416879430413, -1873.7383970916271, -1753.2158846706152, -1720.429754883051, -1888.1903569474816, -2797.1803956478834, -1656.1033175215125, -2072.213865827769, -1912.3984313681722, -1346.1310980767012, -2329.670985892415, -2036.1580373197794, -1838.4466307610273, -2257.4855342134833, -2410.535666823387, -2301.3484213650227, -801.5893338248134, -3581.9229734446853, -1513.4077327102423, -1448.204880028963, -1514.7528784014285, -3160.590195044875, -1568.5070914253592, -3936.816090133041, -1296.5797699913383, -2576.8787553086877, -1495.35959077999, -2817.4044097810984, -1116.2433612942696, -1118.9983142316341, -1580.60145175457, -3019.7427787929773, -1378.9667697548866, -2298.7133056521416, -1522.2798261344433, -3017.4705838039517, -8659.742837622762, -2338.348008899018, -4129.574190840125, -1685.300235003233, -1994.6210723891854, -2138.2258158922195, -3533.3588146567345, -6907.959871798754, -2111.9934936761856, -2315.2835389859974, -2478.2531992718577, -2865.341469913721, -9278.814480021596, -2208.2878156751394, -1933.9018084444106, -1215.572717525065, -2947.5740380585194, -1672.3542686142027, -2584.775646597147, -3385.965916380286, -1910.0901285931468, -2970.832935720682, -3980.5307012200356, -1851.4816794544458, -3092.310013089329, -2027.4691354483366, -3328.488630577922, -2358.5117229148746, -6743.066661387682, -2068.69309258461, -1202.0776517949998, -4650.494751039892, -1317.9968520849943, -1997.2148165553808, -1767.0898040644825, -1361.8526458889246, -2036.8317271526903, -1685.670331766829, -2267.5802659392357, -1696.1246632933617, -1252.6775356456637, -1921.4682454615831, -1570.702351950109, -2598.963241431862, -2225.5382304638624, -1780.1194963678718, -1335.3772016614676, -1435.6949718296528, -2931.8712030127645, -2521.1820894777775, -1160.786773847416, -1390.1697689816356, -1906.4787662699819, -1465.3507287800312, -3205.729969263077, -1951.032416407019, -2708.8838223489, -1657.1371797025204, -1941.9960748106241, -2074.808925360441, -1499.1637441888452, -2687.8327903077006, -1569.74607873708, -2218.7259502336383, -2249.756357103586, -2034.9286205992103, -1544.6104609817266, -1716.3205675892532, -2576.069249011576, -1521.8740145266056, -1536.015788435936, -1903.9540837965906, -1613.1804069429636, -1390.8868238851428, -1663.1408039033413, -1544.0417671203613, -2636.580275837332, -4701.690324515104, -2143.46159401536, -1586.1986337304115, -1935.7444795519114, -1497.324377566576, -2201.4779218435287, -942.5068508777767, -1824.987073674798, -3775.815686941147, -1379.0667381510139, -1872.8541056215763, -1913.6041823923588, -1993.270697593689, -3458.3553999848664], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3984631951112965, "mean_inference_ms": 4.487753831297302, "mean_action_processing_ms": 4.206135560810982, "mean_env_wait_ms": 3.2483359448056084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1048320, "timesteps_this_iter": 131040, "agent_timesteps_total": 1048320, "timers": {"sample_time_ms": 39255.836, "sample_throughput": 3338.102, "load_time_ms": 23.621, "load_throughput": 5547635.609, "learn_time_ms": 14615.058, "learn_throughput": 8966.095, "update_time_ms": 2.288}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015624999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 445.23388558162, "policy_loss": 0.007522541977808551, "vf_loss": 89.03906980124853, "vf_explained_var": 0.0005903448041621929, "kl": 0.001509938730677252, "entropy": -0.18395679080892208, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1048320, "num_agent_steps_sampled": 1048320, "num_steps_trained": 1048320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1048320}, "done": false, "episodes_total": 2240, "training_iteration": 8, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-46-44", "timestamp": 1691020004, "time_this_iter_s": 39.36097002029419, "time_total_s": 328.90614128112793, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 328.90614128112793, "timesteps_since_restore": 1048320, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.380357142857136, "ram_util_percent": 51.5642857142857}}
{"episode_reward_max": -697.3525814861059, "episode_reward_min": -6626.365292001516, "episode_reward_mean": -1731.478368805156, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1554.78011842072, -1739.103015769273, -1467.2411183044314, -1723.3532957583666, -1102.2053773850203, -1120.919067652896, -1995.581428423524, -1787.6165731176734, -2134.8421769440174, -2168.9735310077667, -2268.2345219403505, -2859.9340546187013, -2908.260882794857, -1299.9852253310382, -1840.252549983561, -1419.5745096802711, -2210.3200160488486, -1566.7206410616636, -3760.293142259121, -2114.5805230289698, -1684.0043115019798, -1810.3818504214287, -4076.9055139161646, -2175.6887117922306, -1510.701575562358, -2383.4166647940874, -2367.004233015701, -2917.5308954119682, -1740.7005086243153, -2312.3119887411594, -3187.16998777166, -1077.4642336964607, -2178.7944810390472, -1552.450706128031, -1544.0435682665557, -1662.1729244925082, -1269.645946726203, -1196.9015089105815, -799.7462860494852, -1135.1724790334702, -1485.8008538484573, -1769.5069757401943, -1345.2794643640518, -2451.3924555778503, -1454.7826482355595, -1546.1866417527199, -1840.9077414795756, -1174.4487338513136, -952.6735336184502, -2908.206883855164, -1360.500959098339, -1564.1858809292316, -1733.276854582131, -1204.3936942219734, -1227.5405202507973, -697.3525814861059, -2218.1459745168686, -1554.8279915302992, -1590.4120588451624, -1556.7160614281893, -1519.1433867961168, -1270.9019151180983, -963.510837065056, -1678.163590312004, -1975.0422077775002, -2492.6242007389665, -905.9505009874701, -1653.1403864175081, -1940.6237937510014, -1180.9879971817136, -1426.4344014823437, -801.7612262517214, -1726.4165500700474, -1198.7948506474495, -1261.2116155810654, -1172.0707666361704, -2184.8903230624273, -1730.301093608141, -1570.1666600480676, -1986.9820205457509, -2464.9356942921877, -1736.9819328822196, -1288.4621241278946, -2012.0497563835233, -3000.5399747267365, -1516.4366627633572, -1328.9912713170052, -1564.773034594953, -2394.1665089577436, -1727.4810605160892, -1605.0096526294947, -1345.80433611013, -2164.9395679980516, -2194.555002052337, -1606.7352562472224, -1297.6485374942422, -1705.5485952273011, -1379.1021271534264, -1036.293872088194, -1560.0646928623319, -2021.6806592866778, -2410.6057678461075, -2030.2307253032923, -1671.879316933453, -1404.80007032305, -1422.4498807638884, -2244.9794936552644, -1722.1038767546415, -1624.4197106286883, -4136.112175185233, -1905.2083421200514, -2431.9848202914, -1856.6429380625486, -3486.9911096543074, -1866.3633999973536, -1899.2654925957322, -1508.6157887279987, -2265.1565810889006, -2191.2980449050665, -1698.0122694596648, -1396.795411966741, -1378.4325611293316, -2129.477504685521, -1643.3221529722214, -2410.0178703814745, -1273.9761509001255, -2026.404054529965, -2125.6519599556923, -1710.0997695475817, -2312.5132219195366, -1217.409382738173, -1731.4803311675787, -1578.9915515333414, -2132.168484725058, -1148.9479236230254, -1009.552198247984, -1955.028700741008, -1733.1606835573912, -2472.0224874839187, -1386.7719873338938, -1339.4201888144016, -1315.2540845274925, -2004.361081108451, -2259.904527038336, -1400.2203555107117, -1524.5494722276926, -1409.7214265838265, -2742.223541457206, -1660.8940463457257, -1522.8553813695908, -1170.2878004461527, -1687.4408660680056, -1476.886605501175, -1546.5485322289169, -2257.793836146593, -1431.429229438305, -1316.785120844841, -1111.683197632432, -1246.1189171224833, -2304.754749432206, -988.0685505121946, -1295.750074610114, -1987.484507292509, -6626.365292001516, -1578.0164598040283, -985.6068760715425, -1221.749537833035, -2835.9766630791128, -1852.3883545771241, -1548.9235297665, -1111.2823169538751, -1703.5118520408869, -1473.7964283823967, -1459.656350389123, -1073.2512721419334, -1581.8519082441926, -1870.733927886933, -1291.6256286799908, -1122.9224943220615, -3593.784570330754, -3202.4511950723827, -1278.4810319244862, -2396.657945752144, -3103.9260990172625, -1523.5649862736464, -1195.4398832544684, -1820.1278038173914, -1465.1298039928079, -1125.1669709533453, -1719.4709766432643, -2167.105016209185, -2133.4338364824653, -1919.783739849925, -1813.992081016302, -2106.7970498800278, -1538.9119087159634, -2262.75874966383, -2545.0991930626333, -2306.8918683081865, -2061.024967625737, -2584.187582075596, -1421.2485028803349, -1614.7390399724245, -2100.332104668021, -1395.0066109895706, -1179.2386761736125, -1199.4834235608578, -1995.319592922926, -999.4624569267035, -1579.6785496026278, -2364.8779275789857, -2958.3496965691447, -1391.9596006646752, -1655.3124535009265, -2146.0199269652367, -1785.8535451181233, -1897.0825415924191, -1356.45620720461, -1098.007704257965, -1383.349497191608, -2493.605754717253, -1622.7213368564844, -2019.310360610485, -1351.3329388350248, -1767.2865986842662, -1674.927553575486, -2894.3796150535345, -1858.1741617880762, -1738.4295945465565, -1650.40632524807, -2706.6025684028864, -753.21654099226, -1537.592555642128, -1285.0217839628458, -1242.1402029246092, -1227.9824189506471, -2220.793992444873, -1229.3848332092166, -1384.2746414393187, -1720.4826355986297, -2036.2079484760761, -955.969811104238, -1069.380618661642, -1102.0830706208944, -2292.84940642491, -1325.342158049345, -1747.5484501309693, -1884.102698110044, -1079.6298253498971, -1413.1603126376867, -1145.5747144669294, -1246.3933068215847, -1677.679198563099, -992.9819527026266, -1241.421760391444, -2068.6500165462494, -1303.0860002487898, -1247.6499413102865, -1098.4028224647045, -1148.3153910189867, -1701.7737049981952, -1306.6032872200012, -2335.4942062050104, -1142.1145788431168, -1319.6978581100702, -1180.5553779006004, -1059.8479573577642, -1651.4372727572918, -1610.738155413419, -1720.4402799159288, -1666.4547722637653, -1383.798533141613, -2451.831181176007, -1604.671488571912, -3084.816414952278, -1422.6649476662278, -2104.555752888322, -1772.9732560887933, -1323.5130388960242, -1363.4116394221783, -1935.7670876830816, -984.9431681782007, -1869.4935645610094, -1103.4277146831155, -1672.3184977844357, -2153.1224668622017, -1590.5859028995037, -1586.7763617485762, -1951.6541577819735, -1484.4433440808207, -1149.7772816941142, -3107.4912775978446, -2006.5762988179922, -1566.0748475119472, -3272.523721853271, -1522.4083347171545, -2224.122753456235, -1860.5020214915276, -1523.82900916785, -2852.6160101890564, -1140.7460230048746, -1952.0561569351703, -1983.624646352604, -1541.7234449982643, -2682.4220196157694, -1374.395948059857, -1276.532749287784, -2165.8015162572265, -1174.1145913153887, -981.548602707684, -1455.6840817928314, -1004.4116222113371, -1230.11364787817, -1675.0511509925127, -2912.1662584245205, -985.5919647626579, -1098.8258285429329, -1143.9804365690798, -2493.5541852228343, -1903.4418731182814, -2339.880957134068, -968.4889503568411, -1291.83206281811, -2207.669399753213, -1106.8140440434217, -1687.0296122729778, -1271.6861360669136, -1393.5743051320314, -1144.7988664321601, -1561.7838481906801, -1379.9168693721294, -1361.389453113079, -1430.7798377647996, -1822.4449306298047, -1110.6787495315075, -939.9804994761944, -2600.3590784557164, -1376.8781676776707, -1838.6939168721437, -1913.827111557126, -2797.6033154167235, -1644.8022053018212, -1554.9551740810275, -1426.1099313497543, -1074.524470280856, -2348.143981233239, -1442.309225473553, -2162.2840213142335, -1616.2121112644672, -2219.545913591981, -1770.8479837626219, -1048.1251653283834, -1722.722380593419, -1174.1604873985052, -1003.8833142891526, -1392.9671146832407, -1866.57192010805, -1575.085431471467, -1388.443651765585, -1312.5830318182707, -1748.9896710962057, -1435.60487036407, -1723.886297415942, -1954.4032788649201, -1223.2921102009714, -1637.176753088832, -1171.4431707002223, -1341.7798753455281, -1730.4401172474027, -1472.531110726297, -1959.3334609009326, -1940.0823721885681, -1733.0964163318276, -1638.3340682536364, -1448.2162604518235, -3108.8770089372993, -1354.7868602871895, -1286.8085556924343, -1794.2228145822883, -1767.2917497344315, -1575.2143302708864, -2507.4986996501684, -1939.99462832883, -1313.0275673493743, -2579.8019305169582, -2019.752911414951, -1632.8704411387444, -2643.911308057606, -2379.426175519824, -2797.9957525134087, -4215.1103207319975, -1725.374119141139, -1799.978807091713, -2585.8731292188168, -1789.8059938773513, -1618.735433652997, -1878.2632971853018, -1353.7778080776334, -1392.4594128876925, -1564.9505641907454, -1436.794657625258, -1878.0967355519533, -2639.6807417422533, -1455.057366605848, -1677.850814640522, -2256.280643954873, -2287.5866630747914, -2236.437225945294, -6411.950077980757, -1700.529195010662, -1183.9072526171803, -1246.385090380907, -2720.3020060434937, -1859.2133821435273, -1419.7206103280187, -1600.0069474373013, -2471.964653994888, -1832.5586343556643, -1887.011618386954, -1415.8264263793826, -1374.6052929461002, -2616.6089666187763, -980.4102922901511, -1824.3468126021326, -1019.6844719052315, -1561.8963174670935, -1504.1878913342953, -1418.8723182827234, -1842.423536438495, -1062.2324298806489, -819.3859286829829, -1984.251138791442, -1112.2204122841358, -1610.778565717861, -949.1939532086253, -1425.4926802888513, -1757.3875649571419, -1618.790667667985, -853.6138542294502, -1775.7971726953983, -2076.13308224082, -1682.7347630038857, -1629.5902152657509, -1196.834280923009, -1942.5199420154095, -1411.9740830212831, -2076.6093127280474, -2159.740880100988, -1251.9553298018873, -1196.922099545598, -1988.3566999733448, -1775.2319952994585, -1453.2321254760027, -1373.542377218604, -1158.0051954686642, -1893.1932751750574, -1507.1312275473028, -2023.959739850834, -1911.437472568825, -1857.514992903918, -1217.7654838413, -1130.675486985594, -1187.0597852095962, -1050.1891541033983, -1124.3083808347583, -1107.8875482976437, -2015.9877280145884, -1204.9125341363251, -1649.5395322442055, -2304.200228482485, -1321.3441446870565, -1611.1411313563585, -1902.5770302563906, -1344.6670870631933, -1713.6821606275626, -1259.5644336324185, -1367.0475480519235, -1156.1125801503658, -1474.592334792018, -1213.2236439436674], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402767112411459, "mean_inference_ms": 4.498419418369891, "mean_action_processing_ms": 4.206188769939223, "mean_env_wait_ms": 3.2457524638324955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1179360, "timesteps_this_iter": 131040, "agent_timesteps_total": 1179360, "timers": {"sample_time_ms": 39266.62, "sample_throughput": 3337.186, "load_time_ms": 24.096, "load_throughput": 5438327.982, "learn_time_ms": 14653.519, "learn_throughput": 8942.562, "update_time_ms": 2.307}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812499999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 442.6485983353576, "policy_loss": 0.0007975840885480585, "vf_loss": 88.52873361238869, "vf_explained_var": 0.008381793896357218, "kl": 0.0021108624383604393, "entropy": -0.18831702588813706, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1179360, "num_agent_steps_sampled": 1179360, "num_steps_trained": 1179360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1179360}, "done": false, "episodes_total": 2720, "training_iteration": 9, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-47-24", "timestamp": 1691020044, "time_this_iter_s": 39.33989691734314, "time_total_s": 368.24603819847107, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 368.24603819847107, "timesteps_since_restore": 1179360, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.300000000000004, "ram_util_percent": 51.316071428571426}}
{"evaluation": {"episode_reward_max": -2511.956666700542, "episode_reward_min": -2511.956666700542, "episode_reward_mean": -2511.956666700542, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2511.956666700542], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -819.3859286829829, "episode_reward_min": -6411.950077980757, "episode_reward_mean": -1739.6626069014474, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1575.2143302708864, -2507.4986996501684, -1939.99462832883, -1313.0275673493743, -2579.8019305169582, -2019.752911414951, -1632.8704411387444, -2643.911308057606, -2379.426175519824, -2797.9957525134087, -4215.1103207319975, -1725.374119141139, -1799.978807091713, -2585.8731292188168, -1789.8059938773513, -1618.735433652997, -1878.2632971853018, -1353.7778080776334, -1392.4594128876925, -1564.9505641907454, -1436.794657625258, -1878.0967355519533, -2639.6807417422533, -1455.057366605848, -1677.850814640522, -2256.280643954873, -2287.5866630747914, -2236.437225945294, -6411.950077980757, -1700.529195010662, -1183.9072526171803, -1246.385090380907, -2720.3020060434937, -1859.2133821435273, -1419.7206103280187, -1600.0069474373013, -2471.964653994888, -1832.5586343556643, -1887.011618386954, -1415.8264263793826, -1374.6052929461002, -2616.6089666187763, -980.4102922901511, -1824.3468126021326, -1019.6844719052315, -1561.8963174670935, -1504.1878913342953, -1418.8723182827234, -1842.423536438495, -1062.2324298806489, -819.3859286829829, -1984.251138791442, -1112.2204122841358, -1610.778565717861, -949.1939532086253, -1425.4926802888513, -1757.3875649571419, -1618.790667667985, -853.6138542294502, -1775.7971726953983, -2076.13308224082, -1682.7347630038857, -1629.5902152657509, -1196.834280923009, -1942.5199420154095, -1411.9740830212831, -2076.6093127280474, -2159.740880100988, -1251.9553298018873, -1196.922099545598, -1988.3566999733448, -1775.2319952994585, -1453.2321254760027, -1373.542377218604, -1158.0051954686642, -1893.1932751750574, -1507.1312275473028, -2023.959739850834, -1911.437472568825, -1857.514992903918, -1217.7654838413, -1130.675486985594, -1187.0597852095962, -1050.1891541033983, -1124.3083808347583, -1107.8875482976437, -2015.9877280145884, -1204.9125341363251, -1649.5395322442055, -2304.200228482485, -1321.3441446870565, -1611.1411313563585, -1902.5770302563906, -1344.6670870631933, -1713.6821606275626, -1259.5644336324185, -1367.0475480519235, -1156.1125801503658, -1474.592334792018, -1213.2236439436674], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.397584203043559, "mean_inference_ms": 4.494504116486669, "mean_action_processing_ms": 4.1701652131283105, "mean_env_wait_ms": 3.2309994059568465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1310400, "timesteps_this_iter": 131040, "agent_timesteps_total": 1310400, "timers": {"sample_time_ms": 36864.524, "sample_throughput": 3554.637, "load_time_ms": 22.963, "load_throughput": 5706470.881, "learn_time_ms": 14667.36, "learn_throughput": 8934.123, "update_time_ms": 2.312}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906249999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 435.86410671055654, "policy_loss": 0.0049791972176434374, "vf_loss": 87.16765098161595, "vf_explained_var": 0.04084587406941212, "kl": 0.0019461364119387095, "entropy": -0.191853995712, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1310400, "num_agent_steps_sampled": 1310400, "num_steps_trained": 1310400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1310400}, "done": false, "episodes_total": 2720, "training_iteration": 10, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-47-39", "timestamp": 1691020059, "time_this_iter_s": 15.046011686325073, "time_total_s": 383.29204988479614, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 383.29204988479614, "timesteps_since_restore": 1310400, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.781818181818181, "ram_util_percent": 51.5}}
{"episode_reward_max": -666.1329012066126, "episode_reward_min": -3450.006581120193, "episode_reward_mean": -1394.7590130670162, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1619.6939344406128, -1900.7293100971729, -915.0613326206803, -1112.3613347560167, -1601.0440377146006, -1928.6193533539772, -1225.579387485981, -1028.0203800797462, -1574.2017511948943, -2173.632588084787, -1082.9276916012168, -1680.9579925239086, -1519.2987050414085, -1478.4807883128524, -866.9932252541184, -1740.3388165310025, -1284.3368548452854, -1148.0826797485352, -1942.4260242469609, -1475.1969534307718, -1620.1582148261368, -1079.70154427737, -969.1640051156282, -1383.2403693646193, -2107.784372135997, -1412.9699266776443, -1533.350562363863, -1043.7945890575647, -1896.0425537377596, -1978.7782542519271, -1183.22597438097, -1377.418831706047, -953.8402420803905, -1197.426188338548, -1068.353202790022, -2235.4092508256435, -822.5397230684757, -1042.5513911768794, -2521.2675187289715, -990.4736525416374, -1350.7873130440712, -1176.6808186620474, -1479.366965983063, -995.19888189435, -1307.9393589738756, -882.7059890478849, -1463.5495264232159, -898.5740632563829, -1593.8589271605015, -1113.6632255837321, -977.4277480095625, -834.971781231463, -837.7139889970422, -1381.8931205496192, -1287.5522100925446, -2305.0638961568475, -1707.9536195397377, -1130.9253337476403, -1686.6357242017984, -686.8770260512829, -1026.9734654091299, -2536.5502266846597, -1318.7908570542932, -1023.9076256453991, -1008.0158958807588, -1369.4418676793575, -1650.9535633698106, -1688.0479034334421, -1398.4860219806433, -1805.5732571855187, -1380.7929840236902, -1206.3429667316377, -773.6372405514121, -1306.5125875845551, -1543.9720097854733, -859.9346381276846, -1008.1196779385209, -1143.2110551819205, -1497.0539735853672, -1896.8322083204985, -1046.2706898152828, -1061.907526154071, -3450.006581120193, -2770.5793224945664, -1368.4858128800988, -1066.279513090849, -2838.497939437628, -1557.3830878660083, -1409.7692793272436, -1468.0129711329937, -1265.9003988094628, -1087.6636859029531, -1341.6239325106144, -2087.253827754408, -1487.4403561651707, -1230.231632463634, -1306.5192998796701, -1479.462122015655, -2094.714190647006, -1356.4924645274878, -1617.361038774252, -1473.7382026501, -1603.8350164443254, -1269.7937887571752, -2289.024742875248, -1296.5875458046794, -1444.3262713700533, -1709.502378076315, -1060.5036396831274, -1661.5409152060747, -1826.814320281148, -1267.6046625114977, -871.3307537510991, -1293.5290927141905, -1501.2606554627419, -1324.9436646550894, -1595.4960378855467, -1626.7481964975595, -1511.6334279477596, -1102.6252045854926, -1599.6225371062756, -1052.1874517649412, -1086.1725891679525, -1708.8290670663118, -1386.4021186381578, -1444.9087522476912, -1012.3419324159622, -1171.264754191041, -1071.2706940099597, -1140.6526897512376, -1210.1658686809242, -1024.6507107317448, -2157.5084962695837, -978.8151140213013, -1221.2769736852497, -793.3324881643057, -1313.7736193314195, -1135.1296830251813, -1256.4623244702816, -853.2057318463922, -1107.564031086862, -1684.5368107035756, -1608.7077986076474, -2181.765893727541, -1568.5339096784592, -954.8043758422136, -1647.2788198813796, -2098.35157264024, -1335.4997687637806, -1211.228624716401, -1184.5795611590147, -1236.4990741461515, -1003.6131034940481, -1114.697605803609, -1010.1481796130538, -666.1329012066126, -1002.7716626673937, -1515.3560623973608, -1190.4323598071933, -1186.3711806684732, -1860.7930628359318, -1047.8138782083988, -688.5703935623169, -2437.3948314785957, -1423.0016143098474, -1349.0148160345852, -1406.2498060017824, -1286.734384343028, -900.2080180682242, -1062.641591694206, -1047.3662446811795, -1706.56569371745, -1109.6311079375446, -1026.4097535833716, -1650.5611418113112, -1084.405554715544, -1065.03962251544, -1096.4245068058372, -1216.3413152694702, -1159.8465730771422, -1696.4617417529225, -1899.5460656955838, -1487.7425309419632, -1751.5286707878113, -1801.8733640760183, -1120.4072301443666, -1308.3366287052631, -1256.3788931369781, -1383.2343881726265, -1279.9302135556936, -977.0889199152589, -1075.8244033902884, -1051.353617735207, -968.3611790239811, -1133.7108277454972, -1836.1893124133348, -1249.2423336207867, -999.5956903100014, -1729.2120230346918, -1009.4788161590695, -1683.34739869833, -1274.4227775372565, -1211.2729369401932, -2223.010404340923, -1291.478621583432, -2011.0232471004128, -1321.3204410523176, -989.0177709311247, -1793.9076353535056, -3211.6024957746267, -2198.6430013142526, -1923.9771618396044, -1232.3849702626467, -1008.75071837008, -1047.2917411625385, -1874.3100903257728, -1524.7955498993397, -1231.1678369641304, -1559.0813754089177, -2196.0339203178883, -1100.8958562761545, -1208.8891595453024, -1362.8216593116522, -2125.9391142502427, -2103.5300146490335, -1161.5663385540247, -1350.616022258997, -958.2658549174666, -1463.0148001182824, -1105.1226842924953, -2284.775859847665, -1696.9791864454746, -1236.0400343760848, -1597.6953919678926, -1405.5545245409012, -1301.8869782797992, -865.6589570343494, -1083.3828930780292, -1346.9746724292636, -2223.4635845944285, -979.619661545381, -1087.3377988785505, -1947.5615422427654, -1097.7642613872886, -1209.5094622820616, -1819.1457139886916, -1753.6434875056148, -1063.2698887102306, -840.9612767249346, -1299.152283616364, -1106.2306931987405, -868.1603201180696, -1213.4070026054978, -1135.5259284824133, -1297.8464748561382, -973.2208489775658, -1113.144416704774, -1948.8729619830847, -1468.3859224952757, -1386.8862338513136, -1021.1986526809633, -1514.9775276631117, -978.4525709748268, -978.011746108532, -984.4290154315531, -1256.053809478879, -1533.069116577506, -1102.7499271966517, -803.5892801061273, -1016.5020010769367, -1135.1609733309597, -1206.900816515088, -2288.3897132873535, -2141.727084644139, -1102.593164600432, -1086.8408572338521, -1494.011424407363, -1647.160149410367, -742.0380414500833, -1111.6668927893043, -1564.768388837576, -1904.8431403040886, -1057.550196930766, -1101.6552723050117, -1341.571482911706, -1234.6749055776745, -1017.6479348689318, -1534.6336769610643, -1635.455132111907, -1748.2227097451687, -1121.573829114437, -984.0294413864613, -2638.3230186998844, -755.2901263386011, -1567.4773896932602, -2618.7722135409713, -1983.562080193311, -1926.358800187707, -1277.308324471116, -1856.6756530553102, -1347.5130780264735, -1865.2346498593688, -1327.5021813064814, -1173.9115573987365, -1913.3704480677843, -1021.660773396492, -844.8991885259748, -1176.5269874930382, -1203.2261180579662, -928.0023642703891, -1390.4280901290476, -1884.8445134311914, -1354.6419605314732, -1319.971140794456, -1257.4594319313765, -1654.9061641693115, -1328.4845865890384, -1439.814965993166, -1501.3754749298096, -1253.3227305822074, -859.8800088465214, -1330.3934934101999, -1370.6356008648872, -1210.1149538755417, -1028.257033996284, -1330.9718532301486, -1387.5078307129443, -1469.637062087655, -1064.9693496599793, -1522.060561913997, -1055.684444360435, -1808.3378151506186, -1141.8481492586434, -1181.956693790853, -804.3201929442585, -1662.2843999266624, -2033.330385826528, -1002.5166189074516, -1181.0971571877599, -916.0582305192947, -1119.1747997254133, -1897.9833779782057, -973.1584475040436, -1563.077080450952, -1129.9157945364714, -1418.0971496999264, -2245.285195171833, -1022.4715831205249, -1303.109879784286, -839.2993892133236, -1515.8914309963584, -1291.394564088434, -1368.0321430265903, -2407.0905650556087, -1096.5013283342123, -1167.8931228369474, -1159.3564383964986, -1154.2357120886445, -1719.9592332616448, -1200.423834644258, -2143.429499676451, -1115.9976661503315, -1523.7365012131631, -1095.677952453494, -907.8207794725895, -877.5343884304166, -913.9320316165686, -1578.4591799378395, -1076.8021309189498, -1788.285645117052, -979.3661470413208, -1274.114346217364, -1539.0971975028515, -1833.122261852026, -1760.2270274087787, -2935.059296771884, -912.9726123213768, -1226.9026026502252, -1825.9948335140944, -1213.758895739913, -1315.4455247223377, -1091.9116121977568, -881.1061450690031, -1622.8940699556842, -1031.3165118843317, -1268.795615658164, -1254.5098634436727, -2144.305471561849, -1230.4288049843162, -785.4406131654978, -2016.0731844902039, -1829.1770197576843, -1511.8436228204519, -2820.84520066157, -1171.00195832178, -2896.595666622743, -2093.5045469664037, -1966.2680269628763, -1591.7869396954775, -1470.077753469348, -1001.2100489884615, -1122.2272669523954, -1398.4091350063682, -1164.5023303553462, -1567.3822933137417, -773.7439695894718, -1656.9606460109353, -1051.9361513964832, -1297.7847639918327, -2638.7116734981537, -1261.7914607869461, -907.4492084421217, -1014.0793609470129, -2120.9941034689546, -1167.3164646923542, -3068.55824239552, -1830.9108681082726, -939.4662878103554, -1448.9627196788788, -1184.008018963039, -1021.2252187542617, -905.1028177440166, -1812.038954332471, -1622.2007708773017, -1485.58717636019, -1680.6579074561596, -2043.003492206335, -952.1364707052708, -1116.187003724277, -1213.7421273812652, -2718.1249413639307, -1032.987780496478, -1533.0372030846775, -987.7569444552064, -1464.4063008725643, -946.4593690186739, -2616.482311259955, -1194.2768356502056, -1336.6274680495262, -1205.2465062886477, -895.7336579859257, -1681.4527842998505, -1100.2518224865198, -1445.4450150579214, -726.2605131715536, -1124.0480157881975, -949.719686307013, -1252.7444517314434, -1456.0654620826244, -872.5052462667227, -1474.4596825316548, -1777.160012692213, -973.1711304783821, -1042.2752855792642, -1900.432213485241, -1005.9986499883235, -861.9219355098903, -1332.7805787324905, -1046.5321599282324, -1315.6067860759795, -996.35621753335, -1297.7819967120886, -1483.1607545092702, -1397.7270473018289, -1276.7384924255311, -1198.4824422001839, -1406.204171873629, -1831.0454867184162, -1259.4944636188447, -2064.1632660627365, -1283.1537617519498, -1579.681139498949, -1032.2790036126971, -1039.2331642471254, -1376.3525894880295, -1058.8349736370146, -1412.6124222800136, -1892.0223682820797, -1418.5378548800945, -1221.7872486263514], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400828859352988, "mean_inference_ms": 4.504506220518637, "mean_action_processing_ms": 4.205751863485415, "mean_env_wait_ms": 3.239153042679783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1441440, "timesteps_this_iter": 131040, "agent_timesteps_total": 1441440, "timers": {"sample_time_ms": 38356.762, "sample_throughput": 3416.347, "load_time_ms": 22.886, "load_throughput": 5725797.54, "learn_time_ms": 14727.349, "learn_throughput": 8897.732, "update_time_ms": 2.322}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531249999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 433.78970341792945, "policy_loss": 0.01308852873485272, "vf_loss": 86.74466174819564, "vf_explained_var": 0.044767386703935576, "kl": 0.0015967734494343503, "entropy": -0.19166562658163808, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1441440, "num_agent_steps_sampled": 1441440, "num_steps_trained": 1441440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1441440}, "done": false, "episodes_total": 3200, "training_iteration": 11, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-48-18", "timestamp": 1691020098, "time_this_iter_s": 39.36515736579895, "time_total_s": 422.6572072505951, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 422.6572072505951, "timesteps_since_restore": 1441440, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.16785714285715, "ram_util_percent": 50.80714285714286}}
{"episode_reward_max": -726.2605131715536, "episode_reward_min": -3068.55824239552, "episode_reward_mean": -1412.5723472232885, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1315.4455247223377, -1091.9116121977568, -881.1061450690031, -1622.8940699556842, -1031.3165118843317, -1268.795615658164, -1254.5098634436727, -2144.305471561849, -1230.4288049843162, -785.4406131654978, -2016.0731844902039, -1829.1770197576843, -1511.8436228204519, -2820.84520066157, -1171.00195832178, -2896.595666622743, -2093.5045469664037, -1966.2680269628763, -1591.7869396954775, -1470.077753469348, -1001.2100489884615, -1122.2272669523954, -1398.4091350063682, -1164.5023303553462, -1567.3822933137417, -773.7439695894718, -1656.9606460109353, -1051.9361513964832, -1297.7847639918327, -2638.7116734981537, -1261.7914607869461, -907.4492084421217, -1014.0793609470129, -2120.9941034689546, -1167.3164646923542, -3068.55824239552, -1830.9108681082726, -939.4662878103554, -1448.9627196788788, -1184.008018963039, -1021.2252187542617, -905.1028177440166, -1812.038954332471, -1622.2007708773017, -1485.58717636019, -1680.6579074561596, -2043.003492206335, -952.1364707052708, -1116.187003724277, -1213.7421273812652, -2718.1249413639307, -1032.987780496478, -1533.0372030846775, -987.7569444552064, -1464.4063008725643, -946.4593690186739, -2616.482311259955, -1194.2768356502056, -1336.6274680495262, -1205.2465062886477, -895.7336579859257, -1681.4527842998505, -1100.2518224865198, -1445.4450150579214, -726.2605131715536, -1124.0480157881975, -949.719686307013, -1252.7444517314434, -1456.0654620826244, -872.5052462667227, -1474.4596825316548, -1777.160012692213, -973.1711304783821, -1042.2752855792642, -1900.432213485241, -1005.9986499883235, -861.9219355098903, -1332.7805787324905, -1046.5321599282324, -1315.6067860759795, -996.35621753335, -1297.7819967120886, -1483.1607545092702, -1397.7270473018289, -1276.7384924255311, -1198.4824422001839, -1406.204171873629, -1831.0454867184162, -1259.4944636188447, -2064.1632660627365, -1283.1537617519498, -1579.681139498949, -1032.2790036126971, -1039.2331642471254, -1376.3525894880295, -1058.8349736370146, -1412.6124222800136, -1892.0223682820797, -1418.5378548800945, -1221.7872486263514], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.388314792315319, "mean_inference_ms": 4.494259102730689, "mean_action_processing_ms": 4.159915744059571, "mean_env_wait_ms": 3.215807567900699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1572480, "timesteps_this_iter": 131040, "agent_timesteps_total": 1572480, "timers": {"sample_time_ms": 36016.374, "sample_throughput": 3638.345, "load_time_ms": 21.32, "load_throughput": 6146373.169, "learn_time_ms": 14786.842, "learn_throughput": 8861.933, "update_time_ms": 2.336}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765624999999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 428.59283558350853, "policy_loss": -0.003403382859024, "vf_loss": 85.72177092576112, "vf_explained_var": 0.004040536807856679, "kl": 0.001669741893117483, "entropy": -0.20071736373354457, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1572480, "num_agent_steps_sampled": 1572480, "num_steps_trained": 1572480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1572480}, "done": false, "episodes_total": 3200, "training_iteration": 12, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-48-33", "timestamp": 1691020113, "time_this_iter_s": 15.16069483757019, "time_total_s": 437.8179020881653, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 437.8179020881653, "timesteps_since_restore": 1572480, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.766666666666666, "ram_util_percent": 51.29999999999999}}
{"episode_reward_max": -551.9104562848806, "episode_reward_min": -3009.247510135174, "episode_reward_mean": -1206.7049796292333, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1289.0882097929716, -904.6403343454003, -1323.3884042650461, -820.62000644207, -1705.2396964803338, -891.1154165789485, -1122.9275908917189, -984.7557113617659, -1019.1021648198366, -1067.1474228799343, -1073.4075009822845, -1373.3333743438125, -2225.915619380772, -1212.2621160298586, -1729.8119275271893, -1366.7125744111836, -1197.4509175866842, -1108.5602271854877, -1300.8371500596404, -1829.1212343350053, -830.1300602182746, -1266.403018295765, -1446.9870317578316, -943.1862965058535, -1227.390165001154, -1366.922176167369, -924.2071124315262, -1633.8520002663136, -904.5734084919095, -1550.9649639204144, -1158.941931925714, -905.0621537417173, -1157.6728422790766, -685.1072863265872, -1161.878334224224, -858.7617111504078, -998.1255607493222, -2381.5090580135584, -1024.9862650111318, -1042.21232534945, -1097.790232796222, -1061.8868806809187, -1279.397695247084, -944.5741639137268, -1680.6602950561792, -1928.2148790583014, -1017.7529513388872, -795.403566300869, -1003.3631418943405, -787.8926297426224, -1114.2503643855453, -996.1792318820953, -748.5153130665421, -1577.7390543818474, -1045.9044323563576, -1086.9799980670214, -851.9081623107195, -865.9402780234814, -827.1975043416023, -889.3648788779974, -1055.8230113387108, -1113.372036203742, -1493.321974284947, -1157.616992695257, -1063.2347340285778, -1008.4981709718704, -1251.742776118219, -1032.7644379884005, -1587.0198929011822, -1076.8629523441195, -1158.1158891357481, -680.8410177528858, -1162.0740495324135, -1236.3215841054916, -1432.6558502689004, -1593.2581786960363, -1266.3100958876312, -738.203773457557, -1778.8528377283365, -1555.2047872543335, -1247.7348423674703, -1605.3410412222147, -1593.63362903893, -1530.2510896921158, -1604.544559031725, -739.0747665762901, -1188.9542012996972, -1069.6476651653647, -706.2405429407954, -785.0517889857292, -2192.561264064163, -753.3373571112752, -2455.0263087935746, -1199.9952774569392, -951.7928435653448, -1097.1977843642235, -1421.7239593863487, -1682.7992281913757, -1201.749192096293, -1264.4182082600892, -1868.4131695628166, -975.4235997647047, -1226.2612662166357, -871.4484038725495, -1031.803698869422, -1062.657607883215, -998.1199529888108, -1857.1450752541423, -1126.639235779643, -1641.0729964599013, -1523.6595310121775, -1225.5978279858828, -1019.6006534732878, -1034.179916770081, -1558.2178509384394, -1161.7389581948519, -1112.6540430895984, -2229.8935033604503, -2059.030271369964, -824.550603736192, -1298.0885870512575, -1278.4035874158144, -1290.2233338356018, -685.8567504361272, -1350.9748077392578, -1274.0733087658882, -871.8926832489669, -1411.3830287456512, -1080.6037678271532, -1311.3530303239822, -867.5704951882362, -1311.3924117907882, -1435.9485474452376, -1428.2579421754926, -1036.5384093634784, -835.7722376398742, -1125.40275689587, -851.4249756634235, -1325.4291715435684, -756.5240280665457, -920.9391272552311, -975.8029140457511, -1521.0108903944492, -854.373265042901, -1104.5883665978909, -1336.8907604515553, -1011.9877229854465, -551.9104562848806, -850.2421861439943, -687.4379963874817, -1599.3704321980476, -1428.2452045157552, -1675.3275431278162, -1804.4996046125889, -1082.7051764503121, -1219.3635228201747, -1047.004079774022, -1436.393006324768, -1174.0826546475291, -1167.4796116948128, -830.782846301794, -1039.254368841648, -1539.2685617096722, -1207.9649191498756, -1068.8874486088753, -1143.7955149710178, -2199.8076656237245, -1181.7324860617518, -2396.674879655242, -1294.2327155917883, -708.4677644520998, -1321.2941882833838, -1407.7602564804256, -674.4237852245569, -885.6979548558593, -1067.4429529458284, -1054.4233180396259, -1429.2007886767387, -1205.7545964866877, -1424.671233780682, -1137.9038063660264, -781.4762716293335, -773.109697341919, -1017.3337045162916, -1366.117225471884, -1184.2465624772012, -587.5818256437778, -1127.244211934507, -1619.3621287420392, -1395.0289013385773, -977.3199005424976, -1764.9503625929356, -2054.6471342146397, -1221.3804536759853, -1042.2407602593303, -1479.525535210967, -1358.2549297474325, -1096.4981147944927, -1430.15936280787, -1114.6569163650274, -881.7910692095757, -910.3079418838024, -840.0169707089663, -2027.9652125686407, -799.2826285362244, -1597.5503880046308, -1985.5881037563086, -1060.3164655640721, -742.4237243533134, -1329.3865429237485, -983.7488851845264, -697.2190069146454, -1346.467186667025, -1378.2083008214831, -1055.5223124995828, -1277.1925915405154, -1611.4577830731869, -644.4860134571791, -1279.3896538726985, -865.3644163906574, -1003.8876669853926, -1347.5287695378065, -1275.2946758717299, -1591.435554280877, -2285.074741229415, -1357.227178171277, -1010.6194402985275, -2059.9436932988465, -1110.5911217425019, -1068.0687377750874, -1407.3673564568162, -1055.1534479111433, -876.3705628328025, -1212.713779848069, -1085.4552698284388, -2174.4940686672926, -701.2437535300851, -1190.2913760840893, -1012.9194829761982, -2299.8401138558984, -732.0542896687984, -997.7085902839899, -1578.4802139103413, -1093.847843542695, -958.4062827676535, -933.9415995031595, -772.1972123757005, -1156.6114720702171, -730.0813739560544, -1380.6796770989895, -787.2748410999775, -1312.0516974627972, -902.9847702533007, -1532.5713210105896, -1228.807549521327, -1190.5846708770841, -1400.053831614554, -1224.8874332234263, -1122.499541386962, -1231.9151399731636, -2445.3721783980727, -971.4657391309738, -1015.5988213121891, -2443.8209840655327, -1574.1705098897219, -1061.2434044405818, -1045.3705304414034, -1037.131537400186, -1332.2890065535903, -880.5239532962441, -873.5579424276948, -975.2258622683585, -987.9072897434235, -1655.7233869433403, -886.2336965948343, -1193.1602865755558, -1585.7657852470875, -1159.0463071018457, -1003.9034635722637, -902.0249808505177, -858.3937959000468, -1142.382120385766, -1069.7003411576152, -1058.1628663241863, -1079.3078359365463, -941.3176227062941, -939.7416457086802, -1314.0013444516808, -947.8078382462263, -1299.886416502297, -1643.4849257320166, -2286.294861897826, -1019.3691195473075, -1260.6823386698961, -1254.0447572469711, -1227.4177433513105, -791.7240612767637, -1114.3408378586173, -1144.1231271028519, -1350.9970555827022, -1341.1402028054, -1300.9198206067085, -1061.5484902113676, -1322.1635824143887, -1510.4773497506976, -1506.6104055568576, -1367.9320931434631, -1409.519452534616, -1273.2084545716643, -954.4561427682638, -992.0879269726574, -972.5044683404267, -1022.7267210073769, -1836.5075021125376, -947.1784467101097, -2321.201213300228, -1341.9047204963863, -967.9042850211263, -2005.4441192299128, -1461.1990502141416, -774.9072471112013, -787.0200218260288, -623.3218104243279, -818.5050718858838, -1194.5586967431009, -781.4708358980715, -858.4471880942583, -1073.4957332909107, -685.7400431111455, -800.3495322894305, -1103.9726143553853, -1170.3179306983948, -1729.1466660350561, -914.9394776150584, -1022.564904615283, -1097.2209296263754, -1361.0926688499749, -991.1220945864916, -1056.0273170452565, -661.954890973866, -811.7743874713778, -677.3958270475268, -1538.678612112999, -1402.324794843793, -856.2405599877238, -758.7785776779056, -1268.0511519312859, -2448.261716991663, -1117.8242457658052, -1125.690436333418, -1562.376121595502, -1020.1070491597056, -1108.1009180694818, -967.0444258749485, -1240.5779869109392, -687.8815945833921, -1430.527344122529, -788.9126803390682, -1075.069891013205, -1180.4449483975768, -1055.16981812194, -798.350697055459, -1286.5902737230062, -1438.0629851222038, -1234.047588057816, -637.0531697198749, -838.6654005348682, -2450.4896694272757, -1477.122725751251, -790.7554149478674, -658.2452723570168, -1106.0556886941195, -895.2798961177468, -1445.2311705201864, -873.9467653036118, -1896.2606805637479, -2450.8575395457447, -822.7232612967491, -1034.6136163976043, -934.5561790168285, -1207.543738424778, -2076.175809726119, -986.4538295269012, -928.5730177648365, -787.9815816730261, -1260.0006910711527, -3009.247510135174, -1154.682316981256, -908.4528684373945, -1526.3276945836842, -1131.897138889879, -1384.734840132296, -1164.6270030289888, -818.944888189435, -2015.0706198364496, -1124.9168304800987, -1810.9078574441373, -780.9350374601781, -1333.4291345626116, -1731.839240713045, -1159.5799010843039, -951.6660207360983, -1579.7465359345078, -1625.2445641960949, -1041.7740801014006, -1101.8626593779773, -1410.5614072233438, -1316.165483057499, -952.7787884771824, -1010.1835490018129, -849.9628879586235, -1452.0458765774965, -1193.05976074934, -1045.7799109146, -857.3368452191353, -914.3550737574697, -995.96488109231, -1093.234389975667, -1234.6316375508904, -772.9193691313267, -1296.7081415001303, -888.2923451513052, -1128.2889959756285, -1157.9470135290176, -1125.7922350130975, -1115.1375712305307, -1385.9547911975533, -1234.8534885421395, -1324.4624119363725, -2073.664216890931, -1304.274682506919, -1136.5588821843266, -1689.7753280289471, -1073.7462829947472, -2041.648543164134, -626.3643737360835, -1545.943781916052, -1462.4439768344164, -995.503973454237, -920.8478242382407, -1402.5727321058512, -1036.6789286211133, -947.1836837306619, -1372.1170469373465, -1432.9740104563534, -1014.629214450717, -907.4461483955383, -1668.4984966516495, -1369.2360416427255, -1094.007216885686, -820.4998967908323, -1203.5098748505116, -1144.954373344779, -763.0970193147659, -890.306734919548, -827.7819297462702, -686.5767957344651, -1022.9970375597477, -936.6674504578114, -1265.7854084819555, -1312.7933744341135, -1741.3509530052543, -979.7853817120194, -1507.750918187201, -771.6706875190139, -874.3081585168839, -1117.171364441514, -763.2679005935788, -1350.8180440962315, -1543.0439109951258, -881.6756543368101, -1295.277199074626, -1362.6864537596703, -1206.6625656187534, -838.8647786974907, -1322.9550451263785, -938.12657161057, -1142.212308825925, -1400.1385760754347, -1094.1431867536157], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405141689304794, "mean_inference_ms": 4.512462395743266, "mean_action_processing_ms": 4.206747386125815, "mean_env_wait_ms": 3.240701239225086, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1703520, "timesteps_this_iter": 131040, "agent_timesteps_total": 1703520, "timers": {"sample_time_ms": 38480.754, "sample_throughput": 3405.339, "load_time_ms": 22.975, "load_throughput": 5703681.679, "learn_time_ms": 14845.062, "learn_throughput": 8827.177, "update_time_ms": 2.336}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812499999999e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 422.02747020478597, "policy_loss": 0.009670422454215366, "vf_loss": 84.39562449574898, "vf_explained_var": -0.04017478494661256, "kl": 0.0013649326224301958, "entropy": -0.200450735306868, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1703520, "num_agent_steps_sampled": 1703520, "num_steps_trained": 1703520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1703520}, "done": false, "episodes_total": 3680, "training_iteration": 13, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-49-13", "timestamp": 1691020153, "time_this_iter_s": 39.38144278526306, "time_total_s": 477.19934487342834, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 477.19934487342834, "timesteps_since_restore": 1703520, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.843859649122805, "ram_util_percent": 51.25438596491228}}
{"episode_reward_max": -626.3643737360835, "episode_reward_min": -3009.247510135174, "episode_reward_mean": -1204.8202720566187, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1207.543738424778, -2076.175809726119, -986.4538295269012, -928.5730177648365, -787.9815816730261, -1260.0006910711527, -3009.247510135174, -1154.682316981256, -908.4528684373945, -1526.3276945836842, -1131.897138889879, -1384.734840132296, -1164.6270030289888, -818.944888189435, -2015.0706198364496, -1124.9168304800987, -1810.9078574441373, -780.9350374601781, -1333.4291345626116, -1731.839240713045, -1159.5799010843039, -951.6660207360983, -1579.7465359345078, -1625.2445641960949, -1041.7740801014006, -1101.8626593779773, -1410.5614072233438, -1316.165483057499, -952.7787884771824, -1010.1835490018129, -849.9628879586235, -1452.0458765774965, -1193.05976074934, -1045.7799109146, -857.3368452191353, -914.3550737574697, -995.96488109231, -1093.234389975667, -1234.6316375508904, -772.9193691313267, -1296.7081415001303, -888.2923451513052, -1128.2889959756285, -1157.9470135290176, -1125.7922350130975, -1115.1375712305307, -1385.9547911975533, -1234.8534885421395, -1324.4624119363725, -2073.664216890931, -1304.274682506919, -1136.5588821843266, -1689.7753280289471, -1073.7462829947472, -2041.648543164134, -626.3643737360835, -1545.943781916052, -1462.4439768344164, -995.503973454237, -920.8478242382407, -1402.5727321058512, -1036.6789286211133, -947.1836837306619, -1372.1170469373465, -1432.9740104563534, -1014.629214450717, -907.4461483955383, -1668.4984966516495, -1369.2360416427255, -1094.007216885686, -820.4998967908323, -1203.5098748505116, -1144.954373344779, -763.0970193147659, -890.306734919548, -827.7819297462702, -686.5767957344651, -1022.9970375597477, -936.6674504578114, -1265.7854084819555, -1312.7933744341135, -1741.3509530052543, -979.7853817120194, -1507.750918187201, -771.6706875190139, -874.3081585168839, -1117.171364441514, -763.2679005935788, -1350.8180440962315, -1543.0439109951258, -881.6756543368101, -1295.277199074626, -1362.6864537596703, -1206.6625656187534, -838.8647786974907, -1322.9550451263785, -938.12657161057, -1142.212308825925, -1400.1385760754347, -1094.1431867536157], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.395945050683856, "mean_inference_ms": 4.503113307587752, "mean_action_processing_ms": 4.160966568621905, "mean_env_wait_ms": 3.2181884671641114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1834560, "timesteps_this_iter": 131040, "agent_timesteps_total": 1834560, "timers": {"sample_time_ms": 36164.094, "sample_throughput": 3623.484, "load_time_ms": 20.947, "load_throughput": 6255794.534, "learn_time_ms": 14902.5, "learn_throughput": 8793.156, "update_time_ms": 2.313}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4414062499999995e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 415.87669952173303, "policy_loss": 0.002582927298538695, "vf_loss": 83.17255335982128, "vf_explained_var": -0.0260126810774581, "kl": 0.0013759365913668467, "entropy": -0.20528690391437127, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1834560, "num_agent_steps_sampled": 1834560, "num_steps_trained": 1834560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1834560}, "done": false, "episodes_total": 3680, "training_iteration": 14, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-49-28", "timestamp": 1691020168, "time_this_iter_s": 15.182424306869507, "time_total_s": 492.38176918029785, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 492.38176918029785, "timesteps_since_restore": 1834560, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.899999999999999, "ram_util_percent": 51.53333333333334}}
{"evaluation": {"episode_reward_max": -4174.463617645204, "episode_reward_min": -4174.463617645204, "episode_reward_mean": -4174.463617645204, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4174.463617645204], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -558.8484620451927, "episode_reward_min": -3760.6030040085316, "episode_reward_mean": -1102.9864346779602, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.0511408597231, -1779.175608843565, -624.0429444499314, -1667.7753522247076, -1145.134831443429, -1002.0400345399976, -1315.0552394986153, -1418.7014269270003, -1397.4678603266366, -820.3050679117441, -882.9763463959098, -1017.0707788467407, -1834.284996394068, -987.4482117965817, -872.204143922776, -1121.3829294890165, -1244.9061635285616, -921.1343496069312, -1110.1253239661455, -636.9954331945628, -1089.4064043313265, -1221.9957839772105, -1096.9930061399937, -1054.730000294745, -663.0217414647341, -758.3310032337904, -1750.2667320370674, -1078.2486858069897, -1181.4208805710077, -1250.2554454766214, -1274.8266061097383, -1247.2359236553311, -1324.0452144928277, -1375.389903306961, -1071.7301690857857, -1668.6018554084003, -953.9790796339512, -834.2450648546219, -1104.4603744596243, -876.4175869002938, -769.6856685429811, -700.6260749995708, -1049.31276114285, -1074.3243212774396, -783.4164191931486, -1052.6621690317988, -1240.6284548193216, -1333.9404001682997, -1304.519992608577, -995.4529739879072, -1250.0158803835511, -938.9880580604076, -1151.6959665305912, -1317.129285722971, -1044.458897009492, -1281.1312301382422, -1101.1491921860725, -1673.7584653124213, -1035.607133693993, -1377.1281869634986, -1108.470557026565, -1003.7873626798391, -1640.1689421534538, -1163.1879163831472, -868.9248892515898, -2433.5576477646828, -879.06369349733, -1227.8497662097216, -878.1434066873044, -1613.1280957087874, -1233.9351835921407, -772.127672933042, -845.1493435129523, -1386.6328883990645, -1188.01078876853, -883.073833629489, -2021.4421899691224, -912.5641817599535, -1162.5601809173822, -689.0028575062752, -1061.8528073430061, -1143.7729096598923, -1169.2386410236359, -725.7230827957392, -943.8145727664232, -1525.5794298052788, -693.6357306465507, -823.757560774684, -1514.0810442268848, -1684.6627911254764, -1615.826490238309, -1087.6698655709624, -1025.003720857203, -1175.7304174005985, -979.9581885524094, -1234.227726995945, -966.3382949829102, -1157.9098104853183, -792.3700282052159, -902.2752952482551, -803.6139388084412, -901.4941079467535, -785.967215295881, -1085.1720315217972, -844.780390381813, -1520.3388413405046, -915.8162283562124, -1002.9621238783002, -967.943427272141, -1085.5897638648748, -891.1992899924517, -1155.8998780921102, -809.303744405508, -1158.1646065413952, -1157.6627825796604, -830.1686989609152, -966.5806833803654, -1238.0278000682592, -1113.1985912434757, -1152.2243168354034, -1266.7328592166305, -1195.4737577438354, -877.8204048462212, -2598.3859702646732, -736.7936327978969, -828.9352700151503, -826.7980486899614, -1035.2487898916006, -1200.1168089732528, -1594.9875006265938, -955.9365573003888, -1070.057718269527, -876.5302270911634, -892.2372714988887, -1188.6263914704323, -733.025286572054, -931.4835471622646, -1032.866780795157, -1115.410237915814, -1088.412337884307, -3760.6030040085316, -999.3138095885515, -1874.9151103124022, -725.681019231677, -736.5664693936706, -1078.6982212364674, -621.0367186889052, -1417.547355696559, -1445.3670974448323, -1077.8492770642042, -1431.60359018296, -1223.0121748670936, -1197.4893886819482, -973.941052660346, -1064.499479394406, -778.506541095674, -1138.0280973017216, -1040.2954364418983, -620.988456979394, -1333.5858371406794, -1780.9534256756306, -1332.6020669043064, -923.080586951226, -1073.0413240343332, -999.5804110877216, -877.7977637648582, -858.774032715708, -1010.9770957678556, -1155.8218041956425, -874.2003109622747, -1110.7144307643175, -1416.0871096141636, -895.7561949053779, -840.1581455543637, -1350.867898762226, -929.1364535540342, -1164.0898104012012, -781.159358009696, -734.7530949953943, -807.4740431010723, -930.8223903030157, -884.2280532494187, -1234.845769096166, -936.7658697217703, -757.1598087251186, -1036.4198754541576, -1135.6769003272057, -1212.872846134007, -688.1118644624949, -945.0377319902182, -984.2950064502656, -1026.5128485783935, -1386.3053127601743, -1222.6269542053342, -2225.9962778538465, -777.0697865448892, -996.7601265907288, -1255.1480242311954, -909.6308488994837, -671.4544157125056, -935.0638890787959, -948.8052241057158, -1474.2629871815443, -1051.4419375434518, -1388.748459547758, -894.3570197224617, -1055.9195286780596, -952.4917789027095, -705.0092512741685, -967.706075867638, -950.907137542963, -810.6787987723947, -1046.328446187079, -1153.4363106526434, -698.5699241757393, -965.1985868066549, -1014.3684026747942, -845.8664831519127, -1654.4912984222174, -901.8637632876635, -585.8269990421832, -1519.0260579511523, -1953.9547903612256, -982.8291289508343, -1143.7001330964267, -1041.3997629210353, -991.589368917048, -741.028476037085, -1193.9814188852906, -1408.6068041920662, -975.9014571718872, -1147.3968378081918, -1043.3111000284553, -939.1955703496933, -909.2126392945647, -1029.3416737765074, -1281.4985392130911, -907.546124458313, -1168.152808368206, -1033.6295531615615, -1239.2791203595698, -905.7653939723969, -2027.1363601237535, -1121.3644151166081, -984.356633335352, -960.6553458869457, -1174.5652896985412, -993.0917127430439, -1669.2756368219852, -1108.5592113509774, -1138.0033916793764, -1283.4557784311473, -1627.4965625423938, -920.2684835344553, -1121.1913443654776, -1290.0314338877797, -1110.2279678732157, -1228.3161689192057, -898.8811901956797, -1186.7560962885618, -1051.646284326911, -1539.2864984571934, -1032.7078969925642, -976.4379314482212, -814.8921842724085, -1205.6886859163642, -1164.4359390735626, -1433.6918810904026, -897.4853535965085, -1116.0933635644615, -676.0422312691808, -951.9806083664298, -873.7737881690264, -827.4141371771693, -1098.4729545414448, -725.1967742294073, -1065.3047117739916, -1533.756685912609, -907.1426062881947, -1030.8802447915077, -1044.6350498516113, -1257.1300514414907, -651.8068539295346, -1021.2458247840405, -1133.413371953182, -1216.5053796097636, -931.6560546271503, -1299.4505338072777, -1128.6946733295918, -869.6730104088783, -2777.663171105087, -1060.390953026712, -1337.8894808199257, -999.2315808683634, -1192.7026118366048, -1580.2756918594241, -990.2201326340437, -1980.1345507446676, -998.7125093340874, -1058.0809714272618, -1125.858873873949, -668.4308253899217, -1022.513812109828, -884.8492775261402, -1688.9574911147356, -651.641784645617, -1013.0055227726698, -1339.8618999235332, -752.0224785171449, -1023.8111852966249, -1408.2677114605904, -1070.0046168267727, -1514.5787068996578, -1301.4481581747532, -826.1941694915295, -1129.9014197438955, -809.3225448876619, -866.0611253678799, -1030.3627457544208, -871.3476021587849, -1069.0944894477725, -825.1871740594506, -981.9448624700308, -890.1222374886274, -724.1217763796449, -739.473497658968, -867.3614681065083, -982.1595680713654, -811.0207362473011, -980.0066474974155, -1299.5372342765331, -1077.5610119625926, -1090.5425646454096, -906.409001596272, -1636.7529744952917, -897.4462178200483, -823.8633899688721, -776.8670562282205, -2360.716997202486, -721.9883599132299, -1969.5769463069737, -875.1442942544818, -925.0624491386116, -707.839085303247, -1061.2580122947693, -1196.1309488154948, -736.278979294002, -1000.483803872019, -1034.0342081803828, -2691.078231714666, -1584.988933634013, -973.7329584360123, -873.2321430519223, -1154.3535089716315, -1223.619225859642, -1034.3841181844473, -1000.7631713375449, -835.6462010517716, -965.318113880232, -1787.7870405614376, -1063.1510856747627, -585.2256096452475, -1331.7519018128514, -934.3307905569673, -857.7091049421579, -1734.2356784120202, -1338.6862464398146, -1122.5915762521327, -1161.0871811956167, -751.9877421185374, -2781.333868831396, -1172.7054562289268, -1533.3006386347115, -1157.6307540386915, -775.1421946231276, -1210.960112273693, -838.9802799969912, -976.0601911097765, -778.9813466109335, -866.4644581079483, -1434.7793309167027, -752.8100179433823, -848.5020107775927, -919.3684925734997, -1070.979923442006, -979.0102406740189, -1293.063693523407, -1121.948607929051, -723.9153174981475, -1420.3722497969866, -1099.632605716586, -781.5332225738093, -1731.9014594852924, -881.3658489175141, -851.9299284443259, -1139.5588086992502, -1423.0334230028093, -1013.4283287972212, -1048.967653285712, -642.5488885641098, -877.1796431988478, -707.5986546948552, -867.9942366369069, -856.1435680910945, -1055.367448091507, -1185.7918990701437, -824.6378290392458, -1077.1800408028066, -718.9098483249545, -938.8849278837442, -981.0192534439266, -938.795654155314, -1692.8245850652456, -834.3676098287106, -997.0498693883419, -839.6540404744446, -1113.9587303102016, -1247.1320307701826, -807.4368359185755, -767.9682295396924, -711.3280123770237, -2812.49812772125, -855.746421046555, -933.2671742551029, -834.0730169415474, -866.6714090257883, -903.7721446678042, -966.0902951434255, -788.6489975601435, -1025.7704403549433, -665.3544089701027, -1035.4978222995996, -717.1235669180751, -1342.743039637804, -831.982005469501, -1083.166534282267, -1133.0986993983388, -1559.7322088181973, -832.7929495088756, -876.2547108381987, -1034.1349396780133, -767.3334014490247, -1658.1067277491093, -1183.29145392403, -1133.8991151675582, -1088.289084404707, -1228.3600018024445, -992.6730678230524, -1188.2127445936203, -609.4776311740279, -980.8554373830557, -1473.566149711609, -1363.661920413375, -1067.597495958209, -1056.4239026159048, -868.0666661672294, -1393.261156514287, -2619.815137863159, -849.8914148882031, -771.4884894639254, -774.8497602939606, -1274.2923272550106, -558.8484620451927, -896.062963783741, -1049.77807867527, -1031.4771325234324, -1161.2825395390391, -1456.2498028501868, -1300.156292669475, -687.3115110844374, -702.0161957982928, -1712.6923566162586, -1147.074112266302, -1229.322492659092, -841.2605415470898, -1039.8450680393726, -1430.9768513068557, -993.3968756720424, -1618.8203613646328, -796.3958412446082], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400754133193194, "mean_inference_ms": 4.517224660041632, "mean_action_processing_ms": 4.207499735867509, "mean_env_wait_ms": 3.2406048154339713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1965600, "timesteps_this_iter": 131040, "agent_timesteps_total": 1965600, "timers": {"sample_time_ms": 38631.774, "sample_throughput": 3392.026, "load_time_ms": 22.427, "load_throughput": 5843004.098, "learn_time_ms": 14896.695, "learn_throughput": 8796.582, "update_time_ms": 2.315}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2207031249999997e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 409.9654521088429, "policy_loss": 0.007087340590944345, "vf_loss": 81.98579423145581, "vf_explained_var": -0.02556643862023576, "kl": 0.0013705964761100591, "entropy": -0.21031708118095194, "entropy_coeff": 0.001}}}, "num_steps_sampled": 1965600, "num_agent_steps_sampled": 1965600, "num_steps_trained": 1965600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 1965600}, "done": false, "episodes_total": 4160, "training_iteration": 15, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-50-07", "timestamp": 1691020207, "time_this_iter_s": 39.208282232284546, "time_total_s": 531.5900514125824, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 531.5900514125824, "timesteps_since_restore": 1965600, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.15535714285714, "ram_util_percent": 51.33749999999999}}
{"episode_reward_max": -558.8484620451927, "episode_reward_min": -2812.49812772125, "episode_reward_mean": -1063.1467247850355, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1434.7793309167027, -752.8100179433823, -848.5020107775927, -919.3684925734997, -1070.979923442006, -979.0102406740189, -1293.063693523407, -1121.948607929051, -723.9153174981475, -1420.3722497969866, -1099.632605716586, -781.5332225738093, -1731.9014594852924, -881.3658489175141, -851.9299284443259, -1139.5588086992502, -1423.0334230028093, -1013.4283287972212, -1048.967653285712, -642.5488885641098, -877.1796431988478, -707.5986546948552, -867.9942366369069, -856.1435680910945, -1055.367448091507, -1185.7918990701437, -824.6378290392458, -1077.1800408028066, -718.9098483249545, -938.8849278837442, -981.0192534439266, -938.795654155314, -1692.8245850652456, -834.3676098287106, -997.0498693883419, -839.6540404744446, -1113.9587303102016, -1247.1320307701826, -807.4368359185755, -767.9682295396924, -711.3280123770237, -2812.49812772125, -855.746421046555, -933.2671742551029, -834.0730169415474, -866.6714090257883, -903.7721446678042, -966.0902951434255, -788.6489975601435, -1025.7704403549433, -665.3544089701027, -1035.4978222995996, -717.1235669180751, -1342.743039637804, -831.982005469501, -1083.166534282267, -1133.0986993983388, -1559.7322088181973, -832.7929495088756, -876.2547108381987, -1034.1349396780133, -767.3334014490247, -1658.1067277491093, -1183.29145392403, -1133.8991151675582, -1088.289084404707, -1228.3600018024445, -992.6730678230524, -1188.2127445936203, -609.4776311740279, -980.8554373830557, -1473.566149711609, -1363.661920413375, -1067.597495958209, -1056.4239026159048, -868.0666661672294, -1393.261156514287, -2619.815137863159, -849.8914148882031, -771.4884894639254, -774.8497602939606, -1274.2923272550106, -558.8484620451927, -896.062963783741, -1049.77807867527, -1031.4771325234324, -1161.2825395390391, -1456.2498028501868, -1300.156292669475, -687.3115110844374, -702.0161957982928, -1712.6923566162586, -1147.074112266302, -1229.322492659092, -841.2605415470898, -1039.8450680393726, -1430.9768513068557, -993.3968756720424, -1618.8203613646328, -796.3958412446082], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3862067589728895, "mean_inference_ms": 4.503648699717137, "mean_action_processing_ms": 4.154574986952307, "mean_env_wait_ms": 3.212332742626273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2096640, "timesteps_this_iter": 131040, "agent_timesteps_total": 2096640, "timers": {"sample_time_ms": 27242.503, "sample_throughput": 4810.131, "load_time_ms": 20.742, "load_throughput": 6317518.657, "learn_time_ms": 14916.193, "learn_throughput": 8785.084, "update_time_ms": 2.302}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.103515624999999e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 412.14833662240056, "policy_loss": -0.001254131357972239, "vf_loss": 82.43070828017368, "vf_explained_var": 0.0004739605397733736, "kl": 0.0015965462741558858, "entropy": -0.2148503264058448, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2096640, "num_agent_steps_sampled": 2096640, "num_steps_trained": 2096640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2096640}, "done": false, "episodes_total": 4160, "training_iteration": 16, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-50-22", "timestamp": 1691020222, "time_this_iter_s": 15.261165142059326, "time_total_s": 546.8512165546417, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 546.8512165546417, "timesteps_since_restore": 2096640, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.827272727272726, "ram_util_percent": 51.154545454545456}}
{"episode_reward_max": -443.1203189715743, "episode_reward_min": -2647.337915286422, "episode_reward_mean": -967.9402774220284, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-898.1631728708744, -611.9516733884811, -882.8373178727925, -783.8745077215135, -929.2115633487701, -982.5520863234997, -1152.5302945002913, -843.396487057209, -841.4224512651563, -768.0208441093564, -1569.397615775466, -1147.1538429558277, -1274.6206204146147, -1075.3689993992448, -702.0033637583256, -1000.23765578866, -788.5861114636064, -649.5920392768458, -1165.5518928170204, -745.5264504104853, -904.9550271555781, -743.4773235246539, -965.841861627996, -770.867343917489, -956.5030159708112, -626.4237269610167, -665.459737688303, -851.3043031655252, -1123.875881690532, -941.9319902062416, -576.0962458122522, -1121.5014638453722, -654.7409973070025, -1026.1297190487385, -1184.5172479115427, -716.4370905533433, -1020.2982227951288, -854.9095003604889, -942.6746307313442, -699.5321543365717, -700.5390248894691, -954.8107078652829, -901.5217942278832, -921.662104293704, -707.0286229401827, -658.8677981570363, -919.7298128306866, -885.8375671673566, -897.0664825439453, -968.0871505662799, -637.529153123498, -1286.0153568945825, -834.1208618357778, -722.9960723780096, -1247.3381970971823, -1102.8378223851323, -1267.981875449419, -665.7190588563681, -639.0537644326687, -1030.4218885749578, -1137.8176137581468, -1320.9395881071687, -798.6706580072641, -1088.2484281305224, -1392.6145929843187, -807.4531729631126, -1474.2930925935507, -1663.2003181576729, -1048.7665632739663, -1267.5463825166225, -804.8818158656359, -1108.9023799672723, -1368.532485127449, -1544.0712617188692, -841.1373720765114, -772.5301860123873, -897.5651097856462, -650.8272907389328, -734.1556580103934, -1423.4314538426697, -1002.254548445344, -770.3243543989956, -724.0878035668284, -748.2183468639851, -817.9406818300486, -1124.0551228560507, -934.7878225147724, -913.9335686154664, -884.391921594739, -859.4843926243484, -948.7895918861032, -937.0811590589583, -1254.690175447613, -826.6495684944093, -1378.5033993571997, -672.9832235276699, -904.7785598281771, -604.1034656241536, -1119.5726862996817, -871.1492536999285, -896.4671887457371, -1127.0926499851048, -775.3900197967887, -689.537207826972, -966.9984966255724, -999.8277182988822, -887.7478614449501, -1015.7550568506122, -1258.0333068966866, -1081.7793313078582, -1106.4019222855568, -717.1389513090253, -1497.4603989757597, -1005.8940811920911, -863.0170977972448, -2069.9636164456606, -1410.3097421377897, -973.1208477765322, -2534.852395452559, -1109.6189213246107, -965.5262888036668, -694.2507106512785, -565.0659499950707, -1134.4371278882027, -590.4645358622074, -956.4892022460699, -1585.1297317259014, -709.1521306708455, -1678.2751346230507, -1015.8041459023952, -851.2845928370953, -691.8014009296894, -1075.398205332458, -780.3186773145571, -633.2908926606178, -855.0347945019603, -918.7669033408165, -1135.912239804864, -859.3566528707743, -933.7538906894624, -1026.0771413818002, -910.3943209536374, -1214.1938742548227, -1305.1398148983717, -564.5126184225082, -1055.5798238664865, -637.0018482767045, -877.4758381843567, -997.1862893514335, -837.2986876666546, -1051.336642563343, -560.4998824708164, -1283.6614137142897, -797.7006810605526, -651.9877623319626, -865.3702914267778, -996.915506452322, -982.4631620459259, -886.4615816362202, -797.3102674223483, -910.32113468647, -1065.654003445059, -707.9156544990838, -1113.880632519722, -1739.5823925361037, -1415.158364072442, -843.9239986389875, -923.4191962182522, -1066.1806974932551, -749.4455346167088, -808.1007133983076, -970.8187941908836, -1391.8693744167686, -794.7828182503581, -948.4845256060362, -593.824974808842, -707.9498848356307, -1083.7290820330381, -793.9649757668376, -1128.7984777987003, -1149.072482259944, -783.8923915326595, -684.864992249757, -919.2565620914102, -942.6817574352026, -759.7954067960382, -657.3205208797008, -886.0307309702039, -873.5408359691501, -1655.8353333882987, -970.1103916503489, -629.1718484014273, -953.4529412128031, -944.1393329575658, -761.2774721831083, -930.3485418111086, -1217.203520655632, -1629.3759742230177, -1171.6629498675466, -1021.25508508645, -1034.406342085451, -772.8971767537296, -1112.7570924311876, -1107.9318008609116, -1053.2662962526083, -1720.269175145775, -778.8745225071907, -760.5832931399345, -748.7001160867512, -1388.8519857488573, -1241.3661269545555, -809.8362319990993, -584.5895083397627, -828.7778694629669, -841.2442676201463, -1000.4972683573142, -804.4466387461871, -443.1203189715743, -815.898399695754, -985.1657389998436, -946.4590801671147, -827.8765965253115, -949.2219683676958, -1131.8425673115999, -979.6642553955317, -713.6234857589006, -847.2733412832022, -1060.9486088305712, -870.560459960252, -600.5448066443205, -980.5386313274503, -963.8676549941301, -950.3195061422884, -802.9787008455023, -1015.596262447536, -706.5356152877212, -1018.9865486808121, -919.9720904231071, -765.4720498621464, -1069.8879334256053, -1167.0987064391375, -875.5088616758585, -792.6186298131943, -937.1171229183674, -851.5280995517969, -1107.840730264783, -718.654827311635, -957.7343635633588, -807.7823328953236, -848.344790622592, -777.9951923526824, -708.2029309123755, -692.8490221425891, -915.5328661650419, -1260.8867529183626, -801.0677775591612, -1160.7172913104296, -1349.4188169315457, -838.3319929540157, -785.8830291479826, -1068.174640238285, -1066.9106565639377, -799.1336428970098, -1408.4700630903244, -914.7581856250763, -1197.8792448882014, -2074.133822530508, -831.0384357273579, -736.7431828081608, -1241.3040815517306, -886.9681065529585, -1312.9237230755389, -603.4680154584348, -697.9024114813656, -584.3186619877815, -1733.3917598724365, -881.125142455101, -811.2810942307115, -866.1995866037905, -1086.0269752182066, -855.4412191212177, -940.3818092830479, -600.6403847411275, -734.352447733283, -985.1777408532798, -732.5730182901025, -1100.9354127645493, -836.8978654406965, -1212.631032794714, -663.4016348663718, -1156.2201636210084, -815.2773849964142, -910.1298978403211, -897.4777101054788, -867.973512865603, -659.5453268289566, -1094.8913157060742, -686.4783032387495, -1053.742108359933, -1187.0430010035634, -876.9760932922363, -1150.5632197689265, -1367.3268443495035, -924.6308510452509, -925.6598121672869, -838.3727310746908, -866.5912438482046, -805.9376590512693, -2647.337915286422, -1371.6212548986077, -1038.5715212002397, -877.1654130518436, -776.0042230784893, -1041.8918490707874, -1183.514544710517, -1045.7224810272455, -934.1800573766232, -807.2970009073615, -994.0784224867821, -1458.04910877347, -1267.5277745872736, -1178.3116267770529, -713.4376232624054, -1037.6812339425087, -840.4654860645533, -803.4582812339067, -1103.7102592885494, -676.7044217567891, -924.3407454192638, -1160.9151552915573, -607.5178747624159, -1044.417262904346, -932.8939180523157, -1024.3179599195719, -971.8469022512436, -1044.1690951325, -1495.4297572374344, -1047.6906431540847, -983.8836512714624, -884.6924988217652, -775.5873924084008, -692.7517605870962, -728.16559445858, -846.476704929024, -993.5005955845118, -872.9057041034102, -1267.2944713681936, -923.4104158729315, -953.9466912001371, -618.7091208770871, -758.6203060541302, -909.2824091911316, -666.9004041329026, -1554.021616011858, -1016.6255565732718, -827.703731700778, -824.7338377684355, -1128.0225583910942, -1012.5606356300414, -828.7838193029165, -1105.828887745738, -800.6131346747279, -838.7519025653601, -799.3525159060955, -1537.3763180226088, -913.7143914699554, -1013.911066249013, -594.3516329824924, -826.7513321824372, -1163.3074777647853, -1333.9945315122604, -927.1127807348967, -906.2705414071679, -768.6300133019686, -1363.3088316731155, -965.0061099380255, -805.5952842831612, -1029.77567628026, -725.3488939031959, -1505.9402328804135, -1014.2457662373781, -1307.2108361385763, -859.5972519796342, -1958.581430155784, -831.298354446888, -853.2776974514127, -1063.2154474891722, -1247.7055189013481, -959.7409375533462, -1035.9116222411394, -915.7551623061299, -937.8204929120839, -1108.3974294513464, -877.6785781234503, -807.3854328021407, -1248.3995856884867, -977.2121005952358, -1185.3170085400343, -607.8188246190548, -555.0596100389957, -1077.1951019242406, -1127.8874034769833, -945.2475080005825, -952.3103018663824, -1154.9468093961477, -979.5517500713468, -758.0659952126443, -1386.0094010457397, -653.3816532045603, -956.5613644272089, -688.1405589282513, -745.2372693568468, -710.2092293053865, -542.8835019692779, -1188.7095220908523, -920.9539904072881, -742.3562405593693, -1097.4731954671443, -967.465816617012, -699.6318299025297, -953.2249065712094, -944.363100156188, -749.506256364286, -885.3197136670351, -1566.5160256326199, -1171.9343102611601, -894.5917617604136, -683.2615484967828, -2135.3956890553236, -810.9585927426815, -511.35384722054005, -864.1110921129584, -1334.6945466771722, -800.8976000845432, -703.3534740507603, -910.6121590547264, -979.4148659110069, -1081.2268106490374, -733.2376354783773, -1293.2551315501332, -998.8168831318617, -1033.9087148159742, -1305.549194380641, -1161.148029010743, -788.7062309235334, -967.9475127235055, -594.9259398970753, -1909.4095946401358, -917.6697457619011, -956.5469908663072, -710.0318844094872, -1587.9429409056902, -892.9022358804941, -711.0370719879866, -819.4142429232597, -1045.348859321326, -1345.1404603943229, -1127.9890533089638, -957.5139130614698, -674.4375788271427, -775.2000144869089, -768.5632080286741, -702.6955217123032, -1543.7789664268494, -598.7878041192889, -932.9253437370062, -869.9704700000584, -761.4338515400887, -794.89642868191, -840.1620542965829, -818.4813234359026, -629.1580701768398, -1485.1923345327377, -708.7877501472831, -929.9199503287673, -777.1751941591501, -961.2167045995593, -880.593538492918, -1121.427843466401, -882.938188040629], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404910859576327, "mean_inference_ms": 4.519469252851554, "mean_action_processing_ms": 4.20709699648159, "mean_env_wait_ms": 3.2385639548015157, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2227680, "timesteps_this_iter": 131040, "agent_timesteps_total": 2227680, "timers": {"sample_time_ms": 29665.995, "sample_throughput": 4417.179, "load_time_ms": 22.223, "load_throughput": 5896714.944, "learn_time_ms": 14916.111, "learn_throughput": 8785.131, "update_time_ms": 2.296}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0517578124999993e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 397.6136393314492, "policy_loss": 0.00031410784898984223, "vf_loss": 79.52219873517218, "vf_explained_var": 0.018052871402446515, "kl": 0.0019523790748323762, "entropy": -0.21658644921356632, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2227680, "num_agent_steps_sampled": 2227680, "num_steps_trained": 2227680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2227680}, "done": false, "episodes_total": 4640, "training_iteration": 17, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-51-02", "timestamp": 1691020262, "time_this_iter_s": 39.20596981048584, "time_total_s": 586.0571863651276, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 586.0571863651276, "timesteps_since_restore": 2227680, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.30178571428571, "ram_util_percent": 50.998214285714276}}
{"episode_reward_max": -436.68136893212795, "episode_reward_min": -1848.3200038522482, "episode_reward_mean": -852.4582965708134, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-872.5835000351071, -1115.1467005088925, -791.264878436923, -742.2094382047653, -586.0842581279576, -1568.9373723939061, -881.6859288066626, -829.6517683193088, -961.0149310231209, -612.5098307356238, -1087.2889893613756, -828.4323901832104, -1023.9083931073546, -966.0330227985978, -769.4946834445, -1140.8752166181803, -924.8619948765263, -1060.2083296403289, -959.1253809779882, -762.1936714611948, -855.4645608365536, -980.2689977027476, -694.4436387643218, -1024.5089830085635, -653.332239151001, -672.2824541777372, -892.8062620274723, -1185.3702694922686, -980.1444334089756, -676.5485604926944, -1028.8345173746347, -888.8753354400396, -894.755143634975, -882.479195214808, -747.4603220745921, -688.4123783558607, -874.6356085687876, -649.0282949954271, -719.8702328316867, -755.0922205299139, -877.8289394080639, -887.722823381424, -909.806307412684, -733.2695932798088, -590.4493183195591, -827.4655247628689, -1022.0198764055967, -842.1607860401273, -850.275859631598, -851.0760005675256, -1686.6940999515355, -901.0415679216385, -849.0729906782508, -725.7800326123834, -647.4191147238016, -629.9359787330031, -649.6382394880056, -1047.2591952979565, -1098.2320994064212, -638.3014375567436, -1109.1504170261323, -934.8072964847088, -743.8582833260298, -1081.291367970407, -797.0245691724122, -612.5249803848565, -762.990441326052, -577.8825488463044, -909.1195742040873, -1100.8078909739852, -901.6645135655999, -879.1832322739065, -799.5303800106049, -1030.6464604735374, -789.8267080634832, -773.4571740292013, -1406.0733679011464, -813.6665875613689, -632.800509441644, -714.6632484383881, -436.68136893212795, -886.1411680430174, -807.4344440326095, -1277.9516325443983, -987.2109843790531, -887.8263602592051, -677.3515408188105, -1037.4652709439397, -888.2674016319215, -590.7091694921255, -854.1787197366357, -795.3982971459627, -1022.4907772243023, -666.1126517727971, -994.236007668078, -836.7474363557994, -660.950864776969, -596.3581618107855, -668.4533881545067, -765.6421202495694, -797.4540749192238, -890.0045887306333, -493.76054448634386, -801.0887908525765, -1006.9155444577336, -963.4104573819786, -734.3385098055005, -682.2540640309453, -594.3715263493359, -641.0006485134363, -684.6879411786795, -692.0322964601219, -666.5223170369864, -638.8500844202936, -1087.5684053301811, -863.1620161086321, -797.0132023394108, -808.216433852911, -1025.6268030256033, -959.179990939796, -730.1358530670404, -1019.5908608287573, -610.8875040560961, -710.3449647203088, -839.1630588620901, -1007.4031788744032, -770.5147277414799, -848.6417894288898, -788.429370008409, -919.9068159088492, -760.5452020540833, -1080.0348742399365, -1031.186019986868, -648.0702732503414, -922.1952353194356, -1463.4312198013067, -918.6408698707819, -800.7979324162006, -698.0896246284246, -822.521055392921, -745.3889645189047, -1041.3968031406403, -1013.6735764667392, -866.004380390048, -980.3129573557526, -1075.2239573970437, -462.5229603871703, -828.8008713424206, -666.5044824182987, -733.0840472429991, -1195.2888501808047, -766.5401285514235, -861.9511791653931, -971.6602434366941, -605.8464318960905, -695.4891063869, -1076.1129696555436, -827.1602593008429, -762.9803638607264, -977.7839774489403, -685.8755652084947, -992.5147653482854, -967.199506090954, -669.2131856381893, -711.3219019025564, -659.1089278236032, -540.8367040753365, -745.3663399815559, -726.5734663568437, -494.9823284447193, -713.4075265824795, -826.0721749439836, -737.5033455938101, -1050.6994233578444, -982.8683140724897, -674.4677421599627, -620.3789233714342, -1089.2808470278978, -876.1982349529862, -1128.682805761695, -608.5151978507638, -876.1188556030393, -778.8309846669436, -1109.691467359662, -790.719430282712, -934.7255501486361, -1058.3987829983234, -623.2769245617092, -867.4356099739671, -964.9919085465372, -665.6581013612449, -892.7929944992065, -1309.8900448679924, -649.878406573087, -830.5944363586605, -883.4654534012079, -573.0413340479136, -1848.3200038522482, -746.4996513575315, -742.3108760863543, -807.0765451416373, -780.6688923914917, -991.4374150633812, -974.1249451525509, -919.4465860873461, -1505.809021703899, -659.8999730795622, -689.7606264799833, -700.6059150397778, -755.4586407132447, -891.1564421541989, -704.7055713478476, -1014.0797103047371, -1071.153762102127, -760.4360918998718, -775.905144661665, -543.5335179939866, -955.161843765527, -641.7659538090229, -814.0648152902722, -1140.8284651972353, -749.4098002389073, -702.8631526827812, -1441.1954644359648, -865.2456141263247, -668.2609079182148, -1115.6966133154929, -894.336854301393, -707.7992111705244, -910.2727483808994, -610.6073926985264, -722.303601320833, -871.2276162654161, -909.8625509664416, -856.169356547296, -964.6782406419516, -920.6770251691341, -481.2689282223582, -814.4607568588108, -794.0019172132015, -789.7983958870173, -1156.5757919326425, -891.2569825649261, -1166.7909647077322, -887.7295249663293, -765.3206431642175, -585.9220247715712, -891.5283004641533, -927.8000265359879, -686.8233567476273, -923.8851310908794, -874.3114527314901, -1324.434265948832, -976.1797943264246, -932.8792908042669, -1136.3990044556558, -890.5948089957237, -960.4807744473219, -987.0708805527538, -867.3245109394193, -938.3474155217409, -785.3821636140347, -755.30198559165, -1626.0074480473995, -912.4681522548199, -664.4302735924721, -1055.7490505632013, -597.2828989028931, -800.1850520819426, -1010.7829121500254, -726.1813822761178, -872.3641794919968, -520.7569598704576, -1061.7929070740938, -1542.8507603928447, -1012.8854907974601, -946.5549472048879, -661.4060014337301, -673.7128049135208, -775.3731877282262, -577.2064166590571, -796.2124513536692, -895.7483297139406, -974.5742422193289, -771.6998394206166, -827.5784139111638, -1052.9848236776888, -778.5280113480985, -869.397261781618, -907.0454301796854, -606.7108401656151, -650.4057650268078, -623.6027780622244, -650.7786184772849, -845.6251999437809, -887.4339506775141, -722.725424811244, -668.0433770939708, -832.8955400660634, -704.7842437773943, -801.6449783165008, -758.3427222408354, -703.1965797692537, -869.60542050004, -1045.4252794831991, -1597.9465785622597, -814.6750231161714, -888.8297173082829, -638.1068727597594, -1126.3891530297697, -1041.2846098393202, -640.4856118671596, -771.2717773020267, -793.4198379404843, -1190.2130701579154, -1206.5178888440132, -1071.1934007927775, -761.9525970965624, -967.6494464874268, -493.39026030153036, -664.2605094611645, -737.5700824409723, -837.986429259181, -732.2254497576505, -885.1017875224352, -1048.300288669765, -794.7321216613054, -740.154362089932, -922.514840066433, -810.0767669826746, -899.6255908720195, -660.4028924666345, -954.3614332377911, -907.4997709318995, -810.6271484605968, -681.2738215476274, -781.1646121293306, -498.9407860338688, -827.2504893578589, -1136.304432168603, -581.8449482098222, -555.1760629415512, -545.0110401064157, -616.6792490519583, -1046.9893314614892, -631.946515917778, -917.871350236237, -598.9496093913913, -831.916515558958, -886.1816402766854, -758.4145562443882, -739.8820244260132, -710.9568736180663, -780.446980766952, -746.6429162323475, -734.0871916413307, -1030.4149328134954, -728.8922539278865, -877.1669004727155, -777.3637950979173, -643.550408706069, -712.375882294029, -967.9088604748249, -878.3669004365802, -833.6344071999192, -600.6371846497059, -807.7625410892069, -1059.7874598857015, -1086.038853727281, -897.494702771306, -603.6535618007183, -911.8306785970926, -807.590555626899, -1001.2464667689055, -639.6616892926395, -955.2716715596616, -860.0852210074663, -711.592758834362, -701.7082848846912, -806.6112376749516, -831.0531425029039, -699.6089645922184, -848.5860590785742, -1037.1790379732847, -871.7790024764836, -578.0223434716463, -1197.9579218775034, -860.2357555925846, -790.9549853503704, -639.9914943724871, -744.5882393866777, -871.3354600518942, -611.424448594451, -894.0295598059893, -716.5338374562562, -1050.1239190995693, -868.9549107849598, -964.2671313136816, -982.4659609049559, -871.4604113511741, -694.3034237883985, -1007.7606860548258, -980.0054729282856, -1032.580206334591, -713.4037579447031, -549.1253396868706, -690.685784265399, -998.729810193181, -893.2518089935184, -609.994517184794, -855.722636193037, -503.4716329872608, -953.971697986126, -1028.9451343268156, -743.6042574383318, -1270.762503027916, -1069.1061813421547, -1060.000582024455, -822.9913024157286, -611.3171691000462, -1328.5211650580168, -842.441931117326, -809.314854612574, -902.0163883194327, -703.5351568944752, -826.1241591274738, -789.5001605078578, -842.3543137609959, -959.9875503368676, -904.3536711484194, -575.7559731602669, -1266.3533755466342, -1080.5958911329508, -688.7078313529491, -648.0076026916504, -892.5583153069019, -674.355618422851, -586.3894088938832, -834.3313277177513, -728.2968464270234, -700.5516993254423, -672.8698389679193, -856.0278376638889, -818.0287919640541, -1191.0988052114844, -684.9396761059761, -977.3153277635574, -763.1138170287013, -914.7999628931284, -806.5882100537419, -825.6500764340162, -781.0914308726788, -753.7829434517771, -912.6425694189966, -1610.1597917079926, -1022.9159724712372, -630.2273609489202, -978.4635697081685, -787.15608535707, -792.3372888341546, -751.5376476943493, -1156.78027690202, -834.8797562718391, -1164.218738913536, -690.8999831657857, -824.2073279991746, -760.2615812644362, -1041.0956213325262, -952.2599250003695, -646.3501522392035, -833.3069331534207, -1019.6679206490517, -964.9410223998129, -1064.5983513966203, -951.9829167313874, -830.9365735016763, -884.7927286997437, -952.3559953458607, -943.8603421151638, -906.0458704903722], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41410476187757, "mean_inference_ms": 4.522943392506684, "mean_action_processing_ms": 4.206475748911314, "mean_env_wait_ms": 3.2356590964772276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2358720, "timesteps_this_iter": 131040, "agent_timesteps_total": 2358720, "timers": {"sample_time_ms": 29680.026, "sample_throughput": 4415.09, "load_time_ms": 22.335, "load_throughput": 5867023.586, "learn_time_ms": 14916.682, "learn_throughput": 8784.796, "update_time_ms": 2.275}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789062499997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 395.1046052131147, "policy_loss": 0.001681817323278907, "vf_loss": 79.01902215882441, "vf_explained_var": 0.04681943180740521, "kl": 0.0016490606694168487, "entropy": -0.21870333837565556, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2358720, "num_agent_steps_sampled": 2358720, "num_steps_trained": 2358720, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2358720}, "done": false, "episodes_total": 5120, "training_iteration": 18, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-51-41", "timestamp": 1691020301, "time_this_iter_s": 39.4892373085022, "time_total_s": 625.5464236736298, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 625.5464236736298, "timesteps_since_restore": 2358720, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.43035714285715, "ram_util_percent": 51.32321428571429}}
{"episode_reward_max": -503.4716329872608, "episode_reward_min": -1610.1597917079926, "episode_reward_mean": -865.5852875323966, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-831.0531425029039, -699.6089645922184, -848.5860590785742, -1037.1790379732847, -871.7790024764836, -578.0223434716463, -1197.9579218775034, -860.2357555925846, -790.9549853503704, -639.9914943724871, -744.5882393866777, -871.3354600518942, -611.424448594451, -894.0295598059893, -716.5338374562562, -1050.1239190995693, -868.9549107849598, -964.2671313136816, -982.4659609049559, -871.4604113511741, -694.3034237883985, -1007.7606860548258, -980.0054729282856, -1032.580206334591, -713.4037579447031, -549.1253396868706, -690.685784265399, -998.729810193181, -893.2518089935184, -609.994517184794, -855.722636193037, -503.4716329872608, -953.971697986126, -1028.9451343268156, -743.6042574383318, -1270.762503027916, -1069.1061813421547, -1060.000582024455, -822.9913024157286, -611.3171691000462, -1328.5211650580168, -842.441931117326, -809.314854612574, -902.0163883194327, -703.5351568944752, -826.1241591274738, -789.5001605078578, -842.3543137609959, -959.9875503368676, -904.3536711484194, -575.7559731602669, -1266.3533755466342, -1080.5958911329508, -688.7078313529491, -648.0076026916504, -892.5583153069019, -674.355618422851, -586.3894088938832, -834.3313277177513, -728.2968464270234, -700.5516993254423, -672.8698389679193, -856.0278376638889, -818.0287919640541, -1191.0988052114844, -684.9396761059761, -977.3153277635574, -763.1138170287013, -914.7999628931284, -806.5882100537419, -825.6500764340162, -781.0914308726788, -753.7829434517771, -912.6425694189966, -1610.1597917079926, -1022.9159724712372, -630.2273609489202, -978.4635697081685, -787.15608535707, -792.3372888341546, -751.5376476943493, -1156.78027690202, -834.8797562718391, -1164.218738913536, -690.8999831657857, -824.2073279991746, -760.2615812644362, -1041.0956213325262, -952.2599250003695, -646.3501522392035, -833.3069331534207, -1019.6679206490517, -964.9410223998129, -1064.5983513966203, -951.9829167313874, -830.9365735016763, -884.7927286997437, -952.3559953458607, -943.8603421151638, -906.0458704903722], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404706191635536, "mean_inference_ms": 4.511815857826239, "mean_action_processing_ms": 4.1592729690779455, "mean_env_wait_ms": 3.212613777222092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2489760, "timesteps_this_iter": 131040, "agent_timesteps_total": 2489760, "timers": {"sample_time_ms": 27274.735, "sample_throughput": 4804.446, "load_time_ms": 20.836, "load_throughput": 6289029.943, "learn_time_ms": 14925.381, "learn_throughput": 8779.676, "update_time_ms": 2.254}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394531249998e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 389.62274431023764, "policy_loss": 0.005713894591637741, "vf_loss": 77.91861023441437, "vf_explained_var": 0.007328730223426682, "kl": 0.0018587037903218327, "entropy": -0.22639382740075442, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2489760, "num_agent_steps_sampled": 2489760, "num_steps_trained": 2489760, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2489760}, "done": false, "episodes_total": 5120, "training_iteration": 19, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-51-57", "timestamp": 1691020317, "time_this_iter_s": 15.349410772323608, "time_total_s": 640.8958344459534, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 640.8958344459534, "timesteps_since_restore": 2489760, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.65, "ram_util_percent": 51.42727272727273}}
{"evaluation": {"episode_reward_max": -6186.750578813255, "episode_reward_min": -6186.750578813255, "episode_reward_mean": -6186.750578813255, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6186.750578813255], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -410.6840411350131, "episode_reward_min": -1480.0144494771957, "episode_reward_mean": -710.2203525812089, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-783.9825453460217, -537.9948401227593, -965.8124811649323, -598.3774994164705, -704.2455888316035, -920.8650975339115, -826.8283216431737, -510.57101115584373, -654.680447049439, -805.6765882372856, -575.8790749907494, -786.6945426091552, -692.62210470438, -589.4103066250682, -755.728590592742, -736.0285172089934, -660.3503266982734, -770.7374786250293, -899.361202403903, -609.6211381107569, -703.5919021572918, -1040.733777999878, -565.5114263296127, -608.6115906387568, -712.0933332256973, -817.5775742884725, -712.492761798203, -786.1350603252649, -571.3358695805073, -791.8937992677093, -652.4777673333883, -613.9041435569525, -766.2195999622345, -614.8238944616169, -626.4033053815365, -677.3614199012518, -827.7828569710255, -594.3084469661117, -562.4372757673264, -876.352776221931, -639.2317071035504, -707.133501842618, -435.843950368464, -782.0163362175226, -806.7334267944098, -770.0963570475578, -703.3170640394092, -480.2756884545088, -580.235334135592, -908.1268843747675, -497.7334114462137, -788.0151472240686, -730.4938658773899, -650.9809041768312, -961.6894885096699, -469.50508197396994, -593.8406679779291, -676.3135210424662, -656.5531602501869, -757.1849178820848, -989.2952009290457, -675.5682315155864, -476.04171906784177, -761.6435872912407, -796.4207583516836, -657.0753023400903, -612.8191784918308, -1138.5097215361893, -732.4398624747992, -505.19504706561565, -819.7561912611127, -792.446967408061, -883.6500343680382, -474.88478806614876, -482.55926267802715, -622.8183797001839, -675.4193303883076, -912.6683004200459, -685.7824488580227, -1068.0432430580258, -674.1332515627146, -509.792931355536, -649.7268894761801, -868.4535476267338, -644.9119648616761, -733.6057460606098, -746.0788035020232, -686.0539128631353, -621.746388874948, -685.5954645574093, -738.9942757934332, -801.620751671493, -518.1358163356781, -656.6539287641644, -905.8262610882521, -791.086796104908, -685.5043138861656, -632.4068892151117, -671.8679817467928, -588.4175688326359, -816.6539309024811, -610.3811588250101, -813.3937563449144, -807.6772127002478, -658.8581490367651, -680.0520732402802, -607.7148051559925, -692.3769169151783, -607.1087093949318, -799.4612492583692, -634.1334574148059, -425.0072692297399, -672.8668087534606, -624.9569059349597, -759.7243846729398, -763.7877301573753, -773.8923431485891, -531.9146147668362, -579.1095154955983, -595.076683178544, -795.9398610517383, -830.8796047121286, -931.3056487906724, -671.6193086653948, -630.3118476718664, -560.3072776161134, -654.2902696579695, -1135.7293249964714, -544.5005551278591, -779.403157286346, -746.3489574491978, -653.4392766058445, -1004.4043304473162, -685.3194889500737, -1040.2445940673351, -693.5873108692467, -806.666447840631, -783.7966878563166, -791.2798869758844, -874.0130679532886, -678.4059226028621, -602.6947269961238, -902.4305351674557, -1007.8322682082653, -677.7040557935834, -647.7495588064194, -886.0947245452553, -827.7706774324179, -679.9750932827592, -720.0279780626297, -813.1574628166854, -767.5030017793179, -968.2847687005997, -719.9843185991049, -640.4126048758626, -782.3642460107803, -671.3800848424435, -639.5786957629025, -777.5614978671074, -586.9456344544888, -410.6840411350131, -526.3429060578346, -737.4979019649327, -870.01021720469, -627.5399428531528, -872.9192632697523, -646.5575224608183, -694.226443938911, -649.7744359746575, -819.4225810021162, -743.2549404539168, -807.5595357269049, -751.4171775281429, -796.1840839982033, -881.7545707044192, -852.8320871293545, -747.57420553267, -812.5245931893587, -766.9809465389699, -508.9569375105202, -595.7246929891407, -704.1127962246537, -727.9449673518538, -685.2642414458096, -759.9165459573269, -595.6083071231842, -609.3047136068344, -757.911672398448, -511.0686935260892, -613.4449707642198, -892.3381675928831, -973.2227471023798, -761.9610546529293, -539.1523107141256, -658.046671692282, -518.9934623837471, -695.2306433320045, -843.4933499507606, -842.4086284339428, -566.7323363572359, -521.6171282604337, -832.9950343668461, -574.8100655041635, -619.9007463343441, -523.6793688628823, -706.8005251549184, -654.4779617488384, -693.0140340458602, -772.9154698327184, -815.5708529055119, -726.438066650182, -734.0559995919466, -885.0050009936094, -627.3344499766827, -927.5542807132006, -654.1048320867121, -545.1941010579467, -614.7090199440718, -691.1965558677912, -745.9600723087788, -668.6981934458017, -530.7405072152615, -761.6635161042213, -768.2191558480263, -775.8491156846285, -459.40992210432887, -598.5727346986532, -632.3626394718885, -627.2960902154446, -775.5619482137263, -671.8007347248495, -807.7890935987234, -623.8197496160865, -554.1520675048232, -552.3752657696605, -568.6637058407068, -869.8595726080239, -710.320255920291, -757.8658701553941, -795.6767151430249, -654.822036370635, -653.4044106602669, -596.2354008853436, -731.1035936772823, -669.5236301273108, -728.4405652098358, -1036.8645107001066, -449.55836112983525, -537.1788937672973, -848.9975040927529, -844.4389911442995, -661.6970634534955, -838.6486793458462, -755.0338728278875, -815.9104197025299, -544.4710408281535, -737.6366945654154, -784.1742475517094, -789.5207348018885, -793.3366714119911, -1480.0144494771957, -829.9510684162378, -570.2233625818044, -637.080914825201, -856.2638405412436, -503.27675645798445, -721.4502309188247, -506.3504533544183, -652.9608070552349, -700.9071410670877, -566.6327061057091, -772.7409126758575, -678.4205989539623, -514.4019763767719, -676.6627128571272, -742.4293270558119, -543.0163132250309, -582.7628786936402, -918.1291721016169, -878.1693277060986, -529.0768395289779, -1157.6563556939363, -728.9313012436032, -723.8290356714278, -530.9238136857748, -548.2054388821125, -890.2835729420185, -646.218334838748, -698.0195327699184, -517.9220207706094, -519.9582452215254, -526.2709450945258, -748.0673772022128, -844.4952316433191, -674.3120619133115, -895.3524532169104, -608.5450188592076, -891.8847016356885, -697.0919865965843, -423.24703519791365, -563.3659593313932, -585.8525469489396, -608.9535889849067, -775.7111012749374, -491.9086435586214, -645.6672759577632, -1083.3175576366484, -1053.149278908968, -706.4322362840176, -828.2994413375854, -954.3059706836939, -675.5718697011471, -672.507465749979, -686.8431420177221, -677.1349383145571, -764.4467655867338, -607.6745007075369, -580.0568870231509, -607.2585110533983, -603.1156646311283], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413058481744218, "mean_inference_ms": 4.5248983625840875, "mean_action_processing_ms": 4.206855796631013, "mean_env_wait_ms": 3.235215894591793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2620800, "timesteps_this_iter": 131040, "agent_timesteps_total": 2620800, "timers": {"sample_time_ms": 29702.975, "sample_throughput": 4411.679, "load_time_ms": 22.501, "load_throughput": 5823730.942, "learn_time_ms": 14908.669, "learn_throughput": 8789.517, "update_time_ms": 2.244}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697265624999e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 375.60074420456624, "policy_loss": 0.0006130878049364956, "vf_loss": 75.11930666687668, "vf_explained_var": 0.00924933982151811, "kl": 0.001769385012675976, "entropy": -0.2305090800995895, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2620800, "num_agent_steps_sampled": 2620800, "num_steps_trained": 2620800, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2620800}, "done": false, "episodes_total": 5440, "training_iteration": 20, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-52-36", "timestamp": 1691020356, "time_this_iter_s": 39.112391233444214, "time_total_s": 680.0082256793976, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 680.0082256793976, "timesteps_since_restore": 2620800, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.20357142857143, "ram_util_percent": 51.375}}
{"episode_reward_max": -423.24703519791365, "episode_reward_min": -1480.0144494771957, "episode_reward_mean": -702.8540377488546, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-668.6981934458017, -530.7405072152615, -761.6635161042213, -768.2191558480263, -775.8491156846285, -459.40992210432887, -598.5727346986532, -632.3626394718885, -627.2960902154446, -775.5619482137263, -671.8007347248495, -807.7890935987234, -623.8197496160865, -554.1520675048232, -552.3752657696605, -568.6637058407068, -869.8595726080239, -710.320255920291, -757.8658701553941, -795.6767151430249, -654.822036370635, -653.4044106602669, -596.2354008853436, -731.1035936772823, -669.5236301273108, -728.4405652098358, -1036.8645107001066, -449.55836112983525, -537.1788937672973, -848.9975040927529, -844.4389911442995, -661.6970634534955, -838.6486793458462, -755.0338728278875, -815.9104197025299, -544.4710408281535, -737.6366945654154, -784.1742475517094, -789.5207348018885, -793.3366714119911, -1480.0144494771957, -829.9510684162378, -570.2233625818044, -637.080914825201, -856.2638405412436, -503.27675645798445, -721.4502309188247, -506.3504533544183, -652.9608070552349, -700.9071410670877, -566.6327061057091, -772.7409126758575, -678.4205989539623, -514.4019763767719, -676.6627128571272, -742.4293270558119, -543.0163132250309, -582.7628786936402, -918.1291721016169, -878.1693277060986, -529.0768395289779, -1157.6563556939363, -728.9313012436032, -723.8290356714278, -530.9238136857748, -548.2054388821125, -890.2835729420185, -646.218334838748, -698.0195327699184, -517.9220207706094, -519.9582452215254, -526.2709450945258, -748.0673772022128, -844.4952316433191, -674.3120619133115, -895.3524532169104, -608.5450188592076, -891.8847016356885, -697.0919865965843, -423.24703519791365, -563.3659593313932, -585.8525469489396, -608.9535889849067, -775.7111012749374, -491.9086435586214, -645.6672759577632, -1083.3175576366484, -1053.149278908968, -706.4322362840176, -828.2994413375854, -954.3059706836939, -675.5718697011471, -672.507465749979, -686.8431420177221, -677.1349383145571, -764.4467655867338, -607.6745007075369, -580.0568870231509, -607.2585110533983, -603.1156646311283], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.428031775985907, "mean_inference_ms": 4.5153051292398905, "mean_action_processing_ms": 4.181103836532888, "mean_env_wait_ms": 3.224900170946644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2751840, "timesteps_this_iter": 131040, "agent_timesteps_total": 2751840, "timers": {"sample_time_ms": 27280.782, "sample_throughput": 4803.381, "load_time_ms": 20.891, "load_throughput": 6272507.799, "learn_time_ms": 14888.632, "learn_throughput": 8801.346, "update_time_ms": 2.29}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486328124996e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 353.95043387362017, "policy_loss": -0.004558984073479477, "vf_loss": 70.79441105422153, "vf_explained_var": 0.027943934804649764, "kl": 0.0019633100664545196, "entropy": -0.2361277437979175, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2751840, "num_agent_steps_sampled": 2751840, "num_steps_trained": 2751840, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2751840}, "done": false, "episodes_total": 5440, "training_iteration": 21, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-52-51", "timestamp": 1691020371, "time_this_iter_s": 15.07331895828247, "time_total_s": 695.08154463768, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 695.08154463768, "timesteps_since_restore": 2751840, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.854545454545455, "ram_util_percent": 51.213636363636375}}
{"episode_reward_max": -377.004273802042, "episode_reward_min": -2028.2425642665476, "episode_reward_mean": -666.3620264313145, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-619.3317096754909, -652.1467201039195, -707.7398269400001, -572.8384258896112, -757.9044480621815, -798.2869569212198, -562.4384476467967, -727.7607006058097, -555.2025207132101, -713.1068474650383, -766.3437883257866, -846.705611910671, -756.3712424226105, -683.1820154227316, -511.3714656718075, -559.2174000814557, -795.6865838989615, -1278.6972604095936, -567.6127041503787, -764.9627869725227, -694.6426328793168, -825.0048329681158, -788.1532493159175, -571.3128828033805, -693.8411171585321, -651.2310091629624, -838.4010123685002, -689.4342604875565, -739.0921360626817, -596.772883169353, -599.4970229417086, -600.4224159233272, -571.9509630575776, -494.47942611575127, -607.6694971248507, -931.8864603042603, -489.8001338224858, -742.845507055521, -741.529528208077, -572.544169485569, -729.2789534851909, -961.8241716846824, -608.5331486724317, -600.8896278142929, -590.3806923180819, -749.663346812129, -542.9484557434916, -437.0242394953966, -485.0135213024914, -450.47516937647015, -894.5777479093522, -613.0770981311798, -909.4661655575037, -752.6989638656378, -471.9888167977333, -521.0394015572965, -929.5645888745785, -526.6149673163891, -569.1533022373915, -668.1762646362185, -576.1736312992871, -432.9512407928705, -760.0569912567735, -806.6184559445828, -608.7907999157906, -701.4304313380271, -646.0493279285729, -587.2401576340199, -638.9537673965096, -709.5272767394781, -682.7448040544987, -1042.952915802598, -780.6074481010437, -539.0361139774323, -573.600302875042, -807.7150401473045, -438.5774563252926, -523.9120045304298, -819.6807893663645, -482.3809135258198, -679.1144256144762, -611.078427657485, -448.48120667785406, -646.4200923442841, -841.9100354164839, -701.6448945701122, -682.3331579305232, -491.3272712305188, -698.7098909430206, -510.8143691942096, -580.0671766474843, -701.8611463159323, -585.3012896589935, -812.5088577196002, -482.81549493968487, -1336.7335294410586, -485.32008738815784, -619.5341270565987, -515.9823671728373, -945.9025597125292, -611.3371621891856, -738.6130919158459, -849.5435109362006, -838.7667029127479, -691.1755782626569, -809.345207169652, -659.2788199260831, -642.013908714056, -578.5197608657181, -692.7675864249468, -664.0811457596719, -905.4497348442674, -773.7789592519403, -654.3467546477914, -657.0613861605525, -828.6141268312931, -614.61367431283, -494.1044898033142, -724.4099661782384, -539.719715885818, -860.5955873467028, -602.3111198544502, -628.106338083744, -655.874081350863, -666.1317556574941, -523.0683626234531, -852.6110973805189, -567.3016409277916, -751.956480294466, -861.9464624971151, -555.2033612579107, -625.566270891577, -719.4966221898794, -605.5685744322836, -609.9963044561446, -660.0121992081404, -663.3215562403202, -463.60354322195053, -897.096412576735, -459.1925653219223, -627.7923002429307, -811.9826339557767, -770.7167492508888, -576.6509827971458, -854.0852835550904, -666.9292739927769, -556.5661553218961, -573.5671941936016, -490.700661316514, -893.362198010087, -445.8169386833906, -637.2014125734568, -591.1071768449619, -749.5645700935274, -562.7902587130666, -740.9658894836903, -651.4564689863473, -662.8719670772552, -601.9201277345419, -531.7921722605824, -405.84323831647635, -484.1717061176896, -547.8375852108002, -638.5691094771028, -507.30933737009764, -557.7878083512187, -504.07240803539753, -757.5409515872598, -536.9239726737142, -837.478670373559, -867.1508995778859, -1046.8457642495632, -514.6043865084648, -688.29447722435, -797.725363753736, -651.5878490060568, -765.3222275152802, -738.9846465718001, -811.2273039296269, -778.3953870683908, -654.1445789784193, -865.0181302912533, -437.4912767112255, -743.7406835481524, -650.2714536190033, -636.789623439312, -673.8196744322777, -563.1118204593658, -742.2769122868776, -485.2998074442148, -783.7723930254579, -604.1853859620169, -734.3677830323577, -869.7784840613604, -585.5638717934489, -652.19605730474, -495.03447245433927, -1066.5383817702532, -612.2755976077169, -2028.2425642665476, -645.016395572573, -660.9765054881573, -645.3396563492715, -757.5358377806842, -688.849471449852, -553.8904120624065, -683.8408372327685, -665.7352436296642, -519.8581910133362, -1014.9678865671158, -625.0966024845839, -617.3152096755803, -678.8984677307308, -714.830768302083, -643.8393453657627, -698.0556979179382, -791.436251308769, -888.219829171896, -793.8511675596237, -646.1465980671346, -608.706686258316, -739.6046226769686, -717.5856488794088, -932.6981208845973, -795.307190708816, -602.8022190704942, -756.997313093394, -692.9765899330378, -507.719124302268, -606.9032845646143, -650.3177577257156, -547.3548053279519, -601.7862218171358, -530.3727265745401, -776.9514695033431, -836.6080819889903, -647.888198196888, -569.6044588461518, -570.7358874827623, -671.9440767653286, -786.3221131749451, -587.0050202719867, -617.6319655925035, -843.8010494410992, -629.9984360057861, -812.1969832777977, -812.9918550997972, -629.7324097454548, -627.6137273311615, -746.0543943420053, -510.7710165530443, -711.9589934945107, -554.9176553785801, -775.2865485586226, -576.4791026851162, -496.364978864789, -474.5814385265112, -678.8764382004738, -459.08750443160534, -628.148146674037, -867.5820646770298, -752.3997720703483, -717.846447315067, -522.2394981756806, -687.78885307163, -862.098145853728, -835.3463194593787, -719.1353116035461, -859.2699186746031, -632.898419469595, -729.8770920038223, -629.9765104800463, -708.1560029610991, -821.5045090392232, -500.2396152727306, -396.4731340557337, -640.505444675684, -672.8093647025526, -633.3146476447582, -508.8997168019414, -514.7538333237171, -618.0190206747502, -605.2828739508986, -601.8463767841458, -578.3942859303206, -820.6087414771318, -481.60084254294634, -539.1499206274748, -571.5883127227426, -529.9818398393691, -501.404383957386, -817.0792649313807, -610.5712309330702, -759.652397185564, -558.0196702927351, -655.7507679462433, -686.67056620121, -518.3377145715058, -503.98754873871803, -649.5510214865208, -569.9981520883739, -694.9402404353023, -602.5015379413962, -1276.077080309391, -772.1124107465148, -780.9184815138578, -721.7393524199724, -875.6624349933118, -566.5232412219048, -697.641865350306, -795.4138596430421, -755.3917401283979, -585.9382469654083, -637.2583447042853, -763.5770070925355, -504.1806829124689, -831.8236670307815, -552.0395492613316, -559.0900867134333, -835.9291580170393, -731.0912760421634, -572.6686996594071, -535.6812534816563, -568.9652235321701, -745.7775598373264, -491.12781219929457, -614.4202916771173, -524.6830298453569, -460.82141621410847, -658.0611657202244, -439.06845715269446, -547.4030547067523, -478.5232170969248, -537.1953448578715, -681.2583796232939, -481.7561376094818, -627.3561592102051, -624.5714728832245, -377.004273802042, -522.4918789081275, -800.3003389537334, -759.6933172494173, -462.9274649731815, -597.8101553022861, -712.6960752308369, -608.310143135488, -482.8825453668833, -1136.4166261181235, -647.994427151978, -739.0480747818947, -457.2031041830778, -858.3973922580481, -1128.0679631493986, -755.3614963367581, -727.6600807607174, -582.9389843344688, -794.8213781174272, -656.8704326301813, -523.1724663898349, -871.5834883078933, -685.0848036240786, -863.647872440517, -579.3726146817207, -924.7640854716301, -559.1258099079132, -675.9683950133622, -613.5499634444714, -705.2141864076257, -559.6851108614355, -590.9289127290249, -822.642192542553, -649.0433331336826, -896.3040661811829, -520.4164370447397, -828.9329768121243, -640.0551838688552, -830.6281357705593, -765.6595180146396, -530.368227943778, -577.2650962732732, -499.13203826360404, -826.1825025081635, -624.5522644817829, -498.0838351678103, -668.0375663079321, -746.5557945892215, -830.5474519319832, -724.1095090061426, -729.8840921744704, -729.1199443042278, -667.0309572517872, -718.7480796575546, -520.1123125106096, -766.6697188094258, -669.7758454456925, -481.06129475682974, -680.1575520634651, -552.1960280835629, -688.3705009445548, -760.3478292003274, -813.3807991370559, -857.468070872128, -837.0081078112125, -678.139206238091, -767.7907819505781, -478.88788068294525, -591.0320339500904, -845.9210965111852, -465.4852114468813, -960.1599778458476, -653.428713992238, -582.4134158790112, -760.8907422870398, -433.23992239683867, -667.9602373093367, -680.1376714035869, -691.8731640204787, -419.8041956871748, -722.1439868062735, -844.4005218222737, -521.3341455794871, -576.8298201113939, -669.1181864440441, -707.1599482875317, -442.8505858331919, -677.1582986190915, -644.000949934125, -488.8372584693134, -699.6919132098556, -703.828336507082, -576.9259027019143, -538.832840397954, -523.4031641483307, -733.3602192997932, -498.706475391984, -725.8245931565762, -620.392573511228, -917.8256841860712, -459.1958878338337, -538.0785087943077, -679.6501879859716, -585.1326732933521, -796.9705074578524, -558.6122207269073, -537.7932968065143, -585.7963756471872, -444.3291646055877, -862.3526150286198, -531.0797607861459, -514.0853377357125, -482.87747862935066, -503.65379168093204, -606.0013674497604, -686.6478525847197, -658.3272691071033, -484.95609609782696, -547.0758774727583, -654.1637817025185, -816.2762844711542, -640.2852318733931, -700.3708928860724, -653.1099046580493, -433.69859535992146, -757.1069710999727, -625.5517264604568, -558.2395653948188, -422.9663291051984, -715.9016954749823, -696.4887250997126, -812.5211383774877, -819.0722757093608, -523.3408633172512, -452.2104123160243, -401.4859691038728, -589.0198030695319, -703.4445276372135, -546.6810969822109, -823.1669001430273, -767.4406593255699, -777.1975537091494], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418543145990238, "mean_inference_ms": 4.525700033142423, "mean_action_processing_ms": 4.206047345784709, "mean_env_wait_ms": 3.232614475999721, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2882880, "timesteps_this_iter": 131040, "agent_timesteps_total": 2882880, "timers": {"sample_time_ms": 29662.317, "sample_throughput": 4417.726, "load_time_ms": 22.395, "load_throughput": 5851233.716, "learn_time_ms": 14900.026, "learn_throughput": 8794.615, "update_time_ms": 2.264}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743164062498e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 346.9479335771121, "policy_loss": 0.0051402390542609755, "vf_loss": 69.38420784516147, "vf_explained_var": 0.0264772696947966, "kl": 0.001816616146548625, "entropy": -0.24005240760076002, "entropy_coeff": 0.001}}}, "num_steps_sampled": 2882880, "num_agent_steps_sampled": 2882880, "num_steps_trained": 2882880, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 2882880}, "done": false, "episodes_total": 5920, "training_iteration": 22, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-53-30", "timestamp": 1691020410, "time_this_iter_s": 39.32701778411865, "time_total_s": 734.4085624217987, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 734.4085624217987, "timesteps_since_restore": 2882880, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 44.33214285714286, "ram_util_percent": 51.1375}}
{"episode_reward_max": -401.4859691038728, "episode_reward_min": -960.1599778458476, "episode_reward_mean": -643.5067892429978, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-499.13203826360404, -826.1825025081635, -624.5522644817829, -498.0838351678103, -668.0375663079321, -746.5557945892215, -830.5474519319832, -724.1095090061426, -729.8840921744704, -729.1199443042278, -667.0309572517872, -718.7480796575546, -520.1123125106096, -766.6697188094258, -669.7758454456925, -481.06129475682974, -680.1575520634651, -552.1960280835629, -688.3705009445548, -760.3478292003274, -813.3807991370559, -857.468070872128, -837.0081078112125, -678.139206238091, -767.7907819505781, -478.88788068294525, -591.0320339500904, -845.9210965111852, -465.4852114468813, -960.1599778458476, -653.428713992238, -582.4134158790112, -760.8907422870398, -433.23992239683867, -667.9602373093367, -680.1376714035869, -691.8731640204787, -419.8041956871748, -722.1439868062735, -844.4005218222737, -521.3341455794871, -576.8298201113939, -669.1181864440441, -707.1599482875317, -442.8505858331919, -677.1582986190915, -644.000949934125, -488.8372584693134, -699.6919132098556, -703.828336507082, -576.9259027019143, -538.832840397954, -523.4031641483307, -733.3602192997932, -498.706475391984, -725.8245931565762, -620.392573511228, -917.8256841860712, -459.1958878338337, -538.0785087943077, -679.6501879859716, -585.1326732933521, -796.9705074578524, -558.6122207269073, -537.7932968065143, -585.7963756471872, -444.3291646055877, -862.3526150286198, -531.0797607861459, -514.0853377357125, -482.87747862935066, -503.65379168093204, -606.0013674497604, -686.6478525847197, -658.3272691071033, -484.95609609782696, -547.0758774727583, -654.1637817025185, -816.2762844711542, -640.2852318733931, -700.3708928860724, -653.1099046580493, -433.69859535992146, -757.1069710999727, -625.5517264604568, -558.2395653948188, -422.9663291051984, -715.9016954749823, -696.4887250997126, -812.5211383774877, -819.0722757093608, -523.3408633172512, -452.2104123160243, -401.4859691038728, -589.0198030695319, -703.4445276372135, -546.6810969822109, -823.1669001430273, -767.4406593255699, -777.1975537091494], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409932236744752, "mean_inference_ms": 4.518389323728954, "mean_action_processing_ms": 4.161153628385429, "mean_env_wait_ms": 3.215114814782079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3013920, "timesteps_this_iter": 131040, "agent_timesteps_total": 3013920, "timers": {"sample_time_ms": 27270.178, "sample_throughput": 4805.249, "load_time_ms": 20.752, "load_throughput": 6314716.942, "learn_time_ms": 14883.049, "learn_throughput": 8804.647, "update_time_ms": 2.244}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.768371582031249e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 339.37948388079093, "policy_loss": -0.001698138770205164, "vf_loss": 67.87735223257414, "vf_explained_var": 0.024746722324774685, "kl": 0.0018431307213033774, "entropy": -0.24418737221255524, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3013920, "num_agent_steps_sampled": 3013920, "num_steps_trained": 3013920, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3013920}, "done": false, "episodes_total": 5920, "training_iteration": 23, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-53-45", "timestamp": 1691020425, "time_this_iter_s": 15.13565731048584, "time_total_s": 749.5442197322845, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 749.5442197322845, "timesteps_since_restore": 3013920, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.871428571428572, "ram_util_percent": 51.5}}
{"episode_reward_max": -266.76186725497246, "episode_reward_min": -1407.3087813928723, "episode_reward_mean": -602.8165877596824, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-632.0019967705011, -692.3260503709316, -564.8799322992563, -709.1835635155439, -535.3595301732421, -782.2850970700383, -443.19669177383184, -798.7624360918999, -644.8457934558392, -715.9508943855762, -768.0864524692297, -524.2244706079364, -583.3896017223597, -585.9384109675884, -511.1177865639329, -1407.3087813928723, -392.50010795146227, -697.6164356917143, -559.9832223281264, -563.028627127409, -818.3870767150074, -838.5484312325716, -595.6126249954104, -603.6184170767665, -646.4087513238192, -591.622544169426, -618.5159325748682, -988.1907861381769, -934.2684072367847, -509.9556687101722, -466.4779675900936, -455.93004569783807, -456.57369512319565, -407.20359460636973, -479.9719227850437, -570.3181023299694, -905.6322565246373, -466.30520221590996, -644.0031334497035, -778.8517108112574, -458.5545136630535, -377.31488406285644, -430.87775851786137, -636.270368475467, -554.4455327913165, -545.8823193702847, -546.6672631055117, -574.5383492875844, -731.3867893368006, -516.6973314099014, -420.55593793839216, -567.7057467326522, -566.3301842659712, -798.8249755427241, -458.3054079785943, -726.498946480453, -563.3236809782684, -522.9565390795469, -652.8287091106176, -660.1446264982224, -602.010012820363, -626.3700794652104, -446.1372566521168, -805.7657505422831, -489.46352715045214, -703.9557701535523, -501.59443658590317, -443.7322753742337, -553.1252596527338, -413.9922002181411, -496.99203062057495, -612.7606605291367, -479.82886727154255, -603.9074139371514, -448.51103761792183, -479.71988758444786, -716.3563071787357, -527.4629967212677, -562.1642241925001, -510.51908649504185, -629.9807519027963, -502.5107845067978, -785.5866380259395, -499.5921139754355, -505.5215414762497, -454.57139087468386, -860.4388598203659, -714.5098403766751, -430.34146823361516, -599.1814675331116, -644.1662185490131, -483.24161437153816, -521.3772590383887, -498.61797469109297, -503.82627625763416, -551.0202491134405, -894.8283501714468, -612.4342171102762, -584.0430056490004, -619.1879642866552, -600.1120515875518, -571.525517417118, -580.430647354573, -653.3886895813048, -1004.3829339891672, -479.45135217159986, -630.6801880523562, -661.7618853226304, -902.7533312216401, -750.7132860198617, -655.4265254586935, -641.6533179059625, -783.3740738406777, -738.6761952638626, -666.3539946749806, -744.7492081448436, -768.0141229853034, -838.0068389698863, -469.28819415718317, -540.4010058492422, -726.1560611464083, -621.5708693191409, -569.0333905220032, -589.6065534800291, -548.1182754635811, -734.7836421951652, -795.3500570654869, -697.7786754146218, -450.3996818885207, -654.3819868415594, -482.9486774727702, -579.1474780142307, -494.5366740822792, -358.11981067061424, -672.657087624073, -602.9081705510616, -735.946142628789, -577.5684813410044, -443.7950070798397, -427.58102717995644, -505.8009397238493, -673.2855746783316, -660.8660365492105, -350.5816602483392, -467.192858427763, -361.0505109280348, -624.1699845343828, -595.0299435704947, -623.4952410310507, -518.1308931708336, -601.2742979303002, -498.490223556757, -471.2397569268942, -495.3150264322758, -364.5655262544751, -472.97277139499784, -598.4329294338822, -750.3735741227865, -506.90297554433346, -556.3203498162329, -996.892502233386, -500.547740213573, -641.7184596061707, -715.3436823487282, -524.4329269230366, -421.97860239446163, -724.0801551267505, -372.2369488030672, -449.6599577665329, -373.0339839756489, -554.2472044602036, -518.671584315598, -545.7389793172479, -507.9080822020769, -505.0954208895564, -758.8651576265693, -438.1067999377847, -451.30036985874176, -547.5466153025627, -385.729299698025, -892.8520793169737, -453.34696977213025, -650.3421647101641, -583.4036262631416, -616.9511122331023, -609.7812856696546, -688.4297405034304, -643.4591023400426, -536.3048800565302, -729.5205110758543, -659.7027037590742, -697.1049747727811, -819.4301286190748, -708.0392618253827, -462.5178726091981, -704.0300237089396, -682.0332846790552, -563.6445416659117, -593.0752429068089, -611.8601351231337, -742.1983294580132, -657.9050368070602, -679.0579408332705, -902.3169098459184, -522.7542209625244, -504.31117279827595, -947.2640439905226, -758.2701521068811, -634.5327541232109, -642.1809942163527, -827.8682147562504, -600.080233424902, -903.7886304408312, -757.6451684907079, -905.8345962762833, -610.7310183253139, -613.1790879741311, -739.1562581639737, -700.4939207918942, -578.0316005349159, -710.345396604389, -637.3854237534106, -821.6375622302294, -400.89235508441925, -506.3685607984662, -696.4543563425541, -613.3161993063986, -478.87385258078575, -522.5500777512789, -640.7997158952057, -598.1970569193363, -504.26253962516785, -581.4626880288124, -761.1835548505187, -422.6172492355108, -438.23889061808586, -777.4794076830149, -475.6348624974489, -527.8705455213785, -709.8734995462, -630.0083870068192, -632.1527375280857, -577.6916196942329, -394.4712457880378, -579.7001153826714, -499.29735523089767, -419.1785454452038, -482.61969266831875, -555.1698783263564, -705.1410874575377, -511.26005823910236, -663.7818704470992, -549.1793524026871, -1066.4102123752236, -453.77755776047707, -712.2065318115056, -266.76186725497246, -536.5402184203267, -662.5988416150212, -515.301084510982, -600.4734322354198, -672.2927385941148, -592.8886763658375, -614.6752617172897, -564.555701491423, -706.5320871025324, -536.5574736073613, -484.53713704645634, -474.35128835216165, -499.4827232733369, -444.46587551385164, -551.6136270165443, -455.71486484259367, -539.2499761879444, -788.3338964506984, -495.0198331475258, -521.8052164465189, -410.80819803103805, -474.96010733395815, -505.05871253460646, -683.3329359963536, -565.8703680038452, -551.1854671612382, -479.1451112627983, -910.0298508405685, -490.7519259788096, -685.7081503421068, -632.0761985778809, -646.4532199129462, -797.0597429573536, -878.9499295912683, -752.1553287357092, -530.4387816041708, -742.4175010845065, -831.337681055069, -590.1365912854671, -729.420800074935, -574.387606471777, -425.5484789684415, -533.716502610594, -983.2707178071141, -378.69877760857344, -727.0509981364012, -432.1836175620556, -806.7431710381061, -502.02173276245594, -483.2959742518142, -640.7635680548847, -747.9204766526818, -852.2549653351307, -845.6845242530107, -975.93904517591, -463.94224405288696, -700.3391129076481, -880.7188058942556, -790.5641352087259, -682.8457148522139, -483.49826150760055, -514.4267660789192, -448.543999357149, -636.2072340250015, -556.9678095551208, -505.2058058977127, -600.1666376665235, -588.1579087460414, -526.6359881069511, -563.8329411298037, -575.6165353655815, -631.0689020659775, -483.41009046137333, -693.1872150450945, -791.3636469244957, -504.355112940073, -594.5934141948819, -614.711678724736, -393.9749543964863, -481.32532289624214, -369.7613462097943, -326.07063798606396, -548.8919692486525, -510.0067249238491, -552.609552398324, -668.8345044329762, -369.8643940538168, -465.5358312949538, -599.7811396718025, -427.51811872422695, -468.70212277024984, -636.8084594905376, -490.9510377570987, -522.3181689307094, -453.20525358617306, -562.5352064222097, -650.4750708043575, -458.87212816625834, -372.04508869349957, -500.7917201668024, -541.3181529864669, -631.7382558323443, -423.12214260548353, -637.9406526088715, -508.3834619522095, -707.8714958652854, -532.2717980369925, -410.0086348503828, -500.110375225544, -550.9983389079571, -500.4984717518091, -492.62732687592506, -458.23100820183754, -629.2706805355847, -466.0827070623636, -560.5680210292339, -484.0191152840853, -530.6561478748918, -603.4349049329758, -632.7800405286252, -610.6962375193834, -598.4539121948183, -526.813160918653, -591.5317182689905, -534.9750341512263, -636.0601928979158, -673.6363421082497, -828.6642077118158, -470.1445973627269, -741.4884718358517, -753.7804194837809, -473.8513169288635, -851.8534964323044, -538.0881185680628, -850.4910758882761, -1109.131362453103, -781.5636396817863, -626.7723657079041, -385.4315840266645, -760.8928023055196, -794.1194423921406, -725.9004327580333, -792.4741450324655, -565.1600804403424, -690.6567921042442, -738.5112563148141, -815.1920843087137, -759.2952805161476, -642.2998865619302, -452.2014791928232, -531.9861481338739, -920.304476827383, -532.8949527069926, -628.6865906529129, -814.6502647250891, -685.9611788000911, -747.7118791565299, -743.7200238220394, -682.2033354640007, -685.2509467154741, -545.9715651124716, -470.6349047720432, -791.8643143624067, -497.0840738341212, -719.061147801578, -552.1611856147647, -477.6640612632036, -656.3410535752773, -525.5277786627412, -512.1137153729796, -763.9943448007107, -735.0780464857817, -616.2475023269653, -518.9717426151037, -538.4908857755363, -471.94548527896404, -667.0168870724738, -479.8767168112099, -642.9622587636113, -617.7411386296153, -709.660284653306, -633.8946565166116, -435.5249405801296, -850.9057984724641, -663.8879235498607, -502.93178244680166, -488.31160601973534, -445.3521250523627, -609.0094073787332, -558.4134840667248, -476.15748707950115, -789.9543726444244, -424.3018154259771, -570.2921936959028, -636.16984494403, -616.1513388222083, -745.0657102502882, -658.2590779364109, -452.547173704952, -651.9860198050737, -478.18773723207414, -653.0360347293317, -462.4500338882208, -640.0950884744525, -483.938647210598, -675.6915215551853, -986.3843464851379, -675.3560284078121, -467.121954806149, -691.6867248918861, -484.0738111138344, -603.5734329968691, -268.3934429883957, -445.8778225928545, -498.73133731633425, -507.7287233695388, -788.6394773572683, -556.1843490600586, -471.9531021155417, -569.9070880562067, -657.8361054509878, -393.44752143137157, -514.0264701563865], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416340920806429, "mean_inference_ms": 4.526609673873157, "mean_action_processing_ms": 4.205634893960511, "mean_env_wait_ms": 3.231478076604525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3144960, "timesteps_this_iter": 131040, "agent_timesteps_total": 3144960, "timers": {"sample_time_ms": 29639.799, "sample_throughput": 4421.083, "load_time_ms": 22.396, "load_throughput": 5850928.502, "learn_time_ms": 14892.552, "learn_throughput": 8799.029, "update_time_ms": 2.275}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841857910156245e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 328.2858616844026, "policy_loss": -0.00634533292236116, "vf_loss": 65.66326764834824, "vf_explained_var": 0.010341153990837836, "kl": 0.0017128115505737633, "entropy": -0.2513509231442619, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3144960, "num_agent_steps_sampled": 3144960, "num_steps_trained": 3144960, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3144960}, "done": false, "episodes_total": 6400, "training_iteration": 24, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-54-25", "timestamp": 1691020465, "time_this_iter_s": 39.183414697647095, "time_total_s": 788.7276344299316, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 788.7276344299316, "timesteps_since_restore": 3144960, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 44.12678571428571, "ram_util_percent": 51.39107142857143}}
{"evaluation": {"episode_reward_max": -5202.220133908093, "episode_reward_min": -5202.220133908093, "episode_reward_mean": -5202.220133908093, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5202.220133908093], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -319.0729277431965, "episode_reward_min": -1478.812313362956, "episode_reward_mean": -543.7702633125353, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-443.959326967597, -618.0255789905787, -881.2611456345767, -644.1707895938307, -507.0669693350792, -466.05746644735336, -421.32313035055995, -419.8094696626067, -571.0080917775631, -519.6565538495779, -671.291082918644, -715.1464979536831, -700.570871680975, -476.06149722263217, -662.9295755922794, -455.5009922012687, -545.419697329402, -633.793386772275, -428.5043980255723, -582.3652897775173, -660.9473605751991, -582.7286502793431, -738.7115516364574, -384.3880484774709, -462.34724997356534, -540.8812504447997, -541.5280347317457, -600.9300489798188, -497.36745288968086, -645.9802770614624, -482.64211009442806, -438.65965853631496, -416.35288892686367, -702.0716597288847, -655.2093779183924, -532.8758741691709, -358.43866066634655, -404.1902251318097, -685.8244699910283, -422.1869032755494, -468.2805734425783, -434.559122890234, -491.5601992160082, -735.9131649360061, -540.7575539052486, -596.9582470804453, -508.63831639289856, -552.5328017547727, -530.7126332223415, -584.4826011881232, -616.1124523729086, -501.8118471354246, -465.4591160044074, -447.81866594031453, -627.2620945125818, -349.6441175416112, -543.9609932005405, -554.9147504493594, -397.66172279044986, -427.6404608413577, -484.0786015689373, -433.9373488277197, -493.2439074125141, -513.6806083004922, -389.6918053999543, -620.6136163175106, -531.3554040063173, -576.4630777016282, -623.2643399685621, -428.77478620409966, -501.86329421401024, -529.5343407690525, -466.2765786461532, -599.1002472357359, -629.8465718124062, -592.1817638985813, -468.21832368150353, -515.8942723348737, -486.4625448137522, -368.65015518292785, -491.0888130441308, -532.1011580601335, -492.4358362555504, -459.25504986196756, -619.3775220364332, -650.3820697274059, -522.4544065669179, -473.7530236840248, -526.52535507828, -452.7921288125217, -616.2601012475789, -521.6999996453524, -436.2686026543379, -506.75188671797514, -374.22934870421886, -442.54361433908343, -463.7799069285393, -628.3051879927516, -748.8371097333729, -703.5662840604782, -383.4479987695813, -319.0729277431965, -536.8957028314471, -579.1719772070646, -590.8824979104102, -431.59346698224545, -553.4931850209832, -524.1620630845428, -661.619032677263, -586.9767330624163, -627.7934880331159, -460.29575108364224, -666.452087238431, -468.71790435910225, -414.43309549987316, -512.5025210678577, -641.6231502629817, -403.50729240477085, -565.1103343218565, -726.8710668794811, -551.0469922199845, -584.6470213979483, -568.3765159249306, -429.0826340392232, -489.058493366465, -780.6104402393103, -636.7674346528947, -521.7610012665391, -560.4998619239777, -599.346867904067, -472.26964266598225, -528.2365788966417, -585.6120104491711, -591.562676653266, -645.564345549792, -518.5661105811596, -427.65379852056503, -454.11593125760555, -460.837545722723, -597.7163268812001, -468.8419169411063, -515.2997180223465, -635.6947394758463, -512.3871871707961, -571.2801162153482, -469.40513004362583, -668.2843948453665, -651.8035880587995, -442.5525761023164, -513.1267382353544, -540.3810368478298, -492.22923669964075, -545.6627741344273, -452.20960726588964, -419.04105104506016, -473.2582881003618, -479.60940929315984, -576.5701550841331, -419.5717459656298, -579.311440102756, -411.94319815933704, -584.9921184927225, -477.80449701845646, -434.0806565694511, -734.1729486249387, -442.29441323131323, -433.7424113303423, -538.7218229286373, -515.0449956059456, -525.0631116759032, -495.43945077061653, -638.5662770420313, -578.3128944188356, -390.69264731556177, -521.6635342910886, -696.0948012843728, -429.2082372158766, -404.99067705869675, -341.06293128430843, -570.9471520632505, -656.4591976851225, -511.09965558350086, -456.2708587870002, -425.71576072461903, -622.0150280594826, -495.76163091138005, -376.9177325218916, -546.6670443955809, -452.06445307284594, -480.1462256014347, -398.3934354223311, -489.8198009878397, -533.5910654813051, -487.5733083486557, -596.1809628307819, -739.0420955047011, -602.0647391118109, -555.2012161463499, -676.9300670996308, -645.777779057622, -457.4817828312516, -549.9955761060119, -621.2150032073259, -741.6781477481127, -653.6821799278259, -362.7587045133114, -459.56674436479807, -450.18820882588625, -694.5640653371811, -911.4048931673169, -595.359577126801, -504.4599149003625, -538.4370664805174, -469.2664611916989, -1174.3658491969109, -627.1794890835881, -601.3177039548755, -594.7848392575979, -629.2589109539986, -554.2630918323994, -383.1084047034383, -693.0904805660248, -607.8005436584353, -673.3516937345266, -525.5273795202374, -505.6021184436977, -377.4731844328344, -795.052708119154, -552.937093924731, -558.8717384338379, -554.5100376605988, -364.83177157863975, -598.0576444715261, -570.524448685348, -528.218084808439, -585.7988783493638, -652.5279740393162, -466.7588666751981, -443.25553756952286, -1478.812313362956, -452.82479852437973, -412.47230476140976, -660.9893954247236, -506.02600901946425, -518.5398971885443, -441.2674785107374, -469.30304239690304, -624.8457323461771, -563.4368257969618, -504.3038333132863, -546.7145040556788, -503.7030143458396, -554.4906780682504, -630.1384480148554, -646.4997675642371, -504.1899704039097, -519.800390586257, -667.9314295500517, -421.156451664865, -505.0032500848174, -509.7188479527831, -527.9611332267523, -420.65958415716887, -421.5870263054967, -439.7867208495736, -664.4713549315929, -574.1282213255763, -609.6545509397984, -520.4940339028835, -434.987148553133, -593.8730007708073, -462.9762507677078, -567.8867420554161, -458.88074450194836, -523.3616878092289, -409.67781654465944, -717.7563453987241, -558.1881622523069, -553.7820198759437, -590.795403495431, -489.25555082410574, -537.4950554817915, -643.9794507920742, -591.5162601172924, -500.42686288431287, -370.4730761349201, -429.0667278598994, -734.9786875136197, -738.2011864893138, -449.1497005224228, -472.5963285192847, -712.0192394405603, -542.7666212692857, -504.0210564881563, -327.72775154560804, -827.6759692318738, -599.3313925266266, -499.83983317017555, -765.3659252077341, -663.931464150548, -436.03178837895393, -322.6199227422476, -410.2886293530464, -396.28164506703615, -515.6317013949156, -478.0089368671179, -557.1479396820068, -512.587982557714, -364.07651118189096, -427.26041508466005, -695.0965550690889, -537.9391831457615, -623.8121652603149, -532.7076565995812, -729.3209703788161, -591.5096034929156, -651.5948354005814, -683.2010596394539, -565.1449214816093, -472.9939337745309, -439.2542385905981, -530.899534303695, -447.57797096669674, -438.9252346456051, -625.8285507783294, -677.5405084937811, -520.0630287751555, -471.1382042169571, -398.89946223795414, -715.5598964877427, -550.3438840284944, -571.4239648282528, -579.4428811967373, -698.2836819365621, -513.9774987511337, -353.55328799784184, -510.59814230538905, -688.5407051034272, -446.40424107015133, -475.1205170378089, -459.638020247221, -494.5978684425354, -520.4527602419257, -398.0550668910146, -534.5296440348029, -480.29903911054134, -682.7049612849951, -483.95222072303295, -459.67521065473557, -345.71156914532185, -538.3610722571611, -408.29015711694956, -387.0043208003044, -665.0939310789108, -541.9979536440223, -631.427000656724, -350.0574522316456, -610.0090224891901, -528.1752339769155, -575.9831109568477, -415.9935822598636, -747.6290155723691, -485.89394579827785, -471.6520843356848, -417.92391389608383, -452.08140847086906, -377.0835283398628, -429.4006765410304, -558.329103320837, -630.4314058367163, -412.8338674008846, -546.3137706406415, -444.57044044323266, -478.59378699213266, -740.9063645005226, -469.6120054796338, -663.2821388542652, -568.2150025367737, -394.80826481990516, -427.5981399267912, -447.3820370808244, -659.9057507812977, -460.4415286183357, -532.8483802899718, -635.975283369422, -704.0250001102686, -562.7745313458145, -645.005194760859, -665.610963832587, -603.2716201841831, -508.79895420372486, -613.9655677750707, -480.89804342389107, -734.3825039714575, -526.3988440930843, -369.022456638515, -660.7003240287304, -740.739211037755, -719.5238842759281, -590.1985151283443, -534.5677782148123, -519.2565857544541, -430.0643921419978, -484.1045086532831, -446.03198635578156, -409.906452126801, -576.2954631447792, -453.8395296111703, -610.8041022215039, -457.8310018181801, -553.1173133924603, -492.67757008969784, -561.914741680026, -627.9882514104247, -485.65627796575427, -684.2087587863207, -621.1828676536679, -561.3597797080874, -536.6652307063341, -432.6034595184028, -618.9496835619211, -594.579603984952, -402.20157849788666, -562.135639719665, -624.4343561828136, -494.90765933692455, -533.8197284471244, -556.0970019306988, -540.5512947179377, -489.70102313160896, -453.6396709345281, -626.3945880420506, -581.4811820983887, -605.5755141526461, -618.1232834476978, -563.2919117361307, -606.5479846224189, -469.00372721254826, -630.0221511572599, -641.5505241751671, -548.7683142647147, -432.8626085668802, -590.7917398512363, -702.3958383947611, -643.7196660488844, -664.645027115941, -472.2719940841198, -611.3955984562635, -620.3734078332782, -507.9539062231779, -451.8145552650094, -409.19613863527775, -668.3876871168613, -659.7839295566082, -667.9278622716665, -737.9547833167017, -651.9589548110962, -680.3287525363266, -742.9658370949328, -406.5392694026232, -560.6591064445674, -476.26037959754467, -611.3320140689611, -539.9596621096134, -692.4416644535959, -554.5608615651727, -480.0813461393118, -750.8544632941484, -404.2501692920923, -678.7130299881101, -663.3583925813437, -541.5347042828798, -418.04561423510313, -451.27956119924784, -431.1491080969572, -610.432060200721, -648.1237440593541, -445.3603374660015, -666.0170096717775, -443.6932312641293], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413201021769342, "mean_inference_ms": 4.528359684346606, "mean_action_processing_ms": 4.205186266279293, "mean_env_wait_ms": 3.231405699887853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3276000, "timesteps_this_iter": 131040, "agent_timesteps_total": 3276000, "timers": {"sample_time_ms": 29652.185, "sample_throughput": 4419.236, "load_time_ms": 22.638, "load_throughput": 5788463.928, "learn_time_ms": 14889.721, "learn_throughput": 8800.702, "update_time_ms": 2.266}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920928955078122e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 329.84665131180293, "policy_loss": -0.004827838146998151, "vf_loss": 65.97390670502912, "vf_explained_var": -0.0012709114927544815, "kl": 0.001907368969609527, "entropy": -0.25256599969227256, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3276000, "num_agent_steps_sampled": 3276000, "num_steps_trained": 3276000, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3276000}, "done": false, "episodes_total": 6880, "training_iteration": 25, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-55-04", "timestamp": 1691020504, "time_this_iter_s": 39.18952941894531, "time_total_s": 827.917163848877, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 827.917163848877, "timesteps_since_restore": 3276000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.126785714285724, "ram_util_percent": 51.41071428571429}}
{"episode_reward_max": -369.022456638515, "episode_reward_min": -750.8544632941484, "episode_reward_mean": -564.9509508385137, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-447.3820370808244, -659.9057507812977, -460.4415286183357, -532.8483802899718, -635.975283369422, -704.0250001102686, -562.7745313458145, -645.005194760859, -665.610963832587, -603.2716201841831, -508.79895420372486, -613.9655677750707, -480.89804342389107, -734.3825039714575, -526.3988440930843, -369.022456638515, -660.7003240287304, -740.739211037755, -719.5238842759281, -590.1985151283443, -534.5677782148123, -519.2565857544541, -430.0643921419978, -484.1045086532831, -446.03198635578156, -409.906452126801, -576.2954631447792, -453.8395296111703, -610.8041022215039, -457.8310018181801, -553.1173133924603, -492.67757008969784, -561.914741680026, -627.9882514104247, -485.65627796575427, -684.2087587863207, -621.1828676536679, -561.3597797080874, -536.6652307063341, -432.6034595184028, -618.9496835619211, -594.579603984952, -402.20157849788666, -562.135639719665, -624.4343561828136, -494.90765933692455, -533.8197284471244, -556.0970019306988, -540.5512947179377, -489.70102313160896, -453.6396709345281, -626.3945880420506, -581.4811820983887, -605.5755141526461, -618.1232834476978, -563.2919117361307, -606.5479846224189, -469.00372721254826, -630.0221511572599, -641.5505241751671, -548.7683142647147, -432.8626085668802, -590.7917398512363, -702.3958383947611, -643.7196660488844, -664.645027115941, -472.2719940841198, -611.3955984562635, -620.3734078332782, -507.9539062231779, -451.8145552650094, -409.19613863527775, -668.3876871168613, -659.7839295566082, -667.9278622716665, -737.9547833167017, -651.9589548110962, -680.3287525363266, -742.9658370949328, -406.5392694026232, -560.6591064445674, -476.26037959754467, -611.3320140689611, -539.9596621096134, -692.4416644535959, -554.5608615651727, -480.0813461393118, -750.8544632941484, -404.2501692920923, -678.7130299881101, -663.3583925813437, -541.5347042828798, -418.04561423510313, -451.27956119924784, -431.1491080969572, -610.432060200721, -648.1237440593541, -445.3603374660015, -666.0170096717775, -443.6932312641293], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402520348860783, "mean_inference_ms": 4.5200872458379395, "mean_action_processing_ms": 4.1573261126325285, "mean_env_wait_ms": 3.2095637360115155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3407040, "timesteps_this_iter": 131040, "agent_timesteps_total": 3407040, "timers": {"sample_time_ms": 29649.47, "sample_throughput": 4419.641, "load_time_ms": 22.638, "load_throughput": 5788524.892, "learn_time_ms": 14896.079, "learn_throughput": 8796.946, "update_time_ms": 2.268}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.960464477539061e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 318.75388446192056, "policy_loss": -0.005529151979348355, "vf_loss": 63.75604983640828, "vf_explained_var": 0.008018732284559571, "kl": 0.00192536720584604, "entropy": -0.2574465673243273, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3407040, "num_agent_steps_sampled": 3407040, "num_steps_trained": 3407040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3407040}, "done": false, "episodes_total": 6880, "training_iteration": 26, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-55-19", "timestamp": 1691020519, "time_this_iter_s": 15.321572303771973, "time_total_s": 843.2387361526489, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 843.2387361526489, "timesteps_since_restore": 3407040, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 13.831818181818182, "ram_util_percent": 51.27727272727271}}
{"episode_reward_max": -260.9045622050762, "episode_reward_min": -859.8061380833387, "episode_reward_mean": -486.3840875751688, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-449.8237783238292, -593.9554971791804, -517.4311628118157, -553.448154322803, -495.85135009139776, -400.9903385769576, -382.66440061479807, -519.7580195441842, -440.6730903983116, -487.2152482904494, -522.8499934822321, -647.3277062363923, -494.19825526326895, -574.7879611551762, -461.29633159935474, -484.11885246634483, -454.44408959522843, -524.9494334384799, -402.70140124857426, -574.4279993399978, -504.01293759047985, -513.6748669929802, -468.1552682630718, -493.98740193247795, -461.2398444712162, -500.9775509312749, -462.04883670061827, -417.43249585852027, -385.73380533605814, -655.796223923564, -457.1343457624316, -586.4708030261099, -410.5569045320153, -433.17148615419865, -436.2179017364979, -404.1614333614707, -467.75447285175323, -409.96388052403927, -463.9320864006877, -355.5203756764531, -440.06158712506294, -513.4267201572657, -382.0287443548441, -343.6923071593046, -463.61656361818314, -368.33165434747934, -399.6324072740972, -427.9615284986794, -534.4305782020092, -488.71810096874833, -473.20444762706757, -614.142342414707, -478.1183724626899, -464.96063604950905, -488.69951029866934, -377.60290254093707, -355.8807063549757, -493.00533708557487, -445.5043655410409, -615.799805894494, -455.35475996136665, -366.2663260027766, -462.731693610549, -513.0070276260376, -460.40166464447975, -407.92131638526917, -437.07904628291726, -410.30778816342354, -475.31971049308777, -356.4919722676277, -587.1986089125276, -547.5628774911165, -522.9226215332747, -413.63367022946477, -540.4070124551654, -485.1258731968701, -627.8746494501829, -408.14689292013645, -439.27025259286165, -459.22060073912144, -400.0207356736064, -540.9885818213224, -376.17267839610577, -509.37047706358135, -407.646453499794, -526.0472428053617, -505.0505097657442, -647.9747605323792, -466.1374109014869, -426.9498529434204, -419.66115376725793, -395.30893282592297, -773.5055000185966, -479.6740302890539, -447.5269557312131, -430.3543486446142, -414.6516172401607, -491.6591186672449, -592.8583974540234, -567.0601165667176, -526.0170160084963, -480.5768147073686, -639.9650829732418, -399.5696666687727, -558.1830465868115, -537.5299585312605, -609.179174112156, -509.23590330034494, -499.1900416314602, -608.8100975602865, -594.8405548781157, -500.13423290476203, -439.32111823931336, -535.0137159600854, -334.86640471965075, -507.7336428835988, -577.9655922502279, -378.0058860294521, -386.55716662853956, -613.9283434972167, -571.9004414007068, -518.1144813597202, -390.1735720783472, -473.1880065277219, -663.9520373344421, -440.8389752060175, -501.9787365682423, -555.1794275231659, -502.53153252601624, -488.9617369771004, -453.23374047875404, -541.0324505567551, -535.2551229074597, -523.9371666610241, -427.2239499390125, -460.851280644536, -593.384878270328, -357.9466366991401, -397.68987037986517, -452.3480301052332, -448.446908056736, -414.934950761497, -510.62964874878526, -432.869468934834, -586.6604663357139, -380.5361453294754, -472.6588836014271, -667.4391739480197, -432.0245929211378, -466.9327761679888, -466.42693311721087, -348.6978874653578, -489.77285200357437, -316.1406964883208, -405.3123038113117, -465.5300145596266, -555.2815935760736, -586.4452525451779, -427.9555567484349, -387.1728050708771, -457.3776053637266, -470.8323287591338, -400.4671559780836, -527.2079491168261, -432.34724536538124, -518.8877723813057, -417.0653473306447, -521.5715826898813, -550.1468804627657, -419.0406510308385, -420.98830449581146, -393.7955791205168, -340.96159464120865, -483.30980414897203, -534.4533605091274, -466.3803606852889, -491.5807459205389, -422.0303601324558, -483.5045566931367, -637.1854944005609, -550.9952093064785, -553.2942305207253, -484.83379642665386, -475.49226927384734, -371.5076058804989, -360.5639171898365, -441.64244386926293, -424.32997968792915, -499.3351899161935, -326.29878157377243, -435.90189407393336, -528.5099727641791, -376.34915129840374, -413.48344807326794, -470.85043132305145, -493.8328375816345, -456.44006188213825, -501.05922108888626, -539.0806317776442, -525.9537216611207, -552.6994320303202, -662.9007806554437, -377.036634799093, -535.7313315272331, -655.9882354736328, -599.8141081482172, -698.0311813354492, -484.97169075906277, -747.1487946584821, -404.36093340069056, -441.2097444757819, -431.82381868734956, -434.75739048421383, -503.2005750089884, -435.1784484907985, -384.67564265429974, -605.6215275153518, -500.11312063224614, -439.66014144569635, -464.63652887940407, -479.8772173449397, -438.64136508852243, -438.89779637008905, -482.0167396850884, -491.8408046364784, -464.5693918764591, -355.5801476612687, -515.8075542673469, -369.84941010922194, -455.4644526913762, -462.290539319627, -495.98225589841604, -451.2340040951967, -552.4331938996911, -406.8851710781455, -335.81475774757564, -525.217022895813, -371.7051010578871, -445.29425728321075, -540.9463867545128, -467.7735831812024, -541.6693803444505, -409.48141626268625, -437.74425829946995, -368.03567376732826, -466.363322943449, -395.38191002607346, -407.31566175073385, -260.9045622050762, -674.0314093902707, -576.8321686387062, -529.1970145255327, -457.4782791249454, -617.7542208656669, -443.13230957090855, -435.2152185589075, -426.38493932783604, -501.3345964550972, -415.97331804409623, -461.7459376677871, -475.2177600041032, -494.739251434803, -465.3895855396986, -279.8322675675154, -591.5774024315178, -512.9239643216133, -464.0886265747249, -472.6141167357564, -441.19245751202106, -439.93385892827064, -425.69310361891985, -413.68597488105297, -421.6480713710189, -433.51441322267056, -529.0819161087275, -464.08598889410496, -647.4897288680077, -545.2138658165932, -488.5946643128991, -553.7269624769688, -466.0533517859876, -523.5432002544403, -456.0407340042293, -495.90177361667156, -595.5181498974562, -543.90942761302, -428.87204548344016, -504.21841213852167, -447.7005387544632, -568.1125832423568, -417.5511396229267, -443.4316750355065, -408.06606437265873, -462.0223149359226, -359.96186458319426, -469.6855910792947, -510.2168057784438, -407.62833869457245, -648.3678544685245, -568.8913232050836, -697.3461522907019, -547.6737499572337, -545.5193580240011, -726.8000638782978, -586.4856243431568, -471.71701845526695, -516.5197523441166, -519.1508667618036, -617.3381025493145, -552.1582778990269, -409.5750823020935, -466.2193728387356, -583.4130282476544, -591.068362466991, -677.1802573539317, -411.4926113113761, -540.1500735729933, -508.6941554173827, -459.6964805275202, -560.9237143546343, -483.60977905243635, -514.140720449388, -628.9598248749971, -440.2517037689686, -391.93670270591974, -569.1094328463078, -344.95643728226423, -426.39892226457596, -513.3862997815013, -496.05795124173164, -395.0781821832061, -600.5379692316055, -583.2287778630853, -452.48683040589094, -554.9355081692338, -425.7050237059593, -602.5867563635111, -563.4121075645089, -467.4293679818511, -507.6602878123522, -406.2515564262867, -529.41146678105, -530.8787858299911, -528.4657630883157, -442.5426392033696, -430.91333497315645, -474.18431455641985, -397.0955977141857, -465.44548350572586, -623.6381694227457, -636.3363676294684, -404.38543827086687, -370.0135438144207, -549.4409537538886, -546.0020288825035, -392.29392878711224, -456.55476949363947, -692.303787715733, -407.8780246898532, -448.5157024562359, -407.48970463871956, -563.6492351442575, -650.2407061606646, -469.6731294542551, -481.8197092860937, -395.0330962985754, -474.6457079946995, -456.00437131524086, -423.3043228741735, -460.1338719576597, -615.7762548476458, -655.5768604800105, -311.7861243933439, -592.9869488812983, -438.890504764393, -574.0123831480742, -408.30624451488256, -448.53359768539667, -418.7602945417166, -465.31671653687954, -466.7567660138011, -435.9128699153662, -539.6370325535536, -455.28616812080145, -606.5124325752258, -503.9783056974411, -447.6924006380141, -468.51239974051714, -721.3081418722868, -527.025891020894, -401.7690976187587, -414.2639455497265, -553.5476581603289, -534.8527115359902, -555.0917622894049, -525.2243499308825, -445.9684109687805, -437.7038833796978, -772.6394028719515, -461.9585961662233, -606.7584470249712, -450.1122815012932, -532.7706811353564, -478.99014803022146, -587.6253276467323, -859.8061380833387, -377.0589042380452, -585.7004151642323, -525.1215446516871, -407.46927647292614, -504.95053639262915, -493.27572720497847, -629.9626895040274, -574.0577493831515, -484.8028378933668, -503.87228241562843, -411.99444345384836, -572.4671740047634, -495.0732420757413, -456.71394328027964, -444.43847136572003, -402.9289371818304, -504.8703332617879, -383.1736075505614, -493.77289571613073, -701.4470716491342, -431.62000197172165, -562.4502319395542, -674.7897596955299, -450.84464092180133, -478.74102970957756, -575.5391209498048, -499.0366595312953, -355.48593413084745, -505.2663076668978, -457.06723744794726, -463.28798773884773, -539.0456898286939, -538.9303638860583, -476.21935131400824, -315.84003600105643, -613.4360906630754, -488.7467592805624, -609.1008886396885, -567.0488959606737, -558.1338171586394, -474.6617778390646, -310.48198410868645, -532.918100848794, -463.50727728009224, -402.4891932569444, -468.8713910728693, -402.80782402306795, -479.41057145036757, -448.00763734430075, -415.3067119345069, -461.5396950021386, -473.51717430353165, -439.4213342666626, -482.5720349252224, -444.96894749999046, -553.2854692041874, -549.1477917507291, -512.9613221213222, -450.4242223650217, -358.7956525515765, -363.3740539327264, -368.1959724649787, -429.448369294405, -446.00458849966526, -530.9810458570719, -529.6596205383539, -517.1688616983593, -418.51611813902855, -649.6729918122292, -479.4104622453451, -464.7377902790904, -437.53077838756144, -362.4211350232363, -419.9381217546761], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410913227279591, "mean_inference_ms": 4.530163540340532, "mean_action_processing_ms": 4.205774613121024, "mean_env_wait_ms": 3.231220017759955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3538080, "timesteps_this_iter": 131040, "agent_timesteps_total": 3538080, "timers": {"sample_time_ms": 29652.808, "sample_throughput": 4419.143, "load_time_ms": 22.797, "load_throughput": 5748169.738, "learn_time_ms": 14908.879, "learn_throughput": 8789.393, "update_time_ms": 2.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322387695306e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 322.9877316109974, "policy_loss": -0.0010282073840918735, "vf_loss": 64.59831599437207, "vf_explained_var": -0.001419309540034195, "kl": 0.0019253035490714946, "entropy": -0.2598847738837683, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3538080, "num_agent_steps_sampled": 3538080, "num_steps_trained": 3538080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3538080}, "done": false, "episodes_total": 7360, "training_iteration": 27, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-55-58", "timestamp": 1691020558, "time_this_iter_s": 39.30685782432556, "time_total_s": 882.5455939769745, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 882.5455939769745, "timesteps_since_restore": 3538080, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 44.2375, "ram_util_percent": 51.291071428571435}}
{"episode_reward_max": -310.48198410868645, "episode_reward_min": -859.8061380833387, "episode_reward_mean": -494.47644160414114, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-466.7567660138011, -435.9128699153662, -539.6370325535536, -455.28616812080145, -606.5124325752258, -503.9783056974411, -447.6924006380141, -468.51239974051714, -721.3081418722868, -527.025891020894, -401.7690976187587, -414.2639455497265, -553.5476581603289, -534.8527115359902, -555.0917622894049, -525.2243499308825, -445.9684109687805, -437.7038833796978, -772.6394028719515, -461.9585961662233, -606.7584470249712, -450.1122815012932, -532.7706811353564, -478.99014803022146, -587.6253276467323, -859.8061380833387, -377.0589042380452, -585.7004151642323, -525.1215446516871, -407.46927647292614, -504.95053639262915, -493.27572720497847, -629.9626895040274, -574.0577493831515, -484.8028378933668, -503.87228241562843, -411.99444345384836, -572.4671740047634, -495.0732420757413, -456.71394328027964, -444.43847136572003, -402.9289371818304, -504.8703332617879, -383.1736075505614, -493.77289571613073, -701.4470716491342, -431.62000197172165, -562.4502319395542, -674.7897596955299, -450.84464092180133, -478.74102970957756, -575.5391209498048, -499.0366595312953, -355.48593413084745, -505.2663076668978, -457.06723744794726, -463.28798773884773, -539.0456898286939, -538.9303638860583, -476.21935131400824, -315.84003600105643, -613.4360906630754, -488.7467592805624, -609.1008886396885, -567.0488959606737, -558.1338171586394, -474.6617778390646, -310.48198410868645, -532.918100848794, -463.50727728009224, -402.4891932569444, -468.8713910728693, -402.80782402306795, -479.41057145036757, -448.00763734430075, -415.3067119345069, -461.5396950021386, -473.51717430353165, -439.4213342666626, -482.5720349252224, -444.96894749999046, -553.2854692041874, -549.1477917507291, -512.9613221213222, -450.4242223650217, -358.7956525515765, -363.3740539327264, -368.1959724649787, -429.448369294405, -446.00458849966526, -530.9810458570719, -529.6596205383539, -517.1688616983593, -418.51611813902855, -649.6729918122292, -479.4104622453451, -464.7377902790904, -437.53077838756144, -362.4211350232363, -419.9381217546761], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4006610462152524, "mean_inference_ms": 4.522538862397458, "mean_action_processing_ms": 4.15978403538037, "mean_env_wait_ms": 3.2103518217363263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3669120, "timesteps_this_iter": 131040, "agent_timesteps_total": 3669120, "timers": {"sample_time_ms": 27246.498, "sample_throughput": 4809.425, "load_time_ms": 21.161, "load_throughput": 6192633.311, "learn_time_ms": 14917.392, "learn_throughput": 8784.377, "update_time_ms": 2.285}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161193847653e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 314.4576606758792, "policy_loss": -0.005306862017906837, "vf_loss": 62.896573323075486, "vf_explained_var": 0.0032069937302647527, "kl": 0.0020344385567019397, "entropy": -0.2667197400844225, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3669120, "num_agent_steps_sampled": 3669120, "num_steps_trained": 3669120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3669120}, "done": false, "episodes_total": 7360, "training_iteration": 28, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-56-14", "timestamp": 1691020574, "time_this_iter_s": 15.362828254699707, "time_total_s": 897.9084222316742, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 897.9084222316742, "timesteps_since_restore": 3669120, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 13.8, "ram_util_percent": 51.5}}
{"episode_reward_max": -283.81400385499, "episode_reward_min": -723.3348356485367, "episode_reward_mean": -447.0524516132709, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-472.1225379295647, -441.1801171377301, -476.7353880703449, -470.66075986623764, -533.5483218356967, -361.73489911854267, -548.2398522123694, -404.1616847701371, -575.9396452903748, -436.29805954545736, -483.2683906853199, -402.2728401646018, -327.327252458781, -478.07154727727175, -484.52306646853685, -475.7085387855768, -477.02467979863286, -495.8154022395611, -391.41039845719934, -421.126735817641, -373.41279031708837, -470.1292079910636, -552.3016229942441, -453.6792246028781, -515.5654280483723, -427.9023503512144, -324.0219987258315, -425.743963573128, -393.7097786664963, -507.877832390368, -452.02222218364477, -490.4551129117608, -406.8175566866994, -399.8797992169857, -376.08847138285637, -441.06542352214456, -401.4926382675767, -466.6982387378812, -374.8297519609332, -463.5568409115076, -597.4043198078871, -347.46960892528296, -443.5119530931115, -416.0468721538782, -443.94701117277145, -489.2327229846269, -348.56206622719765, -479.7501335926354, -429.8291968256235, -489.0644158869982, -446.15308336541057, -375.8665811382234, -419.0516718327999, -429.1972439363599, -299.16438303887844, -469.43452811799943, -385.8780143111944, -487.99856758862734, -458.663111358881, -387.1223058104515, -449.8867864906788, -453.08393786102533, -383.52643824741244, -480.04916778951883, -461.06318117678165, -516.8449122831225, -439.2104023806751, -460.1772086843848, -647.0259376689792, -499.62914276495576, -422.89433251321316, -433.677579626441, -390.8057370632887, -358.60943342745304, -392.0446843057871, -377.0659333765507, -445.8180132508278, -508.73903439566493, -395.50483913719654, -417.34508783370256, -430.22903937473893, -298.134296014905, -357.29692174866796, -479.0038194209337, -475.41705952584743, -437.57000663504004, -435.95470640808344, -378.61600824072957, -493.7957883030176, -382.87392054498196, -481.23592844605446, -400.7425201609731, -386.17695838212967, -445.6979264318943, -515.0891228020191, -335.82427629083395, -609.7636110782623, -432.9689514860511, -350.99000004678965, -440.026166588068, -589.8611555621028, -381.9574449583888, -371.59590946137905, -381.59697853028774, -443.16964803636074, -469.6017297580838, -474.8418772369623, -532.5968981087208, -454.1272956430912, -417.16738553345203, -351.9196364954114, -528.6623554974794, -408.8522898219526, -508.23685601726174, -460.9579310193658, -490.79119005054235, -559.8198326900601, -357.81284180656075, -564.0453189015388, -454.0610335916281, -464.7898767180741, -575.851162225008, -518.4852417260408, -358.13673285394907, -453.55007871985435, -386.8931120634079, -475.7948328256607, -556.9949256964028, -413.25388182885945, -509.8651941269636, -497.91686080396175, -635.3932220116258, -418.367724865675, -370.7589940726757, -493.3423709869385, -392.1915036663413, -400.86632027477026, -540.0668867453933, -328.1563505977392, -441.04889322817326, -500.9827227033675, -395.64673068001866, -505.4517900645733, -457.45996375381947, -401.4295506104827, -418.6120636090636, -365.00321067124605, -296.2834275662899, -326.4798664525151, -414.61128920316696, -331.6444888524711, -511.65188743174076, -563.0296542476863, -396.29842879623175, -358.42454344034195, -415.184790732339, -402.0805777348578, -328.2923662085086, -372.59291199594736, -328.8973759151995, -405.7038579285145, -391.8666436523199, -509.6278824172914, -469.82985953241587, -504.4396285749972, -388.6083540469408, -332.73459289595485, -389.16912141256034, -449.9500396680087, -617.9946692585945, -416.0150393843651, -455.11639338359237, -383.0169209726155, -395.06205355376005, -553.864427909255, -503.0656573101878, -477.8122665435076, -350.0719954520464, -476.0772391743958, -513.4625071957707, -429.78223736584187, -343.78677859157324, -453.7501774802804, -531.4072955325246, -352.5655978769064, -422.38558681309223, -550.9721592161804, -347.35398925095797, -356.27589595504105, -368.2318860217929, -412.0567778348923, -411.88441144675016, -457.7276673261076, -571.5908244289458, -561.494643047452, -385.4641453549266, -483.85280948877335, -512.0279333144426, -379.70476327836514, -547.9848912805319, -455.04881140589714, -563.8569567650557, -460.94276339933276, -358.9560506492853, -406.15244122594595, -363.6670143529773, -473.25827760249376, -471.2163204997778, -511.6305768638849, -608.6255124211311, -431.0809900164604, -517.9873915910721, -417.6842051669955, -489.0463703200221, -496.383168278262, -398.89135917276144, -525.308062069118, -449.6246827170253, -504.3759911581874, -527.1386771798134, -483.1820997223258, -421.26295763999224, -417.7403479591012, -557.4355706349015, -380.2816381137818, -438.51916617155075, -372.2275779917836, -390.0483634248376, -433.03241731226444, -404.817124389112, -543.9781706295907, -469.96725365519524, -341.4077982157469, -407.3362130150199, -354.72951489686966, -689.9005614966154, -444.11431650072336, -347.4112937450409, -560.4694095402956, -365.48081880807877, -299.3985349535942, -537.2658255435526, -578.7833674177527, -419.2236367687583, -390.1309772133827, -388.2034185305238, -408.33064014464617, -530.1738981902599, -483.47326266393065, -337.739803917706, -491.8518209159374, -392.70200461894274, -380.17135421559215, -411.9335767701268, -443.4101119339466, -550.4348729811609, -329.5387602876872, -536.4993974268436, -495.1196288689971, -433.22731303423643, -608.0473031662405, -377.7509000375867, -319.65896777808666, -466.0008625444025, -283.81400385499, -356.32497619092464, -398.0403910279274, -460.271951533854, -361.4504552260041, -365.12619120720774, -416.207905927673, -434.2749802172184, -497.08333971351385, -528.4355030357838, -462.58289640396833, -492.52625346928835, -410.8800744190812, -410.2783331349492, -438.0095948278904, -370.8861267194152, -476.61619295179844, -429.325929030776, -523.7663063257933, -467.97228007018566, -457.1766234636307, -416.95803026109934, -358.676619656384, -431.1396232023835, -526.4976085051894, -476.64337976276875, -403.1406398937106, -424.4732955992222, -475.7861076965928, -511.0091705620289, -353.5029874239117, -532.991574216634, -432.4799616523087, -378.1209745630622, -553.846045743674, -525.7442827150226, -518.7476488947868, -434.05617777630687, -404.9171310663223, -518.1195750050247, -516.5300999209285, -511.93313835561275, -333.7754496335983, -435.0499794483185, -406.51472226530313, -382.8835111800581, -399.463632799685, -377.7406690865755, -438.6689946837723, -583.925288580358, -497.04985485970974, -461.8266326189041, -517.6321830376983, -568.2272165119648, -390.2111654058099, -421.1821249127388, -540.6556359529495, -523.4656829535961, -475.72066658735275, -371.6156929805875, -465.1922718808055, -457.97900338470936, -298.57839687913656, -315.33738120645285, -384.04278460144997, -451.1895090639591, -452.30509024858475, -498.00851242244244, -438.6216536462307, -335.26479905098677, -443.86546704545617, -389.01159739494324, -492.0955281034112, -348.9358542114496, -447.94916895311326, -374.20732171460986, -390.8367663435638, -453.13848382234573, -355.85185254737735, -467.47917268797755, -396.6760732457042, -506.27124501764774, -383.9853698313236, -389.36599760502577, -442.6313628181815, -492.33382559008896, -356.21753922849894, -426.2369157932699, -427.9165036305785, -363.4050740227103, -559.8914528936148, -455.44661470502615, -417.83716048300266, -571.5546275172383, -377.89751778542995, -534.5689682736993, -418.12506215274334, -517.656945772469, -397.32223965227604, -534.480956017971, -445.6092799436301, -516.4434054121375, -509.0878157541156, -515.2243000268936, -447.659843377769, -623.1607869714499, -377.9809769243002, -475.5345672890544, -508.9816554635763, -431.68718634545803, -388.7277213856578, -447.6232445091009, -514.5652279704809, -380.96608094125986, -425.06617314368486, -473.4137997701764, -542.6443282216787, -364.09010531008244, -337.32971626892686, -405.76010897010565, -323.1489200145006, -479.54817213118076, -449.4057877510786, -723.3348356485367, -500.2240492142737, -438.52115873992443, -461.0903258025646, -389.71327506937087, -548.5722632668912, -410.06909077614546, -504.7507238984108, -302.4870600029826, -533.8527938742191, -341.03095138818026, -490.8967724144459, -398.22269627731293, -516.9706830978394, -416.0337357670069, -493.0001642536372, -419.25427366700023, -471.6173044294119, -656.62372450158, -634.8117807246745, -398.47890661656857, -642.730884315446, -573.9121564403176, -488.7100433334708, -578.5505979657173, -497.14912545681, -495.8701038584113, -452.6473711002618, -521.4738426506519, -323.8496161773801, -540.0461296513677, -374.3788187727332, -460.35052531957626, -369.2559579387307, -430.46331740915775, -387.4375468418002, -332.9453378841281, -458.7906980589032, -402.46775114536285, -443.3045781068504, -436.2919672206044, -454.3098282068968, -410.14697855710983, -482.4832453727722, -360.3844866156578, -409.09466629475355, -581.5946113690734, -500.53593573719263, -459.3013070560992, -397.6632087677717, -483.7352702766657, -549.5342249013484, -375.61749055981636, -435.8185385763645, -423.8241605926305, -655.7923259884119, -367.59438341856, -538.4921503849328, -476.9225307404995, -452.33094660937786, -497.38958409428596, -465.7289196308702, -346.20205288380384, -384.1421710960567, -424.4716994613409, -531.8754489943385, -401.3765521906316, -513.1656129695475, -451.1400315910578, -362.58432924281806, -627.3324513286352, -691.1283797770739, -457.77562880143523, -343.61275386065245, -475.57159446924925, -475.2538892030716, -533.5288988277316, -526.1953960359097, -385.279704017099, -491.0283193215728, -331.98273339122534, -448.73935552313924, -367.66383135318756, -494.0384128689766, -433.40198858082294, -486.6207935139537, -353.0587541926652, -426.3944285977632, -315.7263704240322, -381.5617339685559, -574.2677144631743, -349.0123184360564, -408.50844229757786], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408921634087065, "mean_inference_ms": 4.530490326533696, "mean_action_processing_ms": 4.205196363123693, "mean_env_wait_ms": 3.2305557655670736, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3800160, "timesteps_this_iter": 131040, "agent_timesteps_total": 3800160, "timers": {"sample_time_ms": 29671.189, "sample_throughput": 4416.405, "load_time_ms": 23.112, "load_throughput": 5669826.035, "learn_time_ms": 14911.519, "learn_throughput": 8787.837, "update_time_ms": 2.294}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580596923826e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 313.87211595982154, "policy_loss": -0.001919731852768162, "vf_loss": 62.77607794730894, "vf_explained_var": 0.0004256362342492654, "kl": 0.0017469385101171844, "entropy": -0.26590201349454967, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3800160, "num_agent_steps_sampled": 3800160, "num_steps_trained": 3800160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3800160}, "done": false, "episodes_total": 7840, "training_iteration": 29, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-56-53", "timestamp": 1691020613, "time_this_iter_s": 39.49406909942627, "time_total_s": 937.4024913311005, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 937.4024913311005, "timesteps_since_restore": 3800160, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 44.064285714285724, "ram_util_percent": 51.37678571428571}}
{"evaluation": {"episode_reward_max": -3779.6643146397546, "episode_reward_min": -3779.6643146397546, "episode_reward_mean": -3779.6643146397546, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3779.6643146397546], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -302.4870600029826, "episode_reward_min": -723.3348356485367, "episode_reward_mean": -457.3304666318046, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-542.6443282216787, -364.09010531008244, -337.32971626892686, -405.76010897010565, -323.1489200145006, -479.54817213118076, -449.4057877510786, -723.3348356485367, -500.2240492142737, -438.52115873992443, -461.0903258025646, -389.71327506937087, -548.5722632668912, -410.06909077614546, -504.7507238984108, -302.4870600029826, -533.8527938742191, -341.03095138818026, -490.8967724144459, -398.22269627731293, -516.9706830978394, -416.0337357670069, -493.0001642536372, -419.25427366700023, -471.6173044294119, -656.62372450158, -634.8117807246745, -398.47890661656857, -642.730884315446, -573.9121564403176, -488.7100433334708, -578.5505979657173, -497.14912545681, -495.8701038584113, -452.6473711002618, -521.4738426506519, -323.8496161773801, -540.0461296513677, -374.3788187727332, -460.35052531957626, -369.2559579387307, -430.46331740915775, -387.4375468418002, -332.9453378841281, -458.7906980589032, -402.46775114536285, -443.3045781068504, -436.2919672206044, -454.3098282068968, -410.14697855710983, -482.4832453727722, -360.3844866156578, -409.09466629475355, -581.5946113690734, -500.53593573719263, -459.3013070560992, -397.6632087677717, -483.7352702766657, -549.5342249013484, -375.61749055981636, -435.8185385763645, -423.8241605926305, -655.7923259884119, -367.59438341856, -538.4921503849328, -476.9225307404995, -452.33094660937786, -497.38958409428596, -465.7289196308702, -346.20205288380384, -384.1421710960567, -424.4716994613409, -531.8754489943385, -401.3765521906316, -513.1656129695475, -451.1400315910578, -362.58432924281806, -627.3324513286352, -691.1283797770739, -457.77562880143523, -343.61275386065245, -475.57159446924925, -475.2538892030716, -533.5288988277316, -526.1953960359097, -385.279704017099, -491.0283193215728, -331.98273339122534, -448.73935552313924, -367.66383135318756, -494.0384128689766, -433.40198858082294, -486.6207935139537, -353.0587541926652, -426.3944285977632, -315.7263704240322, -381.5617339685559, -574.2677144631743, -349.0123184360564, -408.50844229757786], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.398290608495875, "mean_inference_ms": 4.522257823248283, "mean_action_processing_ms": 4.1582849331732, "mean_env_wait_ms": 3.2085196246514442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3931200, "timesteps_this_iter": 131040, "agent_timesteps_total": 3931200, "timers": {"sample_time_ms": 27245.363, "sample_throughput": 4809.626, "load_time_ms": 21.449, "load_throughput": 6109486.185, "learn_time_ms": 14934.628, "learn_throughput": 8774.239, "update_time_ms": 2.302}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.725290298461913e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 296.19958485145526, "policy_loss": 8.373395732697601e-05, "vf_loss": 59.23956098522336, "vf_explained_var": -0.008994531246923631, "kl": 0.0018815252773245082, "entropy": -0.27315256031610635, "entropy_coeff": 0.001}}}, "num_steps_sampled": 3931200, "num_agent_steps_sampled": 3931200, "num_steps_trained": 3931200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 3931200}, "done": false, "episodes_total": 7840, "training_iteration": 30, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-57-08", "timestamp": 1691020628, "time_this_iter_s": 15.103236436843872, "time_total_s": 952.5057277679443, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 952.5057277679443, "timesteps_since_restore": 3931200, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 13.768181818181818, "ram_util_percent": 51.531818181818174}}
{"episode_reward_max": -235.76395232230425, "episode_reward_min": -618.8581185638905, "episode_reward_mean": -418.0190169623316, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-318.26670287549496, -391.24469473958015, -516.9517131596804, -423.57072626054287, -524.8898462280631, -302.43300427123904, -552.4995997808874, -435.53451369702816, -397.3381340317428, -368.0146989747882, -434.1809571534395, -319.970965385437, -491.8477139994502, -452.3109018560499, -363.2859563007951, -449.2302279714495, -485.8641332387924, -394.66986303403974, -445.9076166972518, -414.0524667352438, -508.71178255975246, -433.32091568410397, -336.27298630960286, -317.6884780526161, -396.9753641113639, -404.6334698498249, -428.5815112069249, -403.9474571272731, -408.5930165294558, -436.05487021803856, -330.6558311842382, -458.25553131848574, -335.22384560853243, -387.45788061618805, -386.68265970796347, -381.5300890877843, -395.08801726810634, -350.61754783801734, -338.6685664728284, -377.1823355033994, -407.6584258489311, -364.3672265857458, -522.2060230560601, -439.94787910580635, -379.55610247701406, -465.8863091021776, -404.2278370782733, -403.34511529281735, -363.7499383687973, -438.2179421521723, -342.54357079416513, -398.5508719906211, -479.46346040070057, -382.9946919605136, -422.85548968985677, -507.9781200438738, -353.01575347036123, -384.0977129265666, -499.61924363672733, -458.01242481917143, -416.523329295218, -461.626875013113, -431.31889090687037, -485.8047956712544, -364.6189934052527, -538.6808065026999, -390.34495659172535, -437.2222316712141, -388.1050263643265, -371.3296822607517, -321.07922530174255, -509.5542311370373, -465.41391633450985, -424.3803965523839, -485.89151192083955, -538.9418139308691, -388.1268084682524, -400.29737519845366, -382.87110147997737, -392.3174889087677, -446.95726722478867, -281.3676129281521, -378.0238277576864, -394.06890803202987, -358.073370449245, -401.2336754575372, -375.43905507028103, -353.09398201853037, -330.72177985310555, -506.877410158515, -430.9279130846262, -383.37184251844883, -470.87292355671525, -412.6400802433491, -442.0856343060732, -426.2134216725826, -469.0475596114993, -380.78151912242174, -346.24386339634657, -350.921048656106, -525.1523715518415, -424.83005257695913, -433.87772357463837, -406.60210732370615, -330.28239630535245, -507.89120740815997, -577.6256146878004, -357.0286664739251, -481.5335156582296, -340.3451343104243, -361.28548316657543, -516.222794264555, -474.7996167168021, -494.52223765850067, -310.6368561722338, -547.2938370555639, -323.54447911679745, -422.4630600363016, -501.1707195416093, -419.00487533956766, -384.1271713413298, -421.41267380677164, -588.9585238918662, -392.6342596709728, -418.6586776673794, -345.7075222656131, -367.94535655528307, -393.08106323704123, -525.3097260445356, -432.01176658738405, -433.79754749312997, -290.1912340670824, -456.52756452560425, -475.81155079603195, -452.6835677064955, -479.65013625472784, -407.2027197033167, -505.06370763480663, -400.5279122069478, -496.3614469394088, -352.3224085783586, -391.86603812873363, -373.20166686177254, -402.21956975758076, -413.4096226245165, -340.87845731526613, -436.94192111492157, -377.5772451609373, -338.0924559831619, -266.3201678618789, -353.15150920301676, -383.40052726864815, -442.27070105075836, -412.36074889451265, -375.48987509310246, -348.24200044572353, -511.54073863849044, -383.11726807802916, -388.12557289004326, -376.1906960904598, -362.9454947113991, -406.41515266895294, -323.72298638522625, -477.8655101954937, -526.8654545024037, -329.64471520483494, -451.59372702240944, -514.7963196337223, -405.49330146610737, -516.2075749523938, -454.1729383021593, -485.4442908614874, -440.3375075086951, -367.22366761416197, -347.60786052048206, -480.3989502340555, -326.8838959187269, -463.20908553898335, -315.7501372098923, -450.67459370195866, -238.04130540788174, -449.82740753889084, -343.07984785176814, -458.84180534631014, -463.5218837503344, -390.27901350706816, -332.421981588006, -411.0477354899049, -420.4693203214556, -510.43581956624985, -394.9045955911279, -372.74732046574354, -383.4447006583214, -445.46056078746915, -537.60570397228, -427.66529635339975, -364.03665994107723, -510.56849319674075, -526.1189062297344, -337.3960574809462, -386.6751703545451, -436.8398365303874, -435.19756399840117, -425.362072955817, -359.703031308949, -401.24215826392174, -344.04582031071186, -571.8557338491082, -406.1594888083637, -356.2777639850974, -436.27597449347377, -503.56906268466264, -409.6722425427288, -463.7246763110161, -449.7492765709758, -413.9941334426403, -537.6773560792208, -467.59960221499205, -262.6515414789319, -527.0568517148495, -345.5111542493105, -407.1762678436935, -436.24106407910585, -454.10912407934666, -373.62242862582207, -395.7467786036432, -365.1611743494868, -462.62349059432745, -298.57454976439476, -343.8261579796672, -438.5451345592737, -483.16806265711784, -520.4760720990598, -300.73138888180256, -381.66039771586657, -395.06740693748, -499.4756305292249, -554.8177983090281, -366.47255202382803, -454.70708659663796, -424.97945081442595, -442.5915340334177, -532.7971548438072, -431.38483088463545, -388.23092852532864, -364.9806600511074, -329.88653440214694, -457.7573205716908, -392.9856835184619, -485.5783100128174, -426.8635314255953, -464.08798356354237, -367.71074514463544, -552.9443066902459, -398.13984191417694, -367.3872038051486, -413.7082608900964, -364.9067038819194, -383.16795894503593, -381.6815419346094, -449.1362070515752, -323.7553418725729, -345.84787575900555, -387.26632875576615, -447.86858220398426, -403.7405036203563, -515.1366269551218, -540.9010198563337, -320.48395102471113, -617.3655072376132, -451.35588251054287, -420.2115552909672, -366.92156222462654, -536.8755453079939, -418.8868854492903, -454.29897924885154, -405.89788687229156, -388.8469223231077, -431.4280151203275, -357.59977638721466, -374.7615917176008, -421.5875640511513, -394.903761126101, -367.3971892595291, -383.7609844133258, -400.13514518737793, -373.8238181769848, -345.297863997519, -395.28484942764044, -400.6414328068495, -431.07249672710896, -561.9164874106646, -412.3033868819475, -487.78945035487413, -433.1571571305394, -448.4552275761962, -483.42841498553753, -550.7160938233137, -441.6117002815008, -478.6295079141855, -427.5188412554562, -387.0595272704959, -518.6995999664068, -295.54861506074667, -441.69604172185063, -363.9779414460063, -461.3894227296114, -410.56425589323044, -450.12363114207983, -444.21168614178896, -337.8605607226491, -445.9892446026206, -489.92912808060646, -433.33874946832657, -444.02717170119286, -333.11889696866274, -379.04523245990276, -333.86024229228497, -409.67940844222903, -419.04714301228523, -424.96435633301735, -347.4869100637734, -399.1860614977777, -516.7854093238711, -407.5436796322465, -541.3229143526405, -385.9922035522759, -426.04378953948617, -367.4135680682957, -371.85968417674303, -428.34063598141074, -395.4190105050802, -338.6823420897126, -462.97925924509764, -446.96462251991034, -533.0834668278694, -408.93847566097975, -518.3630469571799, -446.70327585190535, -490.2190200686455, -388.3720865473151, -340.52427603304386, -407.5269743800163, -381.61809115856886, -393.6611214913428, -426.6982012093067, -520.3768179640174, -369.4978021197021, -397.78868252038956, -435.1938711106777, -369.5769372135401, -398.7323468029499, -345.8234234750271, -366.05423994362354, -488.69218604266644, -459.3256988711655, -491.62341345101595, -466.95138739049435, -492.0196816548705, -417.54326586425304, -521.5192338190973, -375.3364064767957, -316.286708034575, -409.19297248497605, -493.2507688216865, -347.4914054200053, -428.2962635625154, -418.0671921297908, -443.5180028527975, -412.7199130319059, -302.6926770620048, -511.78376449644566, -569.5536836385727, -509.83868177980185, -390.81951048225164, -377.58777882158756, -329.67558355629444, -606.1895666792989, -346.98348005115986, -395.7445669770241, -432.510863032192, -336.50431535393, -380.9499805569649, -487.69177574664354, -376.76431615650654, -416.50556245818734, -503.06706643104553, -463.4687511175871, -373.2900608256459, -499.7878984455019, -392.0691462904215, -488.2395678907633, -404.96083088219166, -454.5968938320875, -459.31833865493536, -387.47065730392933, -397.3354418631643, -416.5840112864971, -290.10195103287697, -479.2278064638376, -341.1889166086912, -473.16624173056334, -395.38706035912037, -310.8528337702155, -383.82661193050444, -487.3862619921565, -374.74517746269703, -450.763835452497, -415.86065767519176, -494.08811351656914, -362.61662266775966, -387.1464300304651, -435.85109620541334, -410.7595630809665, -358.2126936297864, -412.697984829545, -428.5869588982314, -385.40363016724586, -407.0427648052573, -476.35432313382626, -528.4991413354874, -618.8581185638905, -449.2289127185941, -343.6886928677559, -420.14098377525806, -402.9591330885887, -460.1589663773775, -327.6037817709148, -381.41554057598114, -344.1986371986568, -346.7693468183279, -459.4181637391448, -510.32580583542585, -235.76395232230425, -546.3379321247339, -438.26604664325714, -321.35039956867695, -383.99983106553555, -335.7161646783352, -509.6310807019472, -477.9750255532563, -549.6923227012157, -400.28911336511374, -375.94642585143447, -454.4948020391166, -361.7161598317325, -374.52343011647463, -424.7053951025009, -376.7477686852217, -293.5627526193857, -344.81520046293736, -348.0795694589615, -406.00879173353314, -491.3365508764982, -299.4859788045287, -400.1019616276026, -382.9946387335658, -405.696580208838, -264.02513901889324, -407.7169445157051, -470.88652800023556, -393.54482408612967, -389.2730413377285, -481.27820684108883, -443.40337935835123, -587.1310079544783, -475.50604335591197, -332.13197990879416, -394.6263426989317, -401.2423485741019, -422.9720484428108, -398.28671748936176, -378.06993179768324, -451.6942404061556, -391.0646700039506, -424.16709996014833, -458.1003118753433, -433.23492699861526, -399.6544232182205, -416.2169613093138], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4073366992389635, "mean_inference_ms": 4.53156767954352, "mean_action_processing_ms": 4.205365975849449, "mean_env_wait_ms": 3.229271918461321, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4062240, "timesteps_this_iter": 131040, "agent_timesteps_total": 4062240, "timers": {"sample_time_ms": 29675.14, "sample_throughput": 4415.817, "load_time_ms": 23.144, "load_throughput": 5662051.797, "learn_time_ms": 14939.739, "learn_throughput": 8771.238, "update_time_ms": 2.243}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451492309566e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 289.33039794470915, "policy_loss": -0.0006241587712474968, "vf_loss": 57.86642451269225, "vf_explained_var": 0.020827817126414256, "kl": 0.0019585776795142487, "entropy": -0.2801352065310256, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4062240, "num_agent_steps_sampled": 4062240, "num_steps_trained": 4062240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4062240}, "done": false, "episodes_total": 8320, "training_iteration": 31, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-57-48", "timestamp": 1691020668, "time_this_iter_s": 39.22483420372009, "time_total_s": 991.7305619716644, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 991.7305619716644, "timesteps_since_restore": 4062240, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 44.17321428571428, "ram_util_percent": 50.792857142857144}}
{"episode_reward_max": -235.76395232230425, "episode_reward_min": -618.8581185638905, "episode_reward_mean": -413.79113230265676, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-432.510863032192, -336.50431535393, -380.9499805569649, -487.69177574664354, -376.76431615650654, -416.50556245818734, -503.06706643104553, -463.4687511175871, -373.2900608256459, -499.7878984455019, -392.0691462904215, -488.2395678907633, -404.96083088219166, -454.5968938320875, -459.31833865493536, -387.47065730392933, -397.3354418631643, -416.5840112864971, -290.10195103287697, -479.2278064638376, -341.1889166086912, -473.16624173056334, -395.38706035912037, -310.8528337702155, -383.82661193050444, -487.3862619921565, -374.74517746269703, -450.763835452497, -415.86065767519176, -494.08811351656914, -362.61662266775966, -387.1464300304651, -435.85109620541334, -410.7595630809665, -358.2126936297864, -412.697984829545, -428.5869588982314, -385.40363016724586, -407.0427648052573, -476.35432313382626, -528.4991413354874, -618.8581185638905, -449.2289127185941, -343.6886928677559, -420.14098377525806, -402.9591330885887, -460.1589663773775, -327.6037817709148, -381.41554057598114, -344.1986371986568, -346.7693468183279, -459.4181637391448, -510.32580583542585, -235.76395232230425, -546.3379321247339, -438.26604664325714, -321.35039956867695, -383.99983106553555, -335.7161646783352, -509.6310807019472, -477.9750255532563, -549.6923227012157, -400.28911336511374, -375.94642585143447, -454.4948020391166, -361.7161598317325, -374.52343011647463, -424.7053951025009, -376.7477686852217, -293.5627526193857, -344.81520046293736, -348.0795694589615, -406.00879173353314, -491.3365508764982, -299.4859788045287, -400.1019616276026, -382.9946387335658, -405.696580208838, -264.02513901889324, -407.7169445157051, -470.88652800023556, -393.54482408612967, -389.2730413377285, -481.27820684108883, -443.40337935835123, -587.1310079544783, -475.50604335591197, -332.13197990879416, -394.6263426989317, -401.2423485741019, -422.9720484428108, -398.28671748936176, -378.06993179768324, -451.6942404061556, -391.0646700039506, -424.16709996014833, -458.1003118753433, -433.23492699861526, -399.6544232182205, -416.2169613093138], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.395431111890405, "mean_inference_ms": 4.522269043847285, "mean_action_processing_ms": 4.157289866112285, "mean_env_wait_ms": 3.206247592209778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4193280, "timesteps_this_iter": 131040, "agent_timesteps_total": 4193280, "timers": {"sample_time_ms": 27278.752, "sample_throughput": 4803.739, "load_time_ms": 21.56, "load_throughput": 6077814.154, "learn_time_ms": 14936.528, "learn_throughput": 8773.123, "update_time_ms": 2.252}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225746154783e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 282.8648963099534, "policy_loss": 0.0013317121120653649, "vf_loss": 56.571366340883316, "vf_explained_var": 0.00776801698951311, "kl": 0.001918490336019559, "entropy": -0.282051973392032, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4193280, "num_agent_steps_sampled": 4193280, "num_steps_trained": 4193280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4193280}, "done": false, "episodes_total": 8320, "training_iteration": 32, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-58-03", "timestamp": 1691020683, "time_this_iter_s": 15.241481304168701, "time_total_s": 1006.9720432758331, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1006.9720432758331, "timesteps_since_restore": 4193280, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 13.790909090909093, "ram_util_percent": 51.5}}
{"episode_reward_max": -254.1679138634354, "episode_reward_min": -672.3094545267522, "episode_reward_mean": -395.49917268915357, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-412.2328047081828, -355.77381388098, -361.8923354521394, -304.46853083372116, -337.6104421168566, -479.99879463762045, -345.4336803331971, -458.19835406541824, -445.19421426951885, -378.663732457906, -577.8903209492564, -338.609677195549, -344.9176255017519, -367.0265003219247, -300.4605880379677, -390.3207968957722, -389.76881998591125, -346.19834338128567, -469.34887290000916, -459.6721533536911, -494.3406522497535, -380.57916113734245, -345.53459821641445, -372.8503605350852, -307.6976418495178, -378.6898118928075, -416.99475985765457, -425.25747463852167, -437.6844670102, -404.2799273505807, -488.1961671859026, -434.80501230433583, -434.281486146152, -433.23991345614195, -316.5156107041985, -364.5917632151395, -334.7660958394408, -424.6634687744081, -539.4678940623999, -378.88547206297517, -328.870927631855, -405.2550699263811, -311.19103321805596, -365.59357039630413, -310.1013379767537, -313.7019516453147, -293.23745488375425, -424.99379287287593, -487.9069486260414, -496.00025126710534, -427.5640494674444, -409.4151231870055, -354.64772671833634, -350.58346991986036, -462.59890146553516, -328.46544859558344, -424.4200100377202, -447.0800916403532, -370.58802603185177, -334.8669873997569, -492.37932428717613, -455.3316776826978, -512.0817814096808, -344.39405309408903, -363.7718805000186, -294.90054228156805, -257.2630796395242, -398.8834271878004, -342.3923716843128, -420.0147854834795, -378.37124130129814, -310.4962259363383, -376.04411821067333, -418.7043608427048, -424.0641093105078, -374.9022143892944, -381.9797203168273, -301.72876907140017, -379.03832910209894, -397.8929723035544, -356.8002747967839, -423.3445390202105, -438.65847538784146, -288.2900009546429, -442.84580102935433, -409.43970795720816, -475.83784390985966, -277.6863185092807, -394.99825016222894, -368.86552714556456, -391.10221577063203, -433.93861766159534, -475.7571768462658, -332.85333482548594, -473.70711174979806, -435.75475745648146, -365.91825560852885, -450.6020042523742, -477.30764270573854, -366.16310087777674, -341.02321434393525, -461.98822355270386, -284.35423239320517, -406.82449731230736, -463.8176444172859, -334.01609256491065, -359.4758970029652, -474.12819186784327, -365.30910155922174, -342.1509088650346, -483.6214947104454, -484.81763240695, -558.5524044930935, -315.767576623708, -408.6794270053506, -418.0739552974701, -465.0126917697489, -516.1162400320172, -446.22002992779016, -433.76704359054565, -378.4934331700206, -344.5317382887006, -397.6307502165437, -388.7345950193703, -404.6610524505377, -339.3721148222685, -397.2168415263295, -440.5044801943004, -470.9899410754442, -399.94969764351845, -263.5407603383064, -479.8706383705139, -309.2807283513248, -437.28061724454165, -425.9822259321809, -483.6269094198942, -398.6094829887152, -374.5535923689604, -425.9082848466933, -413.6627035662532, -364.0649558864534, -371.89496866613626, -453.90677703917027, -312.22301752865314, -376.7053569033742, -585.3515005707741, -549.6102300360799, -343.1500596255064, -365.14017029106617, -388.2309088408947, -360.42439315468073, -552.9216402992606, -362.27391638606787, -293.4513622969389, -452.49924286454916, -407.1461324170232, -358.68078787624836, -446.32216925174, -381.50815185904503, -375.13992004841566, -433.4096251130104, -401.3051882274449, -311.7199043780565, -354.7754159197211, -418.1423486471176, -404.434740697965, -550.5127259418368, -355.49305913597345, -533.4542237371206, -257.06149710714817, -402.3829652070999, -472.28973032161593, -537.9848377835006, -313.3088512700051, -415.87130653858185, -364.43420169502497, -398.190499804914, -367.77852899953723, -422.92977015301585, -289.53212743997574, -499.7708832565695, -395.02280705422163, -456.0128611885011, -325.9995552152395, -429.23087567836046, -389.98247484862804, -478.78649525530636, -400.30660266429186, -333.4807709604502, -333.30671790242195, -271.0336625147611, -351.01877584308386, -317.6616070345044, -393.16392378509045, -351.5977459549904, -290.77525249123573, -373.33713150024414, -376.5969806686044, -281.8257389217615, -354.34589279070497, -537.2216429961845, -549.2256459426135, -395.7508483156562, -321.7726195193827, -364.4542045406997, -453.46976858377457, -355.81042709201574, -493.30779978632927, -406.90067226439714, -412.81347335875034, -403.77419816702604, -472.0353435315192, -529.4883945137262, -411.0344349741936, -356.18802498281, -352.5772509276867, -387.98521415889263, -537.5125280022621, -407.50262819603086, -357.4096008166671, -499.93191277980804, -391.0411074310541, -276.7812955453992, -362.69673481583595, -356.2013642638922, -459.07052551209927, -450.8185541033745, -344.8748989775777, -395.9054599106312, -435.1364442333579, -329.71710904687643, -373.7202080562711, -387.18230767548084, -318.2927982881665, -416.6914868429303, -331.8916140347719, -376.90783566981554, -371.4186525270343, -371.8878567740321, -406.55558279901743, -433.6809808164835, -321.86084684729576, -412.3163546845317, -354.37625244259834, -467.7088610306382, -406.18421518057585, -371.8659792356193, -361.52227672189474, -390.9937802404165, -416.0039173960686, -329.04612660221756, -398.55029244720936, -403.0980739071965, -424.99447152763605, -349.11018469184637, -478.68544294685125, -477.16518230736256, -375.1175288259983, -254.1679138634354, -381.84716085344553, -345.3176876306534, -409.93817922472954, -306.11224991083145, -416.5476710870862, -406.0139048397541, -357.1239086315036, -305.3571092262864, -434.67878230288625, -342.71704937517643, -342.43261086568236, -354.5036459863186, -322.49433279037476, -438.8332131393254, -333.1560535430908, -445.74415623396635, -403.8426108211279, -540.0158896259964, -558.7225117497146, -419.7724752938375, -500.53470266237855, -407.59261797368526, -594.7279853224754, -296.3681966997683, -425.13139955699444, -301.6267056018114, -453.2333576530218, -294.05531860142946, -400.53963673114777, -399.9812044650316, -321.98146180063486, -458.58635470457375, -436.03661574423313, -355.40019741281867, -436.95326006412506, -400.8464048355818, -493.17012989521027, -415.75469209998846, -537.9933017082512, -274.6850109361112, -449.3176613301039, -395.77221924066544, -366.0020261183381, -380.18069760501385, -334.4016826953739, -389.39796774089336, -348.35137698054314, -498.5703624486923, -368.05330430343747, -457.3678182065487, -479.99494031071663, -514.94177749753, -306.7053101658821, -342.08361949026585, -348.82034784555435, -322.41341888718307, -312.5820896998048, -371.72180850990117, -278.5536446161568, -427.04853524267673, -308.63580866903067, -362.4367216974497, -438.314400434494, -404.83593042194843, -335.490641400218, -482.2802775502205, -377.649519380182, -331.66071474552155, -514.5567611046135, -387.4668814353645, -455.990332223475, -453.29842833429575, -481.87316521443427, -380.19006906449795, -465.52753907442093, -396.6976370662451, -309.7458429262042, -435.76736085116863, -383.5975301116705, -383.46889663115144, -538.5303279459476, -390.0882456433028, -271.1537147909403, -418.34141689166427, -423.8243297296576, -393.3877050206065, -352.3923415392637, -334.2399147450924, -456.33015094697475, -348.5195723325014, -392.65311757847667, -392.8923845663667, -327.48727428913116, -357.2811107933521, -467.64320620149374, -420.0346676521003, -358.1068681329489, -404.955490231514, -407.08409932255745, -285.7853469699621, -512.1428482010961, -410.038296662271, -483.70474131405354, -362.15872121602297, -453.8244654610753, -482.55796966701746, -326.478335050866, -305.68380412086844, -384.95943880081177, -412.944469563663, -294.04255409538746, -462.4317500144243, -305.9593277424574, -500.7920012846589, -349.8627869486809, -410.9425185918808, -423.0748314782977, -296.95547258108854, -449.1984244957566, -319.61153627187014, -409.8650973364711, -346.08156944811344, -389.95643682032824, -431.519818007946, -380.14288897812366, -440.1757667660713, -367.22157706320286, -367.21191508322954, -385.21133218705654, -424.89927599951625, -391.4223907738924, -393.646101385355, -526.4762766510248, -390.180621240288, -401.7838473916054, -409.0485268421471, -380.654303714633, -485.408151127398, -326.1982480250299, -447.0840069055557, -318.967539915815, -420.66959707438946, -369.73586961627007, -465.12675124406815, -379.5436563268304, -322.2346076145768, -321.9343392699957, -361.28311395458877, -275.41147953271866, -382.08254132419825, -448.6406244933605, -357.1449351981282, -346.61785427108407, -457.60680250637233, -466.67715771496296, -381.85174787789583, -391.97806940972805, -409.99636152386665, -380.27002488449216, -356.6094507165253, -396.7854159679264, -360.64084845781326, -672.3094545267522, -447.60024911537766, -393.9740777499974, -518.1517720967531, -334.55180698633194, -421.28608517348766, -417.46734998747706, -365.10603906959295, -450.23337061703205, -343.32716929912567, -455.9045911356807, -402.42138377577066, -364.8500884324312, -306.93025371432304, -324.88724291324615, -452.1180464848876, -520.0826008655131, -362.1610726863146, -305.95977955311537, -361.1925075799227, -362.78078654780984, -390.77432242780924, -371.7746908739209, -456.1040906980634, -342.68239515274763, -407.9533087089658, -449.54028518497944, -270.47920820116997, -366.3764264509082, -292.8417867720127, -382.9609665200114, -462.1519745886326, -483.2736160829663, -402.75848073512316, -336.32370153814554, -336.9735717177391, -342.53407467063516, -428.69626596570015, -470.84928084909916, -416.9257107656449, -403.5134518686682, -391.39876136928797, -373.308022916317, -313.75547187030315, -361.0379930585623, -325.3011371027678, -364.1140755340457, -390.32671112567186, -393.6278806850314, -315.7093919441104, -331.6967252679169, -419.261472068727, -356.3495764657855, -431.1982252597809, -438.22317116707563, -338.11260691285133, -406.42133785784245, -409.74871323630214, -309.9724763929844], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405417910282336, "mean_inference_ms": 4.531950299959167, "mean_action_processing_ms": 4.204921687939877, "mean_env_wait_ms": 3.2271401687834422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4324320, "timesteps_this_iter": 131040, "agent_timesteps_total": 4324320, "timers": {"sample_time_ms": 29665.452, "sample_throughput": 4417.259, "load_time_ms": 23.023, "load_throughput": 5691703.2, "learn_time_ms": 14950.46, "learn_throughput": 8764.948, "update_time_ms": 2.245}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566128730773915e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 264.8127759515649, "policy_loss": 0.0011563095178910565, "vf_loss": 52.96111357767522, "vf_explained_var": 0.03676393061983115, "kl": 0.0017905186675243761, "entropy": -0.2858009881550266, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4324320, "num_agent_steps_sampled": 4324320, "num_steps_trained": 4324320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4324320}, "done": false, "episodes_total": 8800, "training_iteration": 33, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-58-42", "timestamp": 1691020722, "time_this_iter_s": 39.21534037590027, "time_total_s": 1046.1873836517334, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1046.1873836517334, "timesteps_since_restore": 4324320, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 44.051785714285714, "ram_util_percent": 51.34999999999999}}
{"episode_reward_max": -216.80452075973153, "episode_reward_min": -614.0704938173294, "episode_reward_mean": -381.3982254466042, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260.4560039676726, -286.78738118708134, -504.0043433457613, -380.2417373880744, -395.17948515713215, -351.57550029084086, -437.89051573723555, -350.5964139997959, -422.2503459006548, -468.56859070807695, -366.99756199866533, -387.49013453722, -504.1420321241021, -416.17454481869936, -410.88946844637394, -362.10784043744206, -377.72394842654467, -374.1392479836941, -415.63331539183855, -362.5073075443506, -370.9050785973668, -412.4583795070648, -417.90825179964304, -391.1559089124203, -376.38075030595064, -408.39343386143446, -464.9044012501836, -284.57905016094446, -309.8621505647898, -443.2606847062707, -358.41900561749935, -422.3010269701481, -378.6186372600496, -459.9581434652209, -375.4572081938386, -388.55091439932585, -338.72371327877045, -336.23394468426704, -410.37670412659645, -468.1388430669904, -291.14112543687224, -305.7720566242933, -339.20952210202813, -410.7934817522764, -379.81822066009045, -343.2178452759981, -364.343177318573, -341.14360056072474, -343.66614957898855, -437.2109677195549, -343.0162623152137, -337.6960337534547, -461.5190154798329, -296.87747533619404, -360.08819736912847, -383.4067312180996, -323.6866951659322, -400.96727722138166, -381.4774074330926, -342.3227750211954, -349.80960616469383, -321.3391574397683, -363.6983680650592, -470.7517753969878, -376.2382145822048, -451.5673875659704, -471.6298435628414, -420.1000973880291, -445.21490855515003, -353.09525089804083, -389.57595606148243, -337.48961033672094, -466.3950712233782, -343.95691706612706, -298.3410307466984, -301.4973549544811, -357.09467689320445, -362.8548709657043, -399.9127776622772, -485.87552912533283, -341.92590037733316, -425.4466811642051, -413.00137154757977, -318.4949347563088, -323.52379628270864, -428.83677008375525, -437.35454389452934, -290.75794188678265, -364.30048940330744, -389.65489122644067, -328.8672226816416, -482.29137904942036, -387.29573348909616, -390.4617387354374, -359.2001453638077, -278.26883532106876, -368.9345314949751, -326.1069023665041, -346.3117410764098, -358.91096894443035, -421.6792016848922, -325.42899261415005, -383.5674301609397, -367.77007231488824, -545.2764272615314, -401.37942403554916, -372.7878165766597, -367.58837550133467, -478.83965365588665, -301.32322096452117, -318.75880497694016, -453.38173972442746, -349.67181898187846, -245.61429630219936, -407.32766188681126, -382.4619851708412, -381.77653413265944, -419.8164096325636, -360.09798696637154, -473.6582443192601, -325.307225048542, -328.718010596931, -310.87364497594535, -488.9181312993169, -320.49437732994556, -470.77785747498274, -442.34289890155196, -421.75032318755984, -375.2253124564886, -370.04022497683764, -306.2207749579102, -353.87817730754614, -325.00064451247454, -383.68032912909985, -493.8635924458504, -440.58671674132347, -339.5400379896164, -334.457378834486, -524.7629971206188, -310.04800352454185, -419.7657804749906, -398.13899551704526, -457.75478567928076, -403.3231564760208, -372.45375871658325, -331.51812125742435, -412.025713250041, -346.6200966220349, -416.77803057432175, -300.75101532787085, -350.51023878902197, -342.1658111512661, -445.2608179524541, -469.16389686614275, -387.22028893232346, -360.424963362515, -368.1738959364593, -331.7077664602548, -268.3490242809057, -383.4330962970853, -446.74337673932314, -339.7842478528619, -324.6393332183361, -382.80915492028, -459.7801547050476, -307.1804763302207, -572.635724671185, -367.55008701980114, -344.4576159492135, -350.4109200537205, -313.8009131401777, -303.8584478199482, -488.1780131906271, -441.5500360876322, -338.86679674685, -352.6954867653549, -479.5543494746089, -496.3407532228157, -345.57896542549133, -377.9707423597574, -374.943611189723, -296.5164828747511, -452.5104173719883, -313.4773903042078, -523.2420141026378, -314.034620732069, -413.4515906646848, -346.62810419499874, -358.19721683859825, -381.67077557742596, -333.18282406032085, -395.2381569966674, -447.6440641824156, -454.2537814080715, -378.0063712261617, -314.4995838701725, -377.82473504543304, -391.07768885046244, -399.86853341013193, -357.5141452103853, -364.7989697381854, -409.556245110929, -301.3390085250139, -399.6547804325819, -355.82139718160033, -397.80141820013523, -332.0802602805197, -340.9868564978242, -426.93839382380247, -301.12510327249765, -313.06330644339323, -307.2213183864951, -393.4352495223284, -408.1151480562985, -279.4052090346813, -437.6893608942628, -593.1876403465867, -438.66483510285616, -330.9454692006111, -389.2933655679226, -305.63020995259285, -317.0780930891633, -319.9917615232989, -347.4447884336114, -353.2400648072362, -356.6638189405203, -372.3627101704478, -394.9995891004801, -333.1994027271867, -489.3995652496815, -334.33857221901417, -301.5304487235844, -362.6573550850153, -411.7360987775028, -395.4513445366174, -324.82567657902837, -449.32951409742236, -362.58790465444326, -400.7489316686988, -479.34582498669624, -357.5747425407171, -463.91813276708126, -352.92549043893814, -421.94442731142044, -318.2988459393382, -327.18379609659314, -432.70920229516923, -352.8219363540411, -295.841663017869, -423.27081613242626, -388.95407382398844, -372.65070905536413, -497.35834174603224, -415.6022419705987, -360.25838489830494, -394.975046902895, -392.1793380789459, -342.77473240718246, -416.6279318407178, -324.20999728515744, -407.08602125942707, -307.6620885618031, -510.9906292334199, -370.80836053937674, -369.07375555485487, -472.9178740605712, -311.56222577393055, -414.9540125913918, -463.99792605638504, -419.65392531454563, -421.51292934268713, -395.06994608044624, -468.36226197332144, -382.94350925832987, -421.5172505378723, -399.6571003347635, -479.9529763683677, -287.68581641092896, -348.77735091000795, -402.96122774481773, -353.4399414807558, -315.2439535409212, -369.99423458985984, -359.9794675037265, -328.7253735512495, -311.80180952325463, -425.68907307088375, -401.1371932551265, -388.51408433541656, -415.19914665818214, -361.8170204311609, -335.9612304791808, -483.84175092726946, -400.6293320991099, -369.24782805144787, -400.6649935245514, -343.3759032562375, -350.78753221035004, -277.56609830260277, -366.5076639279723, -423.62609718739986, -338.95772434026003, -346.32342245802283, -370.74780149012804, -450.4203064572066, -467.6880172044039, -408.9877745695412, -385.3980800099671, -305.41012025624514, -398.2471967935562, -281.5910275056958, -396.86694699525833, -363.19205026328564, -352.53555861860514, -359.4753741621971, -444.457120038569, -392.35413977503777, -447.7885713726282, -349.9341582506895, -435.4562203064561, -358.53802295029163, -379.72962269186974, -474.0943999439478, -382.9596630856395, -402.04309409856796, -424.1180796548724, -378.26570346951485, -389.09225349873304, -400.95638197660446, -330.79352814145386, -336.94720131903887, -405.78939743712544, -342.6605905368924, -481.0227763876319, -318.24840857833624, -372.21578565984964, -459.06871138326824, -363.9111894965172, -408.1711405143142, -379.1231206394732, -334.71681647375226, -480.3662832342088, -291.9005815163255, -330.49670999869704, -511.3925932198763, -420.3402522802353, -333.4809187427163, -394.41994056105614, -369.19564582780004, -302.50853138417006, -313.4705587103963, -274.2408476769924, -423.01124224066734, -261.4992084056139, -401.0036518201232, -483.3251299969852, -488.0962285846472, -371.65070102363825, -377.46034844219685, -278.3186746239662, -413.5242052078247, -399.84174982085824, -309.21174182742834, -403.0689979568124, -369.7008761167526, -342.70004992745817, -216.80452075973153, -454.252545427531, -394.6880343519151, -317.68647700175643, -334.5208872407675, -291.04516956955194, -362.15371215343475, -423.0434695482254, -441.50196636095643, -374.34390330314636, -371.0298589654267, -395.180541805923, -374.34223391115665, -398.34181896597147, -427.5599637553096, -405.20243802666664, -418.7549970615655, -310.6781669408083, -393.09049089998007, -503.3535923808813, -440.0129909142852, -484.7059929482639, -297.36322993040085, -395.2316298801452, -454.98561841249466, -286.51247231662273, -450.38509602099657, -412.65541023388505, -492.20917166769505, -396.73328821361065, -394.97471049427986, -403.6622484475374, -346.1547921076417, -333.32936181873083, -328.8127429559827, -342.5498098656535, -362.64104421436787, -453.7658100873232, -306.5901939421892, -353.2107220888138, -614.0704938173294, -383.4240182675421, -403.7547134645283, -424.17000430449843, -445.0383207499981, -387.1454678699374, -399.49851136654615, -388.43217032402754, -389.1260362416506, -345.9098471030593, -329.1806984618306, -357.7255384400487, -442.4643082469702, -411.1266785040498, -287.8058147877455, -461.7265418320894, -342.2400265187025, -445.59440480172634, -306.37508790940046, -377.74369093589485, -273.1742880344391, -364.2283174395561, -375.245198905468, -398.80679804086685, -318.1446497961879, -361.6846868991852, -366.3571491986513, -361.61724450811744, -470.65845956094563, -280.8393578976393, -312.22006646357477, -369.4979611635208, -365.7069681994617, -309.4627007842064, -389.7499475181103, -378.53077606111765, -278.8358271494508, -427.509878359735, -457.2376637365669, -425.50697062909603, -362.94541741907597, -461.34279803931713, -387.80055721849203, -471.06005504727364, -418.56552498042583, -415.5214049965143, -459.37708964943886, -373.4863294586539, -422.6690235994756, -420.35630709677935, -339.48185700178146, -334.6371742039919, -368.872662961483, -378.9210277199745, -343.00481383502483, -321.6070927977562, -345.3675534129143, -313.283495888114, -330.8206944987178, -335.27331356704235, -394.4422679580748, -330.14130287617445, -382.8078480064869, -525.4044733680785, -386.43927120417356, -317.1244343817234, -342.4820159673691, -292.7787342797965, -493.1935653090477, -338.3545299731195, -317.88662434369326, -449.37462168186903, -379.0738482326269, -342.3365238327533], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4046681962380525, "mean_inference_ms": 4.532573465536118, "mean_action_processing_ms": 4.205363640307578, "mean_env_wait_ms": 3.227055848518787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4455360, "timesteps_this_iter": 131040, "agent_timesteps_total": 4455360, "timers": {"sample_time_ms": 29712.063, "sample_throughput": 4410.33, "load_time_ms": 23.0, "load_throughput": 5697319.962, "learn_time_ms": 14943.894, "learn_throughput": 8768.799, "update_time_ms": 2.261}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064365386958e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 260.8899692921928, "policy_loss": -0.010673222468375461, "vf_loss": 52.18838365616337, "vf_explained_var": 0.07207384630770666, "kl": 0.001965063003410909, "entropy": -0.2842665589731654, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4455360, "num_agent_steps_sampled": 4455360, "num_steps_trained": 4455360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4455360}, "done": false, "episodes_total": 9280, "training_iteration": 34, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-59-22", "timestamp": 1691020762, "time_this_iter_s": 39.42553424835205, "time_total_s": 1085.6129179000854, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1085.6129179000854, "timesteps_since_restore": 4455360, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 44.31428571428571, "ram_util_percent": 51.13035714285714}}
{"evaluation": {"episode_reward_max": -2815.745249927044, "episode_reward_min": -2815.745249927044, "episode_reward_mean": -2815.745249927044, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2815.745249927044], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -273.1742880344391, "episode_reward_min": -614.0704938173294, "episode_reward_mean": -383.18927524726837, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-427.5599637553096, -405.20243802666664, -418.7549970615655, -310.6781669408083, -393.09049089998007, -503.3535923808813, -440.0129909142852, -484.7059929482639, -297.36322993040085, -395.2316298801452, -454.98561841249466, -286.51247231662273, -450.38509602099657, -412.65541023388505, -492.20917166769505, -396.73328821361065, -394.97471049427986, -403.6622484475374, -346.1547921076417, -333.32936181873083, -328.8127429559827, -342.5498098656535, -362.64104421436787, -453.7658100873232, -306.5901939421892, -353.2107220888138, -614.0704938173294, -383.4240182675421, -403.7547134645283, -424.17000430449843, -445.0383207499981, -387.1454678699374, -399.49851136654615, -388.43217032402754, -389.1260362416506, -345.9098471030593, -329.1806984618306, -357.7255384400487, -442.4643082469702, -411.1266785040498, -287.8058147877455, -461.7265418320894, -342.2400265187025, -445.59440480172634, -306.37508790940046, -377.74369093589485, -273.1742880344391, -364.2283174395561, -375.245198905468, -398.80679804086685, -318.1446497961879, -361.6846868991852, -366.3571491986513, -361.61724450811744, -470.65845956094563, -280.8393578976393, -312.22006646357477, -369.4979611635208, -365.7069681994617, -309.4627007842064, -389.7499475181103, -378.53077606111765, -278.8358271494508, -427.509878359735, -457.2376637365669, -425.50697062909603, -362.94541741907597, -461.34279803931713, -387.80055721849203, -471.06005504727364, -418.56552498042583, -415.5214049965143, -459.37708964943886, -373.4863294586539, -422.6690235994756, -420.35630709677935, -339.48185700178146, -334.6371742039919, -368.872662961483, -378.9210277199745, -343.00481383502483, -321.6070927977562, -345.3675534129143, -313.283495888114, -330.8206944987178, -335.27331356704235, -394.4422679580748, -330.14130287617445, -382.8078480064869, -525.4044733680785, -386.43927120417356, -317.1244343817234, -342.4820159673691, -292.7787342797965, -493.1935653090477, -338.3545299731195, -317.88662434369326, -449.37462168186903, -379.0738482326269, -342.3365238327533], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.39528168207718, "mean_inference_ms": 4.52319957566398, "mean_action_processing_ms": 4.157524132793255, "mean_env_wait_ms": 3.2024799309066343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4586400, "timesteps_this_iter": 131040, "agent_timesteps_total": 4586400, "timers": {"sample_time_ms": 27290.124, "sample_throughput": 4801.737, "load_time_ms": 21.262, "load_throughput": 6163204.069, "learn_time_ms": 14943.728, "learn_throughput": 8768.896, "update_time_ms": 2.258}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532182693479e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 250.41032975951816, "policy_loss": 0.002036711008864608, "vf_loss": 50.079740257673365, "vf_explained_var": 0.07815691540318151, "kl": 0.0017533783981781854, "entropy": -0.28976954738726324, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4586400, "num_agent_steps_sampled": 4586400, "num_steps_trained": 4586400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4586400}, "done": false, "episodes_total": 9280, "training_iteration": 35, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-02_23-59-37", "timestamp": 1691020777, "time_this_iter_s": 15.013853788375854, "time_total_s": 1100.6267716884613, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1100.6267716884613, "timesteps_since_restore": 4586400, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 14.00952380952381, "ram_util_percent": 51.46666666666666}}
{"episode_reward_max": -176.2450027167797, "episode_reward_min": -533.016927011311, "episode_reward_mean": -336.75673277382157, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294.61137921363115, -318.99319864809513, -335.50977393239737, -334.5063187517226, -361.39443469047546, -373.6829065233469, -342.3313304409385, -342.61719684675336, -351.3654070496559, -287.16682790219784, -327.6124855875969, -364.1346689686179, -248.74478040635586, -374.4718650020659, -411.30448381602764, -238.62108072638512, -491.43766881525517, -288.9637000337243, -305.82311518490314, -296.2310154493898, -445.7342083081603, -447.6051526516676, -347.4986326545477, -326.43178652971983, -369.2535480335355, -310.62897596880794, -364.8247393220663, -373.58603847771883, -333.57072599604726, -297.75923489779234, -383.95105458796024, -370.9608340859413, -298.6532762758434, -445.9355826675892, -363.48910005390644, -344.42502541281283, -324.1039747297764, -333.4666807949543, -313.84270726144314, -409.4923723898828, -308.59322737902403, -317.7563428543508, -314.84483840316534, -354.9051320627332, -399.9602621626109, -279.03202019259334, -279.05727095901966, -327.68588139116764, -387.3234051615, -313.3617704361677, -314.3767793774605, -417.84288719296455, -331.323448702693, -461.9440607316792, -329.0892963409424, -354.3976112306118, -364.1090812534094, -317.9928536117077, -365.0250458866358, -392.34216764196754, -292.30710661411285, -402.5588644146919, -304.5189733952284, -299.14130917936563, -434.0570745319128, -326.78960809856653, -300.9283823296428, -353.3683650791645, -324.961569160223, -351.7431097328663, -289.26920944452286, -331.74599469453096, -338.6232421323657, -265.146361194551, -281.95413202792406, -310.1182531788945, -300.7327502295375, -347.1106062158942, -363.68597753718495, -361.7465174496174, -238.20946170017123, -329.0124485641718, -368.57830798625946, -513.1470423340797, -302.84707755595446, -325.48590621352196, -345.08501403033733, -301.23131743073463, -362.1980987712741, -325.8614001721144, -275.4025178179145, -266.2451723963022, -460.4664573892951, -341.8011817857623, -347.41630195081234, -296.16782092675567, -330.08363839425147, -334.11498185247183, -373.6531890332699, -305.16255558282137, -328.4431205317378, -338.6130555011332, -352.0176644399762, -386.5736602395773, -359.5480599179864, -341.1593713834882, -340.0098156630993, -287.0931085348129, -342.9054993093014, -393.2155675664544, -288.43297305703163, -392.42835588753223, -407.71301886439323, -360.8007297515869, -304.0268535539508, -321.4738885909319, -471.8565868884325, -336.6432852707803, -304.44946802407503, -323.6081841364503, -335.4855302795768, -335.5141086727381, -383.51369166374207, -332.4577509108931, -281.2147182226181, -312.04603945836425, -341.0857708081603, -297.2838816829026, -285.3674663826823, -319.55736584961414, -370.0044803842902, -313.3477179184556, -274.13094664365053, -318.080642670393, -337.90952606499195, -329.5702418535948, -332.15941447764635, -371.5676713157445, -382.8601273819804, -299.2804100140929, -277.5460024178028, -305.74642646312714, -330.61065033078194, -304.79974403232336, -311.04584963433444, -295.99779710173607, -422.5466038733721, -362.576952368021, -319.60731330513954, -277.34290957450867, -343.904293064028, -445.25645887479186, -311.2753417342901, -337.4002211019397, -329.64206751435995, -275.8932938538492, -339.8270186930895, -336.61370668560266, -347.298818603158, -341.55806305259466, -281.0926113277674, -319.51327807083726, -395.6492742188275, -315.9738153666258, -315.73332253843546, -332.98750315979123, -358.60897805541754, -356.19101916626096, -381.16349667310715, -313.05416080728173, -371.74960915744305, -270.81166656687856, -258.0253531113267, -356.89771092683077, -340.5895695965737, -346.08548460155725, -342.80495968461037, -359.48779030144215, -365.30877638980746, -352.93484158441424, -400.65528612583876, -345.9923461228609, -330.00694619864225, -331.2546618580818, -318.8671593517065, -369.5716327056289, -360.0672090277076, -299.1193697564304, -257.14845056831837, -329.71281496435404, -374.7069814428687, -399.1424178183079, -264.59142845869064, -381.35055734962225, -280.9480729624629, -340.10703014582396, -340.38724149763584, -352.52418383955956, -294.56324783712626, -339.4213219098747, -385.8471789136529, -266.73022885620594, -317.05211010575294, -354.34550735354424, -370.2770152390003, -485.83251555636525, -287.58982587233186, -297.32375651597977, -354.5952979400754, -292.07588562369347, -296.06450107321143, -367.26650558412075, -361.61181897483766, -258.0777584016323, -363.01507449150085, -376.7542717922479, -306.95459681376815, -304.3137423172593, -353.99909008666873, -351.8477872572839, -394.69969663769007, -320.11950591765344, -344.20032285153866, -251.3990702033043, -328.4317055493593, -320.5430909395218, -276.2956450805068, -318.00556217134, -385.1451364569366, -361.74286916852, -409.928448356688, -377.66788060963154, -380.26452489197254, -296.18421578221023, -278.46984948962927, -285.24811878055334, -306.0857376754284, -279.55750922858715, -254.72463188320398, -407.42053140699863, -336.69579558447003, -268.4813510775566, -273.5456049963832, -390.31445828825235, -313.15599098801613, -392.43501725792885, -399.11829750984907, -333.3457831759006, -321.22544716950506, -314.09090465307236, -361.40075220912695, -292.8298255801201, -366.6723098587245, -360.2522401958704, -345.36986514925957, -293.750556088984, -329.5936356931925, -287.3806525096297, -393.7281709648669, -371.25734174996614, -386.05823869258165, -357.21325501799583, -336.17733835428953, -292.5415259487927, -513.5491378456354, -369.72154275141656, -390.94103733450174, -391.1451844330877, -338.3635364845395, -399.0416261386126, -408.35536659508944, -321.2373649775982, -271.65677627176046, -314.20272916555405, -387.32644329965115, -361.03205382078886, -303.12082935869694, -386.259499065578, -314.38320242613554, -376.8389394506812, -328.61528155207634, -302.82912826538086, -372.0037169903517, -271.30095370672643, -321.7605178691447, -344.8267639577389, -360.5906065776944, -352.41884165629745, -310.41594582796097, -406.2432170212269, -331.16336999088526, -348.5395969077945, -317.07744257338345, -454.7748319283128, -318.71674334071577, -311.46998892724514, -336.8290845453739, -369.6557045057416, -378.2097802311182, -333.5234171003103, -271.9783098883927, -332.002215821296, -288.859337836504, -286.0482543706894, -343.0190318375826, -400.35970897972584, -328.195567086339, -304.01713594421744, -329.79537224024534, -311.04939452186227, -297.6205604672432, -340.21557119488716, -315.6322959288955, -317.5134067237377, -365.4467629045248, -303.621110111475, -352.38428412377834, -352.7029042765498, -318.18972884863615, -338.3918845951557, -326.65519516915083, -328.41381990443915, -274.6378538161516, -304.6269655171782, -332.08754674345255, -320.4053385518491, -264.3389634117484, -317.54757130891085, -310.09914552234113, -314.8398344218731, -309.25053115934134, -444.8868612572551, -221.58707161992788, -363.3536748215556, -346.44564732164145, -349.0328338518739, -343.2722747027874, -295.8965953141451, -367.8408458009362, -286.3326510824263, -273.8888267464936, -305.02422301471233, -325.28204199671745, -337.4291981086135, -340.4548043683171, -325.2645587697625, -367.75576654076576, -334.49069434404373, -335.4142969213426, -361.24297608807683, -309.39337315782905, -316.91010362654924, -267.9500503614545, -312.66527073830366, -379.5294409543276, -309.8655128777027, -364.5611380673945, -275.5665073469281, -271.64884987846017, -391.52259343862534, -329.6813426911831, -341.7368056252599, -268.1749695241451, -281.9566775225103, -334.5739077180624, -344.1273152977228, -295.6761656701565, -384.53899965435266, -265.38037956878543, -313.2860275506973, -345.8532378356904, -344.98605643957853, -533.016927011311, -352.5518873203546, -289.4993529096246, -332.82347797602415, -356.1940747499466, -296.7883965522051, -267.7162696570158, -309.61312885954976, -400.88405936956406, -371.81975734233856, -416.67973358370364, -369.10929721593857, -344.8028172105551, -360.1955516785383, -280.0871163904667, -372.0071434080601, -341.81274000834674, -477.2248768955469, -285.41371328011155, -354.23379596695304, -345.90197230130434, -176.2450027167797, -291.6698611974716, -373.40817444399, -300.95655198022723, -370.7786081135273, -316.97154109179974, -301.87027867883444, -338.7762700729072, -329.79993565380573, -326.28626301139593, -379.76700861006975, -356.50806365534663, -257.83995308354497, -344.686825402081, -308.74208926409483, -329.83557379059494, -395.3965039551258, -420.1481336578727, -319.6305856183171, -216.32959312945604, -322.2486242428422, -366.5346246995032, -292.83436319977045, -317.61944013834, -314.83999190479517, -320.01133098080754, -313.4645772576332, -323.11058989167213, -382.1854569353163, -335.4512186422944, -361.1124585047364, -351.6877209767699, -363.7545174956322, -306.0863658115268, -427.80038191750646, -409.54860557615757, -321.63350520282984, -303.81427367031574, -354.2248582690954, -345.4641958028078, -277.4742030054331, -293.1204426251352, -345.8773899450898, -351.7974513024092, -345.32890447229147, -283.83582577109337, -329.0156495720148, -299.5055288784206, -233.57815799117088, -325.30413683503866, -278.74403504282236, -273.3581970259547, -351.84147875756025, -389.14579290151596, -342.21186968684196, -365.6511968933046, -334.3419563919306, -376.18587855249643, -298.794771745801, -374.83313794247806, -329.5705716907978, -348.5366549640894, -352.37419536709785, -288.2055745497346, -308.7999681904912, -305.5962698236108, -364.4573438242078, -345.9734607897699, -329.4065932724625, -311.2799484729767, -356.3786944001913, -401.57956291362643, -433.93630401045084, -366.0572331547737, -463.1820584349334, -328.7689568847418, -300.918712683022, -343.011706225574, -391.8161676675081, -305.74618918448687, -327.22695022821426, -375.8942121602595, -291.5281816497445, -374.2467401139438, -313.457561686635, -285.3661213815212, -302.491675645113], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402699228647228, "mean_inference_ms": 4.5331962722183, "mean_action_processing_ms": 4.205018803382258, "mean_env_wait_ms": 3.2262032606753217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4717440, "timesteps_this_iter": 131040, "agent_timesteps_total": 4717440, "timers": {"sample_time_ms": 29689.425, "sample_throughput": 4413.693, "load_time_ms": 22.721, "load_throughput": 5767459.586, "learn_time_ms": 14941.664, "learn_throughput": 8770.108, "update_time_ms": 2.268}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207660913467394e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 238.2239486084011, "policy_loss": -0.0005679944978192718, "vf_loss": 47.645067884930576, "vf_explained_var": 0.09188249685858313, "kl": 0.002008168704538209, "entropy": -0.29055540354448406, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4717440, "num_agent_steps_sampled": 4717440, "num_steps_trained": 4717440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4717440}, "done": false, "episodes_total": 9760, "training_iteration": 36, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-00-16", "timestamp": 1691020816, "time_this_iter_s": 39.33562254905701, "time_total_s": 1139.9623942375183, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1139.9623942375183, "timesteps_since_restore": 4717440, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 44.089285714285715, "ram_util_percent": 50.885714285714286}}
{"episode_reward_max": -176.2450027167797, "episode_reward_min": -477.2248768955469, "episode_reward_mean": -337.25000107607804, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.88405936956406, -371.81975734233856, -416.67973358370364, -369.10929721593857, -344.8028172105551, -360.1955516785383, -280.0871163904667, -372.0071434080601, -341.81274000834674, -477.2248768955469, -285.41371328011155, -354.23379596695304, -345.90197230130434, -176.2450027167797, -291.6698611974716, -373.40817444399, -300.95655198022723, -370.7786081135273, -316.97154109179974, -301.87027867883444, -338.7762700729072, -329.79993565380573, -326.28626301139593, -379.76700861006975, -356.50806365534663, -257.83995308354497, -344.686825402081, -308.74208926409483, -329.83557379059494, -395.3965039551258, -420.1481336578727, -319.6305856183171, -216.32959312945604, -322.2486242428422, -366.5346246995032, -292.83436319977045, -317.61944013834, -314.83999190479517, -320.01133098080754, -313.4645772576332, -323.11058989167213, -382.1854569353163, -335.4512186422944, -361.1124585047364, -351.6877209767699, -363.7545174956322, -306.0863658115268, -427.80038191750646, -409.54860557615757, -321.63350520282984, -303.81427367031574, -354.2248582690954, -345.4641958028078, -277.4742030054331, -293.1204426251352, -345.8773899450898, -351.7974513024092, -345.32890447229147, -283.83582577109337, -329.0156495720148, -299.5055288784206, -233.57815799117088, -325.30413683503866, -278.74403504282236, -273.3581970259547, -351.84147875756025, -389.14579290151596, -342.21186968684196, -365.6511968933046, -334.3419563919306, -376.18587855249643, -298.794771745801, -374.83313794247806, -329.5705716907978, -348.5366549640894, -352.37419536709785, -288.2055745497346, -308.7999681904912, -305.5962698236108, -364.4573438242078, -345.9734607897699, -329.4065932724625, -311.2799484729767, -356.3786944001913, -401.57956291362643, -433.93630401045084, -366.0572331547737, -463.1820584349334, -328.7689568847418, -300.918712683022, -343.011706225574, -391.8161676675081, -305.74618918448687, -327.22695022821426, -375.8942121602595, -291.5281816497445, -374.2467401139438, -313.457561686635, -285.3661213815212, -302.491675645113], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.389664037749193, "mean_inference_ms": 4.521612040480445, "mean_action_processing_ms": 4.154550259064267, "mean_env_wait_ms": 3.202356457706369, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4848480, "timesteps_this_iter": 131040, "agent_timesteps_total": 4848480, "timers": {"sample_time_ms": 27286.655, "sample_throughput": 4802.347, "load_time_ms": 21.086, "load_throughput": 6214444.127, "learn_time_ms": 14930.335, "learn_throughput": 8776.762, "update_time_ms": 2.27}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830456733697e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 234.4125288298778, "policy_loss": 0.0024998456272890303, "vf_loss": 46.87970860799154, "vf_explained_var": 0.09375357446277441, "kl": 0.0024920788357421543, "entropy": -0.29805783628349236, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4848480, "num_agent_steps_sampled": 4848480, "num_steps_trained": 4848480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4848480}, "done": false, "episodes_total": 9760, "training_iteration": 37, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-00-31", "timestamp": 1691020831, "time_this_iter_s": 15.149412870407104, "time_total_s": 1155.1118071079254, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1155.1118071079254, "timesteps_since_restore": 4848480, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 13.740909090909092, "ram_util_percent": 51.48636363636364}}
{"episode_reward_max": -181.09476587176323, "episode_reward_min": -548.1479024142027, "episode_reward_mean": -286.027271969336, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-285.38935527577996, -289.8530460372567, -273.2701913304627, -262.2923957929015, -299.11561643332243, -210.68614533543587, -309.2572072967887, -296.4435213431716, -304.23650017380714, -203.31997984834015, -290.6643993407488, -268.4169105552137, -270.53547671437263, -275.1604573391378, -279.79409220814705, -336.446213144809, -296.12281212955713, -361.3515067771077, -265.14708130806684, -263.0628747344017, -239.23599664866924, -310.17328472062945, -295.24394761770964, -293.20407850667834, -201.92753337323666, -301.21960382163525, -266.55039997398853, -274.93215814232826, -220.77116857469082, -343.25759094953537, -247.64674851857126, -228.43110443279147, -290.350764259696, -270.5895340666175, -267.73620019108057, -421.78757348656654, -286.5244441330433, -367.2640229463577, -300.0710762888193, -281.2278814613819, -275.7029861435294, -256.8407776877284, -192.69192262738943, -213.16828729957342, -304.0833595953882, -353.3831694275141, -246.02506441622972, -304.6350997686386, -270.43732734024525, -329.0515815503895, -307.13568676263094, -203.59684412926435, -301.023943990469, -273.3063314333558, -326.44365007802844, -248.25851580500603, -242.35645492840558, -259.71447230130434, -266.1308011971414, -212.88448824733496, -283.1272433921695, -198.72405987232924, -217.99212115257978, -349.8986828327179, -402.2424156367779, -216.36202596873045, -272.3091065660119, -277.56709583103657, -352.66345627605915, -224.71205800026655, -377.26840491592884, -282.7551682367921, -285.985649890732, -248.61819337308407, -273.90469247847795, -256.8015314862132, -247.72572733461857, -232.85092943906784, -321.99973921477795, -289.03600107878447, -344.80259693413973, -291.00216141343117, -300.42909194529057, -290.1537055596709, -319.38688322901726, -372.8306302204728, -288.53559312969446, -243.7082175463438, -240.67943690903485, -268.0978145748377, -293.184719838202, -314.15944516658783, -262.95019522309303, -422.1931122094393, -252.5247607268393, -285.60037937015295, -251.13978040218353, -187.94315084815025, -262.04717187583447, -292.1230007316917, -300.99180375784636, -318.9601788073778, -311.19080939888954, -356.77097899466753, -273.53090696781874, -401.7988525517285, -335.0957779288292, -344.02732829749584, -300.759324349463, -348.0267271026969, -276.8467333242297, -321.442633934319, -288.96414241939783, -359.3309214785695, -337.3986820280552, -252.35212321579456, -262.1079049706459, -248.49839656054974, -254.05429188907146, -388.35700016468763, -303.5756414234638, -267.9437053576112, -249.96140246093273, -337.7590447962284, -239.045833542943, -260.53922510147095, -296.3015636615455, -256.2518976330757, -263.82646083831787, -272.28512126766145, -236.2681768387556, -277.0894200913608, -398.0605390127748, -281.6096756309271, -332.10277335718274, -261.80197274312377, -237.95252284407616, -264.85116094350815, -255.47751718759537, -284.9403561130166, -371.77340399473906, -313.18711856007576, -271.61841290816665, -193.4071337133646, -337.63905161619186, -237.9910831823945, -264.0362048968673, -286.69145791977644, -217.90802863240242, -259.31674421578646, -240.83142657577991, -240.7303182017058, -278.21978981792927, -499.50453808903694, -355.82666554301977, -259.8507329747081, -226.70722361840308, -221.19355382025242, -272.94021444022655, -409.1153422296047, -267.66014467179775, -410.0403013378382, -225.41871329396963, -220.41570445150137, -332.8646842613816, -293.0427479147911, -314.27110912278295, -226.3408764898777, -271.6679153069854, -287.7208477258682, -400.6412660330534, -310.48674787953496, -234.12157328426838, -288.36752017214894, -227.0461933836341, -288.783268738538, -453.4315525665879, -299.15654230862856, -290.82300209999084, -548.1479024142027, -329.9913945645094, -263.6779498979449, -297.52267883718014, -426.4391395971179, -235.99437699466944, -339.900237262249, -330.3507166877389, -332.637938644737, -271.33555022627115, -277.8423554748297, -198.62415373325348, -269.4098903462291, -208.59310819208622, -302.9958354011178, -228.86840180307627, -294.45555233210325, -272.26376843452454, -199.31970355659723, -240.60479243658483, -349.188375659287, -240.35873072221875, -276.57025288790464, -315.7444902583957, -317.06751777231693, -304.29943151026964, -307.018067792058, -292.1283501200378, -282.25230373442173, -380.2658456414938, -321.3804657533765, -188.4827120602131, -291.11117337085307, -307.04738227277994, -223.68286618590355, -241.1064911186695, -302.64492370933294, -346.3870692923665, -229.82477043569088, -270.4541779831052, -230.1524287983775, -415.7150422297418, -329.2275950592011, -263.5415024161339, -251.61250467598438, -220.5616744607687, -290.4506773352623, -228.6902140416205, -397.9506582170725, -244.60099367797375, -212.79580495879054, -423.70366552472115, -268.3608694076538, -261.0931405723095, -256.42383256554604, -249.781149700284, -203.58885090053082, -329.60662492364645, -321.3207950219512, -299.38508523255587, -440.7791988402605, -310.7311728820205, -325.4646633565426, -279.8917561471462, -272.57298747450113, -298.96198259294033, -259.34342616796494, -302.6149532608688, -189.34261383116245, -248.24876908957958, -251.31460205465555, -274.4791833534837, -269.7261510640383, -288.44659646227956, -193.2230814471841, -251.9756491035223, -297.86281125992537, -296.9883047491312, -215.40800942853093, -229.75683467835188, -332.90363221615553, -312.3641010969877, -181.09476587176323, -251.95867890119553, -332.7142335548997, -316.70042879134417, -252.34573800116777, -424.28806790709496, -311.97880654037, -301.4412942826748, -238.08627565205097, -335.0188196655363, -322.8591701835394, -314.8299606144428, -251.2369552589953, -248.106763869524, -271.191723421216, -241.37237208336592, -365.9582027569413, -337.7719948813319, -229.9744562730193, -350.6212353184819, -348.21604472771287, -402.61006024107337, -295.830509416759, -326.6794495135546, -214.4845304787159, -255.59036170691252, -193.4655862674117, -311.2113852649927, -347.0274075716734, -195.52759642153978, -331.7955845594406, -295.3582676015794, -281.5243748128414, -276.9804852977395, -252.22826512902975, -231.24463114142418, -241.90168975293636, -271.45272320508957, -300.09247728437185, -279.33370301127434, -308.52495051920414, -311.27229552716017, -300.4700037240982, -366.2686311677098, -280.30668822675943, -347.90135201998055, -359.4534824192524, -339.35650530457497, -266.02032655477524, -271.5285184234381, -338.39448587596416, -356.17453315109015, -229.0944359600544, -256.69648945331573, -286.2477894946933, -309.76964519917965, -336.05849942192435, -248.1277537047863, -219.5692959278822, -336.1518623456359, -237.1093060746789, -202.68298653513193, -225.66147646680474, -254.58265924453735, -307.46607922017574, -267.38200677745044, -267.12034905329347, -256.3542817905545, -241.81235298886895, -270.6780190169811, -193.83446047455072, -328.4621242135763, -289.1576487869024, -312.0840387493372, -216.52229210734367, -214.228611972183, -369.7467139773071, -248.6997043862939, -233.43297638744116, -262.57187013328075, -375.14247200638056, -303.980956338346, -335.8890082985163, -264.17830231040716, -268.2058052122593, -341.7676119543612, -371.7493517808616, -223.41232812777162, -210.55209777504206, -242.17923509329557, -310.96139892190695, -284.60801216214895, -411.93832144886255, -237.5712725147605, -245.2857814859599, -216.76535118743777, -305.8633023314178, -203.2602026546374, -361.93175323307514, -240.03500400856137, -243.11667330563068, -273.64717496186495, -311.27078744769096, -347.9259337298572, -205.4854217134416, -216.11401007324457, -206.47684702649713, -276.21476551145315, -248.56356614083052, -410.5649518221617, -216.42177164554596, -358.6213588118553, -309.2400501072407, -240.7716377750039, -279.25575218722224, -213.62939392775297, -271.3535349816084, -288.17454532533884, -243.44016221165657, -301.9399011731148, -327.6183076053858, -361.2129677683115, -283.35003431886435, -181.46902404725552, -222.4568939357996, -385.74353055655956, -310.074406132102, -329.1592780724168, -225.24466771632433, -356.92946504056454, -394.6686736792326, -216.4571400154382, -232.028586268425, -244.9876718223095, -317.37032564356923, -228.37037234008312, -249.1634562201798, -218.222995005548, -379.6960192024708, -234.9188442826271, -330.0918907299638, -232.8417064808309, -390.2731273621321, -487.915751978755, -348.56184761598706, -240.36125934496522, -288.2517044246197, -267.64586344361305, -223.2414033934474, -302.8050954565406, -275.05328572168946, -215.26264284923673, -339.00994976609945, -227.58958685398102, -326.67507922649384, -240.98648178204894, -302.9790892023593, -336.4493578374386, -240.68343303352594, -321.7167123258114, -302.9123926386237, -337.9599524438381, -303.53306356072426, -254.82063654065132, -357.9694794639945, -389.5903237462044, -331.3436566963792, -219.206045916304, -205.94753995537758, -283.08693557418883, -291.9820639565587, -520.620643928647, -258.6043804436922, -350.60802025720477, -230.2203558087349, -282.8842750713229, -204.3588919788599, -267.93484584242105, -354.279360935092, -246.95817639678717, -237.99596782773733, -401.76679584011436, -245.8854174502194, -278.76929116249084, -266.6825775317848, -283.79583007097244, -324.744655482471, -312.651719301939, -260.3723265193403, -214.61626435816288, -289.2913120929152, -284.1825750917196, -271.1393250897527, -282.51119984686375, -209.62166042998433, -248.61517477035522, -278.93946845829487, -259.8207430392504, -272.1075585260987, -414.20289044082165, -290.89370511472225, -360.31896923296154, -287.6202494762838, -276.71778455004096, -236.16481503099203, -207.61831465363503, -200.12871884554625, -263.3749593347311, -335.7465410977602, -273.6907392665744, -196.42317421734333, -254.25306621193886, -341.16832472383976, -228.78398344665766, -239.49456596374512, -332.3707790002227, -242.11481270194054, -230.79964278638363, -321.2363567277789], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4038306463632955, "mean_inference_ms": 4.533863526109908, "mean_action_processing_ms": 4.205411375062032, "mean_env_wait_ms": 3.2273902100545873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4979520, "timesteps_this_iter": 131040, "agent_timesteps_total": 4979520, "timers": {"sample_time_ms": 29686.676, "sample_throughput": 4414.101, "load_time_ms": 22.685, "load_throughput": 5776503.463, "learn_time_ms": 14935.684, "learn_throughput": 8773.619, "update_time_ms": 2.276}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915228366849e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 241.92376108145544, "policy_loss": -2.9696213335317753e-05, "vf_loss": 48.38447918088632, "vf_explained_var": 0.10605680654125829, "kl": 0.0020744717712278113, "entropy": -0.3034939317827156, "entropy_coeff": 0.001}}}, "num_steps_sampled": 4979520, "num_agent_steps_sampled": 4979520, "num_steps_trained": 4979520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 4979520}, "done": false, "episodes_total": 10240, "training_iteration": 38, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-01-11", "timestamp": 1691020871, "time_this_iter_s": 39.56917953491211, "time_total_s": 1194.6809866428375, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1194.6809866428375, "timesteps_since_restore": 4979520, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 44.12456140350878, "ram_util_percent": 51.47894736842105}}
{"episode_reward_max": -181.46902404725552, "episode_reward_min": -520.620643928647, "episode_reward_mean": -286.90931126546116, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301.9399011731148, -327.6183076053858, -361.2129677683115, -283.35003431886435, -181.46902404725552, -222.4568939357996, -385.74353055655956, -310.074406132102, -329.1592780724168, -225.24466771632433, -356.92946504056454, -394.6686736792326, -216.4571400154382, -232.028586268425, -244.9876718223095, -317.37032564356923, -228.37037234008312, -249.1634562201798, -218.222995005548, -379.6960192024708, -234.9188442826271, -330.0918907299638, -232.8417064808309, -390.2731273621321, -487.915751978755, -348.56184761598706, -240.36125934496522, -288.2517044246197, -267.64586344361305, -223.2414033934474, -302.8050954565406, -275.05328572168946, -215.26264284923673, -339.00994976609945, -227.58958685398102, -326.67507922649384, -240.98648178204894, -302.9790892023593, -336.4493578374386, -240.68343303352594, -321.7167123258114, -302.9123926386237, -337.9599524438381, -303.53306356072426, -254.82063654065132, -357.9694794639945, -389.5903237462044, -331.3436566963792, -219.206045916304, -205.94753995537758, -283.08693557418883, -291.9820639565587, -520.620643928647, -258.6043804436922, -350.60802025720477, -230.2203558087349, -282.8842750713229, -204.3588919788599, -267.93484584242105, -354.279360935092, -246.95817639678717, -237.99596782773733, -401.76679584011436, -245.8854174502194, -278.76929116249084, -266.6825775317848, -283.79583007097244, -324.744655482471, -312.651719301939, -260.3723265193403, -214.61626435816288, -289.2913120929152, -284.1825750917196, -271.1393250897527, -282.51119984686375, -209.62166042998433, -248.61517477035522, -278.93946845829487, -259.8207430392504, -272.1075585260987, -414.20289044082165, -290.89370511472225, -360.31896923296154, -287.6202494762838, -276.71778455004096, -236.16481503099203, -207.61831465363503, -200.12871884554625, -263.3749593347311, -335.7465410977602, -273.6907392665744, -196.42317421734333, -254.25306621193886, -341.16832472383976, -228.78398344665766, -239.49456596374512, -332.3707790002227, -242.11481270194054, -230.79964278638363, -321.2363567277789], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3901383970953285, "mean_inference_ms": 4.521455181246748, "mean_action_processing_ms": 4.153237328692953, "mean_env_wait_ms": 3.2007557946929395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5110560, "timesteps_this_iter": 131040, "agent_timesteps_total": 5110560, "timers": {"sample_time_ms": 27270.295, "sample_throughput": 4805.228, "load_time_ms": 20.731, "load_throughput": 6321086.091, "learn_time_ms": 14922.828, "learn_throughput": 8781.178, "update_time_ms": 2.288}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957614183424e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 235.44558698907096, "policy_loss": -0.000144274151992607, "vf_loss": 47.088954829827856, "vf_explained_var": 0.1875040334612665, "kl": 0.002149418387587072, "entropy": -0.30758965549503176, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5110560, "num_agent_steps_sampled": 5110560, "num_steps_trained": 5110560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5110560}, "done": false, "episodes_total": 10240, "training_iteration": 39, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-01-26", "timestamp": 1691020886, "time_this_iter_s": 15.107560634613037, "time_total_s": 1209.7885472774506, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1209.7885472774506, "timesteps_since_restore": 5110560, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 13.857142857142858, "ram_util_percent": 51.599999999999994}}
{"evaluation": {"episode_reward_max": -4128.805197522044, "episode_reward_min": -4128.805197522044, "episode_reward_mean": -4128.805197522044, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4128.805197522044], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -119.29527022689581, "episode_reward_min": -592.8232576772571, "episode_reward_mean": -252.467755946322, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-223.41240702196956, -463.5007838755846, -175.53422351926565, -259.80763856321573, -300.52963906526566, -235.16717775166035, -146.72922982275486, -198.18558926135302, -280.1256727576256, -233.95093304291368, -183.3589969277382, -186.42608346045017, -237.74123646132648, -190.83747709542513, -355.37398041039705, -206.14266927540302, -270.5176873356104, -336.08009511977434, -348.2906706407666, -312.95003195665777, -239.27466395497322, -249.47607415169477, -195.9533615708351, -234.37341809272766, -239.41689448058605, -332.15662705898285, -163.86674024164677, -176.5732767470181, -195.62179496139288, -171.12399719655514, -150.78932431340218, -241.02285224944353, -256.8913510069251, -513.4764995276928, -185.81441587209702, -337.10770665481687, -223.86134029179811, -449.66972083598375, -205.68724047765136, -119.29527022689581, -194.8089488297701, -309.01238219439983, -197.86076737940311, -186.85101629048586, -365.2992797642946, -264.6437093690038, -265.1343121416867, -165.44332606345415, -224.104143448174, -294.01209811121225, -173.2439194843173, -185.4060059785843, -176.68460646271706, -211.4303330257535, -345.15487515181303, -216.40294270589948, -162.92080206423998, -385.4652506746352, -300.3095357045531, -284.3849145770073, -360.15974862128496, -388.4172809533775, -453.6363778412342, -190.9590590596199, -189.807273440063, -190.7490485534072, -355.5134538412094, -337.3695915043354, -360.70029809325933, -222.41437803953886, -249.9693312421441, -205.0483358129859, -251.06197829544544, -157.28655797243118, -196.18526373803616, -198.8532758280635, -209.71207566559315, -174.4140757471323, -150.36815843731165, -232.8814204260707, -170.78006837330759, -354.91592203080654, -231.41615338623524, -362.774041172117, -191.86786418408155, -342.4071991443634, -179.37513355910778, -284.3354957178235, -164.45031264424324, -440.56919130682945, -196.93921073526144, -164.5975735411048, -214.6852474361658, -286.6273603066802, -197.41064601391554, -193.61228945106268, -338.41398034617305, -213.64566055312753, -362.8548096381128, -467.72037000209093, -247.61634236574173, -195.82463217526674, -220.9589364901185, -239.7520409077406, -314.2574528064579, -410.52997824549675, -341.5240885466337, -226.68041672557592, -175.44063360244036, -336.64173016883433, -335.67872500419617, -218.9289646819234, -217.31079626269639, -198.13638561218977, -192.48093850910664, -179.83234307914972, -209.05490935593843, -201.8757518865168, -328.0580342784524, -210.52648379653692, -241.50523084402084, -188.56326639279723, -186.1298969388008, -179.6202798113227, -265.4251055084169, -223.66086012870073, -356.0274703577161, -195.49685762822628, -134.98945711553097, -446.8273584097624, -166.23852518200874, -196.40889981389046, -235.7787652388215, -264.5415376871824, -350.9276094585657, -273.11623817682266, -191.07542381435633, -353.3155182823539, -332.487443305552, -308.66849511116743, -243.10908678546548, -245.9811897724867, -262.0318686179817, -209.46630892902613, -213.19493948668242, -267.8422873169184, -390.7414633501321, -282.36170833557844, -222.01373524218798, -323.4359200447798, -225.48865313827991, -354.3080656826496, -192.684125687927, -205.06360607594252, -169.45909694582224, -168.18516698479652, -298.0416615009308, -165.48496983200312, -321.2540897503495, -260.4925414323807, -345.56990195810795, -235.86350462585688, -272.0076649747789, -174.31528398394585, -317.26893496513367, -409.4474398419261, -148.26916932314634, -239.1658484786749, -207.9839218184352, -333.9399892985821, -321.81063862890005, -291.55992037802935, -334.91342171281576, -208.6202785372734, -224.7806943655014, -442.8317053616047, -341.2009777314961, -189.08491204679012, -272.92185163125396, -203.65906642377377, -324.7890137657523, -188.69366873800755, -161.15614600479603, -215.95207630097866, -326.01894036494195, -127.59087305516005, -341.14706376194954, -592.8232576772571, -202.4974486529827, -212.1616635620594, -340.883957400918, -197.5412304624915, -271.3167157769203, -206.3261153846979, -317.49931578710675, -490.70932238548994, -212.41467294096947, -187.399718914181, -236.17253601551056, -212.15216629952192, -369.4626839701086, -209.76373275369406, -441.5735390558839, -154.24357484281063, -304.70500732958317, -235.0338646583259, -233.4404043778777, -207.84179439768195, -198.53219938278198, -196.8874318227172, -359.56860572099686, -254.3808982204646, -193.64215406775475, -214.60688677802682, -313.672877125442, -355.3542521446943, -314.71467363089323, -386.82057378068566, -164.903193898499, -186.02961098402739, -202.37550608813763, -250.01274141296744, -196.1219951491803, -385.28363566473126, -332.5346782207489, -280.49924720451236, -258.2525588199496, -239.64627440273762, -174.63560895621777, -324.56378761678934, -253.94731782376766, -167.43591585755348, -206.33846573531628, -193.68102581985295, -170.7659057341516, -161.26737410575151, -150.3170608151704, -216.50953022390604, -185.34675569087267, -182.93547628447413, -168.1761296968907, -237.93514473736286, -257.07115967944264, -160.4694616496563, -192.6688362210989, -229.1316456273198, -302.25294717401266, -163.74678729474545, -233.3704408109188, -176.46067982167006, -164.15177194494754, -235.5200169235468, -266.0675061568618, -161.1267308369279, -338.81334128789604, -182.2468953244388, -381.27737414836884, -155.09118119999766, -235.6505315452814, -241.36242208629847, -209.20071174576879, -226.85294589400291, -269.63716434687376, -276.1697084233165, -199.18338982015848, -321.82455035857856, -278.36006373912096, -386.0992760658264, -235.45059157162905, -324.8065683990717, -309.1557165905833, -179.1621129438281, -297.16430493444204, -239.26513213664293, -350.9672823827714, -327.7397591918707, -202.4461689516902, -250.93175947666168, -345.18403635174036, -316.729389436543, -202.86572036519647, -219.0989006087184, -306.391465485096, -357.7083846628666, -169.41720753721893, -170.48159333318472, -283.23350455984473, -210.93471271544695, -252.0448448136449, -224.5170926451683, -162.8732485473156, -211.35696259886026, -233.20917711034417, -180.156559035182, -188.24042916297913, -244.98328401893377, -217.99696484953165, -365.8264976888895, -204.54215366393328, -284.7769266217947, -207.85109980404377, -328.93882631510496, -215.23861285299063, -171.59517941437662, -378.1399249583483, -252.08710983023047, -328.012663513422, -167.62615276500583, -376.24623633921146, -247.71355098858476, -177.11636155098677, -221.07670878246427, -165.43217907100916, -123.40352110937238, -332.07218232378364, -266.84004455059767, -251.68853150308132, -197.13897337391973, -190.7435778155923, -280.88556512631476], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407574422874407, "mean_inference_ms": 4.534518916992271, "mean_action_processing_ms": 4.2056406539916535, "mean_env_wait_ms": 3.2260125462731013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5241600, "timesteps_this_iter": 131040, "agent_timesteps_total": 5241600, "timers": {"sample_time_ms": 29660.675, "sample_throughput": 4417.971, "load_time_ms": 22.318, "load_throughput": 5871592.758, "learn_time_ms": 14916.179, "learn_throughput": 8785.092, "update_time_ms": 2.297}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.637978807091712e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 226.5683506298601, "policy_loss": -0.0016889911178005336, "vf_loss": 45.31504564729643, "vf_explained_var": 0.20791719731036906, "kl": 0.0017199342660743602, "entropy": -0.31433260900145366, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5241600, "num_agent_steps_sampled": 5241600, "num_steps_trained": 5241600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5241600}, "done": false, "episodes_total": 10560, "training_iteration": 40, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-02-05", "timestamp": 1691020925, "time_this_iter_s": 39.105772256851196, "time_total_s": 1248.8943195343018, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1248.8943195343018, "timesteps_since_restore": 5241600, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 44.38571428571429, "ram_util_percent": 51.5}}
{"episode_reward_max": -100.65529080852866, "episode_reward_min": -593.1617650203407, "episode_reward_mean": -251.29935945751689, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.6463785469532, -233.56190730631351, -279.13888904079795, -412.8046357482672, -235.81525271385908, -164.9797505736351, -215.53708270937204, -114.95709670335054, -250.37491073459387, -192.66012131422758, -215.80005180835724, -216.5544604808092, -196.63785004615784, -218.2950345426798, -212.6661782413721, -374.5844636633992, -203.12112388759851, -319.5943131893873, -266.12172973155975, -287.61547067016363, -232.3237762004137, -417.5613355487585, -115.33834888786077, -198.5975349843502, -217.22817110270262, -388.863078514114, -259.7698893249035, -247.8172725737095, -250.44269168376923, -168.40354850143194, -186.39948707818985, -201.69260896369815, -118.9702391140163, -120.20503965765238, -100.65529080852866, -370.8341258838773, -161.02757871896029, -230.25007871165872, -239.7766204327345, -186.34003483504057, -127.5021029561758, -372.2159638181329, -355.3914002403617, -128.82564152032137, -303.5891991108656, -203.5288593992591, -169.2866846099496, -166.90877344831824, -396.01304572820663, -175.1579150557518, -333.4419411048293, -469.1043039448559, -283.3038998544216, -344.4844895526767, -160.5848129093647, -283.4706876575947, -268.5691917017102, -193.63917779177427, -193.11942745000124, -310.67485089600086, -365.85650157928467, -204.5393059104681, -311.76247604191303, -156.72725731506944, -330.53070572018623, -301.2156506385654, -198.4963135495782, -140.03487070277333, -141.0118724256754, -180.0234270989895, -141.554516851902, -256.4163681715727, -312.02332977950573, -317.0666382983327, -206.69399133324623, -423.688022531569, -334.5479575023055, -260.87549612671137, -199.1715800240636, -308.08454413712025, -170.62818348407745, -181.08490198478103, -219.4143476113677, -181.03472907096148, -173.1306445673108, -197.4932762235403, -393.8800109922886, -263.9677305370569, -184.56110670790076, -345.15565875917673, -149.0342150516808, -327.7032236084342, -169.42284742742777, -171.5103821195662, -234.44987969100475, -195.71997044980526, -167.84684936888516, -182.97877322882414, -321.4605070054531, -183.073681935668, -159.15422208607197, -260.065402045846, -203.36362742632627, -215.12839610129595, -195.15834665112197, -236.04093847423792, -321.00053337961435, -211.56471899151802, -231.31197317689657, -255.691226541996, -246.14220092445612, -252.86643604189157, -275.87787920981646, -146.99639473855495, -201.27082405239344, -206.27203324064612, -231.65819694846869, -209.26120015978813, -137.86772543936968, -290.08643896877766, -358.26969192922115, -192.07880854606628, -360.1175147816539, -240.55295097455382, -329.0267303902656, -316.3203985095024, -354.7237076945603, -203.99743586406112, -201.7683803215623, -397.70740348659456, -371.3483673706651, -446.54249292612076, -281.967311412096, -161.07648941129446, -139.50418632477522, -192.3310338035226, -365.8359677568078, -472.1683968529105, -343.42316630482674, -209.0181838274002, -344.0211279541254, -176.8916824273765, -240.69959308207035, -186.00050680339336, -340.31039130687714, -137.92944067716599, -257.3593579903245, -138.88887042552233, -305.7216569632292, -195.21070638298988, -161.47014735639095, -159.44879984855652, -420.7256896495819, -188.0444039851427, -173.39972331374884, -152.72869673743844, -224.6035378947854, -433.0469772666693, -276.9180042296648, -386.454335488379, -334.45726357772946, -286.0029167458415, -325.61133483983576, -314.9040730372071, -353.8788284249604, -201.2909231595695, -356.02219815552235, -237.60076319426298, -167.0323998220265, -186.9341170489788, -245.24643092229962, -165.4707363024354, -515.8073278665543, -187.84302881360054, -218.3342141136527, -244.863730289042, -296.28746447712183, -347.20262175798416, -304.6985117048025, -160.3087104782462, -236.71037498489022, -212.88585494458675, -417.93542570248246, -208.74034660309553, -159.9380550161004, -194.82785612344742, -314.1515759974718, -153.5343875400722, -223.94602348282933, -199.2991014868021, -450.0539089292288, -149.3655856102705, -242.7100698798895, -220.54901457577944, -173.27055424451828, -310.92938474938273, -209.5236282031983, -327.7159353494644, -194.43883419781923, -208.92468356713653, -164.50513992086053, -274.69179030507803, -207.61938228458166, -182.91283253580332, -167.12950931489468, -202.4742419552058, -206.94021205604076, -185.97024991735816, -190.26568258553743, -287.99887093156576, -307.05229587852955, -328.86313377320766, -211.07690651714802, -190.85935200750828, -195.10530008748174, -280.9187413714826, -203.73498658835888, -326.26364829950035, -193.21944661438465, -593.1617650203407, -237.3022441342473, -402.7678364813328, -190.7453369796276, -243.80712655186653, -338.5345237851143, -359.64245031401515, -254.57436399161816, -193.75145198591053, -170.29250488057733, -455.79465702176094, -192.18673126772046, -465.18705812096596, -244.99741923063993, -420.4667171537876, -248.9007127135992, -164.04211010038853, -461.3472307641059, -357.6538028419018, -185.5455278158188, -135.8660002052784, -283.1319695264101, -236.36745066940784, -337.84973315894604, -109.4358773007989, -353.655738344416, -467.28707425296307, -389.2095966078341, -190.45733572915196, -162.83206144720316, -206.78555079177022, -433.4951630830765, -377.15677750110626, -201.69147277623415, -279.1514529325068, -466.1045510619879, -180.3808460459113, -123.33005329966545, -197.42998684197664, -132.99459702521563, -297.3328147344291, -369.2144512720406, -297.2464694529772, -171.90742695331573, -173.54383145086467, -202.69973044097424, -147.1692646741867, -296.14839340001345, -363.65029506385326, -156.58974207937717, -144.86703868955374, -213.49382992088795, -478.16126069426537, -154.46919467300177, -277.793442748487, -204.42122583836317, -351.709951877594, -131.23875849694014, -414.09581042826176, -259.4792912751436, -208.10259506851435, -326.6681896150112, -314.1318538673222, -235.79568518698215, -332.1145772598684, -397.6720239818096, -187.93574534915388, -275.24216540157795, -433.43627720326185, -127.2237156406045, -297.22430708259344, -367.37047043070197, -368.38946998119354, -196.19764237850904, -228.78679485991597, -289.5878373682499, -171.4304679259658, -220.06035140156746, -246.20152872800827, -366.2195947431028, -309.1651832610369, -237.08903447538614, -237.1711544021964, -274.43447641283274, -185.64046716690063, -214.04737150669098, -182.03004260361195, -185.54860098659992, -167.88490898162127, -191.5182228386402, -234.76401944458485, -321.31125853955746, -322.5532866567373, -270.9844939317554, -350.58754020929337, -240.42941530793905, -367.2366831228137, -229.04299059323967, -253.57181200385094, -333.7175587899983, -283.7305245026946, -149.0569480806589, -444.837418474257, -159.81009232997894, -373.27475195378065, -152.57147283107042, -401.3617566972971, -228.59037078917027, -282.0730554461479, -518.2100458815694, -211.5130255818367, -555.47304302454, -188.67194506153464, -319.42312029749155, -137.21731761097908, -239.6784127652645, -213.8552097082138, -248.02021424472332, -400.65786281228065, -156.64146619290113, -381.2450820803642, -447.21408572793007, -220.17460878938437, -336.8090267535299, -149.47416532039642, -138.38826698064804, -268.49062491580844, -186.90191895514727, -182.93597266077995, -160.11038175970316, -191.4114332124591, -324.16866982728243, -349.1772548556328, -224.66443973779678, -212.99742348119617, -252.47786188870668, -179.11705380678177, -160.68015249818563, -196.72457039356232, -180.68472522497177, -265.917827822268, -153.0991359502077, -169.3270607292652, -225.83441358432174, -274.59876750409603, -244.50576829910278, -149.2150590158999, -149.27717309445143, -300.41523157060146, -166.00177351757884, -153.42954865656793, -357.44650918245316, -370.91108002513647, -174.81834429502487, -217.08333835750818, -397.6816371381283, -291.39955450594425, -131.24620877951384, -234.79877265542746, -325.6740732640028, -137.03614634275436, -397.81963953375816, -279.12745790183544, -159.31454749032855, -429.6276260353625, -236.66484193131328, -193.23243875801563, -245.9373338073492, -264.2603936102241, -208.95148572325706, -329.30447160452604, -351.19784016162157, -149.14326164871454, -192.5077745616436, -364.377902969718, -286.9256382472813, -260.6425430774689, -185.97837829589844, -219.87601532787085, -374.9384760670364, -239.31704274564981, -152.86608591675758, -297.5002031028271, -165.91405841708183, -196.40842708945274, -182.52855988964438, -221.50622572749853, -405.02235439419746, -341.34421956539154, -228.37504707463086, -325.02691053785384, -179.64292530715466, -178.81896745413542, -289.98051619529724, -282.1808864027262, -265.53661148250103, -166.07958929240704, -184.19507431983948, -172.2523543909192, -312.4245169349015, -403.9343476742506, -167.74544743448496, -168.49835953861475, -184.32096686959267, -153.07891775667667, -416.3410800136626, -483.4227798730135, -400.8932621330023, -319.76652187108994, -203.6921151727438, -156.87341390550137, -231.16789693571627, -175.16410482861102, -161.65716136991978, -141.20742200873792, -179.288468003273, -408.8344291970134, -172.14145127683878, -221.0309406146407, -212.23488356173038, -381.49583135545254, -295.2197101563215, -355.5306386258453, -330.36560716480017, -149.27852384746075, -190.32598293945193, -353.05838756263256, -215.04627925157547, -169.9792377576232, -355.8518958464265, -164.45082147419453, -176.9880845323205, -128.9947392679751, -260.3332666605711, -203.68735406547785, -411.2583382874727, -161.17661095410585, -187.6196274906397, -135.66556452959776, -370.24366209656, -183.37536016851664, -155.58322063833475, -397.181123226881, -149.09584810584784, -230.4947474449873, -147.08043634705245, -166.90481160208583, -159.8418690264225, -465.887174397707, -226.12367818504572, -163.38023030012846, -149.19459813460708, -313.9226987026632, -153.67712227255106, -220.45846125483513, -163.2261360064149, -196.32409550249577, -137.36870634555817, -153.95263769477606, -126.43690084666014, -192.3413411974907], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411603185577546, "mean_inference_ms": 4.535555662831142, "mean_action_processing_ms": 4.205957375331436, "mean_env_wait_ms": 3.2273908479477416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5372640, "timesteps_this_iter": 131040, "agent_timesteps_total": 5372640, "timers": {"sample_time_ms": 29679.244, "sample_throughput": 4415.207, "load_time_ms": 22.448, "load_throughput": 5837425.136, "learn_time_ms": 14919.953, "learn_throughput": 8782.869, "update_time_ms": 2.283}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.818989403545856e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 219.94054004793566, "policy_loss": 0.0014534582471603795, "vf_loss": 43.98633526217553, "vf_explained_var": 0.22097216370285197, "kl": 0.0018833712478565539, "entropy": -0.32009233432858647, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5372640, "num_agent_steps_sampled": 5372640, "num_steps_trained": 5372640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5372640}, "done": false, "episodes_total": 11040, "training_iteration": 41, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-02-44", "timestamp": 1691020964, "time_this_iter_s": 39.499990463256836, "time_total_s": 1288.3943099975586, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1288.3943099975586, "timesteps_since_restore": 5372640, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 44.57678571428572, "ram_util_percent": 50.871428571428574}}
{"episode_reward_max": -126.43690084666014, "episode_reward_min": -483.4227798730135, "episode_reward_mean": -241.2646397430077, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-397.81963953375816, -279.12745790183544, -159.31454749032855, -429.6276260353625, -236.66484193131328, -193.23243875801563, -245.9373338073492, -264.2603936102241, -208.95148572325706, -329.30447160452604, -351.19784016162157, -149.14326164871454, -192.5077745616436, -364.377902969718, -286.9256382472813, -260.6425430774689, -185.97837829589844, -219.87601532787085, -374.9384760670364, -239.31704274564981, -152.86608591675758, -297.5002031028271, -165.91405841708183, -196.40842708945274, -182.52855988964438, -221.50622572749853, -405.02235439419746, -341.34421956539154, -228.37504707463086, -325.02691053785384, -179.64292530715466, -178.81896745413542, -289.98051619529724, -282.1808864027262, -265.53661148250103, -166.07958929240704, -184.19507431983948, -172.2523543909192, -312.4245169349015, -403.9343476742506, -167.74544743448496, -168.49835953861475, -184.32096686959267, -153.07891775667667, -416.3410800136626, -483.4227798730135, -400.8932621330023, -319.76652187108994, -203.6921151727438, -156.87341390550137, -231.16789693571627, -175.16410482861102, -161.65716136991978, -141.20742200873792, -179.288468003273, -408.8344291970134, -172.14145127683878, -221.0309406146407, -212.23488356173038, -381.49583135545254, -295.2197101563215, -355.5306386258453, -330.36560716480017, -149.27852384746075, -190.32598293945193, -353.05838756263256, -215.04627925157547, -169.9792377576232, -355.8518958464265, -164.45082147419453, -176.9880845323205, -128.9947392679751, -260.3332666605711, -203.68735406547785, -411.2583382874727, -161.17661095410585, -187.6196274906397, -135.66556452959776, -370.24366209656, -183.37536016851664, -155.58322063833475, -397.181123226881, -149.09584810584784, -230.4947474449873, -147.08043634705245, -166.90481160208583, -159.8418690264225, -465.887174397707, -226.12367818504572, -163.38023030012846, -149.19459813460708, -313.9226987026632, -153.67712227255106, -220.45846125483513, -163.2261360064149, -196.32409550249577, -137.36870634555817, -153.95263769477606, -126.43690084666014, -192.3413411974907], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.397910846083063, "mean_inference_ms": 4.524486466971466, "mean_action_processing_ms": 4.154255275750878, "mean_env_wait_ms": 3.20090503695356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5503680, "timesteps_this_iter": 131040, "agent_timesteps_total": 5503680, "timers": {"sample_time_ms": 29683.654, "sample_throughput": 4414.551, "load_time_ms": 22.448, "load_throughput": 5837586.335, "learn_time_ms": 14922.703, "learn_throughput": 8781.251, "update_time_ms": 2.316}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.09494701772928e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 223.94242700621768, "policy_loss": -0.0010969412487717093, "vf_loss": 44.789259380764435, "vf_explained_var": 0.3182712159917346, "kl": 0.0017041466217638263, "entropy": -0.3236841309989225, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5503680, "num_agent_steps_sampled": 5503680, "num_steps_trained": 5503680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5503680}, "done": false, "episodes_total": 11040, "training_iteration": 42, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-03-00", "timestamp": 1691020980, "time_this_iter_s": 15.274394273757935, "time_total_s": 1303.6687042713165, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1303.6687042713165, "timesteps_since_restore": 5503680, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 13.795454545454545, "ram_util_percent": 51.58181818181818}}
{"episode_reward_max": -95.9954080954194, "episode_reward_min": -532.1686301827431, "episode_reward_mean": -223.3649972166478, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.80437894910574, -198.72436797618866, -383.2341732606292, -294.29895908385515, -255.03421253710985, -296.1360046155751, -119.3844690322876, -219.10758627206087, -294.75397392362356, -162.8083320260048, -127.605404086411, -318.4918980970979, -375.54899710416794, -236.23509331792593, -175.32728569209576, -378.51284179091454, -364.4023265093565, -217.42055454850197, -174.6254120040685, -188.40978477150202, -181.45449685305357, -280.30491087026894, -185.6202693581581, -274.643835907802, -182.70651097595692, -144.9020022675395, -175.96232445165515, -251.38173864036798, -387.73463209718466, -389.47562926262617, -193.38366825133562, -184.93562771379948, -323.7593435719609, -185.69445406645536, -170.49621517397463, -151.82416037470102, -151.40085161477327, -226.27645922638476, -197.61351121217012, -156.57216595858335, -159.05166170746088, -170.08833122998476, -149.9208866506815, -168.63243748247623, -106.84502638876438, -217.14250431209803, -295.2493033334613, -182.77483899891376, -185.1409296244383, -324.8437542617321, -239.976867005229, -354.8513765744865, -162.6375715136528, -148.998973865062, -212.09782043099403, -186.20804092288017, -272.2651903722435, -161.14029651880264, -174.9579634591937, -166.75716546177864, -171.80812736600637, -174.82778607308865, -472.43946474790573, -224.68160147033632, -475.7191659659147, -217.99781849980354, -184.46181992441416, -191.7125159483403, -187.09573717042804, -279.8481097891927, -112.46218517422676, -212.27856688946486, -152.78740150481462, -177.10007321834564, -133.02757222950459, -167.26809371821582, -192.77390753477812, -264.0626208744943, -352.1399884670973, -301.13033550977707, -520.3455457389355, -343.98693035542965, -151.30745951086283, -173.99192497879267, -188.92132135480642, -281.77166324853897, -386.2524420693517, -287.0121999755502, -158.34938486479223, -127.295154992491, -192.44537108018994, -257.4992077983916, -168.96993789076805, -204.47957686707377, -181.6645713634789, -286.72339391708374, -141.85408344492316, -184.96130920946598, -186.8235587105155, -155.76558987796307, -226.9388158544898, -177.4621221497655, -195.6739208251238, -532.1686301827431, -211.12629873678088, -208.42533142119646, -280.648263245821, -399.11335657536983, -178.33182685822248, -149.5658460482955, -167.56016036123037, -156.2904884442687, -151.61425286531448, -218.23595160990953, -375.12528152018785, -161.31845660693944, -162.9596616923809, -407.58058977127075, -159.46131156384945, -175.96397303789854, -195.1052238419652, -192.02568919956684, -446.68883126974106, -307.88395960628986, -242.05844169855118, -167.00751189514995, -149.38844759762287, -123.47235801070929, -254.0354437455535, -297.4389289841056, -169.1352634727955, -159.31184162199497, -120.24570543318987, -175.7507252842188, -181.88972805440426, -280.8719533011317, -134.26733155548573, -103.70664972811937, -117.51865444332361, -187.04190269112587, -96.3593323007226, -191.38556699454784, -127.69934724271297, -336.6295779682696, -342.4900118857622, -179.78658175468445, -221.86572948098183, -148.81680693477392, -284.69310685247183, -278.8286688514054, -134.572828322649, -169.82318424247205, -174.59462160617113, -145.21502208709717, -263.57679465413094, -212.87209993600845, -180.22284583747387, -397.1855939440429, -180.35605278238654, -184.57694805413485, -132.63448398187757, -268.7153755798936, -174.73651100695133, -368.6810614466667, -158.07659362256527, -149.22044786810875, -315.87903552502394, -150.88854601234198, -197.88738474994898, -187.06037174537778, -185.78224501386285, -181.3088800534606, -309.9522845596075, -134.07237109541893, -177.1269939020276, -152.82593106850982, -151.0463707856834, -260.8982972986996, -413.93459932133555, -166.7132935076952, -323.2091092765331, -381.2123716622591, -228.11937134712934, -184.85472936928272, -293.17968562990427, -177.00688187032938, -111.58381614089012, -285.0072904601693, -237.66383639723063, -130.4516778588295, -273.44772339239717, -176.59497103095055, -175.62096225470304, -198.13454050943255, -163.7116557508707, -475.0642583966255, -282.65036553144455, -266.2755230218172, -249.86288226395845, -161.8222883027047, -275.6696671471, -182.28879695385695, -246.20468918979168, -248.80841144919395, -211.9465086236596, -167.37337423861027, -241.7868513967842, -360.5373855084181, -157.64060103148222, -220.68853503838181, -163.8477982506156, -195.31455685943365, -227.38934610038996, -193.40431783348322, -497.42637810856104, -114.01238618046045, -200.6741241812706, -467.9748889505863, -170.7473990470171, -367.9215949848294, -268.6142996959388, -189.73597368597984, -336.68237106502056, -294.09910418093204, -193.82828952744603, -184.83235488831997, -163.4481837823987, -169.00288730859756, -151.66985989175737, -298.0686856843531, -190.64187230169773, -176.2900639437139, -147.224694237113, -189.74926345050335, -154.57132342085242, -171.66830108314753, -182.72780772298574, -179.25128500536084, -219.16271827369928, -269.39889519661665, -144.7279190570116, -235.1695444099605, -167.67194493114948, -137.40731195360422, -160.39904022216797, -222.3869016095996, -127.73439675569534, -154.06154380738735, -167.70610886067152, -125.03155463933945, -147.87668734043837, -184.38569407910109, -363.320969812572, -191.02852794528008, -126.54821690917015, -188.8568786997348, -121.93335497379303, -184.06002878397703, -171.0440145097673, -208.18140912801027, -199.45978520065546, -189.76718394458294, -383.90180549770594, -153.43204023316503, -378.1124101039022, -184.39202025532722, -238.4308279529214, -282.61908046901226, -240.34588487446308, -244.20674572139978, -166.8863342627883, -173.7977885454893, -399.95938782021403, -313.775449231267, -119.65706089884043, -128.45037088170648, -235.35877069085836, -147.7008591890335, -302.2098569944501, -127.98350976407528, -194.18971367925406, -201.8354315981269, -129.22022677212954, -151.32775845378637, -198.6555491425097, -148.86477436125278, -156.10187090933323, -276.4750208556652, -317.69901907630265, -382.59277195483446, -299.41300439089537, -415.27424693107605, -206.82361821830273, -150.08034194633365, -331.3901811391115, -306.3377513438463, -322.6771381627768, -391.1044143624604, -136.64867531135678, -379.2973043471575, -182.617711417377, -245.8563499674201, -167.00947088748217, -360.66384357213974, -167.21130130439997, -199.0557422861457, -141.14049128443003, -128.56981163471937, -222.26331263780594, -213.80235872976482, -160.48588614165783, -351.41852094233036, -178.70420414209366, -175.55597036331892, -164.11804477125406, -160.98639900237322, -316.11005982756615, -231.66763618215919, -312.6040537804365, -230.10848465561867, -159.0638158172369, -179.3173222616315, -136.20218098163605, -206.20972797647119, -261.9331310503185, -125.72009797394276, -398.0798855870962, -219.32796732708812, -161.61224905401468, -300.17177072167397, -266.4161171987653, -218.98748445510864, -153.88191356509924, -161.00248305127025, -293.13591830432415, -363.0586483180523, -249.69765770435333, -296.4399580731988, -326.1382647305727, -285.39022022672, -258.66612835228443, -148.28208806365728, -354.70125494897366, -220.402862098068, -161.1705346032977, -186.9500738531351, -261.95313239097595, -183.19059581309557, -218.44693986326456, -190.5259249135852, -334.34774251282215, -148.1068650558591, -263.26620507240295, -147.62092750146985, -117.98550748080015, -164.7438838928938, -191.9399487823248, -257.5486602038145, -345.13255720958114, -198.28405003249645, -132.24736116826534, -171.1367245092988, -281.7255732193589, -218.41553470864892, -156.04941623285413, -170.53790621459484, -156.8627755716443, -389.25863618403673, -271.91895920038223, -238.84738698601723, -141.03972359001637, -216.98265819251537, -182.6669081747532, -172.25209882110357, -273.91165355592966, -143.4332680478692, -273.3518969267607, -179.84346893429756, -166.72102849930525, -150.26295666396618, -129.5748259946704, -186.3381847627461, -386.94025557488203, -231.5348521247506, -222.2203543819487, -390.45513351261616, -316.649879174307, -251.44714312255383, -419.30080196633935, -484.57256519794464, -386.2685366291553, -407.0963171347976, -214.0874228477478, -183.47546231746674, -160.5420290902257, -185.05876022204757, -132.74180081486702, -236.54575546830893, -162.40792778879404, -158.0983154028654, -218.54601288586855, -203.11924401670694, -444.9690523520112, -360.77288180589676, -187.63265544176102, -155.86481573432684, -291.72297291085124, -159.1873359978199, -201.02384204417467, -283.4908433482051, -216.04862304776907, -146.13940515369177, -221.55232657119632, -169.3948044925928, -167.2486800402403, -144.45115008205175, -217.79685048758984, -308.1967620700598, -285.8327361084521, -186.63884723745286, -150.46577870100737, -144.75517720729113, -291.8315469995141, -327.0822597257793, -162.85629738122225, -185.17467632889748, -137.18561021983624, -161.53101465851068, -206.32451182603836, -281.2559881359339, -234.40584445744753, -131.1252337768674, -347.6618527919054, -221.80470378696918, -144.48056199401617, -181.13079981133342, -303.42069495655596, -183.61956695467234, -166.16371968388557, -360.03237123042345, -355.51458828151226, -181.20077249221504, -478.36557871848345, -194.9130038022995, -292.18927247822285, -180.10676814615726, -224.01641099900007, -152.17316469550133, -205.17533300071955, -201.4462571889162, -162.47989802062511, -99.9005471393466, -201.50011315196753, -313.79560562595725, -306.51588099449873, -346.96755880489945, -301.57003712654114, -125.21127367019653, -138.57232031226158, -210.58317185379565, -95.9954080954194, -184.47973949462175, -259.9866013377905, -186.09557402133942, -365.7837760299444, -263.7948825582862, -204.94412772357464, -131.89461153373122, -146.19110491871834, -124.13891632854939, -146.7681092619896, -219.9437974318862, -307.60819555819035, -123.00119949877262, -312.1949855238199, -155.6748385708779, -148.19248494505882, -245.69493508338928, -288.9125987030566, -96.12048555165529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411694852930055, "mean_inference_ms": 4.536589002652481, "mean_action_processing_ms": 4.206315363073397, "mean_env_wait_ms": 3.2273492977902833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5634720, "timesteps_this_iter": 131040, "agent_timesteps_total": 5634720, "timers": {"sample_time_ms": 29703.268, "sample_throughput": 4411.636, "load_time_ms": 22.742, "load_throughput": 5762011.804, "learn_time_ms": 14922.217, "learn_throughput": 8781.537, "update_time_ms": 2.325}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.54747350886464e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 216.6801776608121, "policy_loss": 0.009126280423296178, "vf_loss": 43.326584997142945, "vf_explained_var": 0.33283838971541346, "kl": 0.0017004888693645896, "entropy": -0.3251002935098491, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5634720, "num_agent_steps_sampled": 5634720, "num_steps_trained": 5634720, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5634720}, "done": false, "episodes_total": 11520, "training_iteration": 43, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-03-39", "timestamp": 1691021019, "time_this_iter_s": 39.38092875480652, "time_total_s": 1343.049633026123, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1343.049633026123, "timesteps_since_restore": 5634720, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 44.26428571428572, "ram_util_percent": 51.53750000000001}}
{"episode_reward_max": -95.9954080954194, "episode_reward_min": -484.57256519794464, "episode_reward_mean": -228.16908304659648, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.5748259946704, -186.3381847627461, -386.94025557488203, -231.5348521247506, -222.2203543819487, -390.45513351261616, -316.649879174307, -251.44714312255383, -419.30080196633935, -484.57256519794464, -386.2685366291553, -407.0963171347976, -214.0874228477478, -183.47546231746674, -160.5420290902257, -185.05876022204757, -132.74180081486702, -236.54575546830893, -162.40792778879404, -158.0983154028654, -218.54601288586855, -203.11924401670694, -444.9690523520112, -360.77288180589676, -187.63265544176102, -155.86481573432684, -291.72297291085124, -159.1873359978199, -201.02384204417467, -283.4908433482051, -216.04862304776907, -146.13940515369177, -221.55232657119632, -169.3948044925928, -167.2486800402403, -144.45115008205175, -217.79685048758984, -308.1967620700598, -285.8327361084521, -186.63884723745286, -150.46577870100737, -144.75517720729113, -291.8315469995141, -327.0822597257793, -162.85629738122225, -185.17467632889748, -137.18561021983624, -161.53101465851068, -206.32451182603836, -281.2559881359339, -234.40584445744753, -131.1252337768674, -347.6618527919054, -221.80470378696918, -144.48056199401617, -181.13079981133342, -303.42069495655596, -183.61956695467234, -166.16371968388557, -360.03237123042345, -355.51458828151226, -181.20077249221504, -478.36557871848345, -194.9130038022995, -292.18927247822285, -180.10676814615726, -224.01641099900007, -152.17316469550133, -205.17533300071955, -201.4462571889162, -162.47989802062511, -99.9005471393466, -201.50011315196753, -313.79560562595725, -306.51588099449873, -346.96755880489945, -301.57003712654114, -125.21127367019653, -138.57232031226158, -210.58317185379565, -95.9954080954194, -184.47973949462175, -259.9866013377905, -186.09557402133942, -365.7837760299444, -263.7948825582862, -204.94412772357464, -131.89461153373122, -146.19110491871834, -124.13891632854939, -146.7681092619896, -219.9437974318862, -307.60819555819035, -123.00119949877262, -312.1949855238199, -155.6748385708779, -148.19248494505882, -245.69493508338928, -288.9125987030566, -96.12048555165529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.397670757848807, "mean_inference_ms": 4.525539592538462, "mean_action_processing_ms": 4.154758366388048, "mean_env_wait_ms": 3.200417815163608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5765760, "timesteps_this_iter": 131040, "agent_timesteps_total": 5765760, "timers": {"sample_time_ms": 27284.121, "sample_throughput": 4802.794, "load_time_ms": 21.121, "load_throughput": 6204279.341, "learn_time_ms": 14928.461, "learn_throughput": 8777.864, "update_time_ms": 2.311}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.27373675443232e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 214.51740425590927, "policy_loss": 0.005765324487428057, "vf_loss": 42.89738267467868, "vf_explained_var": 0.33935439041865767, "kl": 0.001662659548213839, "entropy": -0.3336481751079628, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5765760, "num_agent_steps_sampled": 5765760, "num_steps_trained": 5765760, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5765760}, "done": false, "episodes_total": 11520, "training_iteration": 44, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-03-54", "timestamp": 1691021034, "time_this_iter_s": 15.282313585281372, "time_total_s": 1358.3319466114044, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1358.3319466114044, "timesteps_since_restore": 5765760, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 13.818181818181815, "ram_util_percent": 51.595454545454544}}
{"evaluation": {"episode_reward_max": -3000.2470326274633, "episode_reward_min": -3000.2470326274633, "episode_reward_mean": -3000.2470326274633, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.2470326274633], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047040691870653, "mean_inference_ms": 3.8137821380249752, "mean_action_processing_ms": 1.2267854161367207, "mean_env_wait_ms": 196.9232316502554, "mean_env_render_ms": 2.982194790107285}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -83.82386701926589, "episode_reward_min": -568.0567318275571, "episode_reward_mean": -205.46660763590674, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.11587541550398, -177.73559982143342, -170.01022934354842, -197.27125158533454, -312.5622879303992, -307.2335143983364, -135.07258210331202, -160.33386284857988, -235.85737050324678, -134.2988534644246, -235.78109131008387, -142.67168807983398, -175.63651105761528, -197.6727862805128, -311.33084140717983, -187.96752579510212, -145.64969301223755, -365.42057033628225, -144.08928425610065, -188.3292879909277, -231.0117685776204, -302.69864359870553, -212.14194396696985, -162.51668363064528, -133.06434539705515, -204.83634214103222, -138.73464420810342, -283.3675016462803, -134.92373936623335, -313.47138433903456, -307.27705904841423, -170.53150198236108, -167.38600150495768, -92.37564103491604, -172.9681220576167, -176.03056171536446, -151.0781099423766, -135.69824163615704, -185.08524094894528, -290.77342499420047, -184.50232437252998, -124.32090827822685, -183.187876842916, -370.9986111521721, -343.5369851887226, -169.84451704472303, -164.66487393528223, -283.993894867599, -135.67359945178032, -153.03047592192888, -182.0766438022256, -149.95331424102187, -338.0674497708678, -148.35357899591327, -337.94927802681923, -188.73799688369036, -568.0567318275571, -157.63182467967272, -381.49881978332996, -176.13686803355813, -152.89568043500185, -105.56429143995047, -180.12695330008864, -264.8013634085655, -148.86650198325515, -282.582960318774, -270.21314138919115, -360.0557594746351, -175.84000413119793, -160.29210218787193, -154.61177350580692, -181.0777639374137, -136.34867879003286, -299.90186696499586, -153.34823542833328, -339.85330097936094, -91.34111580252647, -160.29540513455868, -105.38222467526793, -163.14681135118008, -222.93850821256638, -359.22573109716177, -297.5819887816906, -141.1882967427373, -285.54751732200384, -165.420421756804, -209.28187926858664, -164.5361973270774, -246.30601306259632, -139.34248340129852, -139.71124875172973, -124.46861760318279, -287.18923165649176, -226.01268093287945, -159.98362851142883, -271.3475641980767, -348.4539896398783, -372.0866856202483, -165.35323218256235, -143.16933167725801, -138.295725915581, -150.73881663382053, -182.80030039697886, -158.62548218667507, -204.74433348327875, -321.87795113027096, -172.94925289973617, -229.46360245347023, -172.8224389180541, -160.96622294187546, -283.5022710710764, -249.7489760145545, -187.35509764403105, -149.2390103265643, -380.4222410917282, -179.3550035506487, -219.975857116282, -326.9692651182413, -390.2618937417865, -221.44568757526577, -167.85806422680616, -139.1018787920475, -136.6908370628953, -142.2230161242187, -263.18290282040834, -268.192351564765, -157.68521934002638, -155.96103091165423, -131.10851380228996, -129.4070338383317, -117.17824756912887, -161.07905595004559, -148.72868955880404, -222.6070664525032, -160.1431118864566, -194.71629956364632, -158.14147748053074, -318.6271238476038, -119.97824027016759, -244.71053528785706, -159.0915568843484, -143.7426906786859, -155.53737822920084, -363.8086320757866, -261.7395543679595, -163.90550677478313, -320.2168784290552, -347.97720947116613, -115.48367745801806, -133.92304062843323, -189.3790162280202, -185.53697115182877, -253.18165768310428, -128.680065728724, -258.75564393401146, -321.2537483442575, -138.1064114421606, -180.73748595267534, -104.06853116396815, -125.36659850925207, -135.0638122037053, -186.5887482240796, -195.25828540325165, -138.03593020513654, -173.5971581786871, -190.70738393068314, -257.7167504951358, -363.2718133032322, -236.84560538828373, -132.6944935284555, -375.9978091418743, -204.66031538322568, -101.29098068550229, -154.37802486866713, -97.54888141155243, -314.7726309299469, -229.53974732756615, -128.3474285453558, -173.57088516652584, -352.9792685545981, -238.28536421060562, -159.22625758871436, -198.850655015558, -311.7994484230876, -270.5278799459338, -177.58642312139273, -127.23921851068735, -392.91304598748684, -120.31801009178162, -170.7113302499056, -140.01098841428757, -352.1381130144, -181.30046958476305, -248.78106700628996, -179.08227770775557, -330.8278463706374, -212.68296167254448, -250.56341411918402, -480.7605535015464, -212.16650337725878, -185.9233908429742, -347.28033355250955, -129.6969686113298, -195.16268496960402, -296.21275831758976, -197.05558056384325, -180.87823145091534, -189.69516626000404, -226.38766595721245, -252.69506567716599, -233.10399353131652, -360.5031807720661, -158.24938161671162, -205.751769579947, -177.60431603342295, -152.07031133025885, -225.92378973588347, -320.7669051364064, -232.21584413200617, -171.05106426402926, -160.58160303533077, -188.0698861964047, -149.99085138738155, -169.1791353970766, -167.72318190336227, -315.9301599562168, -155.22041960805655, -162.99647571891546, -184.29266277700663, -121.45390901342034, -136.32937435805798, -198.6200370118022, -108.42963204160333, -149.18053328990936, -129.93661031872034, -107.21445760503411, -368.6814393699169, -264.94112607091665, -144.31633896753192, -277.7751159761101, -146.77918671816587, -277.9082312732935, -93.84228666126728, -205.91123482584953, -163.1810197494924, -115.01560082286596, -128.24649558216333, -358.6605497673154, -153.34696726500988, -174.2953947149217, -215.1841492280364, -151.6724356263876, -113.87514465674758, -212.55976682901382, -126.70137530565262, -357.8828247413039, -107.80548398569226, -125.70635545253754, -248.23165667057037, -142.02116579562426, -155.0600934624672, -317.39118057489395, -174.19489491730928, -134.23097287863493, -153.2006440013647, -294.6577648073435, -147.78463008999825, -157.45256461575627, -321.692039296031, -260.40473406761885, -330.227684430778, -360.52021120488644, -156.71854454278946, -194.6253093406558, -181.29862201958895, -232.78947842493653, -302.1282502487302, -123.97320444136858, -147.71603091061115, -360.4331937022507, -147.064976349473, -143.14960761368275, -203.4566319435835, -334.69101969897747, -130.9973700735718, -131.07512033730745, -114.52270521223545, -310.4981023222208, -174.42134146392345, -345.0966184735298, -182.65941981226206, -170.5583741441369, -207.4967992901802, -286.1461169719696, -239.30616146326065, -350.76806020736694, -162.49968346953392, -190.00615559518337, -304.5540313720703, -152.11602595075965, -196.74840960651636, -188.2126815021038, -340.9436696469784, -157.59641372784972, -192.669143371284, -148.61961670964956, -138.8579374179244, -247.11537371575832, -182.1482794135809, -275.682870849967, -348.9374734610319, -189.64209812134504, -162.75703793019056, -292.3003188893199, -172.99723555147648, -184.42807751893997, -277.8194242231548, -176.38938185572624, -311.75043651741, -299.35159151256084, -131.31231442838907, -115.79224418848753, -180.56817004829645, -142.03661327064037, -175.007503695786, -123.07959898561239, -150.8777729049325, -133.94854706525803, -136.98244454339147, -291.84999400004745, -169.45574220642447, -156.1138034015894, -147.81886348873377, -141.00741159170866, -188.05619755014777, -170.1305983439088, -141.96353343501687, -152.2869547754526, -188.0020395964384, -239.55188212171197, -196.82887395843863, -184.77470672130585, -188.56323114782572, -318.90332794189453, -108.39694038033485, -178.42212793976068, -127.33640283346176, -364.65848676115274, -221.2595617696643, -311.6153137125075, -345.8082331120968, -110.86674359440804, -271.6427603587508, -150.11311804503202, -242.15529360249639, -177.84429140016437, -135.98741555213928, -310.2491169497371, -362.1514695137739, -152.45336443558335, -194.4574544019997, -162.6178360953927, -156.8566106930375, -218.5410155430436, -166.0014010667801, -139.94140046834946, -152.39672914147377, -264.65005378983915, -136.86727789789438, -128.21045914664865, -147.9903403762728, -109.71044578403234, -318.6597121208906, -154.33105895668268, -148.01969453692436, -323.90258705616, -179.09798968583345, -367.51251344010234, -168.8935252726078, -150.8950308188796, -135.6100222095847, -167.6362108439207, -133.61293187737465, -154.27397363632917, -117.31121727079153, -186.03386647999287, -178.85213204473257, -126.27890014648438, -167.9012156277895, -171.68194745481014, -174.3371870070696, -215.14511809498072, -186.30191419646144, -214.0012204311788, -155.40559427440166, -324.91411765292287, -205.45599542558193, -260.3808561190963, -206.46893878281116, -126.4892778545618, -195.53737208247185, -173.61987480521202, -265.8391940332949, -219.8905087634921, -362.0965868830681, -161.58498961851, -182.98311206698418, -254.9325712583959, -146.16891112923622, -164.469165366143, -355.3014137670398, -210.96948663890362, -120.5997027233243, -125.46598067507148, -215.089408531785, -178.6806519329548, -336.7804128602147, -323.4001515433192, -181.2800371646881, -119.1471173837781, -230.62845278158784, -134.29846718162298, -148.59162528067827, -191.72100055590272, -402.3022730220109, -141.64974605292082, -242.1462769433856, -317.38148072361946, -157.8448232524097, -139.86995878070593, -352.2656086906791, -297.85628771036863, -370.12480625510216, -286.8902650177479, -117.29764787852764, -139.49275804124773, -119.01322021707892, -272.5792089253664, -249.88664634525776, -142.62149350345135, -202.8597754612565, -346.51110569015145, -123.11201704666018, -299.2319525927305, -183.20767375081778, -115.30034278333187, -138.01241562515497, -135.54922759532928, -152.95131512731314, -355.18296763673425, -253.61254811286926, -161.90901919454336, -143.23153291642666, -196.6340320110321, -158.4039992019534, -276.02324770763516, -323.4708363711834, -139.58498552069068, -174.33584915101528, -296.86149467527866, -178.49222452938557, -139.58792528510094, -126.41603441908956, -166.4004027545452, -326.222711995244, -145.82329007983208, -271.65998742356896, -169.17925152927637, -181.1874721646309, -120.29533103853464, -160.42966375499964, -124.59306978993118, -116.0817161872983, -221.17670602351427, -133.07137970253825, -217.81604060530663, -180.17303604632616, -131.0948607288301, -83.82386701926589, -276.2428305596113], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410402995929114, "mean_inference_ms": 4.537266999979853, "mean_action_processing_ms": 4.206752390410206, "mean_env_wait_ms": 3.2281763760126645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 5896800, "timesteps_this_iter": 131040, "agent_timesteps_total": 5896800, "timers": {"sample_time_ms": 29714.38, "sample_throughput": 4409.986, "load_time_ms": 22.843, "load_throughput": 5736482.808, "learn_time_ms": 14932.496, "learn_throughput": 8775.492, "update_time_ms": 2.403}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.13686837721616e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 198.8985052607017, "policy_loss": -0.0017666951332011244, "vf_loss": 39.78113056169189, "vf_explained_var": 0.3616510821926978, "kl": 0.001880395593616413, "entropy": -0.33793395965970974, "entropy_coeff": 0.001}}}, "num_steps_sampled": 5896800, "num_agent_steps_sampled": 5896800, "num_steps_trained": 5896800, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 5896800}, "done": false, "episodes_total": 12000, "training_iteration": 45, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-04-34", "timestamp": 1691021074, "time_this_iter_s": 39.33237862586975, "time_total_s": 1397.6643252372742, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1397.6643252372742, "timesteps_since_restore": 5896800, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 44.18035714285714, "ram_util_percent": 51.52142857142858}}
{"episode_reward_max": -83.82386701926589, "episode_reward_min": -402.3022730220109, "episode_reward_mean": -200.02145473627374, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-135.6100222095847, -167.6362108439207, -133.61293187737465, -154.27397363632917, -117.31121727079153, -186.03386647999287, -178.85213204473257, -126.27890014648438, -167.9012156277895, -171.68194745481014, -174.3371870070696, -215.14511809498072, -186.30191419646144, -214.0012204311788, -155.40559427440166, -324.91411765292287, -205.45599542558193, -260.3808561190963, -206.46893878281116, -126.4892778545618, -195.53737208247185, -173.61987480521202, -265.8391940332949, -219.8905087634921, -362.0965868830681, -161.58498961851, -182.98311206698418, -254.9325712583959, -146.16891112923622, -164.469165366143, -355.3014137670398, -210.96948663890362, -120.5997027233243, -125.46598067507148, -215.089408531785, -178.6806519329548, -336.7804128602147, -323.4001515433192, -181.2800371646881, -119.1471173837781, -230.62845278158784, -134.29846718162298, -148.59162528067827, -191.72100055590272, -402.3022730220109, -141.64974605292082, -242.1462769433856, -317.38148072361946, -157.8448232524097, -139.86995878070593, -352.2656086906791, -297.85628771036863, -370.12480625510216, -286.8902650177479, -117.29764787852764, -139.49275804124773, -119.01322021707892, -272.5792089253664, -249.88664634525776, -142.62149350345135, -202.8597754612565, -346.51110569015145, -123.11201704666018, -299.2319525927305, -183.20767375081778, -115.30034278333187, -138.01241562515497, -135.54922759532928, -152.95131512731314, -355.18296763673425, -253.61254811286926, -161.90901919454336, -143.23153291642666, -196.6340320110321, -158.4039992019534, -276.02324770763516, -323.4708363711834, -139.58498552069068, -174.33584915101528, -296.86149467527866, -178.49222452938557, -139.58792528510094, -126.41603441908956, -166.4004027545452, -326.222711995244, -145.82329007983208, -271.65998742356896, -169.17925152927637, -181.1874721646309, -120.29533103853464, -160.42966375499964, -124.59306978993118, -116.0817161872983, -221.17670602351427, -133.07137970253825, -217.81604060530663, -180.17303604632616, -131.0948607288301, -83.82386701926589, -276.2428305596113], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.394533655283664, "mean_inference_ms": 4.524709430880693, "mean_action_processing_ms": 4.153524343835874, "mean_env_wait_ms": 3.1993990314521015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6027840, "timesteps_this_iter": 131040, "agent_timesteps_total": 6027840, "timers": {"sample_time_ms": 27318.532, "sample_throughput": 4796.744, "load_time_ms": 21.382, "load_throughput": 6128636.044, "learn_time_ms": 14920.145, "learn_throughput": 8782.757, "update_time_ms": 2.4}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.6843418860808e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 197.64015160552842, "policy_loss": -0.0022923228248433714, "vf_loss": 39.529978273589975, "vf_explained_var": 0.39358494187768645, "kl": 0.001820003179254137, "entropy": -0.3450379323574804, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6027840, "num_agent_steps_sampled": 6027840, "num_steps_trained": 6027840, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6027840}, "done": false, "episodes_total": 12000, "training_iteration": 46, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-04-49", "timestamp": 1691021089, "time_this_iter_s": 15.174972534179688, "time_total_s": 1412.8392977714539, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1412.8392977714539, "timesteps_since_restore": 6027840, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 13.77727272727273, "ram_util_percent": 51.27727272727271}}
{"episode_reward_max": -65.64450568705797, "episode_reward_min": -438.9484492149204, "episode_reward_mean": -175.9213864142997, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-385.1729101985693, -156.89881055802107, -173.7406477443874, -184.10501431673765, -116.86330633237958, -182.1826847344637, -185.47864266484976, -286.10419553518295, -128.61234906315804, -292.39097887277603, -189.55543909966946, -288.57634311914444, -308.30529806762934, -223.71697092056274, -165.03507474064827, -95.1098563671112, -312.70111705735326, -239.28304361552, -346.1008850187063, -297.8738607056439, -156.75274179130793, -164.51463121920824, -310.8983291387558, -211.57490019872785, -97.34832122921944, -147.7754276022315, -116.25434250384569, -438.9484492149204, -144.38743159919977, -182.65990389883518, -126.03504981845617, -269.72403775528073, -113.61929194629192, -206.869513861835, -144.71173153817654, -254.43517168611288, -289.7859501503408, -106.35988022014499, -125.71778794750571, -102.93135366588831, -87.70975418388844, -184.08142636716366, -130.51721123605967, -125.73069885373116, -144.5603369474411, -302.47328051924706, -133.22929373383522, -282.1108802109957, -118.4786376580596, -111.1974935978651, -130.8850726261735, -114.50329818204045, -208.04400473833084, -259.02627594769, -220.85301481187344, -153.26248978078365, -251.085338704288, -117.04079388827085, -123.71890702843666, -223.86087906360626, -227.59345140121877, -233.03507336229086, -86.9394786581397, -246.96052691340446, -90.10077827423811, -79.43747685849667, -139.31283077597618, -122.8644711598754, -99.89711731672287, -136.44317343086004, -231.36605328321457, -131.52618901059031, -122.11885596811771, -100.76241234689951, -106.45606815814972, -110.31592444330454, -275.07888754457235, -153.016472697258, -237.3841314613819, -224.07629963755608, -264.52932891994715, -154.07309345901012, -280.1749925427139, -126.41348292678595, -300.5172258093953, -179.62564224377275, -143.5381861552596, -117.34351706504822, -299.18412777781487, -106.76682754606009, -118.34551425278187, -101.73354091495275, -194.11950066685677, -295.8623334765434, -145.26642364263535, -104.42034922540188, -323.18834660947323, -211.95993683859706, -132.98158008605242, -276.0577775016427, -189.27783680707216, -280.9860919415951, -249.5804551243782, -115.88983479142189, -176.99258654378355, -106.62145724147558, -162.86373760551214, -190.4068519026041, -313.8187790121883, -85.39387300983071, -158.18312069028616, -205.4574896991253, -261.9119619652629, -366.91242572292686, -290.0987105369568, -141.1965506374836, -196.63556239008904, -127.42968079447746, -192.1418986134231, -165.68548242747784, -157.86491980403662, -146.51487958058715, -139.00708827376366, -112.84923085197806, -168.24427435919642, -346.6152447015047, -129.83212891966105, -282.83885907381773, -242.22797215729952, -146.54520048201084, -388.80958987772465, -178.28586069494486, -159.33586581796408, -144.31394693255424, -102.14509622752666, -287.76800023019314, -172.80160787701607, -188.42912567779422, -200.7769932821393, -110.19484423100948, -211.48126335442066, -131.8865920677781, -128.73446553200483, -137.75835107266903, -130.18088447116315, -237.25907336175442, -98.38892287015915, -303.54551100730896, -161.9549953006208, -147.34761231578887, -131.56594689190388, -119.09784559905529, -96.99281065911055, -148.21429384499788, -100.42238876968622, -181.45935034006834, -159.6666796952486, -199.69012993946671, -148.91852078586817, -119.67884813249111, -240.69168240949512, -118.86741410940886, -248.76885192841291, -258.39488907903433, -155.42496509850025, -100.72259662300348, -324.6824907399714, -133.49520622193813, -153.0505344569683, -122.13526310026646, -299.1200122758746, -193.59740436077118, -185.9678611047566, -117.53391303867102, -153.53073766827583, -139.99728985130787, -158.84924348443747, -125.68511474877596, -187.46517303213477, -87.27331274747849, -128.73419526219368, -133.8558786958456, -129.06738812476397, -151.97137330658734, -135.12554170191288, -150.20791149139404, -147.560348585248, -151.2980057746172, -116.72172052785754, -166.93423822522163, -180.28844223357737, -146.77661826461554, -254.27090477384627, -319.2336565554142, -371.7509205490351, -158.28565686009824, -110.99644298106432, -240.6397206708789, -100.62126293033361, -137.29585203528404, -309.80139933526516, -138.29076955467463, -280.74334172159433, -165.000841146335, -227.36268356442451, -181.1927668042481, -168.674867965281, -168.14017461240292, -281.4433438144624, -185.38293466717005, -156.18543266505003, -194.4454993829131, -330.87881775200367, -138.67362319678068, -104.19141390547156, -113.27681335806847, -113.0572801232338, -138.70313839241862, -175.48894194886088, -133.03013007715344, -124.12405886128545, -139.73040932416916, -155.25176111608744, -186.097814951092, -162.87931601330638, -235.93961941078305, -111.72819902002811, -154.42981777340174, -134.81631191447377, -194.19878842681646, -96.31054059043527, -188.29457092285156, -290.40019457414746, -130.18380666151643, -265.72976937144995, -161.67958371341228, -216.06820595264435, -186.9104106426239, -246.90950049459934, -349.70434684306383, -172.8815915249288, -148.4772575199604, -133.08704859018326, -355.28156089410186, -115.75102355331182, -65.64450568705797, -290.2186223715544, -135.30056400597095, -150.9889104142785, -118.41078398749232, -113.60379140079021, -121.84463423863053, -123.32039068639278, -144.0125252455473, -145.40526619926095, -153.43709165602922, -152.24159374833107, -113.40902853757143, -285.7852231170982, -155.09418793022633, -162.4002376869321, -271.00125781446695, -187.9743049070239, -144.2254385575652, -266.1991040855646, -242.0312428995967, -111.65478882938623, -101.3780747950077, -124.48035299032927, -124.07237759232521, -304.13905169814825, -105.12959522008896, -166.28981520980597, -104.69639326632023, -186.38382831215858, -152.55672601610422, -120.55701797455549, -128.74582719057798, -71.83119995333254, -165.91320960223675, -134.13865038380027, -193.21626697853208, -256.6226050928235, -310.38091610372066, -107.31664173305035, -148.35930168628693, -114.3896836861968, -137.54120012372732, -152.63091073930264, -117.95167049206793, -264.56895488873124, -298.06208239123225, -138.69056393951178, -170.6364921145141, -154.40313480049372, -168.93469382822514, -145.7457845043391, -133.21338094770908, -102.8006364107132, -193.68214222602546, -110.65723017603159, -197.52301658689976, -105.19833148270845, -173.2819944024086, -266.48555509001017, -371.7601449340582, -139.62307618558407, -248.4735713750124, -121.99432279914618, -113.10406577587128, -150.0167300105095, -315.71594036370516, -189.78213084489107, -381.8359627202153, -235.88397008180618, -294.9548869803548, -304.0358764231205, -180.11103887110949, -162.15608151629567, -107.18430975079536, -299.5241197794676, -107.87513499706984, -79.38779111206532, -141.4986057281494, -142.06636852025986, -108.2117053642869, -141.84070477634668, -115.550461422652, -125.1100254803896, -166.58668895065784, -95.53774945437908, -258.8833023570478, -140.84436598420143, -171.92551651597023, -135.26237948983908, -262.3107158020139, -132.8042107820511, -176.10061349719763, -290.46810922026634, -337.36385513842106, -127.10081922635436, -172.420858040452, -160.13209800422192, -138.2883912846446, -115.17893177270889, -127.27872345596552, -144.15706585347652, -185.96445980668068, -178.8909176401794, -162.22799002751708, -123.33658967167139, -122.47804640606046, -164.2686966881156, -222.54884814843535, -129.65982577949762, -98.31756297498941, -264.4670143648982, -226.1682361215353, -192.05018469691277, -201.74959724396467, -206.54042599536479, -149.74960174784064, -166.47716235741973, -82.32214298844337, -271.6949853003025, -145.00789918005466, -87.65902827680111, -150.78868717327714, -172.70375245064497, -129.7558390572667, -142.28392808139324, -134.16356495022774, -158.08601624518633, -115.06490389071405, -148.8611946683377, -163.14831709116697, -136.87170580402017, -195.95857038348913, -174.47334718331695, -115.08920884132385, -150.86005447804928, -117.38702535629272, -129.42620750144124, -152.8236821964383, -120.68274278193712, -158.18139580264688, -112.37612021714449, -191.62567311525345, -157.96904753148556, -335.2325821481645, -176.22390864789486, -128.37381524592638, -180.6149890422821, -93.36363100260496, -103.8139760941267, -182.30518602207303, -189.86300928890705, -348.2032286673784, -305.34267711639404, -204.62729826569557, -146.68021593987942, -112.12977582961321, -252.54679673165083, -178.92353587597609, -154.87201733887196, -159.3005313873291, -315.0897528529167, -309.24672938138247, -95.62539679557085, -159.2002943456173, -161.96559013053775, -206.26089841127396, -220.35188435018063, -338.16100326925516, -175.13237695395947, -104.88307332620025, -168.57513070851564, -137.86524454504251, -259.53547478839755, -120.30677652359009, -256.7607375830412, -82.23990076035261, -166.88773205131292, -127.74882082641125, -156.36661572754383, -107.12150965631008, -119.42126796394587, -211.56323923915625, -276.2398048862815, -160.3071470707655, -288.8678885102272, -128.33995582163334, -119.23859013617039, -276.1648252159357, -101.55634313076735, -117.67852126806974, -90.39091639965773, -131.33397176116705, -119.28017448633909, -125.11184971407056, -118.85976780951023, -197.66649509221315, -112.83726896345615, -116.11407936364412, -127.78026984632015, -189.25919489562511, -277.22356977313757, -152.55373441055417, -142.98834156244993, -204.3082832172513, -103.28637407720089, -119.00931564718485, -189.65733919292688, -152.3537524472922, -124.83934346586466, -119.27951396070421, -124.12685853987932, -119.00132044404745, -258.8877775222063, -193.43816973268986, -143.76391591131687, -197.93552282080054, -124.1199998408556, -241.32752861082554, -147.2986608222127, -229.66725768893957, -172.82541170343757, -148.1316859871149, -104.9346131682396, -173.42521860823035, -156.2207913324237, -139.89743783324957, -136.1344984434545, -109.42198116704822, -118.08557982742786, -132.07688894867897, -145.22273353487253, -97.41282223537564, -197.80648440122604, -151.4211123189889], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409005291220027, "mean_inference_ms": 4.537803574312865, "mean_action_processing_ms": 4.206585468667467, "mean_env_wait_ms": 3.229851622408398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6158880, "timesteps_this_iter": 131040, "agent_timesteps_total": 6158880, "timers": {"sample_time_ms": 29719.96, "sample_throughput": 4409.158, "load_time_ms": 23.204, "load_throughput": 5647222.697, "learn_time_ms": 14931.344, "learn_throughput": 8776.169, "update_time_ms": 2.392}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.8421709430404e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 167.38933743989074, "policy_loss": -0.004618114902078625, "vf_loss": 33.482136158960266, "vf_explained_var": 0.43192863197309567, "kl": 0.0019377776454527862, "entropy": -0.35012746775876663, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6158880, "num_agent_steps_sampled": 6158880, "num_steps_trained": 6158880, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6158880}, "done": false, "episodes_total": 12480, "training_iteration": 47, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-05-28", "timestamp": 1691021128, "time_this_iter_s": 39.437798500061035, "time_total_s": 1452.277096271515, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1452.277096271515, "timesteps_since_restore": 6158880, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 44.239285714285714, "ram_util_percent": 51.34642857142858}}
{"episode_reward_max": -82.23990076035261, "episode_reward_min": -348.2032286673784, "episode_reward_mean": -166.89169477385934, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150.86005447804928, -117.38702535629272, -129.42620750144124, -152.8236821964383, -120.68274278193712, -158.18139580264688, -112.37612021714449, -191.62567311525345, -157.96904753148556, -335.2325821481645, -176.22390864789486, -128.37381524592638, -180.6149890422821, -93.36363100260496, -103.8139760941267, -182.30518602207303, -189.86300928890705, -348.2032286673784, -305.34267711639404, -204.62729826569557, -146.68021593987942, -112.12977582961321, -252.54679673165083, -178.92353587597609, -154.87201733887196, -159.3005313873291, -315.0897528529167, -309.24672938138247, -95.62539679557085, -159.2002943456173, -161.96559013053775, -206.26089841127396, -220.35188435018063, -338.16100326925516, -175.13237695395947, -104.88307332620025, -168.57513070851564, -137.86524454504251, -259.53547478839755, -120.30677652359009, -256.7607375830412, -82.23990076035261, -166.88773205131292, -127.74882082641125, -156.36661572754383, -107.12150965631008, -119.42126796394587, -211.56323923915625, -276.2398048862815, -160.3071470707655, -288.8678885102272, -128.33995582163334, -119.23859013617039, -276.1648252159357, -101.55634313076735, -117.67852126806974, -90.39091639965773, -131.33397176116705, -119.28017448633909, -125.11184971407056, -118.85976780951023, -197.66649509221315, -112.83726896345615, -116.11407936364412, -127.78026984632015, -189.25919489562511, -277.22356977313757, -152.55373441055417, -142.98834156244993, -204.3082832172513, -103.28637407720089, -119.00931564718485, -189.65733919292688, -152.3537524472922, -124.83934346586466, -119.27951396070421, -124.12685853987932, -119.00132044404745, -258.8877775222063, -193.43816973268986, -143.76391591131687, -197.93552282080054, -124.1199998408556, -241.32752861082554, -147.2986608222127, -229.66725768893957, -172.82541170343757, -148.1316859871149, -104.9346131682396, -173.42521860823035, -156.2207913324237, -139.89743783324957, -136.1344984434545, -109.42198116704822, -118.08557982742786, -132.07688894867897, -145.22273353487253, -97.41282223537564, -197.80648440122604, -151.4211123189889], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.393254453465816, "mean_inference_ms": 4.5247463171688205, "mean_action_processing_ms": 4.152691020727359, "mean_env_wait_ms": 3.200708572967571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6289920, "timesteps_this_iter": 131040, "agent_timesteps_total": 6289920, "timers": {"sample_time_ms": 27312.944, "sample_throughput": 4797.725, "load_time_ms": 21.6, "load_throughput": 6066570.67, "learn_time_ms": 14914.636, "learn_throughput": 8786.0, "update_time_ms": 2.377}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4210854715202e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 156.15212710522513, "policy_loss": -0.005754023819322835, "vf_loss": 31.23582690591026, "vf_explained_var": 0.4700590025994085, "kl": 0.0018942007724250796, "entropy": -0.353025904212374, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6289920, "num_agent_steps_sampled": 6289920, "num_steps_trained": 6289920, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6289920}, "done": false, "episodes_total": 12480, "training_iteration": 48, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-05-44", "timestamp": 1691021144, "time_this_iter_s": 15.178420782089233, "time_total_s": 1467.4555170536041, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1467.4555170536041, "timesteps_since_restore": 6289920, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 13.818181818181815, "ram_util_percent": 51.5}}
{"episode_reward_max": -56.69309650361538, "episode_reward_min": -425.84473318979144, "episode_reward_mean": -156.72781108387474, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.3629025965929, -121.45720604807138, -90.19669061899185, -97.33097110316157, -172.4320884756744, -96.53645607084036, -152.76180317252874, -163.02214644104242, -105.77177805453539, -262.847484998405, -212.27377852797508, -230.2225306481123, -270.0134269297123, -115.56113455072045, -116.9895336329937, -130.26900269463658, -108.23768647387624, -195.10775132477283, -151.3792940825224, -320.25946179032326, -319.42318370193243, -182.6224864013493, -177.9725154824555, -170.2844282090664, -129.1033669784665, -138.01044070348144, -121.00091840326786, -112.58951848745346, -158.27470503747463, -186.42669483087957, -169.94512416888028, -190.31061193346977, -167.67753197997808, -79.34356719255447, -236.1714706774801, -181.84871132671833, -105.64709971472621, -228.6327202320099, -186.57260573655367, -149.03074130415916, -275.23745284229517, -140.30470752716064, -103.26249963790178, -322.73910588771105, -92.2380279302597, -82.85605479776859, -133.4492726419121, -118.21703808009624, -157.49537205696106, -123.25587727874517, -95.91700661182404, -179.76770570874214, -114.24183550477028, -133.4385228380561, -191.23656069487333, -425.84473318979144, -114.09547239542007, -301.37251154333353, -132.40440484136343, -143.12892985343933, -56.69309650361538, -267.94660323113203, -172.93411388248205, -306.9403450861573, -106.16733773052692, -117.07651898264885, -130.55194614827633, -89.77124694734812, -125.34601476788521, -109.16827911138535, -75.49112375825644, -222.91253581643105, -80.28128181770444, -88.1465310305357, -158.84497186541557, -116.55905602872372, -140.88714331388474, -128.7024835459888, -131.55648291297257, -155.94939685985446, -123.29154636710882, -135.71197932213545, -230.5167109966278, -170.24359637498856, -133.01085349917412, -87.9677602276206, -84.43497593700886, -124.4584374949336, -105.23505203425884, -287.9364357292652, -136.87235172092915, -116.44650134444237, -150.16267343610525, -139.68749956786633, -130.8948441669345, -183.12675106152892, -116.0913652330637, -135.04937230050564, -143.36146174371243, -146.61867702752352, -127.9205005466938, -119.42907494306564, -116.78596610575914, -140.52007857710123, -99.92767847329378, -114.3857273645699, -222.32745750248432, -162.16103188693523, -114.24605136737227, -140.09174920618534, -301.9825337380171, -269.3136768564582, -126.4361761957407, -130.26138308644295, -184.44323220849037, -189.51551493257284, -117.22416838258505, -305.83461905643344, -208.79771062731743, -135.88942282646894, -151.53727297484875, -175.890721578151, -220.24872809275985, -115.56327755376697, -147.7194518968463, -128.98184529691935, -136.96347183734179, -117.46709397435188, -166.25452976673841, -282.40430960059166, -100.59557443112135, -271.0110751539469, -107.15473868884146, -115.62781949341297, -128.41133411228657, -80.70860426872969, -282.3415463194251, -144.1393005810678, -127.66174037382007, -138.12645475566387, -152.92240956053138, -249.33310393616557, -164.28370156139135, -108.50750854611397, -111.62620583549142, -281.952031083405, -67.67684943974018, -149.66449795663357, -146.23855255544186, -123.57289234548807, -157.09273802489042, -131.3744007796049, -222.52113558351994, -119.612333830446, -124.05166509747505, -240.1349517777562, -157.67529233545065, -120.74891456961632, -92.1769894361496, -135.0514745004475, -129.37952870875597, -152.8615893162787, -141.53550251200795, -311.8662959113717, -139.33893724530935, -123.48392355442047, -180.65350226312876, -129.50664594769478, -311.81144435703754, -78.75611752271652, -114.92869311571121, -285.3189111351967, -211.56330012530088, -93.95288813859224, -111.5355514883995, -204.02357591688633, -175.41863580048084, -106.02526491135359, -151.52888885885477, -208.346531778574, -127.32335040718317, -109.44306872785091, -111.23954531177878, -309.23175640404224, -122.7830893099308, -259.3124290406704, -102.4053280428052, -126.95745389908552, -365.83351159095764, -174.11910270899534, -93.71083940565586, -219.99217699468136, -121.60780136287212, -131.57712571695447, -145.0405240431428, -109.30898038297892, -106.16706470400095, -114.76137165725231, -149.709034929052, -157.4925009086728, -133.11045446246862, -148.81533152237535, -134.8026914075017, -159.28653762489557, -85.17282358556986, -124.83165890723467, -107.91529250890017, -127.97713231295347, -104.22851187735796, -129.82798171788454, -124.32148614525795, -167.16616377048194, -243.3702500462532, -95.90303342789412, -131.32290595024824, -242.62712542712688, -159.9941300228238, -128.45279955118895, -163.3422253355384, -256.8914303854108, -170.90092399716377, -85.39108502864838, -134.21931401267648, -330.26305056735873, -98.58814697526395, -248.9023860692978, -152.03358578681946, -204.90318746864796, -127.4408708512783, -127.07400476932526, -106.9709512591362, -160.29553966224194, -113.3003702685237, -118.2045069783926, -144.57588930428028, -180.85928853601217, -125.73853405937552, -172.5793990343809, -106.31611569225788, -165.04167141020298, -96.50949327647686, -193.42161367088556, -267.04416087269783, -224.55428490415215, -84.77648675069213, -112.20715502277017, -153.08515480160713, -148.00006395578384, -132.03128627873957, -223.56240270286798, -69.19663812965155, -115.24582470208406, -158.14742282778025, -122.04931087046862, -120.2431990802288, -81.91009966284037, -146.185703240335, -127.23819348216057, -115.89926544949412, -113.19664569199085, -111.18474123626947, -129.46803358197212, -110.00351805239916, -164.84246204793453, -99.07155196368694, -128.28229743242264, -189.7835356593132, -219.20961165428162, -187.15809348970652, -125.32691925764084, -265.91628264356405, -217.8102908357978, -85.51786214858294, -111.738574385643, -101.1028889939189, -83.12438876181841, -246.82301928848028, -239.1133408471942, -311.6946357563138, -190.42986058443785, -292.266260959208, -133.27118302881718, -127.92824584618211, -299.34848564863205, -160.9403009787202, -121.42464737594128, -126.34682690352201, -258.3411877118051, -145.540066935122, -268.447030544281, -78.26302845776081, -263.8617154918611, -150.3139724135399, -196.97313311696053, -234.92828407138586, -104.31178215146065, -90.74147936701775, -131.50683649629354, -75.02472899667919, -144.73235104233027, -158.26734106242657, -304.46658505499363, -159.15587075054646, -116.91782919317484, -115.44281170517206, -278.727937027812, -198.68813802301884, -211.2547376975417, -126.53498330526054, -149.3291577361524, -127.29248389601707, -344.42589592188597, -92.20755481347442, -106.60285505279899, -173.7464511729777, -317.7716500759125, -125.23681782186031, -129.83129579387605, -141.89422089606524, -123.6178151294589, -136.8171228915453, -114.97430478036404, -158.69265944510698, -95.01905601099133, -108.96578499674797, -146.70212876796722, -181.80528937280178, -123.4599046856165, -152.788563542068, -172.18779777735472, -114.96449227631092, -121.22524913027883, -107.48524361103773, -212.96961222589016, -271.13104455918074, -113.89329009503126, -276.92921717464924, -125.7370792478323, -94.30106966942549, -241.98291090130806, -141.48922683298588, -81.7971897944808, -215.63740748912096, -103.21432282030582, -116.21791842579842, -129.38282146304846, -194.11896411702037, -128.06801840290427, -137.46871776878834, -82.33260668069124, -126.62369571626186, -157.19944504275918, -138.49744401872158, -90.43527924083173, -127.09196238219738, -206.00948736816645, -160.42843042314053, -154.8083372488618, -128.85433526337147, -109.36523114144802, -108.68087147176266, -235.81939743086696, -162.52516815811396, -132.0257733426988, -205.74913997203112, -202.31581611931324, -85.58108000457287, -100.57506614178419, -197.78401052951813, -168.0085939243436, -223.4528532922268, -103.64047179371119, -94.0909277126193, -118.62510584294796, -85.30947955325246, -149.4777082055807, -100.95856518298388, -150.733857691288, -165.24118595197797, -107.55680778622627, -81.03678927011788, -298.9650221578777, -268.98998250067234, -159.81906252354383, -161.87982561439276, -263.1306016072631, -238.40234869718552, -122.15658714622259, -112.53523584455252, -98.20508619397879, -129.1548998951912, -245.81965947151184, -140.32999550178647, -246.80200213938951, -242.25261998549104, -261.5046918168664, -200.57464583963156, -112.04430235922337, -119.89575310796499, -156.85213141143322, -271.2947756871581, -190.20300099998713, -95.83696842193604, -141.22015911340714, -137.9509426355362, -150.76016337424517, -254.00274562835693, -109.07951414957643, -156.06605664268136, -323.88374619185925, -91.8552807085216, -102.97456612810493, -127.61716175638139, -319.4193004965782, -242.1500441506505, -119.08536572754383, -122.05168375372887, -130.59036321938038, -87.62323024496436, -92.9876831099391, -115.14893913269043, -113.59757962077856, -299.07289150357246, -144.62184734642506, -306.7308488190174, -175.56726685911417, -340.1493769325316, -143.13362845778465, -132.75040394440293, -101.12909252941608, -98.05258676409721, -124.61510371416807, -134.52957051992416, -114.32223580777645, -97.91649892553687, -209.06362882629037, -151.62151420116425, -249.6295357234776, -111.44982241094112, -110.9222009703517, -96.122822239995, -92.62104757130146, -160.33881095796824, -281.29159823805094, -234.79036624729633, -128.49075800180435, -135.52072056010365, -158.79577288776636, -126.18894226104021, -71.18867766112089, -136.59779370203614, -146.35796369612217, -95.37449237704277, -115.07618213072419, -167.16847150027752, -152.6105936281383, -114.07094266265631, -122.28638138994575, -106.65202463045716, -144.50373951345682, -158.58890748023987, -131.26338395103812, -134.029720723629, -112.47779493033886, -211.33945193514228, -155.67785806953907, -95.9655726859346, -101.44228107109666, -199.78503342717886, -154.53284366428852, -137.93285235762596, -104.2799578346312, -137.6279866322875, -126.7513417005539, -87.31234256923199, -232.78187099844217, -122.85632443614304, -114.96911835670471, -126.23293159343302, -85.36935638263822], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410319065263447, "mean_inference_ms": 4.538239541264653, "mean_action_processing_ms": 4.206483130008343, "mean_env_wait_ms": 3.227748573535459, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6420960, "timesteps_this_iter": 131040, "agent_timesteps_total": 6420960, "timers": {"sample_time_ms": 29693.606, "sample_throughput": 4413.071, "load_time_ms": 23.311, "load_throughput": 5621347.149, "learn_time_ms": 14932.297, "learn_throughput": 8775.609, "update_time_ms": 2.344}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.105427357601e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 144.80530965986677, "policy_loss": -0.002654419638526078, "vf_loss": 28.963355207955967, "vf_explained_var": 0.42742976845378944, "kl": 0.0017242549646433278, "entropy": -0.3616020173688943, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6420960, "num_agent_steps_sampled": 6420960, "num_steps_trained": 6420960, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6420960}, "done": false, "episodes_total": 12960, "training_iteration": 49, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-06-23", "timestamp": 1691021183, "time_this_iter_s": 39.29615044593811, "time_total_s": 1506.7516674995422, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1506.7516674995422, "timesteps_since_restore": 6420960, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 44.285714285714285, "ram_util_percent": 51.36785714285713}}
{"evaluation": {"episode_reward_max": -223.3652936220169, "episode_reward_min": -223.3652936220169, "episode_reward_mean": -223.3652936220169, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-223.3652936220169], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -41.58129284530878, "episode_reward_min": -353.6872084736824, "episode_reward_mean": -155.0910157503376, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289.23988975584507, -150.97477511316538, -132.09791854023933, -117.81969620287418, -146.92046507447958, -126.32522186264396, -120.73051857203245, -121.35691943764687, -86.9707388728857, -116.57645835727453, -55.93193066120148, -133.25558018684387, -127.95470210909843, -153.8776894658804, -106.5558415427804, -240.92263877391815, -134.12525507807732, -103.8374789133668, -120.7786351069808, -64.96702397614717, -122.26820361614227, -206.1637209802866, -153.98022608831525, -163.84550666064024, -105.89161771722138, -123.29618405923247, -109.05175252258778, -137.85340748727322, -167.83385199680924, -166.38188898563385, -132.53474482893944, -267.83353213220835, -277.21443850547075, -85.1202656403184, -177.11372254788876, -221.89928827807307, -128.406554967165, -220.04248299077153, -77.34168413281441, -145.19166200608015, -125.39562717825174, -85.95229002460837, -100.21288452297449, -125.18107598274946, -103.14014801755548, -133.75338263064623, -151.77431935817003, -93.99777368456125, -123.42705469578505, -301.8292060047388, -140.36362943053246, -345.26709619164467, -101.56010914966464, -223.88582514598966, -347.09240341186523, -281.4411438703537, -127.17153716087341, -165.6744082942605, -140.70527789741755, -72.88283042609692, -317.49947203695774, -139.28459031134844, -117.36347735859454, -125.31899154186249, -252.38265685737133, -130.40467791631818, -88.13474687933922, -213.02030999213457, -152.63579753227532, -245.62284956127405, -75.40978097170591, -116.63515258580446, -57.351374216377735, -122.28200616687536, -88.17589701712132, -87.17661139369011, -119.50973479449749, -96.75669267773628, -105.37207625061274, -55.12360028922558, -106.89325830154121, -206.65992319583893, -85.61750338971615, -296.5231697931886, -120.20797476917505, -84.40941246598959, -107.65534314513206, -81.58321111649275, -274.0929900109768, -101.1384979635477, -163.4155223146081, -127.20225535705686, -141.3591406494379, -118.0181659385562, -68.3757581114769, -123.19368078559637, -162.75104876607656, -96.29378814250231, -335.28777235001326, -152.57445742934942, -226.531816996634, -203.55758138000965, -147.06678389012814, -79.07839830592275, -66.23507895320654, -62.27835486084223, -101.63277543336153, -99.817426815629, -123.82757409662008, -117.506707072258, -271.34819688647985, -267.56095442175865, -113.40394318290055, -208.7629402205348, -146.71067760884762, -154.93570978567004, -159.83680123835802, -79.02536815404892, -192.21361549198627, -122.93090364709496, -195.75400962680578, -103.01289997249842, -199.0561653226614, -83.97227748855948, -107.64587137103081, -127.80006545037031, -103.30890261381865, -80.04463712126017, -136.4945510290563, -79.08293982595205, -61.873724073171616, -120.34113612025976, -85.04941506683826, -79.33848758786917, -259.8995767235756, -230.75807985663414, -159.15922437235713, -103.0833939909935, -216.45714166387916, -229.51004768908024, -56.090420950204134, -309.7577254772186, -105.98786401748657, -244.54407723620534, -178.21102458238602, -80.28926911205053, -255.5924161300063, -168.06916929781437, -152.66057188808918, -153.56288418918848, -64.23027789592743, -247.76368286460638, -301.1501541752368, -78.49843193590641, -262.88983531296253, -104.9870770946145, -95.09388954937458, -281.6240874007344, -108.26860105246305, -84.97450084984303, -160.02328869700432, -315.00955422595143, -248.33986409008503, -111.6936691403389, -120.46027667820454, -157.07889329642057, -82.81080042012036, -130.08771577477455, -97.9871278218925, -262.58330561220646, -240.43483502417803, -123.84516351297498, -279.74533066153526, -216.90360121428967, -122.39523369818926, -329.30197071284056, -138.88177239894867, -129.83225056529045, -281.0120333246887, -45.3480885066092, -222.03968815505505, -79.93302163481712, -277.4671408608556, -119.99342319741845, -96.37864724546671, -104.38427881151438, -163.17860677838326, -110.49355909228325, -306.23439434170723, -258.63708973675966, -287.67163740098476, -138.99245285987854, -201.4649097174406, -149.19466346502304, -95.9688540995121, -125.91979663446546, -157.30005864799023, -84.26282201334834, -88.00127974897623, -88.09710498899221, -63.99298648163676, -49.27877505123615, -78.51276611164212, -165.58552781119943, -90.35401947796345, -211.38298711180687, -242.49052508175373, -97.45312464237213, -277.69681634008884, -81.69846141338348, -104.58515610545874, -160.8123771250248, -208.6894385293126, -146.1235620379448, -300.67186465114355, -117.15694734826684, -80.87862452864647, -118.21341301128268, -146.6454153507948, -245.9708584919572, -252.88148906826973, -106.9472774527967, -85.98241845145822, -128.64576023072004, -70.58121623843908, -88.90087513625622, -167.35168336704373, -276.35471737384796, -82.14018971472979, -110.67613385617733, -105.22631506621838, -238.8953775241971, -129.3096870407462, -156.92550129443407, -95.22282869368792, -96.71997671574354, -235.58489820361137, -291.9400480687618, -180.7319250255823, -269.4801385998726, -102.94599705189466, -269.6234499588609, -157.75909908115864, -109.93938894569874, -248.2758537977934, -100.80753180384636, -234.89140924811363, -220.7761828377843, -61.02028804831207, -130.53998839110136, -333.6728267669678, -103.75470072031021, -133.7428563758731, -119.841900549829, -90.17320019751787, -57.85622303932905, -294.3864926993847, -248.02621650323272, -261.5209850035608, -330.8636371791363, -178.44341553747654, -233.34989058226347, -262.78099770471454, -234.2170762643218, -140.0818872898817, -240.1505858488381, -136.18988933227956, -233.71245326846838, -179.0296961814165, -71.80222975462675, -93.38748275488615, -89.436259560287, -261.0029869042337, -114.76246565580368, -252.04950775578618, -154.13067365437746, -180.02608666196465, -283.2237225100398, -224.33209205046296, -100.25634909421206, -138.24942949786782, -253.28302573412657, -264.36319401860237, -106.83633806928992, -239.30467821657658, -171.1841087937355, -182.976899754256, -105.0308983437717, -109.1329798027873, -133.00745943933725, -94.70544328913093, -104.25830279290676, -135.31938116252422, -91.04804123193026, -121.87203215062618, -91.82498034462333, -184.32502311095595, -211.98701680079103, -103.33650763332844, -41.58129284530878, -108.40016316995025, -125.87490318715572, -118.96555557101965, -320.25150759518147, -117.05425173044205, -194.18895974755287, -155.27993147820234, -284.22677095234394, -79.21802162379026, -72.38004840165377, -57.705375507473946, -295.303743198514, -182.51454739272594, -291.17668457329273, -167.33697044849396, -141.46355820447206, -122.92648272961378, -98.82828066498041, -266.174074716866, -321.90028784424067, -132.68989606946707, -107.55459441244602, -320.6806342639029, -96.05819722265005, -139.55446016788483, -240.97616769373417, -84.71961445361376, -73.11849321424961, -224.5701829046011, -255.0747666284442, -45.304889511317015, -108.85118617862463, -218.5949907824397, -187.5630387328565, -144.1141306757927, -250.33758883178234, -75.70186314731836, -66.69312060624361, -122.3073964715004, -73.19277288019657, -109.97617078572512, -119.47805495560169, -109.56073185056448, -210.82153469324112, -217.8866272494197, -197.85099130123854, -250.57005243003368, -109.25820614024997, -117.97038587927818, -134.09815376251936, -218.83244065381587, -188.2970373854041, -74.6524364836514, -142.92261653393507, -272.01775704324245, -145.52941634133458, -141.33065530657768, -98.80022887513041, -106.2361996024847, -79.76035594567657, -95.86359223350883, -111.47515627741814, -257.6357549726963, -99.73951229453087, -331.8080479800701, -75.5636794641614, -180.7177997790277, -147.62300115823746, -122.75847853347659, -106.9249285236001, -55.589922182261944, -53.37967699021101, -124.39290638267994, -231.1958664059639, -60.03572158515453, -96.28968220949173, -105.36361380666494, -243.69128831475973, -119.50307111442089, -259.6543288528919, -240.10314888507128, -82.12333916127682, -105.00684644281864, -143.37122029438615, -97.36407624930143, -108.67753560096025, -189.95459942519665, -82.64057163894176, -111.932940967381, -110.65082774311304, -272.5251825451851, -94.60584720224142, -87.54400265961885, -88.51352814212441, -65.08356706053019, -178.28550355881453, -180.89055892638862, -124.41764431074262, -161.51238540932536, -110.2298417519778, -91.8639972731471, -196.0779669135809, -104.9789597839117, -142.81152062118053, -302.31182247400284, -109.93574515962973, -112.18687523156404, -97.78859408944845, -168.8279147669673, -104.48002004995942, -100.63169230334461, -134.71061876416206, -94.40301882475615, -155.34781503677368, -139.3940105959773, -291.22633777558804, -353.6872084736824, -177.47406325489283, -110.3542335703969, -100.86239141225815, -99.8645831644535, -100.77269730716944, -254.61076403409243, -210.9968238696456, -83.7906693406403, -136.38757728785276, -92.77009080350399, -135.41945822536945, -277.21883922070265, -126.42518541961908, -86.2034771926701, -238.1233714222908, -88.39090470224619, -101.76231100410223, -113.25426064804196, -283.44529293477535, -126.08910101279616, -196.64250038936734, -129.40199822187424, -104.72132629156113, -108.92766298726201, -100.26100923120975, -99.7123335301876, -98.70826725661755, -308.42940828949213, -104.86734548956156, -91.94251004606485, -267.9998390413821, -199.81593316048384, -121.47730708122253, -92.17410880327225, -130.07885002344847, -173.71698342263699, -137.87908452749252, -114.32599310576916, -135.85170876979828, -115.42471908032894, -101.16971855610609, -115.52008682489395, -132.76392710208893, -133.671148205176, -198.20239577442408, -220.81294597685337, -120.5076817125082, -239.64611097611487, -101.69377838075161, -140.37825421243906, -302.76773224025965, -182.03099976107478, -67.40544171631336, -319.4492923989892, -297.6553341150284, -272.19160301983356, -84.82719272375107, -171.18116465955973, -217.25335923582315, -75.92465551942587, -105.94874662905931, -142.3635204359889, -279.2190716024488], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42412279624781, "mean_inference_ms": 4.552377991029819, "mean_action_processing_ms": 4.210895791288097, "mean_env_wait_ms": 3.2339555470459276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6552000, "timesteps_this_iter": 131040, "agent_timesteps_total": 6552000, "timers": {"sample_time_ms": 29881.942, "sample_throughput": 4385.257, "load_time_ms": 23.542, "load_throughput": 5566115.237, "learn_time_ms": 14991.621, "learn_throughput": 8740.883, "update_time_ms": 2.356}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.5527136788005e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 152.23567236201123, "policy_loss": 0.0011819892968145673, "vf_loss": 30.445587448749063, "vf_explained_var": 0.3876157466015081, "kl": 0.002257156964923293, "entropy": -0.365589888452629, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6552000, "num_agent_steps_sampled": 6552000, "num_steps_trained": 6552000, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6552000}, "done": false, "episodes_total": 13440, "training_iteration": 50, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-08-10", "timestamp": 1691021290, "time_this_iter_s": 106.71813321113586, "time_total_s": 1613.469800710678, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1613.469800710678, "timesteps_since_restore": 6552000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 38.774342105263166, "ram_util_percent": 65.39144736842105}}
{"episode_reward_max": -65.08356706053019, "episode_reward_min": -353.6872084736824, "episode_reward_mean": -151.35256432468537, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.10314888507128, -82.12333916127682, -105.00684644281864, -143.37122029438615, -97.36407624930143, -108.67753560096025, -189.95459942519665, -82.64057163894176, -111.932940967381, -110.65082774311304, -272.5251825451851, -94.60584720224142, -87.54400265961885, -88.51352814212441, -65.08356706053019, -178.28550355881453, -180.89055892638862, -124.41764431074262, -161.51238540932536, -110.2298417519778, -91.8639972731471, -196.0779669135809, -104.9789597839117, -142.81152062118053, -302.31182247400284, -109.93574515962973, -112.18687523156404, -97.78859408944845, -168.8279147669673, -104.48002004995942, -100.63169230334461, -134.71061876416206, -94.40301882475615, -155.34781503677368, -139.3940105959773, -291.22633777558804, -353.6872084736824, -177.47406325489283, -110.3542335703969, -100.86239141225815, -99.8645831644535, -100.77269730716944, -254.61076403409243, -210.9968238696456, -83.7906693406403, -136.38757728785276, -92.77009080350399, -135.41945822536945, -277.21883922070265, -126.42518541961908, -86.2034771926701, -238.1233714222908, -88.39090470224619, -101.76231100410223, -113.25426064804196, -283.44529293477535, -126.08910101279616, -196.64250038936734, -129.40199822187424, -104.72132629156113, -108.92766298726201, -100.26100923120975, -99.7123335301876, -98.70826725661755, -308.42940828949213, -104.86734548956156, -91.94251004606485, -267.9998390413821, -199.81593316048384, -121.47730708122253, -92.17410880327225, -130.07885002344847, -173.71698342263699, -137.87908452749252, -114.32599310576916, -135.85170876979828, -115.42471908032894, -101.16971855610609, -115.52008682489395, -132.76392710208893, -133.671148205176, -198.20239577442408, -220.81294597685337, -120.5076817125082, -239.64611097611487, -101.69377838075161, -140.37825421243906, -302.76773224025965, -182.03099976107478, -67.40544171631336, -319.4492923989892, -297.6553341150284, -272.19160301983356, -84.82719272375107, -171.18116465955973, -217.25335923582315, -75.92465551942587, -105.94874662905931, -142.3635204359889, -279.2190716024488], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406505916272485, "mean_inference_ms": 4.537956443998925, "mean_action_processing_ms": 4.15509319881351, "mean_env_wait_ms": 3.203501317287918, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6683040, "timesteps_this_iter": 131040, "agent_timesteps_total": 6683040, "timers": {"sample_time_ms": 34043.465, "sample_throughput": 3849.197, "load_time_ms": 21.712, "load_throughput": 6035413.795, "learn_time_ms": 14996.12, "learn_throughput": 8738.26, "update_time_ms": 2.342}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.77635683940025e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 160.69705798060346, "policy_loss": -0.0019168943333977711, "vf_loss": 32.1409585228103, "vf_explained_var": 0.3459446135387626, "kl": 0.0017670251962755503, "entropy": -0.370544585596276, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6683040, "num_agent_steps_sampled": 6683040, "num_steps_trained": 6683040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6683040}, "done": false, "episodes_total": 13440, "training_iteration": 51, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-08-25", "timestamp": 1691021305, "time_this_iter_s": 15.197880506515503, "time_total_s": 1628.6676812171936, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1628.6676812171936, "timesteps_since_restore": 6683040, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 14.48181818181818, "ram_util_percent": 51.24090909090908}}
{"episode_reward_max": -29.48738618940115, "episode_reward_min": -296.83158138394356, "episode_reward_mean": -129.71868395582132, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-135.4668672606349, -166.41264852881432, -170.17315484955907, -234.81213189661503, -153.9359052926302, -99.9044816493988, -198.51300494372845, -90.63989986479282, -137.86601590365171, -140.25907767564058, -278.5858895815909, -79.91093648783863, -138.64123122394085, -94.67339514195919, -95.890764888376, -96.81658013164997, -278.5108869969845, -115.32373888790607, -155.14810751378536, -148.72555746510625, -121.44539214670658, -198.76259086467326, -249.4314070045948, -272.3810558896512, -126.9123600050807, -144.79565338790417, -119.51803826540709, -172.06466162204742, -172.0549659281969, -85.13723304122686, -117.20511148497462, -121.1939762160182, -128.3251329883933, -95.36374051496387, -272.817886531353, -96.55508426576853, -144.36846109107137, -116.77266630530357, -120.87098944932222, -171.20435970649123, -99.18180373311043, -165.59614450484514, -163.72689770162106, -108.48138818144798, -79.6270045787096, -99.90254512429237, -114.21185686439276, -75.9258910343051, -93.09721511229873, -94.49088474363089, -125.07474417984486, -96.63782746344805, -71.7160461768508, -94.8809811398387, -254.36295548081398, -263.905958943069, -105.41815906018019, -93.78914276510477, -231.62534702569246, -117.00003222376108, -104.0242671109736, -106.64729598164558, -52.146261263638735, -133.42855971306562, -96.93499128520489, -119.94249476492405, -249.58677800744772, -106.7024103961885, -249.25400728732347, -117.8744823038578, -147.39294950664043, -53.49677223153412, -66.33493987470865, -57.98605114594102, -139.59073144942522, -267.72653168439865, -105.41473850235343, -78.45817936211824, -113.84653855115175, -117.50878329947591, -93.02966538071632, -239.85779476165771, -101.40009380877018, -75.24502139445394, -86.99814618006349, -77.40506647899747, -47.7211939394474, -102.3426750972867, -104.26625627838075, -69.33733421564102, -102.16895336285233, -92.52129690349102, -90.42009506002069, -101.79731698334217, -111.63304833322763, -99.149319909513, -90.32610298320651, -150.34960840642452, -135.4826789200306, -82.3562251701951, -129.78215803951025, -129.99710880219936, -117.19161123782396, -163.751220472157, -70.0235994271934, -115.34832452982664, -72.86899426206946, -106.05842085927725, -129.54947427660227, -97.58142687380314, -128.14268267154694, -118.22413665056229, -149.63424071669579, -118.12986811995506, -176.34855666011572, -226.89952875860035, -133.10928034037352, -204.70991114154458, -127.48545710742474, -220.24098343774676, -99.04501897469163, -269.2917333096266, -132.56134335696697, -84.27738194912672, -80.31344498693943, -70.28690715134144, -145.75640562921762, -188.82462521269917, -125.53680265322328, -236.61833487451077, -245.7165850996971, -149.20007153600454, -201.02747587487102, -118.78743482381105, -87.72825898230076, -70.43231981247663, -84.24112493544817, -96.17895618081093, -113.82742463797331, -107.16898336261511, -111.3506984859705, -213.080819260329, -115.0571533665061, -106.51462960988283, -178.3078789897263, -120.72147627174854, -123.96583354473114, -111.72296514362097, -95.60282273590565, -124.29889063537121, -169.2308303192258, -247.7798814177513, -98.95267089083791, -120.01072633080184, -205.5565148293972, -124.55898283049464, -97.94453842565417, -206.1083356514573, -251.8127072751522, -87.4252112917602, -106.53586112335324, -105.57589183747768, -136.32225474715233, -140.1285112053156, -80.46615662425756, -240.45949015021324, -122.27849691361189, -164.17006636410952, -105.5419535562396, -158.04042922705412, -136.6550834234804, -103.33586699515581, -99.65450502187014, -94.01315349340439, -156.67486449331045, -216.21819084137678, -99.2487576417625, -120.28641001880169, -180.9020104110241, -138.62845192849636, -119.18720909953117, -102.49497951380908, -112.53289782255888, -112.05539330095053, -84.41386605426669, -144.69610587507486, -105.707687869668, -141.14497210085392, -74.45299937389791, -115.51715908944607, -93.02725530415773, -100.39014676213264, -214.85859246179461, -89.32642194628716, -125.90437587350607, -102.62851430475712, -107.93113213777542, -296.83158138394356, -99.91762267798185, -147.25913736224174, -93.81235044449568, -94.87646761536598, -283.3054645508528, -133.07497335970402, -89.70616832748055, -85.93313428759575, -127.72273388504982, -54.36136623471975, -153.30290999263525, -113.28976014256477, -116.18702824413776, -104.54751820117235, -84.75592017546296, -98.75918284058571, -115.98308381438255, -122.70686446130276, -136.16655308008194, -116.28225868195295, -241.1596725769341, -107.49801261909306, -95.6443699002266, -141.30221335589886, -138.6655398234725, -105.15335185825825, -103.84922230243683, -93.4565137475729, -266.1803172454238, -64.25232477486134, -126.44092739000916, -123.61002152040601, -132.3034695982933, -96.62615528702736, -123.50206086784601, -225.66300423443317, -151.0156512595713, -128.20976228266954, -170.8037669584155, -171.84040032327175, -118.6576357409358, -117.88337137550116, -150.76748505793512, -110.16697167605162, -237.96758986264467, -67.97168281674385, -51.15154489316046, -133.37028924375772, -107.192292265594, -104.62971798330545, -87.51653288304806, -74.96792414784431, -225.95233286172152, -109.51807342469692, -88.26243785023689, -94.09148019552231, -116.80972968786955, -117.71335912495852, -122.96529278159142, -100.71223031356931, -122.5348224490881, -91.8951309248805, -156.51600625179708, -80.37692431360483, -104.2868345938623, -104.90703079849482, -123.33849278092384, -202.75788271427155, -122.8235926553607, -172.39831459522247, -80.01910597085953, -217.52355592884123, -110.49380883574486, -75.06527900323272, -79.65467292815447, -132.64978789538145, -53.172281451523304, -231.06326226890087, -145.77085535228252, -126.83532118983567, -72.62554501742125, -99.7523646876216, -96.22360617667437, -87.38890690356493, -129.16181300580502, -78.78600383549929, -100.36951340734959, -110.42952007055283, -128.48307109996676, -125.24422322958708, -271.7449783044867, -116.3162364885211, -61.96448361873627, -120.60060674697161, -132.790670145303, -122.76006017625332, -213.68761200085282, -86.26797614991665, -66.56754579022527, -197.24619921669364, -118.62687163800001, -97.31556609459221, -115.94044230878353, -284.7593380305916, -49.496186546981335, -106.54719740897417, -259.75062135607004, -242.55400178581476, -101.16705377399921, -116.02190401405096, -115.6414933912456, -103.96220111474395, -130.67485661804676, -227.8136678636074, -124.10465577989817, -158.71463157236576, -113.56671242415905, -79.17786264792085, -84.72990839928389, -104.58440229296684, -116.90827132761478, -166.08931156247854, -117.64270652458072, -114.95703284442425, -119.40160240605474, -105.53729362040758, -131.12276442721486, -103.71744526922703, -73.39355652034283, -92.80554560571909, -89.50696805119514, -121.52606449276209, -123.3679733723402, -109.21132349967957, -89.09918434917927, -122.75543686747551, -202.45192474499345, -126.65766881778836, -127.11894379556179, -88.52694147452712, -83.48686136305332, -120.17548502981663, -66.69061109796166, -89.62945701554418, -230.5881138369441, -69.44526366889477, -118.66870035231113, -99.74341201782227, -115.54923120886087, -84.45803019404411, -228.33320927247405, -264.4706798531115, -89.65725295245647, -281.7972947768867, -99.81498749554157, -123.09669376909733, -53.16448848694563, -149.6521146185696, -133.033732842654, -88.9073894098401, -123.70323039591312, -93.55385688692331, -211.98300672322512, -126.9662678167224, -144.2889076806605, -184.22832535766065, -64.36417978256941, -111.78967440128326, -48.12276627123356, -139.28382764011621, -209.73859497904778, -86.28375510126352, -106.57654286175966, -57.26104390621185, -193.99949905276299, -83.36429813504219, -118.05539930611849, -179.51490936428308, -121.22206165641546, -93.47872400283813, -78.91694835573435, -139.04725465923548, -121.74910982698202, -113.54418990015984, -264.3468574285507, -113.53555002808571, -104.39925502985716, -143.9453164190054, -140.71309001743793, -113.57543649617583, -246.553920596838, -144.8950297832489, -148.38588908314705, -246.29024677351117, -133.38210898637772, -89.99147065728903, -126.27525002881885, -122.48419313132763, -89.9246069714427, -149.0020357631147, -219.563321121037, -216.11646111309528, -195.55395277403295, -185.24696511030197, -231.83474300988019, -59.931432977318764, -44.67935797199607, -223.76013777405024, -96.60820293053985, -238.37814915925264, -120.851030215621, -105.86600558459759, -101.53661936894059, -268.978927731514, -96.88997058942914, -89.06594914570451, -118.35746671631932, -89.94327925145626, -124.6354147568345, -78.8500804901123, -29.48738618940115, -117.47421838715672, -125.322181917727, -85.81154278665781, -122.1344750970602, -118.15546386688948, -109.50015304982662, -111.9967865422368, -118.37977911531925, -144.06568288058043, -122.79790100455284, -154.4644956588745, -87.54751276224852, -240.34546085447073, -124.5653215572238, -94.39838256686926, -162.13880398869514, -148.03345207124949, -103.0166637301445, -133.9745727851987, -124.72789407521486, -82.74615385383368, -118.39853176660836, -86.14824514091015, -134.44900596886873, -111.43522119522095, -57.974961560219526, -131.1776822246611, -104.39122246205807, -103.98609111458063, -116.20447029173374, -122.2304425612092, -124.09437791258097, -103.34667896851897, -85.398043949157, -119.24027105420828, -108.01625376194715, -136.50501945614815, -89.37597257643938, -121.38372531533241, -129.30731668323278, -267.70944733917713, -102.18615755066276, -130.7039649412036, -119.87659092247486, -140.30000170320272, -162.08789774030447, -102.56643887981772, -91.19104730337858, -84.76450558751822, -134.00034120678902, -225.26887952536345, -137.4306744635105, -106.19277708977461, -238.71482253447175, -77.45962912589312, -138.89291231147945, -90.83743842691183, -106.0694984793663, -67.95319152623415, -79.6896789111197, -80.05240455642343], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423301264315156, "mean_inference_ms": 4.552484560230053, "mean_action_processing_ms": 4.21073572481894, "mean_env_wait_ms": 3.233223895210505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6814080, "timesteps_this_iter": 131040, "agent_timesteps_total": 6814080, "timers": {"sample_time_ms": 36440.641, "sample_throughput": 3595.985, "load_time_ms": 23.241, "load_throughput": 5638306.935, "learn_time_ms": 14992.756, "learn_throughput": 8740.221, "update_time_ms": 2.32}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.88178419700125e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 150.1273600992837, "policy_loss": 0.0005681049190189907, "vf_loss": 30.024527279706838, "vf_explained_var": 0.4028920629545779, "kl": 0.0021984921222219685, "entropy": -0.37724272025528777, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6814080, "num_agent_steps_sampled": 6814080, "num_steps_trained": 6814080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6814080}, "done": false, "episodes_total": 13920, "training_iteration": 52, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-09-04", "timestamp": 1691021344, "time_this_iter_s": 39.2076358795166, "time_total_s": 1667.8753170967102, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1667.8753170967102, "timesteps_since_restore": 6814080, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 44.21607142857142, "ram_util_percent": 51.30178571428572}}
{"episode_reward_max": -29.48738618940115, "episode_reward_min": -268.978927731514, "episode_reward_mean": -129.67737143543548, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-121.74910982698202, -113.54418990015984, -264.3468574285507, -113.53555002808571, -104.39925502985716, -143.9453164190054, -140.71309001743793, -113.57543649617583, -246.553920596838, -144.8950297832489, -148.38588908314705, -246.29024677351117, -133.38210898637772, -89.99147065728903, -126.27525002881885, -122.48419313132763, -89.9246069714427, -149.0020357631147, -219.563321121037, -216.11646111309528, -195.55395277403295, -185.24696511030197, -231.83474300988019, -59.931432977318764, -44.67935797199607, -223.76013777405024, -96.60820293053985, -238.37814915925264, -120.851030215621, -105.86600558459759, -101.53661936894059, -268.978927731514, -96.88997058942914, -89.06594914570451, -118.35746671631932, -89.94327925145626, -124.6354147568345, -78.8500804901123, -29.48738618940115, -117.47421838715672, -125.322181917727, -85.81154278665781, -122.1344750970602, -118.15546386688948, -109.50015304982662, -111.9967865422368, -118.37977911531925, -144.06568288058043, -122.79790100455284, -154.4644956588745, -87.54751276224852, -240.34546085447073, -124.5653215572238, -94.39838256686926, -162.13880398869514, -148.03345207124949, -103.0166637301445, -133.9745727851987, -124.72789407521486, -82.74615385383368, -118.39853176660836, -86.14824514091015, -134.44900596886873, -111.43522119522095, -57.974961560219526, -131.1776822246611, -104.39122246205807, -103.98609111458063, -116.20447029173374, -122.2304425612092, -124.09437791258097, -103.34667896851897, -85.398043949157, -119.24027105420828, -108.01625376194715, -136.50501945614815, -89.37597257643938, -121.38372531533241, -129.30731668323278, -267.70944733917713, -102.18615755066276, -130.7039649412036, -119.87659092247486, -140.30000170320272, -162.08789774030447, -102.56643887981772, -91.19104730337858, -84.76450558751822, -134.00034120678902, -225.26887952536345, -137.4306744635105, -106.19277708977461, -238.71482253447175, -77.45962912589312, -138.89291231147945, -90.83743842691183, -106.0694984793663, -67.95319152623415, -79.6896789111197, -80.05240455642343], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406054070088616, "mean_inference_ms": 4.538328321378355, "mean_action_processing_ms": 4.1546145931016945, "mean_env_wait_ms": 3.202797738037683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 6945120, "timesteps_this_iter": 131040, "agent_timesteps_total": 6945120, "timers": {"sample_time_ms": 34024.193, "sample_throughput": 3851.377, "load_time_ms": 21.486, "load_throughput": 6098991.488, "learn_time_ms": 15003.699, "learn_throughput": 8733.847, "update_time_ms": 2.315}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.440892098500625e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 130.50811580762448, "policy_loss": -0.000954801745049758, "vf_loss": 26.102198166659228, "vf_explained_var": 0.46351184917607186, "kl": 0.002166382115652224, "entropy": -0.3802283041472931, "entropy_coeff": 0.001}}}, "num_steps_sampled": 6945120, "num_agent_steps_sampled": 6945120, "num_steps_trained": 6945120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 6945120}, "done": false, "episodes_total": 13920, "training_iteration": 53, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-09-19", "timestamp": 1691021359, "time_this_iter_s": 15.320653676986694, "time_total_s": 1683.195970773697, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1683.195970773697, "timesteps_since_restore": 6945120, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 13.85, "ram_util_percent": 51.5}}
{"episode_reward_max": -36.71280101686716, "episode_reward_min": -332.8162088692188, "episode_reward_mean": -128.49135495316878, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-249.27448971569538, -116.65321396291256, -89.74644616991282, -98.23636917769909, -138.1746409162879, -136.4556228965521, -245.50150028802454, -98.88348316028714, -245.01636209711432, -61.7037031725049, -65.7882828861475, -318.7062624171376, -97.05179282277822, -231.8789407350123, -94.18145796656609, -109.36265701800585, -117.74206309020519, -68.28935705497861, -102.90273285657167, -113.11407980695367, -101.81964185182005, -70.08603506535292, -116.74352616816759, -107.58375634625554, -121.88616995513439, -136.8495456557721, -92.41118755564094, -216.53917546197772, -182.42824652418494, -88.94007922708988, -116.21359051764011, -137.7638975456357, -115.08330497145653, -321.38356494903564, -324.3566761687398, -128.45883547514677, -103.23102395236492, -231.8722661137581, -126.66880702972412, -176.2885997965932, -118.2510406896472, -215.9189741872251, -140.9987858682871, -122.60419312864542, -91.75475000590086, -104.69421136751771, -101.20280508697033, -109.874132797122, -126.6371450945735, -251.4462714791298, -97.11382754892111, -83.85341404005885, -91.41065840050578, -73.3717221133411, -132.9908011853695, -122.95400638878345, -89.80034378916025, -109.22882847487926, -70.5773963406682, -216.6511177122593, -59.05525200068951, -81.42168623581529, -90.10891153663397, -112.86859300732613, -216.25451205670834, -109.8639947772026, -73.01381163671613, -88.37071865797043, -256.09832060337067, -169.1337432488799, -134.59776628017426, -89.65469060838223, -325.21715150400996, -86.7456458248198, -104.26760471612215, -94.83120715618134, -100.32405480742455, -68.67405188083649, -262.12571512907743, -290.6612852588296, -93.63271438330412, -96.50142042338848, -248.74661049991846, -76.05915669351816, -280.60480569675565, -79.72342878952622, -151.29980640858412, -87.99107243865728, -190.00401470065117, -165.4217113479972, -306.1278753131628, -123.22172439098358, -218.04686326533556, -242.22863532230258, -177.17376305162907, -98.18287026509643, -140.03930113464594, -67.8263302333653, -97.94272984191775, -99.83143693581223, -144.21297925710678, -39.346517123281956, -130.28019074350595, -85.8353812545538, -88.01219622790813, -85.34561067074537, -125.06137514859438, -87.51784911751747, -140.43003436923027, -99.3087942712009, -63.454230062663555, -216.55454875528812, -127.1466259881854, -95.74308086931705, -83.17026906460524, -69.79181685298681, -203.8784555271268, -102.79584416002035, -106.14741978794336, -86.96607532352209, -224.4949791058898, -236.96053579077125, -89.33287317492068, -255.49441643804312, -90.64476696401834, -128.83653559535742, -126.62605781853199, -77.79579838365316, -90.62645321339369, -98.67353188246489, -247.52906462084502, -118.69749672710896, -113.06145817786455, -119.06166952848434, -94.71369585208595, -96.58854114683345, -115.72684716433287, -80.45979043841362, -130.626564335078, -97.60195914655924, -39.1941247060895, -90.64135984703898, -112.80417577177286, -99.92274479568005, -96.08825431391597, -82.74495131894946, -184.42051956802607, -233.97278501838446, -144.39012177288532, -45.663753278553486, -146.04023550450802, -286.0525118820369, -79.1619365401566, -89.3220301065594, -288.0749247819185, -53.05037358775735, -67.43693922460079, -82.07418654114008, -153.3534734249115, -86.27891452610493, -67.18432331085205, -54.97576027736068, -103.72281328588724, -76.72887905687094, -36.71280101686716, -134.6163254957646, -134.6431879736483, -122.0184917896986, -250.33774391189218, -128.9214228093624, -224.48859747499228, -116.10233291983604, -63.61208415776491, -116.46751983463764, -102.59640245884657, -175.1866439729929, -213.9780306071043, -124.45316898450255, -57.51082210987806, -56.13874638825655, -83.51343604922295, -57.44928280264139, -79.2750944942236, -65.27624413371086, -99.27502461150289, -120.82520506531, -201.53452207893133, -154.871514339, -108.61871033534408, -121.50554908066988, -106.29963822476566, -118.37753351032734, -70.68885470181704, -232.71857017558068, -62.525506515055895, -250.80957052856684, -156.04362839460373, -65.9201197847724, -143.3925950229168, -191.96790574863553, -215.11777356639504, -121.52268682047725, -108.58500315248966, -109.67700523138046, -96.6273140758276, -118.14055442065, -99.38867122679949, -79.42511270940304, -111.21318925917149, -99.00887207686901, -247.66799032501876, -182.97817865014076, -125.3164049834013, -128.68757293373346, -110.00343485176563, -284.0416374206543, -112.86850332468748, -130.61521267145872, -126.48022304475307, -296.51290656626225, -104.01788607984781, -138.53235275298357, -305.91209088265896, -102.51405981555581, -138.96470475196838, -107.01768175512552, -118.52929186820984, -155.62428580224514, -132.10975750535727, -136.67432071268559, -58.180905640125275, -302.28538060188293, -127.07551980018616, -110.90621634572744, -129.59625820815563, -105.25460790842772, -102.68378600198776, -165.28914663940668, -68.92399426177144, -110.11258193850517, -156.77170727029443, -97.85388028435409, -128.6827867757529, -71.90330544859171, -139.71145908534527, -121.96526028215885, -104.67537006735802, -138.7650277763605, -144.73697456903756, -121.82141287624836, -108.47033137828112, -86.8794222548604, -205.11713956668973, -125.62765763700008, -119.89866385236382, -76.46067022532225, -102.4069939777255, -122.40507024340332, -129.94642736017704, -65.42464138567448, -300.84393883496523, -131.6113765463233, -60.746129769831896, -80.98283625394106, -181.87375569343567, -68.04515822604299, -144.9357290789485, -100.2575421705842, -113.84009851515293, -140.42566512525082, -49.36497001349926, -85.4014561586082, -105.52588776499033, -101.444221585989, -268.9008794352412, -92.68527325987816, -228.16331469640136, -78.85287115350366, -92.7627580538392, -132.62121880613267, -86.20473845303059, -113.35113990306854, -81.34783051908016, -58.687241688370705, -210.01123662292957, -113.65436322242022, -94.716558650136, -78.84462013840675, -105.571030177176, -264.3502151668072, -92.19678878039122, -89.25944466143847, -266.0907660201192, -111.66174221783876, -78.07147062569857, -100.51221273094416, -112.65591202676296, -180.43171721696854, -124.39681138843298, -211.90700948610902, -67.9474024400115, -136.62922034412622, -103.93255435675383, -123.02124676853418, -57.81950695998967, -99.04087380319834, -125.96562576293945, -95.83096551895142, -121.84136873483658, -120.77327473461628, -75.52958302944899, -80.14597560092807, -87.28167963400483, -242.57820537686348, -120.65911254659295, -158.34228855371475, -112.17543315142393, -220.4140793904662, -145.8083535656333, -139.1403520964086, -81.66806445270777, -80.03522934764624, -279.6127855926752, -149.51726523041725, -119.86016479879618, -132.14223688095808, -92.88836837932467, -269.9789949506521, -153.93745986372232, -130.450155839324, -103.36702255904675, -99.19311261177063, -126.21231136098504, -137.87589303404093, -98.40885796397924, -110.37250663712621, -83.14227513223886, -229.43808721750975, -97.39674028009176, -81.93762518465519, -71.49764581769705, -132.45745453983545, -263.06005281209946, -141.22027450054884, -115.67553093284369, -93.3894178122282, -144.70535966008902, -104.21321683377028, -94.71716117858887, -262.86138263344765, -122.44056104123592, -56.75967822223902, -139.13966385275126, -144.27188416197896, -53.49499525874853, -156.50795722194016, -117.48990720510483, -82.30047264695168, -75.5360234901309, -106.8538199737668, -134.43161042034626, -127.5038972273469, -108.54300747811794, -111.78974092751741, -156.2161896377802, -83.31606248021126, -80.9885248169303, -225.95713499747217, -87.86920081079006, -66.40896658599377, -114.83098373934627, -124.6857658661902, -75.60028316825628, -153.75891037285328, -109.26116124540567, -114.48632618039846, -70.16474023833871, -91.6522336602211, -56.53418555855751, -76.04448352754116, -134.44189446419477, -111.51354495435953, -146.4315009713173, -86.95064508914948, -236.42888720333576, -113.46897977590561, -60.41661584191024, -119.88349179923534, -101.81706964969635, -107.39624738693237, -84.70239469408989, -135.09057335555553, -92.13010906428099, -105.4960114583373, -89.47775290720165, -123.84032589197159, -149.830006852746, -91.13415180891752, -112.40339325368404, -80.8489283323288, -113.7206358909607, -219.45861553773284, -221.85892235860229, -97.37020071968436, -170.8736655563116, -94.76658321171999, -84.28973296284676, -80.41573533415794, -248.4826093763113, -94.01870203018188, -154.73605684936047, -95.5968892686069, -82.18319634348154, -99.57909159362316, -90.46974642574787, -136.94606199860573, -332.8162088692188, -117.48959800601006, -113.85132860392332, -104.24722690880299, -123.2498120367527, -102.96288259327412, -206.02188435196877, -115.85462392121553, -255.03493523597717, -79.96869803965092, -105.5777010563761, -116.77997287362814, -78.56286846473813, -128.76645411551, -109.69455163925886, -186.67391266673803, -48.64441788941622, -150.2328749075532, -269.589917704463, -82.1184282451868, -240.43549767136574, -153.96398606151342, -93.64026289433241, -61.95204217731953, -106.31857605278492, -78.27009085565805, -67.76289315894246, -93.81425818428397, -185.88867108151317, -217.07229389250278, -91.85719482600689, -117.61956857144833, -112.28622691333294, -274.56143882125616, -113.41630074009299, -62.10129491239786, -69.38452246040106, -64.33226324617863, -138.64455836638808, -69.5099150761962, -89.69273813813925, -66.14682497829199, -96.64813816547394, -115.10460802167654, -285.3647045940161, -102.88262858986855, -115.0112886056304, -94.09210489690304, -59.91548853367567, -77.26436658203602, -120.57081912085414, -92.20511340349913, -84.68489064648747, -128.18294326215982, -99.93124400824308, -278.1373043358326, -128.11992514133453, -142.7010117918253, -106.99029715359211, -101.52688899822533, -69.08976190164685, -267.6020423155278, -90.99856881052256, -118.75816072523594], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423525692746454, "mean_inference_ms": 4.5525111455283716, "mean_action_processing_ms": 4.21030341642634, "mean_env_wait_ms": 3.2315301560255856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7076160, "timesteps_this_iter": 131040, "agent_timesteps_total": 7076160, "timers": {"sample_time_ms": 36440.19, "sample_throughput": 3596.03, "load_time_ms": 23.633, "load_throughput": 5544693.214, "learn_time_ms": 15000.331, "learn_throughput": 8735.807, "update_time_ms": 2.296}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2204460492503126e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 126.40455694876272, "policy_loss": 0.0035036650173138556, "vf_loss": 25.277024269104004, "vf_explained_var": 0.4597003342430224, "kl": 0.0019386447437403382, "entropy": -0.3838218507694087, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7076160, "num_agent_steps_sampled": 7076160, "num_steps_trained": 7076160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7076160}, "done": false, "episodes_total": 14400, "training_iteration": 54, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-09-59", "timestamp": 1691021399, "time_this_iter_s": 39.34161186218262, "time_total_s": 1722.5375826358795, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1722.5375826358795, "timesteps_since_restore": 7076160, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 44.14821428571429, "ram_util_percent": 51.25714285714285}}
{"evaluation": {"episode_reward_max": -68.43909560516477, "episode_reward_min": -68.43909560516477, "episode_reward_mean": -68.43909560516477, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.43909560516477], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -48.64441788941622, "episode_reward_min": -332.8162088692188, "episode_reward_mean": -125.41060987027362, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.44189446419477, -111.51354495435953, -146.4315009713173, -86.95064508914948, -236.42888720333576, -113.46897977590561, -60.41661584191024, -119.88349179923534, -101.81706964969635, -107.39624738693237, -84.70239469408989, -135.09057335555553, -92.13010906428099, -105.4960114583373, -89.47775290720165, -123.84032589197159, -149.830006852746, -91.13415180891752, -112.40339325368404, -80.8489283323288, -113.7206358909607, -219.45861553773284, -221.85892235860229, -97.37020071968436, -170.8736655563116, -94.76658321171999, -84.28973296284676, -80.41573533415794, -248.4826093763113, -94.01870203018188, -154.73605684936047, -95.5968892686069, -82.18319634348154, -99.57909159362316, -90.46974642574787, -136.94606199860573, -332.8162088692188, -117.48959800601006, -113.85132860392332, -104.24722690880299, -123.2498120367527, -102.96288259327412, -206.02188435196877, -115.85462392121553, -255.03493523597717, -79.96869803965092, -105.5777010563761, -116.77997287362814, -78.56286846473813, -128.76645411551, -109.69455163925886, -186.67391266673803, -48.64441788941622, -150.2328749075532, -269.589917704463, -82.1184282451868, -240.43549767136574, -153.96398606151342, -93.64026289433241, -61.95204217731953, -106.31857605278492, -78.27009085565805, -67.76289315894246, -93.81425818428397, -185.88867108151317, -217.07229389250278, -91.85719482600689, -117.61956857144833, -112.28622691333294, -274.56143882125616, -113.41630074009299, -62.10129491239786, -69.38452246040106, -64.33226324617863, -138.64455836638808, -69.5099150761962, -89.69273813813925, -66.14682497829199, -96.64813816547394, -115.10460802167654, -285.3647045940161, -102.88262858986855, -115.0112886056304, -94.09210489690304, -59.91548853367567, -77.26436658203602, -120.57081912085414, -92.20511340349913, -84.68489064648747, -128.18294326215982, -99.93124400824308, -278.1373043358326, -128.11992514133453, -142.7010117918253, -106.99029715359211, -101.52688899822533, -69.08976190164685, -267.6020423155278, -90.99856881052256, -118.75816072523594], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408261712215396, "mean_inference_ms": 4.54043171102969, "mean_action_processing_ms": 4.155790028659869, "mean_env_wait_ms": 3.2024945459962306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7207200, "timesteps_this_iter": 131040, "agent_timesteps_total": 7207200, "timers": {"sample_time_ms": 34013.354, "sample_throughput": 3852.605, "load_time_ms": 21.911, "load_throughput": 5980687.536, "learn_time_ms": 14993.621, "learn_throughput": 8739.717, "update_time_ms": 2.202}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1102230246251563e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 124.82624145073379, "policy_loss": -0.0021976362589407454, "vf_loss": 24.96705873892726, "vf_explained_var": 0.4189420982287349, "kl": 0.0019825264257812827, "entropy": -0.38762787587967396, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7207200, "num_agent_steps_sampled": 7207200, "num_steps_trained": 7207200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7207200}, "done": false, "episodes_total": 14400, "training_iteration": 55, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-10-14", "timestamp": 1691021414, "time_this_iter_s": 14.987762928009033, "time_total_s": 1737.5253455638885, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1737.5253455638885, "timesteps_since_restore": 7207200, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 14.109523809523811, "ram_util_percent": 51.5}}
{"episode_reward_max": -26.389891669154167, "episode_reward_min": -327.78099469840527, "episode_reward_mean": -106.23401105386534, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-123.4777747541666, -73.03994657471776, -63.75513335317373, -205.83639949560165, -127.52487052977085, -210.03765630722046, -77.17701827734709, -327.78099469840527, -115.42148109711707, -69.15858147293329, -65.78997686505318, -101.11705562472343, -119.10506154596806, -71.91056667268276, -97.52957892417908, -61.97481980919838, -105.34367648512125, -66.68094553053379, -268.8334000110626, -67.0358672067523, -63.21339210867882, -73.85488340444863, -115.35185177251697, -118.01892211288214, -160.08728746324778, -272.80666468292475, -86.95442458987236, -108.08571773767471, -86.28153975307941, -98.64291620254517, -48.44259087741375, -216.2484653107822, -146.5832605883479, -125.81872139126062, -117.91987706720829, -120.37984687834978, -235.61760281026363, -101.50147873163223, -83.56919395178556, -100.43445005640388, -90.31939222011715, -119.76199243217707, -91.89609656110406, -96.89957254379988, -75.77386501431465, -103.23764019832015, -242.08302591368556, -85.72809126228094, -82.71980543062091, -87.12945445254445, -53.05891111493111, -138.8467061445117, -95.78715149406344, -81.6779095698148, -101.9450298845768, -94.41840587928891, -105.68250876292586, -89.09214850142598, -113.93775728531182, -83.70041405409575, -46.21239073108882, -92.08106184378266, -103.62131568044424, -96.3735613822937, -86.80766986310482, -112.80800723284483, -67.8507450222969, -123.33172286115587, -102.04315603524446, -65.85670837759972, -58.401757545769215, -77.69751798734069, -95.10760392993689, -70.61974930018187, -96.07877859473228, -89.48817235976458, -100.38836672529578, -48.61503993719816, -171.49312622472644, -88.44367414340377, -78.561728566885, -115.65678841993213, -65.76933354884386, -93.69849072769284, -91.82274364680052, -75.99144275486469, -108.14628838375211, -101.59782260656357, -126.1236930899322, -114.12285566329956, -58.780959732830524, -64.74021080136299, -63.39166095107794, -238.07713318429887, -73.17769934237003, -43.52228894084692, -72.78687673807144, -107.7872622385621, -109.09267360717058, -58.220848217606544, -98.31989355385303, -225.746737588197, -103.64503269642591, -113.71271601319313, -64.76518005505204, -99.0478892698884, -129.44997956044972, -96.23777587898076, -136.61519490927458, -61.38200262002647, -140.27919671684504, -102.92936953902245, -94.64933086931705, -170.00820527225733, -128.24519633501768, -130.0287759974599, -110.60304916650057, -133.63158221542835, -88.7463395819068, -114.21167843230069, -56.4466442540288, -72.50720330327749, -81.46252519264817, -224.66335707902908, -133.51761183142662, -94.4403041061014, -104.43221106007695, -121.24865094572306, -103.75328873097897, -110.13627760484815, -92.4063918441534, -106.1083876863122, -108.93179842736572, -76.23067227005959, -47.02755667641759, -219.2746258303523, -135.79431208968163, -77.97953119501472, -112.05773697793484, -26.389891669154167, -255.9245102033019, -50.47017428278923, -61.582102954387665, -86.9848185479641, -108.07893262803555, -85.96347542479634, -118.72667024284601, -105.9607018083334, -143.68845364451408, -118.04919442348182, -245.86168557778, -86.95590493828058, -36.737711787223816, -93.4880697876215, -66.83697451651096, -123.3171930462122, -62.30951838940382, -89.30138139985502, -74.43613912910223, -81.72345227748156, -75.42053712159395, -92.72861516475677, -126.69541299343109, -66.99657979607582, -57.72619631886482, -106.65656196698546, -86.76618634909391, -75.05848128348589, -85.96016930043697, -111.3256525695324, -193.81387767381966, -121.28770534694195, -69.00456340238452, -101.17224776558578, -94.0994565486908, -109.26194963976741, -70.80848814547062, -98.00305319577456, -111.52050676196814, -268.1703331246972, -91.86872895807028, -91.24792964756489, -257.76058131456375, -77.5294222086668, -124.63336440175772, -65.98872240260243, -67.71483859419823, -115.09632209688425, -48.54866415262222, -105.69277440011501, -74.57649628818035, -105.26853687316179, -71.45643015950918, -92.38570556044579, -111.68730901926756, -90.923036377877, -114.73222879320383, -62.63893200457096, -95.84780729934573, -242.48800023645163, -101.70251584798098, -89.19065027311444, -108.91084107011557, -85.53049579262733, -148.50231067091227, -87.10306464880705, -89.76109082251787, -115.24287866055965, -83.2997856773436, -114.93459114804864, -112.16775423288345, -58.2665034532547, -212.5579534843564, -72.87937042117119, -59.82468078285456, -115.39869144558907, -125.9301625713706, -214.5303458236158, -266.3620029836893, -97.75220823287964, -225.46596014872193, -278.78806909918785, -80.7787263840437, -235.86629106849432, -102.7747419513762, -61.331690430641174, -89.94514892436564, -102.93124586716294, -49.760021306574345, -227.1805954091251, -83.60971176251769, -89.74234212934971, -107.34776256233454, -100.92717646807432, -127.88143202662468, -53.81204392760992, -114.08711168169975, -98.95010299235582, -76.20251988992095, -54.91280456632376, -50.45798655599356, -100.22235380485654, -97.18579702079296, -78.58637614548206, -103.62666914705187, -75.40314657241106, -85.69973929226398, -147.91274546086788, -65.1161217391491, -82.94253921508789, -80.0934589728713, -92.8740741237998, -41.51428294554353, -74.97877477109432, -96.12789399921894, -87.59709636867046, -127.5958394780755, -103.98303435370326, -63.24918205291033, -69.97577036172152, -143.98466185107827, -115.01379519701004, -84.49695424735546, -128.6557516530156, -146.72348269075155, -62.600945346057415, -95.91334167122841, -103.7020181119442, -97.411211758852, -92.27897953987122, -121.67223059386015, -118.9755817912519, -84.16055815666914, -52.144501067698, -102.81047135591507, -188.2482673600316, -233.36272993683815, -210.22977972775698, -119.46841141581535, -45.54000835120678, -121.51231002062559, -117.54895239323378, -100.74022810906172, -69.89453890547156, -130.39737540483475, -97.03524582833052, -62.98144283890724, -62.58697081357241, -98.52347593009472, -97.42224968224764, -87.71549624204636, -220.09393756836653, -101.85907282680273, -103.10734412819147, -144.59305602312088, -111.28850176930428, -52.540478844195604, -43.60282251611352, -118.54377825930715, -82.44597339630127, -100.73764034733176, -58.83779660612345, -111.99037948995829, -65.24504308402538, -231.73398382216692, -119.24959751218557, -126.58710347861052, -102.85625825077295, -86.10066217929125, -94.38759120553732, -98.62082226574421, -94.19382019340992, -102.29847211390734, -94.97833328694105, -103.40155317634344, -77.03682790696621, -110.0763542726636, -110.6617523431778, -106.0846474841237, -89.86514409258962, -143.28387709334493, -136.65740457177162, -103.555968798697, -72.82330504059792, -76.93109738826752, -82.76143288612366, -106.62418576516211, -80.52148878574371, -45.91571090882644, -94.24145596846938, -136.78915436565876, -89.4148326702416, -256.5046209320426, -78.37327287904918, -99.1986134648323, -104.1379619538784, -93.32252006232738, -108.60100261867046, -114.54429097659886, -53.710587322711945, -73.18975718319416, -100.42700008302927, -37.489050671458244, -73.75164697319269, -101.59483475238085, -60.25594699010253, -114.27572233043611, -87.31353491544724, -56.43872807919979, -89.85552988946438, -77.31603954359889, -92.74307320266962, -93.12541652098298, -93.97012583166361, -92.55261442065239, -36.61763971298933, -81.54277011938393, -103.7619979120791, -106.2452726624906, -99.86954101547599, -129.5896228440106, -97.79790296405554, -96.35058709979057, -86.77023258432746, -120.07444282621145, -103.36016198247671, -59.016767378896475, -80.62224371731281, -114.93535661697388, -77.05774013139307, -102.44224628061056, -109.4272997006774, -72.99857997149229, -70.18847911432385, -94.18206749483943, -114.18287908285856, -116.64394994080067, -157.10179680213332, -62.43849246762693, -103.94462843611836, -99.67125655710697, -93.23577074706554, -125.38953125849366, -110.17709308862686, -113.63665511459112, -76.04254350438714, -72.33773973584175, -83.80862309038639, -129.23241502046585, -110.23291344195604, -41.20257383584976, -100.16602921485901, -225.28701946884394, -100.59633602201939, -126.78727523982525, -214.71322389692068, -75.59086290374398, -149.10106471553445, -88.62746863812208, -114.65828589349985, -99.87376909703016, -76.55230997130275, -209.8616289012134, -105.32469639927149, -98.7478488907218, -59.76519846916199, -107.68718213960528, -113.94726837426424, -85.8774582631886, -87.7008645310998, -226.98984675854445, -98.64122665673494, -108.27320804446936, -126.82641133666039, -71.6730231270194, -97.00545417517424, -98.57580008357763, -101.78057816624641, -92.34612924233079, -73.50715759396553, -78.94967793300748, -92.17006895691156, -98.09391870722175, -89.545509185642, -82.73209858685732, -100.1480919495225, -91.62335227802396, -83.59392010048032, -79.88347148522735, -93.7444956637919, -207.9251561332494, -112.48112573474646, -59.09838004410267, -55.23003339767456, -66.02754461020231, -147.44891777262092, -231.00675116851926, -99.4072868861258, -293.8040385171771, -83.33305297791958, -120.24509965628386, -146.2173338830471, -123.69895036518574, -131.2104577999562, -95.53782731853426, -85.51586839929223, -64.534996047616, -95.8543955385685, -97.39977243542671, -107.44451985508204, -97.26596545428038, -103.42077013850212, -79.57773549109697, -98.61046905070543, -115.58677961677313, -184.31882217526436, -125.3965681642294, -89.17740426957607, -236.73557282984257, -105.41707096621394, -135.83638383448124, -122.00824389606714, -115.70519939437509, -69.01849074661732, -109.84626301750541, -78.7169484142214, -65.69500865787268, -101.98059969767928, -121.29994138143957, -71.79004633426666, -77.4434514194727, -100.53889508545399, -122.7213184311986, -69.41579156368971, -94.87100356072187, -116.14299038052559, -92.76197019219398, -230.3385328873992, -95.93921210616827, -75.50622783973813], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423837167641088, "mean_inference_ms": 4.553204067041017, "mean_action_processing_ms": 4.210596660978921, "mean_env_wait_ms": 3.231602817504535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7338240, "timesteps_this_iter": 131040, "agent_timesteps_total": 7338240, "timers": {"sample_time_ms": 36412.396, "sample_throughput": 3598.774, "load_time_ms": 23.504, "load_throughput": 5575335.548, "learn_time_ms": 14994.859, "learn_throughput": 8738.995, "update_time_ms": 2.197}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.5511151231257815e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 109.8872419715645, "policy_loss": -0.0037759366392809772, "vf_loss": 21.98083298180693, "vf_explained_var": 0.4933207953702592, "kl": 0.0020587385154166404, "entropy": -0.39177033881987294, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7338240, "num_agent_steps_sampled": 7338240, "num_steps_trained": 7338240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7338240}, "done": false, "episodes_total": 14880, "training_iteration": 56, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-10-53", "timestamp": 1691021453, "time_this_iter_s": 39.285109519958496, "time_total_s": 1776.810455083847, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1776.810455083847, "timesteps_since_restore": 7338240, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 44.34642857142857, "ram_util_percent": 50.887499999999996}}
{"episode_reward_max": -22.516820147633553, "episode_reward_min": -296.26945564337075, "episode_reward_mean": -98.87059687439275, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.6802519261837, -77.2915123179555, -212.52171597629786, -111.10569668188691, -74.19552931003273, -70.04441647604108, -76.22928945720196, -80.56203274428844, -51.69544268399477, -178.1994625106454, -210.44290160015225, -148.20665074884892, -36.956447172909975, -71.02633390575647, -112.45048462226987, -55.361070811748505, -82.14370381087065, -98.73290693759918, -68.73268314450979, -134.59907157719135, -92.6244928818196, -70.74050054326653, -69.41614703834057, -56.0691916719079, -62.42166431248188, -123.86449727416039, -142.71743872761726, -246.14834264665842, -27.38981470838189, -63.59248700737953, -27.776914324611425, -93.58568593859673, -85.9761775508523, -101.11807845532894, -120.10347535461187, -74.68703588098288, -159.59073701500893, -206.67827820777893, -77.68403209745884, -46.33940698206425, -83.61064337939024, -90.97095864266157, -67.07078866288066, -173.51626166701317, -51.12385352700949, -104.03166277706623, -92.69366602599621, -197.4931764602661, -69.62475999817252, -109.32078865170479, -57.20415513217449, -100.5080058798194, -86.57315678149462, -94.03020678460598, -77.11638177931309, -81.25456503033638, -51.82142275571823, -72.3321695998311, -23.25233754515648, -81.07089950889349, -56.96529810130596, -54.78893583267927, -36.60305029898882, -46.91277778148651, -80.94068034738302, -65.3231804817915, -158.27551224082708, -98.27859716117382, -81.1780746653676, -62.55124406144023, -66.26926306635141, -80.50724013522267, -113.34156307578087, -129.34832061827183, -76.401980612427, -64.92226215451956, -95.02874590829015, -70.86732963472605, -90.32129487022758, -125.48301562294364, -52.73857078701258, -100.73177003860474, -56.39390438050032, -211.72123296558857, -233.7739727795124, -90.2005174793303, -110.87310130149126, -64.74128798395395, -95.84412355720997, -29.14528126269579, -103.20232724491507, -71.60323937237263, -54.11011051386595, -65.07788909226656, -69.22900401800871, -90.25160065665841, -225.23111725598574, -58.513976380228996, -76.8276889771223, -92.21912547945976, -91.92741329222918, -186.77449574694037, -101.89508174359798, -94.42503543198109, -77.20364984683692, -73.10818846523762, -73.5714682713151, -100.03666368126869, -94.49050974659622, -43.836586482822895, -93.0716242864728, -110.70804823935032, -29.926754277199507, -105.69869688153267, -78.68162630498409, -62.83972792327404, -69.60877151787281, -108.59914131090045, -168.17043283209205, -78.3823254108429, -87.71534389257431, -79.1275206245482, -112.05232660472393, -122.94847452640533, -78.65872001647949, -99.88358667492867, -81.06625634804368, -81.85061122477055, -94.07239705324173, -131.2409204542637, -69.2447537779808, -55.0922876521945, -74.80660318955779, -217.77986630797386, -74.65162835270166, -123.38473242893815, -257.2796378210187, -56.04786049108952, -68.35901673138142, -208.90052308142185, -73.18274115025997, -90.96272990852594, -222.08313912153244, -82.0752173550427, -83.78224514424801, -152.31834323704243, -109.866530418396, -68.07100335508585, -94.90550338476896, -112.55593835376203, -214.2016206458211, -80.53187185525894, -80.27895503491163, -80.83893116936088, -106.14651012420654, -93.31045784056187, -82.21661587059498, -72.33890386298299, -59.849799923598766, -102.91808903217316, -77.92243757471442, -118.58783807046711, -126.61080262809992, -74.69348432868719, -70.01237282902002, -33.119701862335205, -85.83915995061398, -62.498071394860744, -96.0442678630352, -44.479359209537506, -67.9539303034544, -82.63294833526015, -50.86535497754812, -134.28558290749788, -106.27934036403894, -116.51645030640066, -81.82364906743169, -90.96301823109388, -58.62522478401661, -88.12056389451027, -54.314332380890846, -46.150961209088564, -69.93452487885952, -102.54730854928493, -103.41584914550185, -72.15156824141741, -294.72261571884155, -71.87568344920874, -171.24618128687143, -56.7884458610788, -112.64382940530777, -71.37497388198972, -76.55517191439867, -88.41685747355223, -195.4222683608532, -88.19888877868652, -89.58722039684653, -88.47836349159479, -39.550817012786865, -62.300275195389986, -197.43669515103102, -80.5969907194376, -64.07121513038874, -97.85224626213312, -68.3787837550044, -159.5204335451126, -84.88134775683284, -296.26945564337075, -60.3868550285697, -70.33392118662596, -90.38129613548517, -76.63631181418896, -82.87893327698112, -220.22230245172977, -72.88257087022066, -82.4119585826993, -70.33017826080322, -79.37052359431982, -48.016850024461746, -70.45891823992133, -110.95749512314796, -46.246905382722616, -92.01915299147367, -184.57296845316887, -78.44487079977989, -75.0777071788907, -210.2481804229319, -111.66810984164476, -91.7631491869688, -41.73629151284695, -42.021556640043855, -255.18554109334946, -97.80759141594172, -136.2312482148409, -93.83408742398024, -97.5800254791975, -84.06481609866023, -74.9266456887126, -70.93076118454337, -69.31009850278497, -86.10678677260876, -92.7022712007165, -73.80797467194498, -94.36072278395295, -78.11259765550494, -76.58370725810528, -50.90028126910329, -80.77818048000336, -74.81746546924114, -95.3929181471467, -223.05702640488744, -73.57809225469828, -78.2146345693618, -100.41559468954802, -132.21851045638323, -107.62649109214544, -201.97728531062603, -70.80862381309271, -92.46526325121522, -63.752324149012566, -210.43827233463526, -66.9945474639535, -58.49979417771101, -92.78305503726006, -71.60897801443934, -125.98680239543319, -231.50375263765454, -238.47735961526632, -111.8913611099124, -56.92891961336136, -215.93113133311272, -124.7906986027956, -72.1844689771533, -58.49821315333247, -67.7537801116705, -85.22548919916153, -74.20141393318772, -71.69957818835974, -58.41552456468344, -73.00938909128308, -111.55279411375523, -250.1809619627893, -84.78109841793776, -119.73811918497086, -105.78840882331133, -85.74006391875446, -53.021000534296036, -194.6569995880127, -54.08558198437095, -99.48356528580189, -122.18533666431904, -81.41384141892195, -135.99132669717073, -87.8158291131258, -230.89274138957262, -63.81940747052431, -89.20892374962568, -91.72541439160705, -65.22766752541065, -77.31225736439228, -70.84998889267445, -66.96770242601633, -71.87426999211311, -76.27458290755749, -267.687272593379, -103.19265764206648, -90.92736496776342, -41.593168783932924, -98.3921947106719, -108.8775276914239, -77.04263482242823, -101.16302846372128, -69.59345956146717, -81.34873276948929, -115.2311191149056, -180.48282146453857, -73.8870623940602, -85.88683049380779, -83.49693159759045, -109.29028480499983, -106.88694172352552, -108.39612267911434, -90.11316760629416, -56.07624354213476, -280.2571005821228, -55.148214338347316, -22.516820147633553, -55.521830290555954, -202.7534885406494, -76.28058720380068, -83.09993579238653, -86.41300670057535, -95.11283929646015, -74.4145057797432, -95.15334299579263, -94.6159419156611, -124.30025454610586, -218.1725234091282, -199.5097731165588, -69.02970097959042, -24.627735253423452, -119.61681371182203, -76.13103496283293, -56.84198325872421, -158.36329028010368, -71.55770610272884, -57.7186471670866, -64.94358206912875, -69.58672069758177, -291.12507527321577, -80.67834690213203, -53.63845890760422, -77.64234950393438, -65.51393534243107, -209.0811025314033, -78.0097089856863, -149.93930396437645, -61.06561614573002, -116.51913620904088, -51.35722065158188, -34.015953190624714, -72.289689745754, -207.26711662858725, -81.54302651435137, -69.99358131363988, -54.81080463528633, -60.155410181730986, -65.4359543249011, -107.63914130628109, -59.294019527733326, -94.80743137001991, -57.733240991830826, -84.82106274366379, -58.64555002748966, -73.62512338906527, -39.129601150751114, -58.17846081405878, -88.61038206517696, -131.41567473113537, -58.63689498975873, -94.18091656267643, -85.32429084926844, -77.91723098605871, -72.4216887652874, -78.67714539170265, -58.87096570804715, -77.80848203226924, -225.49066827446222, -106.85758045315742, -51.22103513404727, -125.72830297797918, -81.75731343775988, -86.62311579100788, -58.30270415917039, -103.30088893324137, -75.43837556242943, -97.05248361080885, -109.89394211769104, -71.2083509862423, -76.43206409737468, -62.739108588546515, -87.35233439132571, -87.1856956705451, -180.97942129522562, -77.90252136439085, -68.95288209989667, -180.2057204246521, -61.15421299263835, -97.46746644750237, -118.09783886745572, -96.05291573703289, -79.56141896545887, -76.8715630620718, -60.867491744458675, -36.19066767767072, -87.51117553561926, -102.83025987446308, -63.665797866880894, -71.614397585392, -177.07436797767878, -70.38627616688609, -63.847080148756504, -91.95437077432871, -53.80408401042223, -89.57445569336414, -217.0617173090577, -148.860849134624, -241.2183930799365, -92.14803762733936, -71.56761883199215, -60.50046790577471, -175.80314195901155, -219.35874248854816, -96.30112773552537, -70.56118835508823, -245.40279045701027, -108.15820200741291, -56.96748337894678, -56.898094937205315, -218.14811603724957, -81.5800113901496, -61.908223547041416, -77.31721413135529, -80.56840229406953, -84.05048070847988, -104.66396093182266, -149.92778810486197, -71.41854034364223, -175.96379305049777, -71.32666610181332, -80.77836413308978, -61.96495705842972, -205.27934651821852, -100.34431029856205, -74.7215004004538, -114.46616593003273, -72.86370107531548, -129.31619143858552, -90.71828950196505, -86.6418458968401, -272.61617167666554, -112.30389984697104, -63.32134447991848, -82.46069211512804, -57.270231045782566, -62.12128043174744, -75.34638956934214, -75.9227284565568, -92.92346180975437, -93.7696093171835, -101.69968141615391, -59.07912067323923, -93.76343935728073, -51.10056497901678, -129.1447876766324, -88.90182226896286, -288.0885137580335, -70.7484212256968, -79.17173404991627, -236.93811182677746], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425220342230138, "mean_inference_ms": 4.554284701384764, "mean_action_processing_ms": 4.210236509741079, "mean_env_wait_ms": 3.2322132618941493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7469280, "timesteps_this_iter": 131040, "agent_timesteps_total": 7469280, "timers": {"sample_time_ms": 36431.976, "sample_throughput": 3596.84, "load_time_ms": 23.188, "load_throughput": 5651310.528, "learn_time_ms": 14998.855, "learn_throughput": 8736.667, "update_time_ms": 2.229}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7755575615628907e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 108.86689855115733, "policy_loss": 0.0027491099405090955, "vf_loss": 21.770226247849003, "vf_explained_var": 0.49274676354555247, "kl": 0.002345669280034974, "entropy": -0.4047340602750847, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7469280, "num_agent_steps_sampled": 7469280, "num_steps_trained": 7469280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7469280}, "done": false, "episodes_total": 15360, "training_iteration": 57, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-11-33", "timestamp": 1691021493, "time_this_iter_s": 39.638012409210205, "time_total_s": 1816.4484674930573, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1816.4484674930573, "timesteps_since_restore": 7469280, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 43.97192982456141, "ram_util_percent": 51.294736842105266}}
{"episode_reward_max": -36.19066767767072, "episode_reward_min": -288.0885137580335, "episode_reward_mean": -102.99818800874054, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.18091656267643, -85.32429084926844, -77.91723098605871, -72.4216887652874, -78.67714539170265, -58.87096570804715, -77.80848203226924, -225.49066827446222, -106.85758045315742, -51.22103513404727, -125.72830297797918, -81.75731343775988, -86.62311579100788, -58.30270415917039, -103.30088893324137, -75.43837556242943, -97.05248361080885, -109.89394211769104, -71.2083509862423, -76.43206409737468, -62.739108588546515, -87.35233439132571, -87.1856956705451, -180.97942129522562, -77.90252136439085, -68.95288209989667, -180.2057204246521, -61.15421299263835, -97.46746644750237, -118.09783886745572, -96.05291573703289, -79.56141896545887, -76.8715630620718, -60.867491744458675, -36.19066767767072, -87.51117553561926, -102.83025987446308, -63.665797866880894, -71.614397585392, -177.07436797767878, -70.38627616688609, -63.847080148756504, -91.95437077432871, -53.80408401042223, -89.57445569336414, -217.0617173090577, -148.860849134624, -241.2183930799365, -92.14803762733936, -71.56761883199215, -60.50046790577471, -175.80314195901155, -219.35874248854816, -96.30112773552537, -70.56118835508823, -245.40279045701027, -108.15820200741291, -56.96748337894678, -56.898094937205315, -218.14811603724957, -81.5800113901496, -61.908223547041416, -77.31721413135529, -80.56840229406953, -84.05048070847988, -104.66396093182266, -149.92778810486197, -71.41854034364223, -175.96379305049777, -71.32666610181332, -80.77836413308978, -61.96495705842972, -205.27934651821852, -100.34431029856205, -74.7215004004538, -114.46616593003273, -72.86370107531548, -129.31619143858552, -90.71828950196505, -86.6418458968401, -272.61617167666554, -112.30389984697104, -63.32134447991848, -82.46069211512804, -57.270231045782566, -62.12128043174744, -75.34638956934214, -75.9227284565568, -92.92346180975437, -93.7696093171835, -101.69968141615391, -59.07912067323923, -93.76343935728073, -51.10056497901678, -129.1447876766324, -88.90182226896286, -288.0885137580335, -70.7484212256968, -79.17173404991627, -236.93811182677746], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408140087423421, "mean_inference_ms": 4.54332754498786, "mean_action_processing_ms": 4.155612455431278, "mean_env_wait_ms": 3.202103433575467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7600320, "timesteps_this_iter": 131040, "agent_timesteps_total": 7600320, "timers": {"sample_time_ms": 36441.37, "sample_throughput": 3595.913, "load_time_ms": 23.187, "load_throughput": 5651496.479, "learn_time_ms": 15002.355, "learn_throughput": 8734.629, "update_time_ms": 2.232}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3877787807814454e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 110.19540602635826, "policy_loss": -0.0021522105737984184, "vf_loss": 22.04083055065524, "vf_explained_var": 0.5028881038602535, "kl": 0.0020266109818799626, "entropy": -0.4032403269121724, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7600320, "num_agent_steps_sampled": 7600320, "num_steps_trained": 7600320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7600320}, "done": false, "episodes_total": 15360, "training_iteration": 58, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-11-48", "timestamp": 1691021508, "time_this_iter_s": 15.271441459655762, "time_total_s": 1831.719908952713, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1831.719908952713, "timesteps_since_restore": 7600320, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 13.71818181818182, "ram_util_percent": 51.599999999999994}}
{"episode_reward_max": -6.424863982945681, "episode_reward_min": -283.11388463154435, "episode_reward_mean": -89.3421378579631, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.37508784234524, -84.1087552383542, -55.612175427377224, -34.86545119062066, -75.44593173265457, -45.5961621850729, -79.58930294215679, -72.56578753143549, -116.05125517770648, -67.83164857327938, -64.14306954666972, -98.35792460292578, -84.78442430496216, -59.5951303653419, -108.32739289104939, -61.275201842188835, -76.38134111464024, -92.02447494864464, -105.79379721730947, -86.57732063159347, -74.7858519256115, -34.64886289462447, -78.00316862761974, -85.12313240021467, -47.90944831818342, -115.37442747689784, -56.49146766588092, -122.30320405960083, -109.71315036714077, -60.07917008548975, -84.80050471425056, -67.39649265632033, -99.62996689975262, -47.74460889399052, -91.1705261617899, -80.03276176005602, -90.50625452399254, -65.7978959903121, -99.75652468949556, -88.673593275249, -80.0633577555418, -94.33321855962276, -119.43203288316727, -113.35561753809452, -72.6944639198482, -34.191892728209496, -49.91822279244661, -95.14483188465238, -32.4104869812727, -48.173086065799, -82.61156726628542, -65.29366954416037, -68.78616915643215, -40.51887138560414, -71.77521569654346, -54.46909162402153, -155.0845666900277, -71.15766377002001, -81.00920702144504, -70.91610004752874, -137.53243931382895, -84.24196664988995, -100.29006887599826, -16.994305405765772, -247.57910235226154, -72.11186358332634, -102.43866793066263, -72.92440778017044, -83.7897341772914, -71.5676544457674, -69.91100323945284, -65.83345848321915, -60.88113410398364, -23.180965304374695, -43.03384055569768, -76.6435974612832, -48.65872561186552, -82.56365359574556, -62.53190644830465, -89.30515184532851, -97.39311353117228, -80.19259140640497, -112.30159452557564, -65.48270615004003, -63.8160033673048, -90.09916318953037, -148.0174718722701, -37.89965321868658, -219.61263523623347, -215.61348909139633, -46.473364159464836, -80.40516719967127, -109.24024133384228, -73.92792843654752, -93.36288884282112, -56.46011583507061, -60.25984437763691, -46.785491863265634, -210.02931539341807, -66.95929126441479, -233.32980498299003, -266.12374202907085, -107.38169158250093, -52.26698625087738, -107.76374188810587, -87.72840808331966, -65.69214327633381, -67.4158418700099, -100.2811882942915, -49.21298974752426, -66.26235345005989, -266.88643814623356, -233.93415328115225, -201.07294303923845, -231.28506775945425, -50.48147001117468, -51.04583704844117, -89.91224925592542, -69.06562561541796, -28.735945239663124, -77.82669935747981, -66.74457875266671, -132.30557115375996, -208.81037984788418, -79.58000073581934, -22.75222860276699, -71.68435468524694, -64.2238277643919, -126.48956943675876, -202.77856206148863, -86.51166995614767, -13.570732317864895, -69.02112440764904, -57.38325138017535, -66.92492041736841, -78.76175677776337, -49.307590547949076, -204.15147808939219, -126.94263700023293, -72.5315402969718, -94.52217542380095, -48.62994881719351, -73.62001923285425, -221.52626770734787, -102.01596171408892, -183.99290581420064, -14.054268892854452, -94.9961730465293, -25.0927886813879, -108.18188043683767, -72.48124966025352, -256.84193731099367, -235.29324498027563, -197.04875667393208, -55.96643824875355, -75.63891588151455, -53.84092465043068, -59.145243525505066, -66.72259954735637, -72.50648599117994, -47.363855980336666, -113.42039515823126, -115.7954814247787, -77.21497371047735, -48.39631801843643, -59.11301901191473, -112.98817282915115, -63.16449627280235, -46.110545344650745, -112.53602640330791, -94.06653551198542, -95.64250927791, -69.598040394485, -139.96674555912614, -84.83795599639416, -74.01995804160833, -74.02296687662601, -90.139976978302, -68.3542419411242, -97.112796921283, -75.11972827836871, -187.80520065128803, -109.08572184294462, -100.84593010693789, -89.13526310771704, -67.08385585993528, -79.11086050421, -78.7621485888958, -51.807881362736225, -57.17719665169716, -6.424863982945681, -40.583742797374725, -79.69383015483618, -62.57193744182587, -63.737477116286755, -72.60777892544866, -46.48134274408221, -63.60849752277136, -127.9075857102871, -42.63178337365389, -88.95560966432095, -64.06631446257234, -27.186043933033943, -70.62384542822838, -184.7899295464158, -99.72156509757042, -96.73561502993107, -96.43445994704962, -54.007752537727356, -66.96750769019127, -66.27362520620227, -88.84776329621673, -82.17669043689966, -83.00499621778727, -55.86853512376547, -74.67081312090158, -51.76785332709551, -67.40623071789742, -110.68983621150255, -65.72554302960634, -63.26173982024193, -51.900579042732716, -186.96882681548595, -67.78916236758232, -84.77278541773558, -78.8059783577919, -73.02261945605278, -62.70689780265093, -40.922136411070824, -82.9580842256546, -57.45729136839509, -99.82703896611929, -52.199194558896124, -123.1276109367609, -64.20341907441616, -87.23867329955101, -60.56041418761015, -52.478659592568874, -90.5618449896574, -50.98224089294672, -41.11160679906607, -118.36967321485281, -61.806386813521385, -128.2802042067051, -77.56578277796507, -124.05376258119941, -135.89118139073253, -59.276490449905396, -74.41911193728447, -93.1342461630702, -82.4127309396863, -38.3566525131464, -94.78422601521015, -72.87988144904375, -74.22375744208694, -224.58636958897114, -53.52603617683053, -45.29514791816473, -249.65234091877937, -26.592547811567783, -60.268142841756344, -69.08654718846083, -83.54049019515514, -92.09921107813716, -46.742731757462025, -61.175666101276875, -65.87492948770523, -237.8738119006157, -106.95405514165759, -45.07873111963272, -60.94981586560607, -79.71128065884113, -109.95571656525135, -108.11317047476768, -117.10006220638752, -101.54506044089794, -83.96902116388083, -215.10236678645015, -78.98127724602818, -60.315412532538176, -72.7088656835258, -90.65260403603315, -262.6177834123373, -55.02554729580879, -32.76677571237087, -83.18314346671104, -264.17502306215465, -98.61766304820776, -98.37273459136486, -63.07730649411678, -88.8613599985838, -104.93659348133951, -91.14963939040899, -53.12438778579235, -33.39400214701891, -63.85556432232261, -222.812220685184, -29.104084603488445, -71.63272390514612, -283.11388463154435, -188.90934968739748, -84.89843470603228, -154.95449254661798, -200.60316248983145, -100.26921205222607, -82.33937123417854, -142.35771161317825, -98.7617568820715, -49.87109286338091, -76.54231142997742, -112.11336586624384, -53.50092267990112, -110.69947843253613, -82.68478520214558, -64.73436357825994, -55.48172150924802, -77.88112004101276, -72.35054828599095, -60.21619600057602, -57.604153200984, -40.96980158984661, -86.77102514728904, -55.85854945331812, -62.753918044269085, -53.73916018754244, -62.440880104899406, -69.18863413482904, -108.643265850842, -63.91220976784825, -92.18097484111786, -88.29454620927572, -58.44747481495142, -58.07290808856487, -84.0406529456377, -49.773488733917475, -24.942451164126396, -9.423780873417854, -96.56745582818985, -22.86189614981413, -42.55150701664388, -45.02669125422835, -46.00480430573225, -139.3828959837556, -21.76676559075713, -51.90107137709856, -82.00189989060163, -61.88478767871857, -108.03252666443586, -58.16050958633423, -129.4617366436869, -61.05445804819465, -95.89931754022837, -66.1300667989999, -40.742039889097214, -110.86403330415487, -92.66339682042599, -25.879391841590405, -79.60838944464922, -67.68003871291876, -48.45198076404631, -60.24671770632267, -78.07443573325872, -82.4568274281919, -60.03976305574179, -182.10999075323343, -60.32908111065626, -69.30025006085634, -89.97979828342795, -83.25525183975697, -103.40492617338896, -90.78450336679816, -88.68105623871088, -70.97810653597116, -87.33599841594696, -55.449237540364265, -58.561500675976276, -79.5787297077477, -70.82401420176029, -70.65311466902494, -111.85418720915914, -42.241580702364445, -61.40157048031688, -247.01223169267178, -88.2157261967659, -98.11343348026276, -104.253073528409, -94.87992066144943, -70.48222639784217, -76.63441623561084, -55.532844975590706, -60.70784879475832, -81.45700408518314, -53.8950240239501, -154.06815982609987, -97.3386043459177, -77.7685376778245, -58.22417288273573, -78.40919144079089, -89.81232330203056, -44.11713954806328, -56.11419501155615, -88.52273675426841, -60.00498575344682, -74.03752497583628, -119.81667474284768, -85.50760523229837, -60.69217035546899, -236.06693965569139, -66.20818880200386, -198.02646027505398, -104.87632285058498, -87.32841426879168, -78.15479082986712, -97.72591983154416, -102.5484788492322, -244.5305570140481, -38.88832514360547, -117.36046371981502, -65.16180664300919, -229.57562201470137, -89.26644811034203, -101.30902172625065, -232.96501117944717, -113.19374933466315, -237.8010631725192, -66.13590554147959, -104.36831719428301, -66.01700921729207, -72.43819515779614, -93.23629044741392, -73.56155329942703, -39.84302306175232, -100.00248261913657, -71.66392290592194, -116.41381821781397, -260.8781877681613, -65.44030583649874, -216.11484453827143, -53.50316870957613, -59.20629647374153, -133.08875934034586, -190.12796905636787, -93.74454016983509, -111.1096970885992, -88.50749914348125, -104.03444410860538, -53.47025489062071, -68.69194971770048, -106.96703815832734, -73.91982792317867, -120.58967430889606, -58.605566918849945, -54.738813012838364, -96.7452707067132, -32.420770682394505, -184.03279587626457, -62.742665491998196, -90.63781462237239, -70.84248032234609, -99.65374781191349, -87.858329705894, -76.8348950818181, -87.97593844681978, -83.60343897342682, -59.93065543472767, -56.27687033265829, -69.98538911342621, -77.45517655089498, -233.85561250150204, -45.8252900056541, -62.30914734303951, -129.84579674899578, -83.36588750779629, -105.21038108319044, -52.71148909628391, -49.37274174019694, -92.38126718252897, -98.54554537683725, -42.42790852487087, -46.230688370764256], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426665444311957, "mean_inference_ms": 4.554176665763521, "mean_action_processing_ms": 4.210060794068615, "mean_env_wait_ms": 3.230586247954172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7731360, "timesteps_this_iter": 131040, "agent_timesteps_total": 7731360, "timers": {"sample_time_ms": 36460.303, "sample_throughput": 3594.046, "load_time_ms": 23.117, "load_throughput": 5668434.334, "learn_time_ms": 15006.317, "learn_throughput": 8732.322, "update_time_ms": 2.239}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.938893903907227e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 110.55022725198721, "policy_loss": -0.003253275058793546, "vf_loss": 22.1128922346245, "vf_explained_var": 0.47305273496976463, "kl": 0.0022249929255406227, "entropy": -0.40686551115632485, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7731360, "num_agent_steps_sampled": 7731360, "num_steps_trained": 7731360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7731360}, "done": false, "episodes_total": 15840, "training_iteration": 59, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-12-28", "timestamp": 1691021548, "time_this_iter_s": 39.487603425979614, "time_total_s": 1871.2075123786926, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1871.2075123786926, "timesteps_since_restore": 7731360, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 44.260714285714286, "ram_util_percent": 51.512499999999996}}
{"evaluation": {"episode_reward_max": -178.9351238757372, "episode_reward_min": -178.9351238757372, "episode_reward_mean": -178.9351238757372, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.9351238757372], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": -32.420770682394505, "episode_reward_min": -260.8781877681613, "episode_reward_mean": -97.15745855987072, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.241580702364445, -61.40157048031688, -247.01223169267178, -88.2157261967659, -98.11343348026276, -104.253073528409, -94.87992066144943, -70.48222639784217, -76.63441623561084, -55.532844975590706, -60.70784879475832, -81.45700408518314, -53.8950240239501, -154.06815982609987, -97.3386043459177, -77.7685376778245, -58.22417288273573, -78.40919144079089, -89.81232330203056, -44.11713954806328, -56.11419501155615, -88.52273675426841, -60.00498575344682, -74.03752497583628, -119.81667474284768, -85.50760523229837, -60.69217035546899, -236.06693965569139, -66.20818880200386, -198.02646027505398, -104.87632285058498, -87.32841426879168, -78.15479082986712, -97.72591983154416, -102.5484788492322, -244.5305570140481, -38.88832514360547, -117.36046371981502, -65.16180664300919, -229.57562201470137, -89.26644811034203, -101.30902172625065, -232.96501117944717, -113.19374933466315, -237.8010631725192, -66.13590554147959, -104.36831719428301, -66.01700921729207, -72.43819515779614, -93.23629044741392, -73.56155329942703, -39.84302306175232, -100.00248261913657, -71.66392290592194, -116.41381821781397, -260.8781877681613, -65.44030583649874, -216.11484453827143, -53.50316870957613, -59.20629647374153, -133.08875934034586, -190.12796905636787, -93.74454016983509, -111.1096970885992, -88.50749914348125, -104.03444410860538, -53.47025489062071, -68.69194971770048, -106.96703815832734, -73.91982792317867, -120.58967430889606, -58.605566918849945, -54.738813012838364, -96.7452707067132, -32.420770682394505, -184.03279587626457, -62.742665491998196, -90.63781462237239, -70.84248032234609, -99.65374781191349, -87.858329705894, -76.8348950818181, -87.97593844681978, -83.60343897342682, -59.93065543472767, -56.27687033265829, -69.98538911342621, -77.45517655089498, -233.85561250150204, -45.8252900056541, -62.30914734303951, -129.84579674899578, -83.36588750779629, -105.21038108319044, -52.71148909628391, -49.37274174019694, -92.38126718252897, -98.54554537683725, -42.42790852487087, -46.230688370764256], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409264654381661, "mean_inference_ms": 4.54323166262657, "mean_action_processing_ms": 4.1552440798194725, "mean_env_wait_ms": 3.2010736501092882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7862400, "timesteps_this_iter": 131040, "agent_timesteps_total": 7862400, "timers": {"sample_time_ms": 33890.081, "sample_throughput": 3866.618, "load_time_ms": 21.299, "load_throughput": 6152441.527, "learn_time_ms": 14945.701, "learn_throughput": 8767.739, "update_time_ms": 2.218}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4694469519536134e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 108.35466783268983, "policy_loss": -0.002255316362678508, "vf_loss": 21.672779380634267, "vf_explained_var": 0.46325524893712827, "kl": 0.0018680529281084749, "entropy": -0.40995707648629354, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7862400, "num_agent_steps_sampled": 7862400, "num_steps_trained": 7862400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7862400}, "done": false, "episodes_total": 15840, "training_iteration": 60, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-12-43", "timestamp": 1691021563, "time_this_iter_s": 15.022726774215698, "time_total_s": 1886.2302391529083, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1886.2302391529083, "timesteps_since_restore": 7862400, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 13.895454545454545, "ram_util_percent": 51.52727272727273}}
{"episode_reward_max": -3.359193801879883, "episode_reward_min": -285.3707692101598, "episode_reward_mean": -79.61542987980064, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.29072339087725, -58.745490828529, -82.07888985425234, -70.72864659875631, -87.80221841484308, -48.193855214864016, -16.2712725661695, -52.58204706013203, -53.129626236855984, -35.310763623565435, -83.86592227965593, -54.640968181192875, -37.32044855132699, -63.4234866425395, -94.35348956286907, -87.6797175258398, -27.395272113382816, -70.53901113197207, -17.597455073148012, -47.47770616412163, -85.26204337924719, -87.62237920239568, -246.73956555500627, -33.29134954512119, -107.42199114710093, -225.95477301627398, -57.34452334046364, -214.3988001048565, -81.2130352333188, -68.47855192422867, -49.91580539755523, -55.04766637831926, -43.96072870492935, -63.34490814805031, -67.2472356557846, -63.500443238765, -23.70526237413287, -274.1154619976878, -140.6579403579235, -46.317926339805126, -60.14754628390074, -61.02647465839982, -60.00152329355478, -19.57351367175579, -22.656539004296064, -100.32656790316105, -123.20566565170884, -42.7937281280756, -68.0776010453701, -70.17651711031795, -94.51556544750929, -67.99569062143564, -76.31620364636183, -25.31753361225128, -70.37814581394196, -182.6588110625744, -68.32965705171227, -22.80023965612054, -49.31806477159262, -71.08136694133282, -80.39546845853329, -82.22958776727319, -74.78057389706373, -105.99877109006047, -87.31060268729925, -18.65466972067952, -47.50520669668913, -70.8487721066922, -40.23037576675415, -48.05907413363457, -21.475092366337776, -42.42795034497976, -49.68005020171404, -3.359193801879883, -100.48110276460648, -49.33018968254328, -104.68123626708984, -25.504872802644968, -100.69199539721012, -54.4595088288188, -35.48236655443907, -57.762377858161926, -98.56959979981184, -216.19804682210088, -94.79577614739537, -90.54792557284236, -59.630664713680744, -233.87453377246857, -34.298105619847775, -41.70816530659795, -58.662287317216396, -51.35881718248129, -52.212392546236515, -57.052283458411694, -109.48901449888945, -85.07013625651598, -48.54900563135743, -82.40204215049744, -92.95732075721025, -133.590564109385, -279.34060568362474, -64.29376417770982, -66.99852231889963, -59.694573774933815, -57.35356482118368, -72.26976665854454, -240.30307782441378, -60.55643371865153, -231.61436077952385, -107.67540889233351, -29.94908680766821, -61.651617743074894, -86.56502888724208, -47.42845282703638, -109.00841080397367, -59.85372309759259, -105.14786100387573, -88.34164365381002, -79.36226879805326, -47.18431777507067, -62.49572502449155, -60.065756876021624, -56.986014898866415, -36.152829740196466, -92.4594233110547, -87.53459559381008, -23.81367981992662, -100.26575134694576, -146.87978053838015, -86.03507634624839, -95.67018759250641, -77.5013819988817, -41.349169589579105, -85.88282393664122, -78.64673167467117, -97.9137040451169, -87.31794768385589, -40.527281295508146, -68.10160986334085, -73.60051976144314, -45.32035471871495, -92.15252211689949, -23.38603323698044, -123.15749280899763, -54.39710300788283, -265.5742528401315, -104.3148018233478, -118.18186741694808, -89.94930040836334, -37.53535498864949, -29.826209098100662, -106.98315919935703, -55.34881815686822, -205.32910706847906, -61.11214155331254, -54.32134618610144, -17.282384902238846, -67.16243805736303, -70.89745429158211, -111.48959441483021, -31.827604711055756, -63.43231953680515, -95.59754882007837, -9.759342081844807, -4.991396218538284, -58.29253392666578, -274.96785029396415, -41.93869851902127, -26.073564318940043, -30.911683030426502, -119.22558566182852, -98.7413686811924, -85.55237188190222, -40.452729158103466, -72.12994980812073, -67.14798602834344, -82.19875952601433, -65.16745169833302, -115.4544706940651, -139.94299671798944, -47.083187241107225, -37.30168870091438, -285.3707692101598, -245.17025616019964, -54.83735780417919, -77.44342952221632, -38.374640353024006, -90.18867771327496, -84.2805914580822, -32.84572345390916, -8.862304177135229, -47.439006354659796, -53.20551638305187, -51.10658520460129, -51.816103145480156, -66.92397356778383, -99.58176715299487, -59.969293382018805, -61.766302742064, -54.20351338759065, -6.41623043641448, -25.898784957826138, -89.00367994606495, -71.28142995014787, -71.24166100472212, -64.46892601251602, -56.999514520168304, -69.50285955891013, -278.84193667396903, -23.075423762202263, -53.64933569729328, -47.40458312444389, -40.66858674585819, -5.0447637513279915, -54.66617789119482, -56.5788360349834, -106.50609032809734, -57.56532051041722, -21.56715329736471, -59.838239163160324, -62.091817893087864, -82.01123617216945, -66.48406332731247, -51.5459990054369, -45.08975982479751, -96.19259051978588, -39.1373560205102, -36.923910193145275, -79.7724459990859, -34.96802794188261, -57.013636749237776, -78.32948585599661, -47.146378964185715, -90.26783912628889, -25.356085158884525, -69.27919770032167, -231.6059139445424, -215.01135593652725, -73.4899896197021, -47.356724843382835, -182.9805602133274, -125.96702105551958, -101.97446120530367, -198.8988165333867, -95.31688498705626, -40.30005445331335, -61.06654843688011, -25.584336549043655, -98.19217555969954, -197.72033447772264, -8.229257568717003, -94.21630043163896, -70.55273451656103, -119.28074107319117, -67.73487481847405, -65.60653058066964, -240.42459589987993, -45.34743684902787, -56.43909182399511, -50.72766222059727, -59.23974920809269, -84.60014617443085, -57.53624368458986, -185.7967271208763, -69.98541052639484, -74.47579954564571, -44.21605520695448, -25.323367781937122, -246.34775573015213, -80.55006632953882, -75.56864988058805, -15.34397927671671, -86.56077636778355, -226.49412099272013, -45.38341571763158, -57.639175310730934, -230.2981061115861, -76.02815063297749, -164.12870505079627, -40.049392215907574, -76.51263930648565, -86.90015638619661, -28.845092572271824, -71.786909930408, -53.13255916163325, -76.66861578449607, -92.18295320868492, -7.178862411528826, -101.07724454253912, -44.50691692903638, -69.35072205215693, -46.65431985259056, -84.86490640044212, -32.4680015668273, -102.8929404169321, -67.85952458903193, -104.99927868321538, -56.09206886775792, -73.56346268206835, -95.74606657773256, -86.09091524779797, -55.99547305703163, -47.696192467585206, -97.38241182267666, -43.33495359867811, -247.55542772263288, -38.092024728655815, -46.7478515021503, -76.75677768141031, -144.0248882547021, -46.29351124539971, -58.96273286640644, -51.1781165599823, -34.662627287209034, -78.1030092369765, -90.01320523768663, -49.81959857419133, -72.05221172049642, -96.2266183681786, -38.17501815408468], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427778826354799, "mean_inference_ms": 4.554101940376675, "mean_action_processing_ms": 4.209937518031427, "mean_env_wait_ms": 3.2302862040740776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 7993440, "timesteps_this_iter": 131040, "agent_timesteps_total": 7993440, "timers": {"sample_time_ms": 29713.252, "sample_throughput": 4410.153, "load_time_ms": 22.913, "load_throughput": 5719041.247, "learn_time_ms": 14954.089, "learn_throughput": 8762.821, "update_time_ms": 2.252}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7347234759768067e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 102.65079626819117, "policy_loss": -0.0003284559257326596, "vf_loss": 20.53007160720005, "vf_explained_var": 0.48543216838204306, "kl": 0.0023209454019931684, "entropy": -0.41641957513106764, "entropy_coeff": 0.001}}}, "num_steps_sampled": 7993440, "num_agent_steps_sampled": 7993440, "num_steps_trained": 7993440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 7993440}, "done": false, "episodes_total": 16160, "training_iteration": 61, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-13-22", "timestamp": 1691021602, "time_this_iter_s": 39.48177719116211, "time_total_s": 1925.7120163440704, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1925.7120163440704, "timesteps_since_restore": 7993440, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 44.34642857142857, "ram_util_percent": 50.933928571428574}}
{"episode_reward_max": -7.178862411528826, "episode_reward_min": -247.55542772263288, "episode_reward_mean": -82.93646834172309, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.091817893087864, -82.01123617216945, -66.48406332731247, -51.5459990054369, -45.08975982479751, -96.19259051978588, -39.1373560205102, -36.923910193145275, -79.7724459990859, -34.96802794188261, -57.013636749237776, -78.32948585599661, -47.146378964185715, -90.26783912628889, -25.356085158884525, -69.27919770032167, -231.6059139445424, -215.01135593652725, -73.4899896197021, -47.356724843382835, -182.9805602133274, -125.96702105551958, -101.97446120530367, -198.8988165333867, -95.31688498705626, -40.30005445331335, -61.06654843688011, -25.584336549043655, -98.19217555969954, -197.72033447772264, -8.229257568717003, -94.21630043163896, -70.55273451656103, -119.28074107319117, -67.73487481847405, -65.60653058066964, -240.42459589987993, -45.34743684902787, -56.43909182399511, -50.72766222059727, -59.23974920809269, -84.60014617443085, -57.53624368458986, -185.7967271208763, -69.98541052639484, -74.47579954564571, -44.21605520695448, -25.323367781937122, -246.34775573015213, -80.55006632953882, -75.56864988058805, -15.34397927671671, -86.56077636778355, -226.49412099272013, -45.38341571763158, -57.639175310730934, -230.2981061115861, -76.02815063297749, -164.12870505079627, -40.049392215907574, -76.51263930648565, -86.90015638619661, -28.845092572271824, -71.786909930408, -53.13255916163325, -76.66861578449607, -92.18295320868492, -7.178862411528826, -101.07724454253912, -44.50691692903638, -69.35072205215693, -46.65431985259056, -84.86490640044212, -32.4680015668273, -102.8929404169321, -67.85952458903193, -104.99927868321538, -56.09206886775792, -73.56346268206835, -95.74606657773256, -86.09091524779797, -55.99547305703163, -47.696192467585206, -97.38241182267666, -43.33495359867811, -247.55542772263288, -38.092024728655815, -46.7478515021503, -76.75677768141031, -144.0248882547021, -46.29351124539971, -58.96273286640644, -51.1781165599823, -34.662627287209034, -78.1030092369765, -90.01320523768663, -49.81959857419133, -72.05221172049642, -96.2266183681786, -38.17501815408468], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43905917121796, "mean_inference_ms": 4.545182197977862, "mean_action_processing_ms": 4.1806645083751635, "mean_env_wait_ms": 3.214638003706757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8124480, "timesteps_this_iter": 131040, "agent_timesteps_total": 8124480, "timers": {"sample_time_ms": 27327.745, "sample_throughput": 4795.127, "load_time_ms": 21.379, "load_throughput": 6129257.985, "learn_time_ms": 14964.07, "learn_throughput": 8756.976, "update_time_ms": 2.264}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.673617379884034e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 95.48266648353157, "policy_loss": 0.00128734942572814, "vf_loss": 19.094828140778354, "vf_explained_var": 0.520433712283343, "kl": 0.002020341956088366, "entropy": -0.4181932286763277, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8124480, "num_agent_steps_sampled": 8124480, "num_steps_trained": 8124480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8124480}, "done": false, "episodes_total": 16160, "training_iteration": 62, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-13-38", "timestamp": 1691021618, "time_this_iter_s": 15.33123517036438, "time_total_s": 1941.0432515144348, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1941.0432515144348, "timesteps_since_restore": 8124480, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 13.868181818181817, "ram_util_percent": 51.599999999999994}}
{"episode_reward_max": 7.089427076280117, "episode_reward_min": -325.4768024086952, "episode_reward_mean": -73.78281449900048, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.61838805675507, -279.0311144962907, -59.89539524167776, -59.42141207307577, -67.06974077224731, -55.158938605338335, -21.06209582835436, -27.73592033237219, -98.77777204662561, -220.8464287854731, -200.84195806831121, -203.5170340873301, -44.51030343770981, -34.41355645656586, -75.04360310733318, -73.42309679836035, -61.84627079591155, -75.11592715978622, -89.11251845955849, -236.1068123653531, -90.6090572476387, -55.764563500881195, -90.44154738262296, -62.3778216317296, -230.05428737401962, -251.72871029376984, -50.96372186951339, -64.2750496789813, -50.81888696923852, -32.599121283739805, -48.18039832636714, -69.72626946121454, -203.7368169054389, -44.19507164880633, -66.01454133540392, -15.087978228926659, -25.374919161200523, -56.82684104889631, -99.52776084467769, -21.71902845799923, -172.1483245715499, -48.45584210753441, -71.51549272984266, -101.83815687149763, -93.80802320688963, -34.8665996491909, -34.672529838979244, -71.50141372531652, -61.16740195825696, -13.801388826221228, -6.928537423722446, -50.47185455262661, -89.61855348199606, -49.25283444672823, -43.9280511662364, -57.12245327234268, -54.16471732594073, -10.856623269617558, -14.74948014318943, -267.2263450361788, -21.281541354954243, -15.176853325217962, -47.73766332864761, -56.18635808676481, -49.17590583488345, -73.76897185668349, -49.45641092211008, -78.18023880943656, -103.64178794249892, -42.09583704918623, -14.633419267833233, -19.381214037537575, -203.97074434906244, -22.040485456585884, -47.188116773962975, -162.33751332387328, -64.00632719323039, -37.8051403388381, -18.07122015953064, 6.537072971463203, -170.72963321208954, 4.083871196955442, -21.05129510909319, -65.55880454182625, -24.20954317599535, -91.18307327851653, -39.83951022103429, -154.06382156908512, -12.28087243437767, -64.85711457580328, -14.120939146727324, -54.20854186266661, -69.40289081260562, -40.587612088769674, -44.45783867314458, -40.98210787773132, -108.05455800145864, -43.236823204904795, -69.65067432075739, -250.71967259794474, -29.532612081617117, -57.79828496277332, -67.05986110121012, -82.99959411099553, -33.22871947288513, -85.05480002611876, -40.17220360413194, -55.00714962184429, -72.66122474521399, -52.36596651002765, -43.12039474397898, -67.37329733371735, -1.872669119387865, -144.31473636627197, -63.491393998265266, -46.80173061043024, -72.18616750836372, -97.89384756982327, -72.3130974471569, -74.68575715273619, -58.408115385100245, -69.6694138944149, -80.10097822919488, -57.500418435782194, -59.31356928497553, -84.12365611642599, -54.82485086098313, -73.14453250169754, -73.96359499171376, -59.702589333057404, -48.89108693227172, -34.40579169243574, -105.64405186474323, -45.34683819115162, -18.121507182717323, -3.4349192939698696, -193.33477047272027, -58.11307814717293, -19.353640569373965, -213.59429271891713, -67.15013261884451, -63.65564379096031, -46.445624358952045, -32.86335023120046, -42.512758165597916, -74.36805130541325, -53.72198125720024, 5.762556482106447, -9.316657923161983, -41.74061734974384, -74.1503701210022, -50.00971956551075, -27.66222994029522, -72.7540707141161, -100.54568436741829, -23.320438781753182, -39.79081234335899, -66.88466959446669, -25.554413698613644, -79.71399677544832, -67.00338028371334, -248.1262547597289, -34.98835027962923, -87.771439447999, -66.2433698605746, -50.64129386842251, -71.97536560893059, -44.65178360790014, -223.09304532967508, -23.581881016492844, -58.58887555450201, -26.064247203990817, -78.21387127228081, -55.02644608169794, -47.204774245619774, -41.45862289890647, -42.86565790325403, -41.71172505617142, -73.05843713879585, -47.3957267254591, -92.9739383533597, -15.808918230235577, -260.391089707613, -5.2886795327067375, -48.79231356084347, -38.61176634579897, -50.30487711727619, -44.561344373971224, -27.41267827153206, -35.94721619039774, -88.4285172149539, -17.672095894813538, -70.85618883371353, -64.09883637726307, -68.68476141244173, -71.93590047955513, -99.92861450463533, -58.53369255363941, -42.56898591667414, -114.67598560452461, -57.707399904727936, -85.5169480741024, -60.497740257531404, -44.75014065206051, -85.37618728354573, -45.10425425320864, -29.308761551976204, -253.21871627122164, -251.04181110858917, -199.82913870364428, -74.33530988916755, -240.32876666635275, -71.05630537867546, -36.09216345846653, -63.46054910868406, -61.44806484133005, -75.19766794517636, -30.43431930989027, -39.390629068017006, -241.57432697713375, -287.5297899097204, -45.960835464298725, -185.07881433144212, -56.13439426198602, -47.35471051186323, -30.714442510157824, -41.98510640859604, -210.1356665790081, -49.54250106215477, -235.3134698998183, -20.17244580388069, -45.736611645668745, -205.7072113379836, -25.06975193694234, -87.85316178202629, -2.016685087233782, -115.30646751821041, -11.120479855686426, -94.33034704998136, -63.100596610456705, -198.98422836512327, -87.13340646773577, -51.30964478850365, -17.927695833146572, -16.806845277547836, -59.2938928604126, -26.002195186913013, -227.95377834886312, -43.60506569594145, -37.28199301660061, -180.2008150331676, -25.95461605489254, -200.53134052455425, -43.599296018481255, -4.764293305575848, -27.624023787677288, -73.84410725906491, -36.35146152973175, -59.8556706905365, -62.418303586542606, -40.22819488868117, -62.66388585418463, -198.4275873452425, -81.02674159221351, -17.68682413175702, -72.29740868881345, -83.74639990925789, -72.81808263063431, -48.6049946770072, 1.9680770114064217, -39.686675637960434, -28.147238068282604, -57.117123894393444, -52.636129945516586, -209.03130421042442, -32.33130880817771, -29.954469829797745, -54.7947603315115, -226.65500493720174, -36.26441276818514, -50.479818657040596, -5.971587121486664, -102.78785652294755, -47.17145629040897, -29.925747364759445, -70.84188763424754, -51.64400294423103, -58.43076481670141, -17.521599031984806, -27.312688671052456, -183.25398282706738, -73.65028757601976, -40.869616843760014, -92.09157303720713, -74.86327265202999, -64.98165499791503, -212.72616947442293, -38.524392273277044, -67.63607983291149, -41.72723791189492, -43.50473366677761, -88.86811020225286, -64.07040675729513, -42.83376458287239, -61.20005605369806, -72.7575993873179, -6.5225402638316154, -9.428818929940462, -48.231136271730065, -185.18493156135082, -35.315811194479465, -73.09594644606113, -21.17357837408781, -50.15112649463117, -51.447879150509834, -9.362559411674738, -45.88591105863452, -248.1878738310188, -18.954424750059843, -68.92523861676455, -18.76139623299241, -194.72875925153494, -45.80898703634739, -60.58128836750984, -45.902129447087646, -26.608855359256268, -1.4838740788400173, -84.075943402946, -58.53379403799772, -102.3361383676529, 7.089427076280117, -63.04873675107956, -20.594933684915304, -52.71160216629505, -51.81152620911598, -38.031012773513794, -108.15967451781034, -43.05307376384735, -197.7946564257145, -37.13077388331294, -45.37427317351103, -36.4070851393044, -218.24861834943295, -55.85964461416006, -107.63363701105118, -62.87585091590881, -26.01531914435327, -95.96909806877375, -88.80211552977562, -87.27735246345401, -64.56830202043056, -193.63435167819262, -21.316756181418896, -20.57613867521286, -39.43849332630634, -64.30065210908651, -98.59297603368759, -209.55129880458117, -60.05720491334796, -36.39265092462301, -45.90523398667574, -73.70687212049961, -60.63419250398874, -82.62222124822438, -39.0230106562376, -22.538941726088524, -88.49620695784688, -41.456319242715836, -82.89403773099184, -54.34122095257044, -5.8763712123036385, -223.86159164458513, -102.66937651485205, -58.21894359588623, -55.28284562751651, -7.614456407725811, -214.87308377027512, -82.8695700392127, -39.83559787273407, -32.55961000174284, -63.81648318096995, -89.9301180317998, -106.6340517103672, -7.5616275370121, -29.077504374086857, -89.40646339952946, -191.93355249613523, -16.514340184628963, -37.57256018742919, -228.95516957342625, -30.94067118689418, -75.87732573971152, -44.09010975807905, -104.05456261336803, -67.92811951041222, -70.37599374353886, -72.42097862064838, -47.98446224629879, -115.22784849256277, -3.037339501082897, -64.40743459016085, -64.65429642796516, -42.580605613067746, -113.33906266093254, -91.20736277103424, -195.40166144818068, -40.61067184433341, -115.20390503108501, -53.57785592228174, -91.22445971891284, -88.36317762732506, -99.89947786554694, -223.37616719305515, -37.85143366083503, -87.54542048275471, -199.4661912061274, -153.1248892620206, -55.65009581297636, -51.74798309803009, -60.39243072643876, -282.57261104881763, -54.53140473738313, -78.68442239612341, -56.638663329184055, -74.31592923775315, -11.071813829243183, -58.765251487493515, -15.257773853838444, -35.42798437178135, 2.1341561526060104, -34.08588349074125, -25.707525320351124, -114.46816762164235, -41.7112640067935, -55.28677052631974, -69.79753063619137, -22.288230262696743, -325.4768024086952, -181.92426684498787, -67.40974459052086, -46.75541013479233, -43.75654586032033, -42.653587099164724, -55.46887678280473, -34.75447719171643, -43.09618089348078, -53.706600684672594, -76.18461903557181, -50.16729384288192, -25.45769663900137, -223.94115518778563, -203.71681267768145, -32.99208637326956, -52.268455155193806, -49.70405577123165, -86.81316031888127, -8.237007934600115, -117.02193912491202, -56.26006495952606, -40.65545651689172, -56.02602408081293, -121.48450411856174, -55.073625452816486, -47.379709497094154, -17.6488953307271, -46.20217030495405, 4.7327186316251755, -27.657141037285328, -57.45477466285229, -16.714247852563858, -99.47041390091181, -80.25798092782497, -48.550469018518925, -54.80778309702873, -195.18370018526912, -54.98430144786835, -41.345281183719635, -39.463291838765144, -90.29441868886352, -249.60224994271994], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427120062751667, "mean_inference_ms": 4.55445506702492, "mean_action_processing_ms": 4.209627881286541, "mean_env_wait_ms": 3.2307424173584898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8255520, "timesteps_this_iter": 131040, "agent_timesteps_total": 8255520, "timers": {"sample_time_ms": 29742.001, "sample_throughput": 4405.89, "load_time_ms": 23.253, "load_throughput": 5635508.833, "learn_time_ms": 14950.442, "learn_throughput": 8764.958, "update_time_ms": 2.261}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.336808689942017e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 108.12885989558208, "policy_loss": 0.0023722062462482193, "vf_loss": 21.622976867101524, "vf_explained_var": 0.48360378586263214, "kl": 0.002154143618183817, "entropy": -0.423283757755406, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8255520, "num_agent_steps_sampled": 8255520, "num_steps_trained": 8255520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8255520}, "done": false, "episodes_total": 16640, "training_iteration": 63, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-14-17", "timestamp": 1691021657, "time_this_iter_s": 39.26649069786072, "time_total_s": 1980.3097422122955, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1980.3097422122955, "timesteps_since_restore": 8255520, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 44.31428571428571, "ram_util_percent": 51.53750000000001}}
{"episode_reward_max": 4.7327186316251755, "episode_reward_min": -325.4768024086952, "episode_reward_mean": -77.64731495020911, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.81648318096995, -89.9301180317998, -106.6340517103672, -7.5616275370121, -29.077504374086857, -89.40646339952946, -191.93355249613523, -16.514340184628963, -37.57256018742919, -228.95516957342625, -30.94067118689418, -75.87732573971152, -44.09010975807905, -104.05456261336803, -67.92811951041222, -70.37599374353886, -72.42097862064838, -47.98446224629879, -115.22784849256277, -3.037339501082897, -64.40743459016085, -64.65429642796516, -42.580605613067746, -113.33906266093254, -91.20736277103424, -195.40166144818068, -40.61067184433341, -115.20390503108501, -53.57785592228174, -91.22445971891284, -88.36317762732506, -99.89947786554694, -223.37616719305515, -37.85143366083503, -87.54542048275471, -199.4661912061274, -153.1248892620206, -55.65009581297636, -51.74798309803009, -60.39243072643876, -282.57261104881763, -54.53140473738313, -78.68442239612341, -56.638663329184055, -74.31592923775315, -11.071813829243183, -58.765251487493515, -15.257773853838444, -35.42798437178135, 2.1341561526060104, -34.08588349074125, -25.707525320351124, -114.46816762164235, -41.7112640067935, -55.28677052631974, -69.79753063619137, -22.288230262696743, -325.4768024086952, -181.92426684498787, -67.40974459052086, -46.75541013479233, -43.75654586032033, -42.653587099164724, -55.46887678280473, -34.75447719171643, -43.09618089348078, -53.706600684672594, -76.18461903557181, -50.16729384288192, -25.45769663900137, -223.94115518778563, -203.71681267768145, -32.99208637326956, -52.268455155193806, -49.70405577123165, -86.81316031888127, -8.237007934600115, -117.02193912491202, -56.26006495952606, -40.65545651689172, -56.02602408081293, -121.48450411856174, -55.073625452816486, -47.379709497094154, -17.6488953307271, -46.20217030495405, 4.7327186316251755, -27.657141037285328, -57.45477466285229, -16.714247852563858, -99.47041390091181, -80.25798092782497, -48.550469018518925, -54.80778309702873, -195.18370018526912, -54.98430144786835, -41.345281183719635, -39.463291838765144, -90.29441868886352, -249.60224994271994], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411137052863829, "mean_inference_ms": 4.545355187733799, "mean_action_processing_ms": 4.156410791050791, "mean_env_wait_ms": 3.202184682982487, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8386560, "timesteps_this_iter": 131040, "agent_timesteps_total": 8386560, "timers": {"sample_time_ms": 27322.163, "sample_throughput": 4796.106, "load_time_ms": 21.102, "load_throughput": 6209901.287, "learn_time_ms": 14952.385, "learn_throughput": 8763.82, "update_time_ms": 2.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1684043449710084e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 107.99806477293019, "policy_loss": -0.0010987303447818637, "vf_loss": 21.600281399210722, "vf_explained_var": 0.45662368123676617, "kl": 0.0021990211284135244, "entropy": -0.43061602964837065, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8386560, "num_agent_steps_sampled": 8386560, "num_steps_trained": 8386560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8386560}, "done": false, "episodes_total": 16640, "training_iteration": 64, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-14-32", "timestamp": 1691021672, "time_this_iter_s": 15.251375198364258, "time_total_s": 1995.5611174106598, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1995.5611174106598, "timesteps_since_restore": 8386560, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 13.859090909090913, "ram_util_percent": 51.5}}
{"evaluation": {"episode_reward_max": -105.34065991640091, "episode_reward_min": -105.34065991640091, "episode_reward_mean": -105.34065991640091, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.34065991640091], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 21.033172708004713, "episode_reward_min": -347.56710301339626, "episode_reward_mean": -66.10601968656604, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.3903870806098, -31.371353451162577, -5.804305799305439, -57.291239973157644, -74.10307651013136, -65.4780935458839, -53.34890280663967, -76.26490662246943, -206.1827915534377, -29.80965313501656, -85.53221902996302, -63.40663045272231, -26.852606054395437, -106.41589453816414, -59.57074423879385, -251.06925970315933, -59.80436293780804, -61.643272161483765, -25.225167095661163, -57.97031632065773, -276.74702087044716, -57.319314919412136, -198.14075374230742, -234.03598072193563, -22.982248406857252, -39.68804392963648, -72.78243324905634, -79.59259280562401, -65.54615890234709, -31.86965573579073, -5.266570165753365, -198.9336385577917, -39.41689045727253, -202.00681741535664, -32.21207217499614, -99.65043064951897, -29.491811703890562, -39.81752146035433, -38.711334232240915, -24.343347005546093, -64.2756532728672, -70.1689597889781, -61.676912643015385, -45.24941361322999, -50.79990715533495, -49.80120750889182, -56.764313489198685, -41.90173538029194, -54.542228400707245, -20.512669317424297, -70.08378137275577, -38.648700688034296, -32.04375900328159, -30.981795374304056, -157.66944332420826, -183.06319875270128, -60.03856533765793, -43.10784225165844, -41.080026008188725, -198.84048657119274, -71.35032881051302, -23.300701215863228, -83.22273473441601, -56.161073103547096, -54.66913814097643, -91.73788235336542, -90.91676546633244, -224.59120438992977, -12.459004707634449, -39.05128890275955, -53.39540954679251, -17.109374061226845, -57.694362215697765, -11.559567376971245, -77.69405862316489, -56.766408290714025, -35.445268869400024, -252.99565129354596, -38.35349964350462, -25.997375465929508, -61.495241560041904, -84.08242497593164, 4.376252371817827, -39.2563295327127, -35.316239196807146, -37.53424400091171, -175.1671796515584, -51.175603188574314, -33.33925732970238, -42.60341180115938, -48.32478545233607, -17.404981218278408, -27.69942832738161, -110.44856744259596, -4.76882952824235, -32.540630124509335, -47.90652306377888, 0.3802617732435465, -63.02032269537449, -59.5703902952373, -74.11470655351877, -136.0232929289341, -25.81140337511897, -61.25043893605471, -75.64032711088657, -31.43257797881961, -25.395042192190886, -250.48085946589708, -47.06679046154022, -63.60409918427467, -100.66721243411303, -32.90120604261756, -4.77878094278276, -222.91103728674352, -55.331936206668615, -222.84980346634984, -89.65297921001911, -46.222145192325115, -48.17700860649347, -53.36468040570617, -229.1214505583048, -27.356716386973858, -45.22202983498573, -31.075133219361305, -31.541028164327145, -61.72715053334832, -43.405743047595024, -34.51537227258086, -14.380508974194527, -24.014154568314552, -1.1283228732645512, 0.16150632500648499, -23.68178779259324, -21.667501064017415, -70.5510301887989, -51.77126256376505, -41.5886135622859, -0.7307421900331974, -39.1671601831913, -37.60833925381303, -62.745073676109314, -42.28204983845353, 4.209259539842606, -213.5528102479875, -39.12334665283561, -215.52852733060718, -201.9030961804092, -12.053242471069098, -21.616692282259464, -50.287770822644234, -28.900440335273743, -23.63376071304083, -18.935397993773222, -16.529526375234127, -20.51438833028078, -210.09311663359404, -25.808864936232567, -69.67787470668554, -27.98646530136466, -65.59376386553049, -77.09295811504126, -45.47500616312027, -74.0247383415699, -64.19960269331932, -21.406461156904697, -58.98992618918419, -43.83067497238517, -34.78469730913639, -35.50568149611354, -51.78357696533203, -34.285583816468716, -4.746427726000547, -11.451763175427914, -179.6783780604601, -92.75056748837233, -21.349369678646326, -185.13203969225287, -61.24005316384137, -41.651451144367456, 13.709441810846329, -42.71655227616429, -62.345822017639875, -25.197460278868675, -48.28830375522375, -26.110361251980066, -82.48329025506973, -22.208529256284237, -212.54591280966997, -47.336905747652054, -37.367093812674284, -39.45202998816967, -112.861050022766, -48.26220574229956, -58.38981480896473, -82.19385162740946, -1.7090863771736622, -46.334533993154764, -180.11091496795416, -39.602271772921085, -57.286026522517204, -45.48805741220713, -98.58305432088673, -51.95573063194752, -199.54557729512453, -232.47054285556078, -47.0220692679286, -75.65128309838474, -43.81386511027813, -91.23917432874441, -42.680004604160786, -27.62064143270254, -347.56710301339626, -263.8318100757897, -47.5058770775795, -71.52148350700736, -227.92571043223143, -44.369851004332304, -48.75172819197178, -106.46223162859678, -79.7935926951468, -72.6932653337717, -26.58194426447153, -86.93013672530651, -63.61964234523475, -35.95235639065504, -44.17024639248848, -56.76519091799855, -43.80977361649275, -62.82028920203447, -10.184506051242352, -36.149013970047235, -39.26631312817335, -115.45832747220993, -64.19472697004676, -72.80027069151402, -66.45669459179044, -49.687237007543445, -29.609558921307325, -28.66621422767639, -18.272362407296896, -10.293425429612398, -63.62222508713603, -72.66891188174486, -39.89881934225559, -256.0176825989038, -24.193934936076403, -72.52954202890396, -33.261603482067585, -24.25253453850746, -39.42667533457279, -30.36325331032276, -45.12993314117193, 7.783047698438168, -200.1043762639165, -16.20993957296014, -70.14033313840628, -71.83180296979845, -27.49060869961977, -61.709308154881, -81.82579270005226, -49.827857077121735, -73.06752943992615, -97.22669798135757, -47.311094377189875, -42.208415508270264, -23.75901247560978, -56.322904389351606, -32.588874373584986, -50.2189451828599, -96.50953827798367, -44.03760991245508, -67.44861574470997, -39.27372927963734, -45.42201369255781, -74.09806054085493, -23.11045952141285, -18.65208071283996, 6.144822612404823, -52.55024899542332, -12.320112451910973, -205.4757623076439, -44.460662953555584, -32.09262012317777, -27.275993034243584, -36.11846214905381, -187.87282864004374, -66.05135395005345, -36.206396728754044, -78.93156633526087, -64.19635811448097, -41.63426335901022, -53.589711505919695, -66.80686985328794, -56.87237332761288, -36.726199723780155, -94.64367303997278, -47.45872596651316, -104.33792969956994, -62.955569341778755, -57.8747237585485, -52.76541630923748, -64.39638981223106, -55.676863849163055, -48.18739915639162, -100.96099147386849, -41.576671700924635, -12.320353552699089, -70.79764046519995, -21.193702518939972, -68.02469535171986, -0.24100397527217865, -60.023193560540676, -43.51947595179081, 3.0522989965975285, -41.33765732869506, -71.85989001765847, -297.6663747988641, -72.4134351015091, -95.4547208622098, -66.1811068803072, -90.5929414331913, -35.108283624053, -28.590890461578965, -66.05281709134579, -59.35233637690544, -37.265516608953476, -72.04986707866192, -29.172207053750753, -45.85624337941408, -234.19997054338455, -211.9246705174446, -43.574446991086006, -36.65952977910638, -81.66051949560642, -226.03882994502783, -60.572442166507244, -49.8197655454278, -61.57010941952467, -34.17623370140791, -71.1667654812336, -49.928619757294655, -72.0498609803617, 21.033172708004713, -55.611860916018486, -40.78517699241638, -44.27179177850485, -268.4626320526004, -31.573961034417152, -36.77129752933979, -62.17439369857311, -50.97626842185855, -41.51976723596454, -22.21918425709009, -34.39773862063885, -34.38582989573479, -24.75930231064558, -59.022376611828804, -56.47393172979355, -27.398059703409672, -65.6896425113082, -15.589977163821459, -223.61088967695832, -51.208225190639496, -34.7910196185112, -21.883588284254074, -31.906730987131596, -18.42548429220915, -63.93953552097082, -17.560881346464157, -25.43886987864971, -52.276356756687164, -52.514281027019024, -44.629771031439304, -16.25932129845023, -30.23367116227746, -1.4763829670846462, -62.93775814771652, -166.3307163193822, -282.1038837954402, -59.12878037057817, -26.09738857485354, -28.346465311944485, -79.90230375528336, -24.41106218099594, -38.03993308916688, -44.19463682919741, -53.485634718090296, -293.9542311877012, -221.25431739538908, -44.03428580611944, -149.15946336649358, -28.52605327963829, -69.26434985548258, -58.72324551641941, -209.60333450511098, -75.51815108768642, -42.85735346376896, -56.427479326725006, -21.68578142300248, -34.22256284952164, -104.26858335733414, -51.508757032454014, -21.618416972458363, -21.632538426667452, -79.25273512303829, -62.841678731143475, -56.82272996753454, -304.7407968714833, -27.398172423243523, -68.9992249161005, -60.19802492111921, -24.02530037984252, -116.7268827110529, -6.385764509439468, -49.44141215831041, -18.103125970810652, -42.022097021341324, -58.39189253747463, -54.051331385970116, -54.48140750825405, -65.1170731857419, -51.5954596363008, -41.6961745172739, -3.920244909822941, -35.24217292666435, -28.465120539069176, -57.77048660442233, -75.63843061774969, -30.440869461745024, -182.6063124537468, -45.060407999902964, -74.79157304018736, -34.17830119282007, -66.49095156043768, -16.846038676798344, -46.84739224612713, -63.34787015616894, -62.331355549395084, -29.363216184079647, -64.78290766105056, -55.15215242654085, -88.26010622084141, -45.918417509645224, -53.80087733268738, -51.04705885052681, -66.18044222891331, -77.57484744116664, -111.26270747929811, -49.12057476490736, -2.9401239529252052, -37.21008392050862, -90.43563291803002, -40.57868932187557, -31.164616256952286, -55.431161262094975, -40.931352254003286, -96.79401583224535, -246.84480413794518, -30.106236331164837, -26.79768816009164, -63.8580828756094, -49.560499899089336, -64.14961863309145, -220.04358533769846, -56.061880838125944, -42.66169199347496, -31.77728683874011, -67.52732509374619, -33.35059537179768, -28.620105497539043, -50.607183553278446, -48.86762647330761, -39.10634842514992, -38.724019557237625, 0.5574265792965889, -51.7887301966548, -209.767621897161, -63.223444141447544, -38.94057685509324, -104.50120250880718], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425761848950894, "mean_inference_ms": 4.554018769754484, "mean_action_processing_ms": 4.209312076386978, "mean_env_wait_ms": 3.2297655625010795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8517600, "timesteps_this_iter": 131040, "agent_timesteps_total": 8517600, "timers": {"sample_time_ms": 29726.085, "sample_throughput": 4408.25, "load_time_ms": 22.884, "load_throughput": 5726238.981, "learn_time_ms": 14954.593, "learn_throughput": 8762.526, "update_time_ms": 2.258}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0842021724855042e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 89.9949111941982, "policy_loss": -0.0043628214292678585, "vf_loss": 18.002907694881536, "vf_explained_var": 0.5543811981396009, "kl": 0.0019443514480392936, "entropy": -0.43764122909328845, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8517600, "num_agent_steps_sampled": 8517600, "num_steps_trained": 8517600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8517600}, "done": false, "episodes_total": 17120, "training_iteration": 65, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-15-11", "timestamp": 1691021711, "time_this_iter_s": 39.07395911216736, "time_total_s": 2034.6350765228271, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2034.6350765228271, "timesteps_since_restore": 8517600, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 44.56181818181818, "ram_util_percent": 51.441818181818185}}
{"episode_reward_max": 33.370424062013626, "episode_reward_min": -303.6125219911337, "episode_reward_mean": -49.21736418697886, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.178918287158012, -49.56711706519127, -28.088806834071875, -73.51535901799798, -20.704202815890312, -79.04170859605074, -19.924027666449547, -46.45410781353712, -37.8820985108614, -1.5895582493394613, -184.33776180818677, -33.71263452991843, -30.013534229248762, -90.1510239392519, 9.996379800140858, -31.56276746839285, -26.218672655522823, -29.068659625947475, -35.712409898638725, -25.528802193701267, 33.370424062013626, -67.41116265952587, -14.222120083868504, -44.71347461640835, -62.092162773013115, -57.607118513435125, -20.627543218433857, -43.09180495887995, -21.118884079158306, -12.863584447652102, 5.338909707963467, -26.14936914294958, -35.13209468498826, -9.745005581527948, -7.783732756972313, -237.43976209312677, -61.78483809530735, -80.78646612539887, -3.5198570378124714, 7.400709189474583, -282.46230225265026, -58.776767402887344, 0.6245515085756779, -15.392703615128994, 33.10767624527216, -139.98112642765045, -50.522810101509094, -66.86899175494909, -210.3409071341157, -4.95235937833786, 22.440522830933332, -45.60104255378246, 0.042357832193374634, -5.14565322548151, 21.551572740077972, -9.433310993015766, -83.66537952423096, 26.41282620280981, -21.21363865211606, -54.831276290118694, -39.838024631142616, -45.151109497994184, 27.196739930659533, 24.34107904881239, -14.01901937276125, -7.3879537135362625, -26.74091273918748, -42.43654552847147, -55.87459275126457, -57.942039646208286, -17.3567660972476, -61.299959536641836, -58.2580275721848, -125.51913020759821, -39.21245235949755, -182.67714275419712, 7.003149591386318, -25.92795581370592, -4.6556694842875, -36.32782693952322, -230.0360605120659, -47.38603103719652, -94.07433414459229, -22.79105583578348, 16.692140746861696, -72.46743635833263, -43.34865729138255, -225.44247175008059, -24.11921740323305, -1.2442930564284325, -27.54492547363043, 3.0906126275658607, -53.68882004916668, -20.38193855807185, -31.58739399164915, 14.885760247707367, 2.674331657588482, -12.635332368314266, -53.999154694378376, -69.45252943783998, -50.381381303071976, -7.897417154163122, -8.335885144770145, -15.662546023726463, -190.15240459144115, -19.194416888058186, -240.1550893113017, -72.31722865253687, -39.723026648163795, -56.19291355460882, -78.25678486004472, -144.4287522882223, -56.279773861169815, -26.66588068008423, 3.751372493803501, -237.33112462237477, -21.478722866624594, -38.62699466571212, -32.87850345671177, -13.880246207118034, -1.558226004242897, -7.469402078539133, -20.447156205773354, -212.3579239025712, 5.083137396723032, -189.2024406939745, -49.04151987284422, -90.84249502420425, -67.80529264360666, -41.991393975913525, -33.656358540058136, -47.39964948967099, -41.756946727633476, -82.10828810930252, -18.716141372919083, -51.700994197279215, -54.07222103327513, -22.229527089744806, -204.63697715476155, 9.34109004586935, -44.130456149578094, -32.43786435574293, -78.12893282994628, -30.730506293475628, -22.29069036245346, -45.56960669904947, -10.436398640275002, -267.1306016892195, -66.9337650835514, -48.730462435632944, -18.3380510173738, -38.175142377614975, -46.40942221879959, -20.554971538484097, -73.61604886502028, -63.71129220724106, -6.240202467888594, 2.496556468307972, 5.126927576959133, -31.352641064673662, -18.27318226546049, -42.359279207885265, -50.60029594600201, -51.444398034363985, -18.74416296929121, -25.10033993422985, -60.59870993345976, -4.723834909498692, -36.80610650032759, -16.094279028475285, -22.120604675263166, -16.71152152121067, 9.310161590576172, -239.8695697709918, -9.846393719315529, 2.312094997614622, -50.51109390333295, 29.996506474912167, -7.908733353018761, 3.5848492216318846, -60.0946129783988, 1.2476844266057014, -113.02637524157763, -244.99497970193624, -72.23158640414476, -243.74312280863523, -22.958535961806774, -38.18524023517966, -2.2726725190877914, -10.65328149497509, -8.69464060664177, 23.30560462921858, -39.21558827906847, -21.124475985765457, -15.333994090557098, -16.259819459170103, -38.74927589669824, -18.790954187512398, -5.992994569242001, 14.205161482095718, -39.014622405171394, -15.33545047044754, -58.68001013621688, 1.6118193678557873, -31.15822520107031, -69.58899157121778, -22.622796261683106, -40.6007158793509, 2.849217491224408, -7.435085117816925, -47.413194946944714, -76.76765822991729, -44.80683174729347, -20.10542180389166, -69.64336843043566, -30.122461941093206, -27.44197291508317, -52.53130166232586, -99.05437698960304, -54.03692262619734, -46.81157014146447, -38.23186180740595, -15.004950381815434, -69.62593603134155, -39.20142572373152, -31.74881536513567, -32.524845007807016, -34.515526566654444, 8.409135561436415, 3.6425184067338705, -41.86829337477684, -72.24608656018972, -14.285233173519373, -43.664856135845184, -58.15396258234978, -35.39495172351599, -10.924974624067545, -56.685023833066225, -47.16600998491049, 4.76576241850853, -21.535767767578363, -45.25989081710577, -24.74963115900755, -2.627399116754532, -15.329859510064125, -72.02574202418327, 2.6496401466429234, -221.34673885256052, -45.56693712621927, -37.913068890571594, -303.6125219911337, -51.76279879361391, -30.84651731699705, 10.41973251849413, -77.10151616483927, -54.40580129995942, -23.40999326109886, -247.4237406179309, -37.88197482377291, -4.794664904475212, -19.53986521437764, -24.40988639742136, 6.737409219145775, -28.089640274643898, -18.19103967770934, -53.749119045212865, 15.441364523023367, -10.138925392180681, -37.71738174557686, -42.61880538612604, 12.350447870790958, -155.32779831066728, -9.312982995063066, -41.21056743338704, 2.812606707215309, -251.3784225359559, -213.6375237815082, -39.05105135962367, -78.14287799596786, -21.030485317111015, -61.82277179509401, -37.91224620491266, -18.526538163423538, -20.88035948574543, -59.95913127064705, -230.21999722719193, -46.84081298112869, 12.327735427767038, -1.7577720321714878, -69.42708844691515, -69.99093732610345, -38.9815029874444, -44.35550018772483, -14.142080692574382, -7.946524873375893, -37.82266329228878, -51.00307161360979, -80.05761083215475, -51.62921568006277, -33.53560226224363, -17.300059221684933, 5.8511364087462425, -23.855011619627476, -40.71068301796913, -53.75122952461243, -37.92221787571907, -68.49532717466354, -51.780358143150806, -14.593290956690907, 0.41279486566782, -28.933485886082053, -78.6119215786457, -11.857119143009186, -31.46194813027978, -56.42420371621847, -21.39229577034712, -65.16456362977624, -54.00390687584877, -9.660496494732797, -10.939829517155886, 12.030076570808887, -7.1351970955729485, -16.94512030482292, -6.613137125968933, -18.194406393915415, -8.182371467351913, -62.14820473641157, -225.36931112408638, -52.34723918698728, -117.87018240988255, -9.166391728445888, -65.84733923524618, -71.69963291287422, -179.4600623063743, -1.4900903217494488, -40.10417667776346, -25.426624659448862, -24.02984779328108, -42.6700412184, -47.58433575555682, -300.8611668497324, 17.096043679863214, -237.32719792798162, -34.80048903822899, -167.97170966118574, -61.10289374738932, -60.472347147762775, -8.136785812675953, -30.81559669971466, -34.51476649194956, -31.83836580067873, -26.34311743080616, -11.611516289412975, -59.17754055559635, -18.80633869022131, -22.151753809303045, -58.90170835331082, -40.55297129228711, -96.62845499813557, -47.520527612417936, 23.39205539599061, -30.249490164220333, -1.9367800541222095, -35.82787483930588, -15.23284968174994, -91.80503584817052, -56.69766689091921, -28.663274705410004, 8.916522964835167, -189.18177966028452, -70.02929405868053, -256.2917934060097, -25.637574203312397, -213.4684472605586, -237.11974482052028, -21.900657456368208, -51.13041182607412, -61.87149241194129, -17.080664202570915, -34.693357065320015, -65.08938808739185, -76.71227926760912, -19.915177017450333, -291.0050226897001, -43.346208438277245, -68.07890108972788, -39.895113337785006, -30.366296097636223, -27.254473619163036, -72.07017877697945, -44.76901462301612, 5.159050963819027, -64.53662755340338, 13.034130226820707, -77.19599490612745, -12.668980326503515, -43.9476927369833, -225.7726902514696, -214.359647590667, -121.25431614741683, -2.975104659795761, -5.141167011111975, -44.28413366153836, -239.24239253252745, -41.892985701560974, -42.623262006789446, -32.05349266529083, -62.68281742185354, -53.956101417541504, -44.02712653949857, -219.27777422964573, -44.70678912103176, -12.996641300618649, -14.29996407777071, -223.7078470699489, -39.00379518419504, -56.01377798616886, -23.843662820756435, -54.09753326326609, -25.62895903363824, -40.299719236791134, -239.52344568446279, -6.162239965051413, -174.2521420456469, -40.336317494511604, -16.69778013974428, 11.147437281906605, -20.73565863072872, -34.60383877903223, -124.61251055449247, -22.33704313635826, -10.02576333284378, -31.89460875838995, -43.4528127387166, -11.084729123860598, -63.357236213982105, -20.914402209222317, 18.693893127143383, -43.82237924262881, -30.258051097393036, -53.86703617870808, -17.773890618234873, -36.87496215850115, 9.447598028928041, -39.06729815155268, -2.9659976437687874, -0.12335982173681259, -49.61763655394316, -38.21884102374315, -15.540269419550896, 10.087249781936407, -223.8894775658846, 0.22609910368919373, -25.759050868451595, -34.2203538492322, -35.078929021954536, -115.61001344025135, -39.183536905795336, -2.701734321191907, -10.219499334692955, -16.61642125248909, -55.043321028351784, -19.195536121726036, -28.165003709495068, 16.11746346950531, -13.129428572952747, -193.52433667331934, -7.763244278728962, -31.802191272377968, -22.186749832704663, -78.3570670299232, -10.22168242931366, -45.76612438261509, -69.08396412432194, -14.794806532561779, 16.15922949463129, -4.275314837694168, 10.62784102326259, -37.75736303627491, 17.775892842561007], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423675102061937, "mean_inference_ms": 4.553785294622387, "mean_action_processing_ms": 4.2092284581587505, "mean_env_wait_ms": 3.229669341402578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8648640, "timesteps_this_iter": 131040, "agent_timesteps_total": 8648640, "timers": {"sample_time_ms": 29742.44, "sample_throughput": 4405.826, "load_time_ms": 22.901, "load_throughput": 5721934.847, "learn_time_ms": 14971.956, "learn_throughput": 8752.363, "update_time_ms": 2.275}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.421010862427521e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 101.09299136336877, "policy_loss": -0.0017123022785809777, "vf_loss": 20.219868571100267, "vf_explained_var": 0.5380979478359222, "kl": 0.002438651485396566, "entropy": -0.4423760002125121, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8648640, "num_agent_steps_sampled": 8648640, "num_steps_trained": 8648640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8648640}, "done": false, "episodes_total": 17600, "training_iteration": 66, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-15-51", "timestamp": 1691021751, "time_this_iter_s": 39.57646894454956, "time_total_s": 2074.2115454673767, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2074.2115454673767, "timesteps_since_restore": 8648640, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 43.55263157894736, "ram_util_percent": 50.93508771929825}}
{"episode_reward_max": 18.693893127143383, "episode_reward_min": -291.0050226897001, "episode_reward_mean": -50.54982565293554, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.08938808739185, -76.71227926760912, -19.915177017450333, -291.0050226897001, -43.346208438277245, -68.07890108972788, -39.895113337785006, -30.366296097636223, -27.254473619163036, -72.07017877697945, -44.76901462301612, 5.159050963819027, -64.53662755340338, 13.034130226820707, -77.19599490612745, -12.668980326503515, -43.9476927369833, -225.7726902514696, -214.359647590667, -121.25431614741683, -2.975104659795761, -5.141167011111975, -44.28413366153836, -239.24239253252745, -41.892985701560974, -42.623262006789446, -32.05349266529083, -62.68281742185354, -53.956101417541504, -44.02712653949857, -219.27777422964573, -44.70678912103176, -12.996641300618649, -14.29996407777071, -223.7078470699489, -39.00379518419504, -56.01377798616886, -23.843662820756435, -54.09753326326609, -25.62895903363824, -40.299719236791134, -239.52344568446279, -6.162239965051413, -174.2521420456469, -40.336317494511604, -16.69778013974428, 11.147437281906605, -20.73565863072872, -34.60383877903223, -124.61251055449247, -22.33704313635826, -10.02576333284378, -31.89460875838995, -43.4528127387166, -11.084729123860598, -63.357236213982105, -20.914402209222317, 18.693893127143383, -43.82237924262881, -30.258051097393036, -53.86703617870808, -17.773890618234873, -36.87496215850115, 9.447598028928041, -39.06729815155268, -2.9659976437687874, -0.12335982173681259, -49.61763655394316, -38.21884102374315, -15.540269419550896, 10.087249781936407, -223.8894775658846, 0.22609910368919373, -25.759050868451595, -34.2203538492322, -35.078929021954536, -115.61001344025135, -39.183536905795336, -2.701734321191907, -10.219499334692955, -16.61642125248909, -55.043321028351784, -19.195536121726036, -28.165003709495068, 16.11746346950531, -13.129428572952747, -193.52433667331934, -7.763244278728962, -31.802191272377968, -22.186749832704663, -78.3570670299232, -10.22168242931366, -45.76612438261509, -69.08396412432194, -14.794806532561779, 16.15922949463129, -4.275314837694168, 10.62784102326259, -37.75736303627491, 17.775892842561007], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407321156050505, "mean_inference_ms": 4.5448064663600265, "mean_action_processing_ms": 4.156610014407217, "mean_env_wait_ms": 3.202217839045964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8779680, "timesteps_this_iter": 131040, "agent_timesteps_total": 8779680, "timers": {"sample_time_ms": 27328.206, "sample_throughput": 4795.046, "load_time_ms": 21.392, "load_throughput": 6125726.216, "learn_time_ms": 14969.291, "learn_throughput": 8753.921, "update_time_ms": 2.253}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7105054312137605e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 123.78088656288665, "policy_loss": -0.0013042673520018266, "vf_loss": 24.757034375248843, "vf_explained_var": 0.41350163684950936, "kl": 0.0023000058002426126, "entropy": -0.4476245457446703, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8779680, "num_agent_steps_sampled": 8779680, "num_steps_trained": 8779680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8779680}, "done": false, "episodes_total": 17600, "training_iteration": 67, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-16-06", "timestamp": 1691021766, "time_this_iter_s": 15.274423360824585, "time_total_s": 2089.4859688282013, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2089.4859688282013, "timesteps_since_restore": 8779680, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 13.85, "ram_util_percent": 51.5}}
{"episode_reward_max": 38.61060155928135, "episode_reward_min": -249.7600514292717, "episode_reward_mean": -33.03992100078418, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.332081392407417, -3.8452964946627617, -24.09315348416567, -12.19370599836111, -123.45057194679976, -29.868062801659107, -37.907129257917404, -45.52586405724287, -3.3611161708831787, -27.165580693632364, -190.8580430969596, -14.925009123980999, -31.258837431669235, -12.332780131138861, -5.916292577981949, -24.794799152761698, -10.811837077140808, -62.62780128419399, -41.08773818984628, -10.649551961570978, -27.650563597679138, -46.733705550432205, -23.16135599836707, -39.909244399517775, -38.33234021067619, 9.571234341710806, 4.253574889153242, 17.114672854542732, -16.363144643604755, -5.738462142646313, 15.886495180428028, -65.8931511938572, -14.96712439134717, -37.75472618639469, -57.92904685810208, -41.67971704155207, -83.57500416785479, 0.8930890150368214, -13.195514276623726, -60.93627595901489, -1.9209628254175186, -77.54712441563606, -15.674847476184368, -0.893418699502945, -4.340471725910902, -19.874390710145235, -23.901814065873623, 26.39419661834836, -24.714907851070166, -20.466751221567392, -24.796774949878454, -19.374498385936022, -30.826727241277695, 20.39071460813284, 1.733938205987215, -58.766973938792944, -64.11050048470497, -34.40679681301117, -36.02326535061002, -211.04139026999474, -28.268563378602266, -27.460675835609436, -90.99791177734733, 0.5581026822328568, -16.72027438879013, -3.4635448679327965, -83.43284680694342, 7.7865274380892515, -38.58145263046026, -20.426058739423752, -5.264584481716156, -32.25672096014023, -36.633376870304346, -38.21921591460705, -49.92348247021437, -37.720743246376514, 28.683714766055346, -200.42627900838852, 1.3836474269628525, -28.809326626360416, -42.21183771640062, -55.22692670673132, -22.987441711127758, 22.772009540349245, -45.077125035226345, -180.08248982578516, 32.49191393703222, -29.000112768262625, -18.117317602038383, -30.1099767498672, -23.453929148614407, -25.61979040876031, -30.068583346903324, -2.921478144824505, -52.82378435134888, 4.801977826282382, 0.2960108518600464, -75.35839070565999, -19.650699831545353, -29.23873995989561, -10.172018900513649, -15.179384797811508, -206.40873353928328, -19.43369859084487, -1.3071587514132261, -48.25825408101082, -17.91330425441265, 25.55076679214835, -31.191082645207644, -224.3738013356924, -27.921967094764113, -23.317900948226452, -38.98063690960407, -34.92312293499708, -38.68488494306803, -31.166987044736743, -52.13364067673683, -1.0529495105147362, -19.590926688164473, -14.622701324522495, -24.438970122486353, -46.16272834315896, -197.80897212028503, -7.518878139555454, -13.698337152600288, -189.22759725898504, -11.995102815330029, -15.980477288365364, -10.75782584771514, -37.54324019700289, 15.12602349743247, -23.05096148699522, -27.638793267309666, 31.303933568298817, -29.944323528558016, -33.75110217183828, -21.634343422949314, -37.621681679040194, 38.61060155928135, -44.70506073534489, -41.034489810466766, -20.15734025835991, -10.678252916783094, -30.50255810469389, -14.123364493250847, -238.85325407236814, -13.444543216377497, -38.76241808012128, -34.760670356452465, -63.51942689716816, -30.11933173239231, -65.69674265757203, -43.25173810869455, 4.732305608689785, -25.675251239910722, -13.840403178706765, -30.49291768670082, -7.682353410869837, 4.307403091341257, -31.426563285291195, -20.080757446587086, -10.060770839452744, -44.17432604730129, -30.283988803625107, -81.87134215608239, 17.599045153707266, -0.5097905993461609, -29.80937597900629, -18.500247307121754, -15.605553738772869, -19.421251475811005, -78.25319846719503, -3.4073871821165085, 10.511581301689148, -17.55515660904348, -16.91670824959874, -19.495943404734135, -21.96465488150716, 7.938957758247852, -38.67326560243964, -239.6023905109614, -88.70214188843966, -16.29390936344862, -10.722365036606789, -10.51266285777092, -46.97015921771526, -20.161165982484818, -6.793258825317025, 0.47961025685071945, -7.585524432361126, 8.59868597984314, -13.734862677752972, -217.6054663360119, -7.854202970862389, -119.09432088583708, -37.20798836275935, -4.940469339489937, -249.7600514292717, -24.340645752847195, -220.53327367454767, -31.02139177173376, 16.896818345412612, 11.735707715153694, -56.42695824801922, -79.41824232786894, -62.71776509284973, -27.69029702991247, -7.052373979240656, 9.432730428874493, -66.3384370431304, 4.407209761440754, -71.40833529829979, 7.6156917065382, -9.934751506894827, -48.07700937986374, -193.99498423188925, -4.684399638324976, -17.48631054535508, -13.64156174659729, 18.643123529851437, -21.058742962777615, -12.651066645979881, -21.772272519767284, -56.06451926380396, 19.70471054315567, -14.479807160794735, 16.76894612982869, 0.07096275314688683, -33.15777552872896, -60.59912220016122, 0.28507130965590477, -32.42834975197911, -28.393495738506317, -30.22893036901951, 14.183531142771244, 0.14052268117666245, -24.864045400172472, -15.054488070309162, -21.3255982324481, -59.56680189073086, -14.22152129560709, 10.211310856044292, -30.965456165373325, 6.723886378109455, -26.815499145537615, -2.8184555619955063, -30.163001716136932, -22.7412144318223, -53.54888050444424, -48.60723904520273, -39.10419960692525, -160.19643158465624, 5.149905428290367, -39.68171285092831, -6.602494578808546, -177.5722133256495, 9.21408537402749, -13.95586471632123, -37.79225566238165, 17.688929699361324, -52.32763309031725, 3.710404846817255, -14.174225689843297, 23.244393032044172, -5.204661268740892, 5.746107216924429, -40.380302615463734, -23.26764616370201, -62.75772711262107, -15.60131173580885, -10.953521456569433, -32.60280076414347, 8.14782028272748, -59.54038901999593, -4.6857875213027, -14.712360739707947, -49.534317675977945, -75.37977284193039, -3.4748231396079063, 3.4621939286589622, 33.280809588730335, -95.44963768869638, -1.4479693248867989, -17.813390862196684, -17.218763560056686, -32.31943577528, -41.85418336838484, -28.726017646491528, -24.304569832980633, 29.57521850988269, 29.942823123186827, -111.88131741434336, 0.08994252607226372, -24.468115996569395, -75.57002276927233, 29.51711569726467, -233.97791432589293, -0.7836316041648388, -4.455657333135605, -57.64977581426501, -77.00733264535666, -0.17336735129356384, -23.129386700689793, -51.66729934513569, -21.170449428260326, -212.34053603559732, -56.646461956202984, -24.88406101614237, -232.54346782714128, -19.605236500501633, -40.575856383889914, -12.252858037129045, -37.100606702268124, 37.054195784032345, -21.735556200146675, 14.960094142705202, -69.60233021527529, -27.538707442581654, -65.87832489609718, 14.459622405469418, -31.173612043261528, -22.262568198144436, -20.70453157648444, -17.938113376498222, -220.05381675437093, -10.87729200348258, -26.024927139282227, -34.95801757276058, -54.67661318928003, 0.27270560525357723, -8.508940152823925, 6.825204402208328, -44.39324948191643, -57.059335097670555, -37.608806893229485, -1.7662511356174946, -7.006481766700745, -7.112701125442982, -36.19498801231384, -3.76729479432106, -33.941640354692936, -60.786917209625244, -40.536633640527725, -34.60985675826669, -47.07219870761037, -23.489492628723383, -37.07045225054026, -27.3292154148221, -59.88907869160175, -19.22487865947187, -41.647310465574265, -42.89646339416504, 36.24763447418809, -40.74031438678503, -9.658234156668186, -11.714060820639133, -57.18411812186241, -39.5618802011013, -56.70700717717409, -37.19075085967779, -18.27080997079611, -0.08200965076684952, 1.7951462119817734, -29.988347731530666, -3.46151989325881, -23.22705414891243, -19.416905015707016, -86.58630400896072, 17.879336018115282, -51.171993769705296, -9.287254486232996, -1.1035091951489449, 4.385543256998062, -8.192746423184872, 21.303378336131573, -37.361258985474706, 26.41141290590167, -4.799280442297459, -13.806046463549137, -29.51696065068245, -7.713839877396822, -28.554658502340317, 12.527174323797226, -66.24335015565157, -16.154729649424553, -23.068655401468277, -26.716617360711098, -198.6264856159687, -22.339873865246773, 2.326934777200222, -21.76346879079938, -101.41882901638746, 1.1531491689383984, 21.013122230768204, -53.53044789284468, -27.15851664170623, -35.924609050154686, -78.28561860322952, -20.83016048371792, -29.119855750352144, -27.839978028088808, -27.810916375368834, -32.16578874737024, -162.92386980354786, -229.36603588610888, -37.11036725342274, -33.753100749105215, -12.633488599210978, -15.637162428349257, -10.386632226407528, -19.738192792981863, -16.256248086690903, -18.29283842071891, -27.1869974732399, -20.242437109351158, -233.5854867324233, -10.295767467468977, -8.39917579293251, -36.59868970885873, -0.17532237991690636, 1.5834916532039642, -6.210849903523922, -28.828396152704954, -222.41069642081857, 10.224268682301044, -78.85568732023239, -9.859680481255054, -24.36724042892456, -25.45203761011362, 6.305244158953428, 0.5581332333385944, 3.061714857816696, 5.17440789192915, -15.732556983828545, -73.58516477793455, -53.5046609044075, -15.828139197081327, -37.815436750650406, -12.406877771019936, -26.59953536093235, -16.690676737576723, -15.31802841834724, -61.959095396101475, -0.4880407899618149, -130.10649422556162, -229.42541567981243, -18.905529905110598, 19.460125878453255, -30.393050648272038, -24.61800405010581, 3.051029246300459, -38.248509503901005, -11.720763895660639, -14.77955836802721, -38.327335990965366, -45.044852670282125, 18.657491102814674, -22.303149458020926, 10.437250271439552, -6.676461609080434, -53.944634936749935, -17.748306054621935, -7.646537184715271, -6.422521719709039, -12.966950237751007, -45.91892401129007, -94.7690038383007, -25.114182390272617, -34.452741868793964, -22.661947563290596, 15.32642076909542, -0.6594342738389969, -54.38158241659403, 5.040217638015747, -19.215903352946043, -39.48094981908798, 12.813590615987778, -33.08330335840583, 12.605502605438232, -41.827912513166666], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422466925167329, "mean_inference_ms": 4.554146030812634, "mean_action_processing_ms": 4.209517390519956, "mean_env_wait_ms": 3.2300373020963145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 8910720, "timesteps_this_iter": 131040, "agent_timesteps_total": 8910720, "timers": {"sample_time_ms": 29730.819, "sample_throughput": 4407.548, "load_time_ms": 23.135, "load_throughput": 5664239.976, "learn_time_ms": 14961.835, "learn_throughput": 8758.284, "update_time_ms": 2.264}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3552527156068802e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 108.07116746534263, "policy_loss": -0.004799948687796005, "vf_loss": 21.61858876546224, "vf_explained_var": 0.4701083383679817, "kl": 0.0022041236883797934, "entropy": -0.4450546996567839, "entropy_coeff": 0.001}}}, "num_steps_sampled": 8910720, "num_agent_steps_sampled": 8910720, "num_steps_trained": 8910720, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 8910720}, "done": false, "episodes_total": 18080, "training_iteration": 68, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-16-45", "timestamp": 1691021805, "time_this_iter_s": 39.28615665435791, "time_total_s": 2128.772125482559, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2128.772125482559, "timesteps_since_restore": 8910720, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 44.253571428571426, "ram_util_percent": 51.5}}
{"episode_reward_max": 21.013122230768204, "episode_reward_min": -233.5854867324233, "episode_reward_mean": -34.23285706562921, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.713839877396822, -28.554658502340317, 12.527174323797226, -66.24335015565157, -16.154729649424553, -23.068655401468277, -26.716617360711098, -198.6264856159687, -22.339873865246773, 2.326934777200222, -21.76346879079938, -101.41882901638746, 1.1531491689383984, 21.013122230768204, -53.53044789284468, -27.15851664170623, -35.924609050154686, -78.28561860322952, -20.83016048371792, -29.119855750352144, -27.839978028088808, -27.810916375368834, -32.16578874737024, -162.92386980354786, -229.36603588610888, -37.11036725342274, -33.753100749105215, -12.633488599210978, -15.637162428349257, -10.386632226407528, -19.738192792981863, -16.256248086690903, -18.29283842071891, -27.1869974732399, -20.242437109351158, -233.5854867324233, -10.295767467468977, -8.39917579293251, -36.59868970885873, -0.17532237991690636, 1.5834916532039642, -6.210849903523922, -28.828396152704954, -222.41069642081857, 10.224268682301044, -78.85568732023239, -9.859680481255054, -24.36724042892456, -25.45203761011362, 6.305244158953428, 0.5581332333385944, 3.061714857816696, 5.17440789192915, -15.732556983828545, -73.58516477793455, -53.5046609044075, -15.828139197081327, -37.815436750650406, -12.406877771019936, -26.59953536093235, -16.690676737576723, -15.31802841834724, -61.959095396101475, -0.4880407899618149, -130.10649422556162, -229.42541567981243, -18.905529905110598, 19.460125878453255, -30.393050648272038, -24.61800405010581, 3.051029246300459, -38.248509503901005, -11.720763895660639, -14.77955836802721, -38.327335990965366, -45.044852670282125, 18.657491102814674, -22.303149458020926, 10.437250271439552, -6.676461609080434, -53.944634936749935, -17.748306054621935, -7.646537184715271, -6.422521719709039, -12.966950237751007, -45.91892401129007, -94.7690038383007, -25.114182390272617, -34.452741868793964, -22.661947563290596, 15.32642076909542, -0.6594342738389969, -54.38158241659403, 5.040217638015747, -19.215903352946043, -39.48094981908798, 12.813590615987778, -33.08330335840583, 12.605502605438232, -41.827912513166666], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40673771661972, "mean_inference_ms": 4.544457703395828, "mean_action_processing_ms": 4.155569579868533, "mean_env_wait_ms": 3.200419453759215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9041760, "timesteps_this_iter": 131040, "agent_timesteps_total": 9041760, "timers": {"sample_time_ms": 27316.33, "sample_throughput": 4797.13, "load_time_ms": 21.501, "load_throughput": 6094710.431, "learn_time_ms": 14941.445, "learn_throughput": 8770.236, "update_time_ms": 2.248}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.776263578034401e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 93.73487440510152, "policy_loss": 0.002535879968245364, "vf_loss": 18.743987840563594, "vf_explained_var": 0.5372683583194637, "kl": 0.0021877178551352127, "entropy": -0.4515379478747699, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9041760, "num_agent_steps_sampled": 9041760, "num_steps_trained": 9041760, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9041760}, "done": false, "episodes_total": 18080, "training_iteration": 69, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-17-01", "timestamp": 1691021821, "time_this_iter_s": 15.172062158584595, "time_total_s": 2143.944187641144, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2143.944187641144, "timesteps_since_restore": 9041760, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 13.754545454545456, "ram_util_percent": 51.463636363636375}}
{"evaluation": {"episode_reward_max": -133.2523664906621, "episode_reward_min": -133.2523664906621, "episode_reward_mean": -133.2523664906621, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.2523664906621], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 53.47113387286663, "episode_reward_min": -1209.513958260417, "episode_reward_mean": -31.277272835653275, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.50201054662466, -230.98511703312397, -44.10223565995693, -65.27310322970152, -1.5682503767311573, -74.30634067207575, 4.972707774490118, -176.6865298524499, -21.15412300080061, 23.35970924049616, -2.322427876293659, -8.963856164366007, -14.955024622380733, -34.96677005663514, -29.834478564560413, 3.41690943390131, -1.7215901538729668, -190.05902322754264, -29.629364628344774, 19.124816842377186, -11.285006996244192, -180.66707162186503, 29.879529543220997, -2.909291699528694, 16.973593197762966, -185.99051268398762, -16.338391851633787, -29.632651306688786, -2.434940063394606, -6.882858142256737, 17.397884625941515, 4.359799608588219, -5.867759361863136, 13.733729243278503, -25.481082439422607, -42.922417126595974, -3.7166084945201874, -16.274666141718626, -18.469813726842403, 3.3510733172297478, -9.655766524374485, 15.605491667985916, 23.508158937096596, -15.358146764338017, -30.875302121043205, -17.4234376847744, -16.48039809986949, 7.798828836530447, 34.36769930832088, 10.094188407063484, -16.286899715662003, -39.77336107939482, -38.23188844323158, -45.49584134295583, 0.15259469486773014, -14.646562866866589, 12.888993822038174, 22.368697438389063, -60.3849747851491, 21.906449388712645, -45.88758057355881, -40.90109192579985, -25.689977057278156, -23.233900729566813, -9.881248787045479, -21.155920304358006, 3.7404802329838276, -29.0713467374444, -7.768339596688747, 4.219815604388714, 19.950222991406918, -21.287519983947277, -6.889309495687485, -47.235174901783466, -15.966406099498272, 23.11665497533977, -24.648654144257307, 4.11039612442255, 9.657773971557617, -15.874071341007948, -30.112044610083103, -82.80606105178595, 8.883916221559048, -23.876074329018593, 8.302501909434795, -41.40369204431772, -20.225795976817608, -44.94855033606291, -43.351473934948444, -52.496605433523655, 8.069746538996696, 9.508409433066845, -27.820824723690748, -34.58502601087093, -101.5372505672276, -7.950074352324009, -40.780805356800556, -43.67946657538414, 41.10536754131317, -41.477520659565926, -19.490654163062572, -30.69569879770279, -24.26328220963478, -235.65781585127115, -219.95980899967253, -23.213191844522953, -16.24439489748329, 2.8637572899460793, -31.339024482294917, -60.57526516541839, -5.97045948728919, -49.03384333848953, -30.17994261533022, -66.21236579120159, -295.28568132966757, -183.84638133645058, 6.1226051561534405, 37.07506680302322, -38.91559262573719, -65.10152220726013, -45.38637061044574, -33.14072761684656, -6.971059467643499, -178.17285357043147, -17.45585187524557, -7.562403976917267, -57.994349002838135, -7.091009482741356, -41.91925508528948, -13.400180071592331, 34.57981532625854, -48.73858693614602, 5.871590301394463, -30.822893431410193, -9.36743026971817, -35.3176377825439, -7.982464008033276, -54.41712428629398, 9.632603280246258, -20.024224806576967, -36.64007814973593, -45.44061152637005, -33.23403185047209, -49.94119996577501, -17.67621587589383, -3.0020050406455994, -35.699576403945684, -71.67375832796097, -39.30285010486841, -19.632131338119507, -11.07736674323678, 4.292649455368519, 4.003779545426369, 17.537239503115416, -50.226981569081545, -22.701214145869017, -87.58728997409344, -10.290833551436663, -12.822321057319641, -28.91791444271803, 35.94527233392, -21.00374671816826, -42.033849239349365, 0.7718671672046185, -187.20095202699304, -8.850745854899287, 10.71904244273901, 29.469211369752884, -18.949520586058497, 10.938052043318748, 21.407778102904558, -74.98703723400831, -29.654787629842758, -62.69843317568302, -27.10682523995638, 6.054560363292694, -53.38926353305578, -45.00935538485646, -79.94520958140492, -41.229950323700905, -40.976272236555815, -1.5764825195074081, -21.771350249648094, -15.276091599836946, -61.31782276928425, -31.258339174091816, -32.77456248551607, -17.848835479468107, -6.355503052473068, -10.057612165808678, -64.68993202224374, 0.47722675278782845, -10.313381005078554, -34.211236998438835, -220.09653664939106, -57.80336197465658, -9.161189567297697, -29.421402670443058, -38.140094704926014, -36.080056704580784, -28.36680067330599, -198.77784479409456, -23.769393611699343, -28.453424733132124, -41.7156133800745, -17.6787840873003, -13.484341457486153, -7.530846729874611, -35.497693970799446, -20.534990567713976, -23.04093361645937, -9.528544690459967, -0.026117047294974327, -13.34509901702404, -36.45724193006754, 5.887786231935024, -21.457067672163248, 10.898877393454313, -47.0836513414979, -243.8184714950621, -23.293783478438854, -45.3104518763721, -25.37587232515216, -31.945373807102442, -64.56993469595909, -48.57731642946601, 0.3114683926105499, 0.505314365029335, -7.21631595864892, -17.642658203840256, 17.218475664034486, -24.240883614867926, 6.378919442184269, -26.20186421275139, -9.16341457888484, -38.07234986871481, -19.070529468357563, -42.66176823154092, -15.00252490863204, 17.085647713392973, -11.490220975130796, -30.80267235636711, 47.93241019919515, -37.798522958531976, -218.32944334298372, -20.024940501898527, -21.658517133444548, -184.60121651738882, -31.174072194844484, 38.2045194208622, -2.4003285244107246, -13.51649884134531, 17.293201383203268, -24.42784111201763, -55.33253099024296, -13.371446408331394, -2.6467715725302696, -93.15440159291029, 0.9775849804282188, -17.15303521230817, -20.172875344753265, -15.475447107106447, -65.80258980765939, -44.37971391901374, -27.24179131910205, -13.19199875742197, -49.805806040763855, -53.14066369831562, -39.48088859394193, -3.821518797427416, -171.66614726558328, 36.90280468016863, -3.3121330216526985, 28.082207756116986, -79.6353771071881, 11.549357950687408, 13.466940067708492, -51.263403706252575, 21.186628971248865, -33.81845052540302, 23.567017327994108, 17.568671107292175, -29.201929952949286, 26.43532232940197, 5.341555781662464, -23.449253857135773, 13.15107723325491, -15.97146711871028, 1.258946806192398, -223.44101490825415, -39.8939823936671, 28.385740945115685, -21.081331312656403, -33.652873285114765, -41.35785546153784, -2.4696989953517914, -56.475216925144196, -57.63041868060827, -9.017233215272427, -56.37462420016527, -37.25389442592859, -58.81196308322251, -7.544464021921158, -56.35053380578756, -20.786168172955513, -53.66303182207048, -245.93197733908892, -53.901002429425716, -31.348675310611725, -54.11903765052557, -26.072438847273588, -19.72058518230915, -6.212855396792293, -1.3312201164662838, -3.0376105420291424, -103.89557208120823, 17.548501051962376, -15.667576782405376, 28.39817836508155, -45.00563624501228, 18.058667413890362, -32.29698310047388, -54.39785762690008, -54.59730799496174, -1.981719970703125, -54.86264840513468, -18.046895269304514, -12.579905726015568, -14.395054139196873, -22.49083125591278, -27.956907734274864, -17.040167950093746, -21.980975341051817, -43.074770578183234, -14.718143187463284, -10.25559863448143, -12.645568959414959, -61.14777063950896, -45.22324142977595, -69.54296436905861, -11.49937728792429, 4.802376713603735, -25.002905040979385, -32.19101259112358, -1.3255985658615828, 21.87985300272703, -6.583859216421843, 53.47113387286663, -3.7411313205957413, -32.15605716779828, -44.80735433846712, -9.238352350890636, 3.7514894418418407, -30.02627695351839, 17.01717095449567, -53.14640485495329, -39.7254391759634, -4.27598961442709, 0.1448286511003971, -162.98377303034067, -14.044005110859871, -20.329722966998816, -17.523196533322334, -8.989231947809458, 9.607499953359365, 9.549862690269947, -40.195213939994574, -26.892698291689157, 4.267757870256901, -19.272898077964783, -17.640991143882275, -5.329248607158661, -20.915092702955008, -31.06449056789279, -7.7788422256708145, 19.276481494307518, -23.82339076511562, -11.753816161304712, 2.613373067229986, -44.53437025845051, -62.499159432947636, -15.228320062160492, -7.9484642297029495, -204.38959927111864, -25.19833392649889, -174.2441907376051, -13.142016306519508, -13.707500640302896, -32.996472887694836, -22.22254530340433, 15.873323693871498, 1.8864182569086552, -10.080578316003084, -51.71921195834875, -8.69341442734003, 3.5734033547341824, -17.825359247624874, -4.363927662372589, -40.97299061715603, 1.9663658142089844, 14.48585619404912, -25.48142121732235, -5.334131438285112, 6.032850131392479, -22.84589295089245, -45.856849014759064, -53.827153995633125, -12.681793887168169, -23.292171970009804, -23.773918442428112, -26.072640143334866, 18.609435997903347, 10.56513948738575, -14.979561541229486, -11.522202461957932, 30.219832761213183, -10.141271568834782, -11.918440056964755, -1.346223570406437, -23.903340563178062, -37.994779989123344, -50.11596478149295, -43.14198759943247, -191.96129749715328, 24.813992597162724, -26.994777534157038, 21.9129506573081, -18.309309922158718, 12.07320960611105, -22.707846201956272, -45.45600639283657, -8.27521663159132, 19.878665026277304, -13.991695612668991, 7.879681698977947, 5.822796922177076, 5.881880722939968, 10.072476260364056, -8.732556538656354, -1.941687997430563, -28.05819506570697, -44.6468111872673, 13.060210950672626, -43.46991742402315, 8.931481063365936, -22.580508802086115, -48.47522334009409, 8.13313715159893, 5.7019807025790215, -13.239075638353825, -218.9005180671811, 20.234259977936745, -40.2150977216661, -168.3202449567616, -243.6958239004016, -82.7991591244936, -1209.513958260417, 10.63594838231802, -22.353200912475586, -29.955779664218426, -23.052627991884947, 10.170392028987408, -49.36882568523288, -15.359989313408732, -28.614193741232157, -10.610982097685337, 13.60591883212328, -41.214545506983995, -105.92421556264162, -15.009305194020271, -61.22320931404829, -26.806918129324913, -7.403069164603949, 3.0828827396035194, -54.67454893887043, -7.2168583534657955, -20.712328396737576, -23.529048092663288, -34.50194368138909, -42.0194763019681], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421627703068506, "mean_inference_ms": 4.5538561633281605, "mean_action_processing_ms": 4.209274558014283, "mean_env_wait_ms": 3.2300072915258355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9172800, "timesteps_this_iter": 131040, "agent_timesteps_total": 9172800, "timers": {"sample_time_ms": 29711.708, "sample_throughput": 4410.383, "load_time_ms": 23.156, "load_throughput": 5659119.372, "learn_time_ms": 14941.003, "learn_throughput": 8770.495, "update_time_ms": 2.244}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3881317890172006e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 97.48091093233171, "policy_loss": 0.0017602578658193627, "vf_loss": 19.493966993037944, "vf_explained_var": 0.47684654315739977, "kl": 0.002385805846945578, "entropy": -0.4552491759100268, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9172800, "num_agent_steps_sampled": 9172800, "num_steps_trained": 9172800, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9172800}, "done": false, "episodes_total": 18560, "training_iteration": 70, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-17-40", "timestamp": 1691021860, "time_this_iter_s": 39.21308350563049, "time_total_s": 2183.1572711467743, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2183.1572711467743, "timesteps_since_restore": 9172800, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 44.663636363636364, "ram_util_percent": 51.487272727272725}}
{"episode_reward_max": 30.219832761213183, "episode_reward_min": -1209.513958260417, "episode_reward_mean": -39.661933330669996, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.499159432947636, -15.228320062160492, -7.9484642297029495, -204.38959927111864, -25.19833392649889, -174.2441907376051, -13.142016306519508, -13.707500640302896, -32.996472887694836, -22.22254530340433, 15.873323693871498, 1.8864182569086552, -10.080578316003084, -51.71921195834875, -8.69341442734003, 3.5734033547341824, -17.825359247624874, -4.363927662372589, -40.97299061715603, 1.9663658142089844, 14.48585619404912, -25.48142121732235, -5.334131438285112, 6.032850131392479, -22.84589295089245, -45.856849014759064, -53.827153995633125, -12.681793887168169, -23.292171970009804, -23.773918442428112, -26.072640143334866, 18.609435997903347, 10.56513948738575, -14.979561541229486, -11.522202461957932, 30.219832761213183, -10.141271568834782, -11.918440056964755, -1.346223570406437, -23.903340563178062, -37.994779989123344, -50.11596478149295, -43.14198759943247, -191.96129749715328, 24.813992597162724, -26.994777534157038, 21.9129506573081, -18.309309922158718, 12.07320960611105, -22.707846201956272, -45.45600639283657, -8.27521663159132, 19.878665026277304, -13.991695612668991, 7.879681698977947, 5.822796922177076, 5.881880722939968, 10.072476260364056, -8.732556538656354, -1.941687997430563, -28.05819506570697, -44.6468111872673, 13.060210950672626, -43.46991742402315, 8.931481063365936, -22.580508802086115, -48.47522334009409, 8.13313715159893, 5.7019807025790215, -13.239075638353825, -218.9005180671811, 20.234259977936745, -40.2150977216661, -168.3202449567616, -243.6958239004016, -82.7991591244936, -1209.513958260417, 10.63594838231802, -22.353200912475586, -29.955779664218426, -23.052627991884947, 10.170392028987408, -49.36882568523288, -15.359989313408732, -28.614193741232157, -10.610982097685337, 13.60591883212328, -41.214545506983995, -105.92421556264162, -15.009305194020271, -61.22320931404829, -26.806918129324913, -7.403069164603949, 3.0828827396035194, -54.67454893887043, -7.2168583534657955, -20.712328396737576, -23.529048092663288, -34.50194368138909, -42.0194763019681], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405454029202393, "mean_inference_ms": 4.544299881638527, "mean_action_processing_ms": 4.155111445173151, "mean_env_wait_ms": 3.200198781660007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9303840, "timesteps_this_iter": 131040, "agent_timesteps_total": 9303840, "timers": {"sample_time_ms": 27293.199, "sample_throughput": 4801.196, "load_time_ms": 21.7, "load_throughput": 6038782.448, "learn_time_ms": 14927.128, "learn_throughput": 8778.648, "update_time_ms": 2.208}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6940658945086003e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 95.48157070013946, "policy_loss": -0.0016439549196119057, "vf_loss": 19.09749523114987, "vf_explained_var": 0.4792752998704124, "kl": 0.0022774710891372775, "entropy": -0.46328145746261845, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9303840, "num_agent_steps_sampled": 9303840, "num_steps_trained": 9303840, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9303840}, "done": false, "episodes_total": 18560, "training_iteration": 71, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-17-55", "timestamp": 1691021875, "time_this_iter_s": 15.14675521850586, "time_total_s": 2198.30402636528, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2198.30402636528, "timesteps_since_restore": 9303840, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 13.781818181818181, "ram_util_percent": 51.18636363636365}}
{"episode_reward_max": 50.90924610197544, "episode_reward_min": -319.6772902607918, "episode_reward_mean": -20.371863186557313, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.03314568847418, -79.47523592412472, -37.28413961082697, -56.19276846200228, -54.760857842862606, 7.433796852827072, -11.681290611624718, 30.593108616769314, -39.60228945314884, 2.7922904156148434, -84.68029346317053, 32.966709930449724, -8.883145336061716, -30.4421224668622, -45.84359693527222, -34.593795884400606, -260.94955132342875, 31.818162441253662, -19.33921303972602, 7.299016501754522, 50.90924610197544, 25.719507552683353, -73.44047234207392, -3.6129073463380337, -24.19906061887741, -28.76622098684311, -25.200145725160837, -54.65309624373913, -0.9144253432750702, -85.262874096632, 30.245407819747925, -9.490911472588778, -26.59457228332758, -19.84301231428981, -26.006446678191423, -23.08786265552044, 27.60542307049036, 13.919058255851269, -15.143321543931961, -47.005265317857265, -57.88175960816443, 4.824804663658142, 7.376050736755133, 10.570512376725674, -59.12032454460859, -30.798046592622995, -1.3343797717243433, -13.26851635798812, -0.5216480679810047, -32.03848681226373, 10.611849967390299, 18.400586184114218, 12.192465230822563, -40.41405740752816, -50.46925385668874, -2.9537122286856174, 11.916881158947945, -27.245026357471943, -1.7710152119398117, -12.438278008252382, -9.966834858059883, -14.82725577428937, 14.050516974180937, -22.56912061199546, -13.85991071909666, 15.42811773903668, 7.265452072024345, -19.29673209041357, -25.578642688691616, -20.02227575145662, 33.76841337233782, 1.2360845729708672, -0.6472044996917248, -52.42650177702308, -29.18670365586877, -304.7855956982821, -5.238373469561338, -21.262120455503464, -27.018590547144413, -2.8215926587581635, 16.69967533648014, -43.18722917884588, -44.295479744672775, 1.5972679816186428, -31.79825523868203, -35.113203436136246, -20.603316344320774, 7.207925155758858, -10.204891242086887, -31.0139902792871, -60.28795463591814, -2.392517499625683, 10.293100867420435, -17.2117602750659, -7.066359149292111, -4.406070612370968, -2.3965675197541714, -27.578348100185394, 23.341125637292862, 36.637630350887775, 22.661229580640793, 6.920157693326473, -52.94667586684227, 7.992382742464542, -21.400819696485996, 7.170220844447613, -9.41044195368886, -64.89903383143246, -16.272750355303288, -5.277382828295231, 24.378408014774323, -319.6772902607918, -8.876699358224869, -4.7675885409116745, -69.14069931581616, -15.640853568911552, 44.62523905187845, 39.21684515848756, -39.34236526489258, -1.948406746610999, -13.01678992062807, -47.143071407452226, 1.5960252732038498, 3.2342863120138645, -26.32615165784955, -4.943141212686896, 11.087262891232967, -77.50552190095186, -57.890643149614334, 18.711256336420774, 0.021581869572401047, -11.765410393476486, -28.817479573190212, -90.63077342137694, 30.527991887181997, 4.501684237271547, 2.084427796304226, -58.09802334755659, 1.954199194908142, -14.23772481828928, 21.81759638339281, -2.4934653900563717, 4.978397995233536, -220.23978951573372, 6.547225903719664, -57.37845491617918, -235.80760947614908, 20.726212095469236, 18.658935148268938, -10.084701362997293, -22.005023570731282, -223.0358328819275, -54.805468536913395, -2.6227901205420494, -42.6666072383523, -31.973311759531498, 4.249918784946203, 5.786358516663313, 0.640464074909687, -40.134345883503556, -50.36832744628191, -14.877610467374325, 20.5019236728549, -42.95330411568284, -26.155930630862713, -1.0109331756830215, -9.8540048468858, -53.76805838942528, -25.25080978870392, -48.57097824662924, -16.68094028159976, -62.41729587316513, 6.078247111290693, -9.110156659036875, -56.64879386126995, -5.657027535140514, -109.89349241554737, -105.98481979966164, 20.532549034804106, -42.39596275240183, -15.217320933938026, 6.489290747791529, 16.12163231894374, -15.054426781833172, 4.805321734398603, 7.473675187677145, -40.12800711393356, -28.290241971611977, -52.927286479622126, 11.394573505967855, -31.418127991259098, -4.325774658471346, 3.596946880221367, -35.020265962928534, 29.02006021887064, 26.871819652616978, 11.02296906709671, -44.16468484327197, -17.569251615554094, 7.496234774589539, 11.449714569374919, -9.952464994043112, -29.791782446205616, -24.434485375881195, 7.762502372264862, 5.38863530009985, -5.767113909125328, -22.652866799384356, -31.737316593527794, -161.4613582417369, -36.766882460564375, -30.0925984531641, -23.881821233779192, -19.108688861131668, 3.108410209417343, -5.972521997988224, -19.193592969328165, 9.067685253918171, -14.268503062427044, -18.000845406204462, -10.347777009010315, 25.37222556769848, 18.357417665421963, -0.9124486148357391, -57.22217334806919, -54.67610400170088, -48.461081333458424, -60.31890943646431, -13.898201789706945, -10.256930649280548, -32.15446578338742, -47.4789377450943, 23.20700816810131, 8.53868081048131, -8.238085925579071, -92.54216238111258, -10.396987199783325, -14.926612578332424, -66.93229498714209, -15.888385884463787, -55.07442406564951, -12.551009487360716, 46.348864547908306, -31.24358919262886, 2.868472807109356, -27.000380381941795, -35.17729579657316, 23.812888380140066, -4.30599844455719, -4.261862578801811, -14.07604569196701, -2.5772356390953064, -269.09232337772846, -6.4021467082202435, -20.786996230483055, -29.05101779848337, 19.52791655063629, -63.526024758815765, -19.493583783507347, -33.492242727428675, -17.305158590897918, 11.749479696154594, -5.1394182071089745, -13.755632258951664, -15.731302224099636, -31.849477231502533, 2.958597034215927, 20.193825755268335, 8.433150094002485, 25.20915374159813, 7.332931507378817, 22.698961259797215, -263.71578027680516, 5.514523684978485, -36.67276116460562, -234.17139076814055, -11.646493516862392, -21.962798219174147, -6.284024886786938, -121.17372649163008, -17.763749808073044, -183.61228481680155, -85.89130721241236, -92.6432793661952, -2.482979215681553, 12.812499612569809, 12.927693884819746, -4.782935990020633, 20.73296620324254, -54.864667527377605, -63.52936041355133, 17.161531925201416, -32.855902351439, -48.8997644521296, 6.1355112344026566, -20.296359859406948, -34.760115548968315, 8.119651027023792, -62.509569726884365, -17.100242160260677, 28.767545085400343, 9.222263097763062, 15.58490676432848, -21.43280779570341, -4.7181310430169106, 8.107314564287663, 9.162425674498081, -31.902695298194885, -8.960116101428866, 4.127475991845131, 3.5260653607547283, -34.09353806078434, -38.684433341026306, -225.64620837569237, 1.7156540974974632, -63.72285521030426, -23.536306209862232, 3.831491183489561, -1.9260615296661854, 27.354584075510502, -63.30803193897009, 8.155677154660225, -41.033414244651794, -50.007050428539515, 25.324493765830994, -40.709173172712326, 13.173367649316788, 12.130713403224945, -28.326480485498905, -29.34739226847887, 35.309462398290634, -24.282063771039248, -5.752156641334295, -43.21990402787924, -33.447203148156404, -13.629243720322847, -18.17255377024412, 6.150516053661704, -9.035045586526394, 1.806761254556477, -12.934173252433538, 13.301868338137865, -0.8829626552760601, 17.10537178814411, 27.65868972800672, -38.597813688218594, 37.816021751612425, 20.835267830640078, -66.73515800386667, -31.9707058519125, -18.486161410808563, -33.154221557080746, 6.004477173089981, 11.683359753340483, -30.71598096936941, 6.553227502852678, -35.49887350574136, -9.586221527308226, -0.36938269436359406, 7.4722113609313965, -36.9785753749311, -26.624001927673817, 20.605548221617937, -1.6825592406094074, 0.7036208063364029, -6.696108244359493, 8.974229380488396, -6.332757834345102, 7.410682685673237, 38.52793996036053, 49.58729376643896, 16.83460410311818, 38.60250982642174, -18.806962057948112, -4.166214480996132, -49.546956457197666, -32.65025167167187, 6.482509296387434, 4.721563391387463, -8.49564896710217, -27.812562972307205, -22.576354382559657, -0.16424605622887611, 7.820420265197754, 11.366723120212555, -10.091306153684855, 20.67366958782077, 8.5396942012012, 5.722075376659632, 26.963345989584923, 12.703435055911541, -10.75745079293847, -29.31423369050026, -15.772913917899132, -18.371773421764374, -41.31423815339804, -25.286311462521553, -5.368675168603659, -45.724878661334515, 28.448357429355383, -35.14774805679917, -19.153041765093803, -62.95733104646206, 0.22387497499585152, -45.28518758714199, -35.15043819695711, -25.241760354489088, 17.17761655896902, -7.499286621809006, 2.361643321812153, -34.28486067429185, 10.7920115403831, 3.585355434566736, -25.591435439884663, -18.636037833988667, -233.33529771864414, -7.61426654830575, 1.9980654418468475, -69.37100414186716, 11.371855210512877, 11.759830892086029, -5.2987475879490376, -98.35723154246807, -27.42967501282692, 6.440331883728504, -109.3439049422741, -69.22947558015585, 24.750404313206673, 16.531822968274355, -30.378914035856724, -36.82602744176984, -21.581959180533886, -5.181338954716921, 3.034932032227516, 1.988375797867775, -36.27317988872528, -24.630179539322853, -42.59260889142752, -22.489918978884816, -109.2266706302762, 5.991481848061085, -5.6350483149290085, -43.702499099075794, -57.76682225987315, 30.142350383102894, -58.05618403851986, 20.39779095351696, -0.10356167331337929, -18.802569031715393, -21.065468952059746, 30.060509491711855, -21.289531998336315, -17.80735746398568, 2.1301046423614025, -20.123347528278828, -23.11969480663538, -21.335415240377188, -11.716642886400223, -111.93551167845726, -6.6448366437107325, -25.344910319894552, 16.80001485720277, -17.862506423145533, 9.278575394302607, -54.23493564873934, 9.785713102668524, -0.1307587455958128, 14.243448670953512, 4.3728849440813065, 2.39225335419178, 21.25901221856475, -35.776956893503666, -10.280260406434536, 1.454137459397316, -130.5131369382143, 14.407653115689754, -45.313514821231365, 31.334470201283693, 43.683672577142715, -3.306116059422493], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4209682564221255, "mean_inference_ms": 4.553870746457845, "mean_action_processing_ms": 4.209277910896827, "mean_env_wait_ms": 3.229850525132899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9434880, "timesteps_this_iter": 131040, "agent_timesteps_total": 9434880, "timers": {"sample_time_ms": 29672.407, "sample_throughput": 4416.224, "load_time_ms": 23.29, "load_throughput": 5626370.797, "learn_time_ms": 14927.04, "learn_throughput": 8778.699, "update_time_ms": 2.199}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.470329472543002e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 117.60314261837304, "policy_loss": 0.001956271443455226, "vf_loss": 23.5181960598115, "vf_explained_var": 0.3173504167346544, "kl": 0.0025025074605652276, "entropy": -0.47658414001105937, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9434880, "num_agent_steps_sampled": 9434880, "num_steps_trained": 9434880, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9434880}, "done": false, "episodes_total": 19040, "training_iteration": 72, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-18-34", "timestamp": 1691021914, "time_this_iter_s": 39.2950918674469, "time_total_s": 2237.599118232727, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2237.599118232727, "timesteps_since_restore": 9434880, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 44.43035714285715, "ram_util_percent": 51.3125}}
{"episode_reward_max": 62.081020284444094, "episode_reward_min": -322.82613864541054, "episode_reward_mean": -19.254533790876547, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.59091667085886, 19.633826050907373, -15.361745432019234, -22.394288394600153, -28.46611960232258, -15.454818092286587, 3.976558595895767, 18.735125459730625, -13.956815622746944, -14.78888537734747, -42.4133002050221, -19.954265508800745, 2.5680874586105347, -43.656459197402, -6.719437398016453, 3.809592954814434, -10.527888435870409, -18.629068292677402, -24.12861529737711, -5.539144046604633, 2.566892445087433, -21.758166309446096, -10.334329601377249, 28.979858554899693, 27.568773739039898, -270.7914179377258, 28.393296994268894, -43.40841297805309, -58.27881836891174, -29.826926708221436, 37.8661448135972, -11.875970799475908, -74.4069744721055, 28.611026287078857, 6.396637387573719, 17.48456984385848, 41.00978583097458, 17.214813858270645, -23.89458044618368, -47.92792732641101, 8.320334076881409, 10.703714106231928, -28.677975066006184, -0.4824795126914978, 28.906687192618847, -24.963074039667845, -13.497544847428799, -11.36771309375763, 7.5746815875172615, -27.029320172965527, 12.39890518784523, -46.89384998381138, -182.50249724835157, -10.035744227468967, -38.91828362643719, -3.6449859142303467, -67.82527530938387, 4.939869180321693, 29.148137282580137, -21.03184626251459, -13.154094349592924, -8.781581059098244, -55.224772825837135, -16.683322984725237, -120.22936645895243, -48.148935505189, 25.423702251166105, 10.193931594491005, -16.650066684931517, 30.26901414990425, -34.29922375455499, -23.60288167744875, 6.277521878480911, 24.311351746320724, 14.378762036561966, 7.678313132375479, -4.353618033230305, -12.678686209022999, 41.97706864774227, -34.96083648130298, -16.479540057480335, 2.7409584783017635, 14.927158441394567, 0.31017129868268967, -37.606481462717056, -45.2839102037251, 12.63917562365532, -11.738740906119347, -13.477812260389328, -31.33862269297242, -37.5560469776392, -42.176689729094505, 45.96433184295893, -8.338144052773714, -19.805917393416166, -29.08131569623947, -8.264767717570066, -14.941846437752247, -29.03947665542364, -6.76566868275404, -17.084751054644585, -248.24467059224844, 9.655102729797363, -5.539625350385904, -33.03336339443922, -6.664586029946804, -19.201312586665154, 3.273014485836029, -18.24811352789402, -22.53409107401967, 49.53387716412544, 2.010723352432251, 10.408184055238962, 1.6946016512811184, -17.25960384309292, 47.685933634638786, -24.180056385695934, 23.230204105377197, -46.212378941476345, -52.0348007529974, -9.688993640244007, -29.151771385222673, 21.63568079471588, -13.731768190860748, -67.73582816123962, -2.5915901735424995, -222.16704915463924, -7.452861562371254, 37.59319418296218, 15.96700645238161, -11.572337348014116, 34.34836608171463, -12.500796891748905, -93.24513077735901, -29.628567412495613, 3.145565040409565, -8.42820118367672, -20.475088994950056, 45.11814968660474, 24.21224152855575, -39.858389891684055, 18.37348334491253, -0.4180453419685364, -26.63320318609476, -201.80880488455296, -29.725225511938334, -34.057063926011324, -86.64472891390324, -48.18390315026045, -1.6258079633116722, -13.31567258015275, -19.06559459120035, 12.821987107396126, -27.010934993624687, -31.325172904878855, 6.681790836155415, -16.450667932629585, -22.337372489273548, -46.20720833539963, -1.540718700736761, -23.939691472798586, 24.453512236475945, -57.57212304323912, -16.306670404970646, -25.170289248228073, -12.777038998901844, -14.040367014706135, -28.304428670555353, -30.301295939832926, 12.749074377119541, -14.87707695364952, -11.179830130189657, -10.569467592984438, -53.91436967626214, -30.276369333267212, -34.33451449126005, -25.351661037653685, -3.640760861337185, -37.47242721170187, -18.38867499679327, -10.565290875732899, 5.056890495121479, -47.88220885396004, 19.21712577342987, -6.634119018912315, -4.131879203021526, -30.721671476960182, 30.092387162148952, -13.314918484538794, -31.29972956329584, -13.756683364510536, -222.00922678411007, -1.9609578028321266, -26.800625439733267, -25.589886337518692, 25.29055761732161, 4.241233814507723, 0.7839219234883785, -71.36718838661909, 22.591270180419087, 5.1690168753266335, -275.211537130177, -2.4180201441049576, -206.51623797416687, -31.86387201398611, 3.594565138220787, 10.17096234485507, 48.5412303134799, 12.293883435428143, -53.014257319271564, 20.06349888443947, 11.850863866508007, -44.54215405881405, 28.809813413769007, -78.74501214921474, -193.04896560311317, -6.702133766375482, -5.337176211178303, -37.895751126110554, 7.350970394909382, -13.728485941886902, -34.04057731293142, 22.099374644458294, -21.140607334673405, 30.96742031350732, -16.629237815737724, -12.019091224297881, -31.579555977135897, -9.992115214467049, -6.163293920457363, -13.170595176517963, -3.320154093205929, -41.78322834149003, -6.331938549876213, -69.38374276459217, -18.89948827587068, 12.480920374393463, 21.81764255836606, -15.090370044112206, -322.82613864541054, 12.858811814337969, -16.888852275907993, -12.630447495728731, -28.2257986292243, 0.9485970102250576, -33.3830529935658, -5.794245325028896, -17.910942498594522, 18.115165734663606, 18.00322926416993, -12.66945467889309, 37.99040197581053, -18.44116724282503, 32.99729061126709, -7.383992355316877, -46.605090387165546, 37.258342668414116, -33.61154183745384, 13.460318550467491, 4.126176033169031, 11.155475933104753, -14.480154272168875, -9.658101104199886, -2.3837627805769444, 10.198333896696568, -52.37722820788622, -8.704900488257408, -13.728440150618553, -97.62873253971338, 9.661756917834282, -36.23144716024399, 1.715416181832552, 11.025229938328266, -28.385110462084413, 25.691237404942513, -38.03698815405369, 3.9415993988513947, 18.310808952897787, -36.51695678383112, -18.11871699243784, -27.796743102371693, -13.284095030277967, -6.311435796320438, -51.976432245224714, -227.60225012525916, 1.5362579114735126, 10.865982703864574, 19.276288103312254, 10.851054962724447, -57.16704638674855, -18.116811472922564, -259.3328618295491, -12.142078754492104, -58.02720692753792, 0.11715404316782951, -46.411162473261356, -37.97162723168731, 39.127142772078514, -5.9433896988630295, -14.924153313040733, -8.488272968679667, 28.743961594998837, -23.464358873665333, -10.390296053141356, -9.188202384859324, -22.459420207887888, -21.334592018276453, -2.029980506747961, 38.62983947619796, 50.026505295187235, -231.40704480186105, 6.1295566484332085, -9.533637151122093, -19.778161376714706, 30.072593845427036, -10.654626078903675, 8.074624612927437, -198.82062209770083, -44.839260175824165, -13.499304577708244, -12.720362363383174, -11.981713764369488, -47.876948580145836, -79.42554347217083, -33.047254487872124, 39.05398369953036, 21.255556654185057, 2.6247767619788647, -15.485232643783092, -3.9588457979261875, -11.07924098894, -252.1853245627135, 18.637410569936037, 18.446992367506027, -9.877287909388542, -11.572649015113711, -21.317394603043795, -37.80825311690569, -66.52055978775024, -7.169030446559191, -1.7768255583941936, -2.05747115239501, -46.997645534574986, -40.43892399966717, -55.647475726902485, -39.74732091277838, 4.110004357993603, -19.518924470990896, -8.885525155812502, -40.00255432724953, -11.932105865329504, -40.97552827000618, -0.8379131704568863, 7.951216965913773, -8.067878026515245, -75.2518268674612, -165.5414464995265, -249.12095291167498, -26.088172912597656, 3.8283332139253616, 49.67501753941178, -21.722510237246752, -23.455597817897797, 6.102973408997059, -48.67419170588255, -36.08619747310877, -18.8018767721951, 28.972612001001835, 23.928719218820333, 22.2073907405138, -7.338724318891764, -60.116829950362444, -9.007025521248579, -20.82163831964135, -15.987066730856895, -20.856874126940966, -44.64252736419439, 32.85004533082247, 26.118600491434336, -8.51641297340393, -44.78718626499176, -12.881860185414553, 9.506359595805407, 14.142567411065102, -15.015105038881302, -24.818961426615715, -9.563156139105558, -0.13479562103748322, -31.4722101688385, -2.9812961518764496, 35.37124760448933, 24.006340891122818, -180.19314692914486, -41.32262910529971, -28.092414144426584, -7.65170456469059, 41.56600248068571, 11.107622049748898, -59.06413035467267, -16.87926909327507, -35.5594003200531, -34.80686281993985, -71.03915753215551, 9.30540531873703, -25.148497242480516, -42.82051303982735, -26.123387798666954, -75.51049383729696, 0.7058734893798828, -17.85726834833622, -7.1354719288647175, 1.2610565572977066, -34.37953294068575, 13.989051215350628, -3.6627160757780075, 25.782027058303356, 17.117281768471003, 45.963763039559126, 13.9876082316041, 15.82088002935052, 19.74853230267763, -2.196769628673792, -26.15054263919592, 6.394928179681301, -23.00032414123416, -26.548928651958704, -56.89736646413803, 3.385968703776598, -0.8255790695548058, -79.58524283766747, -5.338500507175922, -30.97700797021389, -21.768562402576208, -25.88788393139839, 8.644875258207321, -56.74799216538668, -8.379086196422577, -3.9385771304368973, -0.2420009970664978, -18.580636393278837, 12.832469537854195, -81.18594978004694, -18.527446877211332, -7.38757386803627, -85.74132921546698, -21.708834517747164, 3.9615953601896763, -2.7380941584706306, 6.632967323064804, -23.38306723535061, -7.524280644953251, 9.411848850548267, 5.948040746152401, 29.032627120614052, 12.376190610229969, 14.649475887417793, 11.787708465009928, 29.056399933993816, 0.8435866944491863, -11.111507076770067, -18.655057337135077, -27.971045218408108, 22.648449059575796, 41.95992485806346, -28.597504932433367, -15.72590570896864, 62.081020284444094, 16.348441559821367, -40.97512788698077, 38.757902540266514, -6.341309368610382, -5.2791739869862795, -43.882484167814255, -6.789795968681574, -17.86288320273161, -9.374639168381691, -211.2527564689517, -33.32785180956125, 23.124013382941484, -15.04404155164957], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419997589408005, "mean_inference_ms": 4.55389490751827, "mean_action_processing_ms": 4.209400118864204, "mean_env_wait_ms": 3.2303356347313206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9565920, "timesteps_this_iter": 131040, "agent_timesteps_total": 9565920, "timers": {"sample_time_ms": 29684.699, "sample_throughput": 4414.395, "load_time_ms": 23.537, "load_throughput": 5567361.271, "learn_time_ms": 14926.518, "learn_throughput": 8779.007, "update_time_ms": 2.212}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.235164736271501e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 112.85666976362513, "policy_loss": 0.0006665496067681253, "vf_loss": 22.57019260365476, "vf_explained_var": 0.3849357102720541, "kl": 0.00239326356948557, "entropy": -0.47522020169056445, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9565920, "num_agent_steps_sampled": 9565920, "num_steps_trained": 9565920, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9565920}, "done": false, "episodes_total": 19520, "training_iteration": 73, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-19-14", "timestamp": 1691021954, "time_this_iter_s": 39.365965843200684, "time_total_s": 2276.9650840759277, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2276.9650840759277, "timesteps_since_restore": 9565920, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 44.223214285714285, "ram_util_percent": 51.494642857142864}}
{"episode_reward_max": 62.081020284444094, "episode_reward_min": -211.2527564689517, "episode_reward_mean": -13.170937749501318, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.78718626499176, -12.881860185414553, 9.506359595805407, 14.142567411065102, -15.015105038881302, -24.818961426615715, -9.563156139105558, -0.13479562103748322, -31.4722101688385, -2.9812961518764496, 35.37124760448933, 24.006340891122818, -180.19314692914486, -41.32262910529971, -28.092414144426584, -7.65170456469059, 41.56600248068571, 11.107622049748898, -59.06413035467267, -16.87926909327507, -35.5594003200531, -34.80686281993985, -71.03915753215551, 9.30540531873703, -25.148497242480516, -42.82051303982735, -26.123387798666954, -75.51049383729696, 0.7058734893798828, -17.85726834833622, -7.1354719288647175, 1.2610565572977066, -34.37953294068575, 13.989051215350628, -3.6627160757780075, 25.782027058303356, 17.117281768471003, 45.963763039559126, 13.9876082316041, 15.82088002935052, 19.74853230267763, -2.196769628673792, -26.15054263919592, 6.394928179681301, -23.00032414123416, -26.548928651958704, -56.89736646413803, 3.385968703776598, -0.8255790695548058, -79.58524283766747, -5.338500507175922, -30.97700797021389, -21.768562402576208, -25.88788393139839, 8.644875258207321, -56.74799216538668, -8.379086196422577, -3.9385771304368973, -0.2420009970664978, -18.580636393278837, 12.832469537854195, -81.18594978004694, -18.527446877211332, -7.38757386803627, -85.74132921546698, -21.708834517747164, 3.9615953601896763, -2.7380941584706306, 6.632967323064804, -23.38306723535061, -7.524280644953251, 9.411848850548267, 5.948040746152401, 29.032627120614052, 12.376190610229969, 14.649475887417793, 11.787708465009928, 29.056399933993816, 0.8435866944491863, -11.111507076770067, -18.655057337135077, -27.971045218408108, 22.648449059575796, 41.95992485806346, -28.597504932433367, -15.72590570896864, 62.081020284444094, 16.348441559821367, -40.97512788698077, 38.757902540266514, -6.341309368610382, -5.2791739869862795, -43.882484167814255, -6.789795968681574, -17.86288320273161, -9.374639168381691, -211.2527564689517, -33.32785180956125, 23.124013382941484, -15.04404155164957], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401750154429585, "mean_inference_ms": 4.5438226414411425, "mean_action_processing_ms": 4.154462045970819, "mean_env_wait_ms": 3.2013040805875472, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9696960, "timesteps_this_iter": 131040, "agent_timesteps_total": 9696960, "timers": {"sample_time_ms": 29684.417, "sample_throughput": 4414.437, "load_time_ms": 23.536, "load_throughput": 5567631.977, "learn_time_ms": 14922.106, "learn_throughput": 8781.602, "update_time_ms": 2.212}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1175823681357504e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 105.13401789110368, "policy_loss": 0.001824966354659512, "vf_loss": 21.02449215783013, "vf_explained_var": 0.4100606493838799, "kl": 0.002385639584302822, "entropy": -0.4868059868133196, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9696960, "num_agent_steps_sampled": 9696960, "num_steps_trained": 9696960, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9696960}, "done": false, "episodes_total": 19520, "training_iteration": 74, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-19-29", "timestamp": 1691021969, "time_this_iter_s": 15.20713758468628, "time_total_s": 2292.172221660614, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2292.172221660614, "timesteps_since_restore": 9696960, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 13.772727272727273, "ram_util_percent": 51.53636363636363}}
{"evaluation": {"episode_reward_max": -138.77765914797783, "episode_reward_min": -138.77765914797783, "episode_reward_mean": -138.77765914797783, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.77765914797783], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 57.83335154876113, "episode_reward_min": -326.9105882048607, "episode_reward_mean": -14.617809574013032, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.289527866989374, -4.485584219917655, -59.63763555884361, -17.067354932427406, -17.69565497711301, 12.443489979952574, 10.285110773518682, -4.946800697594881, -22.435797065496445, 23.45080230385065, -1.701713852584362, -18.342329412698746, -37.03175453841686, 7.400199823081493, -27.78397235274315, 28.353017032146454, 4.737918876111507, 27.628847774118185, -8.476977799087763, 10.538446381688118, -20.88920409977436, -34.87224803119898, -33.22285149246454, -46.539413031190634, -4.308608770370483, -2.2154394052922726, -15.79316046088934, -21.31709387153387, 21.407716624438763, 6.2794778142124414, -6.004334386438131, 8.478598721325397, -36.865991190075874, 57.83335154876113, 24.062597952783108, 16.841820690780878, -22.404889278113842, -35.73217302560806, 25.270110484212637, 5.127937011420727, 1.6595589481294155, -31.527650943025947, 48.273010924458504, -43.03249491751194, -2.868088722229004, -76.32852528989315, 20.97996409982443, -24.77029920183122, -21.92601126432419, -13.366427037864923, -3.8512935116887093, 22.431640774011612, -24.129431143403053, 29.19541159272194, 43.30161513760686, -240.21850916743279, -248.2842705361545, 4.542791370302439, -59.03179969266057, 33.760856065899134, -22.236445862799883, 4.133110020309687, 4.084774173796177, 20.92674069106579, -23.50475512817502, -17.07940074801445, 31.775622259825468, -19.915124045684934, -21.29499227181077, -82.45412378758192, -95.03151317685843, -0.48754230700433254, -35.19024830311537, 38.52249638736248, -79.21161433123052, -17.991616759449244, -28.675443042069674, -326.9105882048607, 47.9678205139935, -25.842090614140034, 31.91035334765911, 16.940776154398918, 6.191468231379986, -40.59212973713875, -20.227307431399822, -38.06360411643982, -15.445495030842721, 0.19494258239865303, 16.871982656419277, 21.950991943478584, -2.587466098368168, 8.081894777715206, -61.35120140761137, 12.135043926537037, -18.10043179243803, -37.27085665613413, 22.47905489243567, 21.696109091863036, -8.216485220938921, 46.43807404115796, -70.04747845605016, -7.616024598479271, 27.388950176537037, -17.580183828249574, 15.517328262329102, 17.715777412056923, 4.342153515666723, -75.81738203763962, 34.26763749867678, 35.35434939712286, 5.510950844734907, 0.37356824427843094, 5.535209257155657, -44.5386219099164, -305.00457572191954, 30.644629798829556, 47.15253962576389, 15.677759997546673, 44.01697588711977, -31.362007685005665, -6.331703826785088, 41.695608131587505, -16.301109708845615, 20.078627161681652, -0.5480066537857056, 0.5719052813947201, -2.690804570913315, -239.93520683795214, -63.025392167270184, 3.0905791521072388, 3.0653857588768005, -10.734589040279388, 3.188555844128132, -78.51323290169239, -24.06405721604824, -21.174162909388542, 24.50921397842467, 12.14157435670495, -4.269948370754719, 13.471834026277065, 54.36687871441245, -22.93058694526553, 49.845875166356564, -72.58692921698093, 3.812018871307373, 34.797344114631414, 27.168904703110456, 0.8512367345392704, 10.976571768522263, -26.948480755090714, -32.86100596189499, 15.789850328117609, 20.591723538935184, 23.18539458885789, -39.32233356311917, 8.14155112579465, -76.31741209328175, 15.655287459492683, -16.695516653358936, -9.712086278945208, -17.764282576739788, -23.864470772445202, -26.916121408343315, 4.384520135819912, 42.95829847455025, -26.696643266826868, 32.315301014110446, 26.032272577285767, 6.329374285414815, -12.48917854577303, -37.39391527324915, -28.85634947195649, -67.88588150963187, -4.845141477882862, -27.14813319593668, -26.785169813781977, 20.189910784363747, -48.32392827421427, 12.81833978369832, 15.960195261985064, -82.9876005128026, -71.91747588664293, 13.026118768379092, -89.82440486550331, 1.1261175870895386, -1.631060402840376, -14.08510871231556, -54.26801235973835, -16.248291164636612, 20.108572214841843, 6.010468937456608, -59.32682917267084, 23.8220702894032, -32.0309855081141, -21.709432758390903, -10.493593476712704, 17.10154978185892, -4.316947869956493, -26.19248653203249, -43.96446758136153, -22.91186906211078, 46.20715307816863, -12.93173348531127, -12.795290015637875, -38.76310362666845, -58.13045431673527, -12.38045795634389, -5.3298076167702675, -39.810828279703856, -1.5446893870830536, -1.0024907290935516, -307.8217641040683, -39.887490160763264, -19.66063914448023, -19.768145442008972, 27.407809745520353, -12.829336203634739, -19.546333350241184, -49.540915720164776, -0.7200879864394665, -38.32818531244993, 0.002990391105413437, -258.41109239310026, -60.20866944640875, 30.17302843183279, 20.664014503359795, -39.474595844745636, -11.743679128587246, 27.898004561662674, 28.592488545924425, 13.723137751221657, 21.82420987635851, -6.346145499497652, 10.456736408174038, -15.665194384753704, -45.1378320120275, -28.213071398437023, 3.3457668349146843, 34.238140255212784, 15.138911955058575, -14.574595496058464, -21.731487471610308, 38.892559580504894, 27.446398608386517, -9.133203014731407, -7.517675027251244, -5.372700084000826, -25.335392218083143, 28.848075184971094, -43.122256334871054, -24.34350374341011, -8.551221057772636, -35.449756152927876, 9.816105756908655, -252.1834244504571, -44.07620371133089, -4.368389517068863, -20.600903898477554, -265.70069094002247, 9.423099506646395, -34.22076565772295, -6.690806841477752, 49.730461440980434, -48.67402682080865, 19.00933799147606, 4.490554945543408, -29.124145463109016, -18.701760444790125, -30.165145218372345, -5.015631124377251, 4.84747377038002, -236.0325046479702, -14.01194203644991, 12.405183598399162, -43.4696112126112, -43.87081857025623, -49.67969897389412, -42.258078798651695, 18.687282897531986, -89.63023276627064, -5.00205447524786, -50.22422721982002, 7.153217975050211, 0.7490881271660328, -3.7613037154078484, 7.971952944993973, -41.407751221209764, -10.631603959947824, -20.26194427162409, -31.106321092694998, 17.91850157082081, -249.5089445412159, 39.77544876933098, 7.056284919381142, 8.912145681679249, 7.633600927889347, 30.043633699417114, 5.807147949934006, 23.05216445028782, -7.745616350322962, 27.734808165580034, -65.44088064879179, 42.3681268543005, 8.621015787124634, 35.27868015691638, 55.112632758915424, 15.246927633881569, 9.208620242774487, -89.04398197308183, 33.94229427725077, -40.85467104241252, -92.97458596527576, 45.133745577186346, 16.998257614672184, 43.03309889882803, 8.31786236166954, 47.10633260011673, 19.23373106867075, 10.644369374960661, 19.369495891034603, -3.4079803209751844, -11.928709130734205, 22.95256983116269, -41.02965426072478, -49.104128677397966, 46.6366550065577, 57.379441659897566, 11.148484479635954, -69.42776717245579, -91.41452828794718, -14.896705638617277, 32.89370881021023, -276.4242402911186, 39.90342444553971, -31.841794565320015, -43.885417722165585, -51.00408799946308, 31.16029830276966, -26.69399117678404, -59.89005380123854, 34.89348890259862, -14.906213589012623, -8.324208661913872, 7.012313552200794, 37.53954955562949, -11.902394611388445, 42.88654298707843, -1.1279232576489449, 51.037941217422485, 16.066971972584724, 30.92904095351696, 11.574456490576267, 30.241892706602812, -3.7582230865955353, -11.491280749440193, -62.41292579472065, -56.06575358659029, -0.8655805476009846, -58.17081441730261, 3.592077177017927, -5.34696576744318, -176.73829306289554, -57.288652557879686, 7.2286658603698015, -6.084998946636915, 30.043696522712708, -20.07073948904872, 22.99924710392952, 47.40685706399381, 16.169679827988148, -10.293397709727287, 12.541252521798015, -12.98335949331522, -214.93512130528688, -18.77574196830392, -35.33020594716072, 35.68511554971337, -10.46279650554061, 49.9268215931952, 15.611943691968918, -4.775086153298616, -4.814925581216812, -6.348418556153774, -6.457051120698452, 4.215806849300861, -4.558865778148174, 36.1810504719615, 36.04060002602637, -10.40792865678668, -16.331237994134426, -31.127726800739765, 7.942818388342857, -17.050702769309282, 10.24710289388895, 11.74790757149458, 14.135263523086905, 19.246571473777294, 4.927171070128679, 40.25377094000578, -30.40946903079748, 49.23151585459709, -27.24996130540967, 7.839326273649931, 25.778249498456717, -83.72085293382406, 8.56028289347887, -2.35488398373127, -20.622889757156372, 21.59396444633603, -43.238131031394005, -57.53640829771757, -30.58357408642769, -39.164279118180275, -15.761832386255264, 30.299534305930138, 14.00968274101615, -11.488254398107529, -1.4039418064057827, -29.12870367988944, -17.380618549883366, 31.756763271987438, -21.68969202786684, -3.042526625096798, 21.8270995169878, 16.38475961610675, -24.237398698925972, -27.935613717883825, 6.201899766921997, 11.388708218932152, -35.38669119402766, -93.83172408491373, 45.7487418949604, -6.331439610570669, -40.91794636845589, -54.731938771903515, -65.77922690659761, -9.686213806271553, -49.17581334337592, 4.728287609294057, 15.344981221482158, -47.463124580681324, -218.11850214004517, 7.540205165743828, 11.297530859708786, -24.846488755196333, 14.428827837109566, 30.502704113721848, -12.737525552511215, -5.453278999775648, -80.11857804656029, -8.526579422876239, -50.99402103945613, 0.25435495376586914, -44.62726217508316, -2.8512853607535362, 46.61920922994614, 10.693816605955362, -13.763443741947412, -23.956007458269596, 10.757635161280632, -19.04739848896861, -31.270589642226696, -15.021844580769539, -28.460255037993193, -51.73468667268753, 8.468794971704483, 25.991438169032335, -39.77012147009373, 8.740236304700375, -39.34925661236048, -22.637061897665262, -37.6631271019578, -32.96976875886321, -15.79319915547967, -40.3437484651804, 9.867737676948309, 1.1498307883739471, 35.92230495810509, 9.437525033950806, -39.360591910779476], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420022940562948, "mean_inference_ms": 4.5536862604135475, "mean_action_processing_ms": 4.2094999856322355, "mean_env_wait_ms": 3.229735362158279, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9828000, "timesteps_this_iter": 131040, "agent_timesteps_total": 9828000, "timers": {"sample_time_ms": 29690.599, "sample_throughput": 4413.518, "load_time_ms": 23.448, "load_throughput": 5588567.032, "learn_time_ms": 14918.622, "learn_throughput": 8783.653, "update_time_ms": 2.23}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0587911840678752e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 116.73513387440862, "policy_loss": 0.0009944660809524605, "vf_loss": 23.345545264555135, "vf_explained_var": 0.3702719973193275, "kl": 0.0023815582564149025, "entropy": -0.48738716387834174, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9828000, "num_agent_steps_sampled": 9828000, "num_steps_trained": 9828000, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9828000}, "done": false, "episodes_total": 20000, "training_iteration": 75, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-20-08", "timestamp": 1691022008, "time_this_iter_s": 39.14424228668213, "time_total_s": 2331.316463947296, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2331.316463947296, "timesteps_since_restore": 9828000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 44.26428571428572, "ram_util_percent": 51.59821428571429}}
{"episode_reward_max": 49.23151585459709, "episode_reward_min": -218.11850214004517, "episode_reward_mean": -11.642357038315385, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.775086153298616, -4.814925581216812, -6.348418556153774, -6.457051120698452, 4.215806849300861, -4.558865778148174, 36.1810504719615, 36.04060002602637, -10.40792865678668, -16.331237994134426, -31.127726800739765, 7.942818388342857, -17.050702769309282, 10.24710289388895, 11.74790757149458, 14.135263523086905, 19.246571473777294, 4.927171070128679, 40.25377094000578, -30.40946903079748, 49.23151585459709, -27.24996130540967, 7.839326273649931, 25.778249498456717, -83.72085293382406, 8.56028289347887, -2.35488398373127, -20.622889757156372, 21.59396444633603, -43.238131031394005, -57.53640829771757, -30.58357408642769, -39.164279118180275, -15.761832386255264, 30.299534305930138, 14.00968274101615, -11.488254398107529, -1.4039418064057827, -29.12870367988944, -17.380618549883366, 31.756763271987438, -21.68969202786684, -3.042526625096798, 21.8270995169878, 16.38475961610675, -24.237398698925972, -27.935613717883825, 6.201899766921997, 11.388708218932152, -35.38669119402766, -93.83172408491373, 45.7487418949604, -6.331439610570669, -40.91794636845589, -54.731938771903515, -65.77922690659761, -9.686213806271553, -49.17581334337592, 4.728287609294057, 15.344981221482158, -47.463124580681324, -218.11850214004517, 7.540205165743828, 11.297530859708786, -24.846488755196333, 14.428827837109566, 30.502704113721848, -12.737525552511215, -5.453278999775648, -80.11857804656029, -8.526579422876239, -50.99402103945613, 0.25435495376586914, -44.62726217508316, -2.8512853607535362, 46.61920922994614, 10.693816605955362, -13.763443741947412, -23.956007458269596, 10.757635161280632, -19.04739848896861, -31.270589642226696, -15.021844580769539, -28.460255037993193, -51.73468667268753, 8.468794971704483, 25.991438169032335, -39.77012147009373, 8.740236304700375, -39.34925661236048, -22.637061897665262, -37.6631271019578, -32.96976875886321, -15.79319915547967, -40.3437484651804, 9.867737676948309, 1.1498307883739471, 35.92230495810509, 9.437525033950806, -39.360591910779476], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401991610255981, "mean_inference_ms": 4.5434021151218715, "mean_action_processing_ms": 4.153957972881233, "mean_env_wait_ms": 3.200743180534993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9959040, "timesteps_this_iter": 131040, "agent_timesteps_total": 9959040, "timers": {"sample_time_ms": 27267.927, "sample_throughput": 4805.646, "load_time_ms": 21.838, "load_throughput": 6000504.347, "learn_time_ms": 14919.058, "learn_throughput": 8783.396, "update_time_ms": 2.223}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.293955920339376e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 123.82548384267687, "policy_loss": -0.0015752292808854224, "vf_loss": 24.766177635466327, "vf_explained_var": 0.27616007086623956, "kl": 0.002198910161871196, "entropy": -0.49478692040648514, "entropy_coeff": 0.001}}}, "num_steps_sampled": 9959040, "num_agent_steps_sampled": 9959040, "num_steps_trained": 9959040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 9959040}, "done": false, "episodes_total": 20000, "training_iteration": 76, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-20-23", "timestamp": 1691022023, "time_this_iter_s": 15.371031284332275, "time_total_s": 2346.6874952316284, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2346.6874952316284, "timesteps_since_restore": 9959040, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 14.036363636363637, "ram_util_percent": 51.19545454545455}}
{"episode_reward_max": 68.01677906885743, "episode_reward_min": -396.8196604177356, "episode_reward_mean": -18.35558937007639, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.237777270376682, -25.365389358252287, -26.810553085058928, 25.814265493303537, 9.473636522889137, -29.517157927155495, -3.7248651199042797, -2.2358243204653263, -38.149268202483654, -32.37924684211612, 18.506669126451015, -15.917798269540071, -16.745578311383724, -210.92014173418283, -42.37232495844364, -33.29638157784939, -81.19611097499728, 23.15457771345973, 14.375264596194029, 6.777884688228369, -17.763265408575535, 21.641457252204418, 7.713954094797373, -19.717195317149162, -13.736184768378735, 25.509349387139082, -26.218088693916798, -7.341003689914942, 4.587439805269241, 27.679879762232304, -24.513958893716335, -19.662983380258083, -58.130334947258234, -9.7479367852211, 25.795795062556863, 36.6203334107995, -263.5698672682047, -28.374781474471092, -115.65550567954779, 0.8652851171791553, 8.076382033526897, -27.297429982572794, -59.16551510989666, 9.744961390271783, 32.477016516029835, 31.869927786290646, -1.0845019407570362, 11.59866826236248, 12.101615749299526, -7.299790270626545, -18.30650869011879, 14.641947317868471, 9.60376388579607, -20.550446026027203, -40.34278380125761, 28.85416040942073, -26.64596128463745, -14.41933437436819, -17.060697130858898, -8.265260271728039, 8.410444831475616, -1.8106796443462372, 41.509799748659134, -19.82322734221816, 28.303362257778645, -10.474916629493237, -66.86918967217207, -106.25622041523457, -1.6789927445352077, -48.8750314116478, -50.94862591102719, -2.776042304933071, 24.232429331168532, 45.62053357809782, -3.5632355138659477, -40.6007499396801, -9.060308195650578, -6.168169774115086, 9.765540987253189, -65.42399349808693, 3.6181147769093513, -77.35570031404495, 9.29270276427269, -110.38539178669453, -54.509395346045494, -23.93073832243681, 9.975120160728693, -12.210630021989346, 31.853078693151474, -42.739659797400236, -79.84119632095098, -56.19488047063351, -292.4985169582069, 2.6592122465372086, 37.55355715751648, -27.791867144405842, 4.463131301105022, -79.66001730039716, 54.23051402717829, -2.7878085002303123, -67.45098885893822, 39.91060208529234, 39.11753886938095, -81.44163187593222, -8.953005351126194, -37.433387625962496, -41.05680865049362, 10.75633704662323, -12.086325541138649, -7.547785088419914, 0.2585621029138565, 28.13721001893282, -33.479637302458286, 8.390309400856495, -41.80038046464324, 25.473794277757406, 3.1226707696914673, 19.932243067771196, -11.76015479117632, 35.39018991589546, -30.007491804659367, 16.32301254197955, -4.315158359706402, -8.76876724511385, -84.6320816911757, 48.20659075677395, 8.338166624307632, 4.032729886472225, -13.931812353432178, -57.8961928114295, 22.832018189132214, -35.93628949671984, 18.497579745948315, -2.374025342054665, 3.2531714886426926, -20.960087787359953, 10.326345633715391, -83.90209303796291, -25.290603432804346, -56.912053395062685, 13.849009092897177, -30.365948870778084, 20.96895707398653, -335.95805679261684, -51.822681441903114, -3.391409881412983, -289.5892478302121, 9.39846420288086, 9.003169402480125, -53.29458329081535, 19.96879325993359, -27.7370797470212, 2.9497313648462296, -2.142798710614443, 14.822115138173103, -51.08328901231289, -8.088376492261887, -18.893558140844107, 25.191053457558155, 22.330072589218616, -34.71231256425381, 2.455674309283495, 20.78648556023836, 22.115487471222878, -36.271522380411625, 2.526744730770588, -40.30085749179125, -72.72442588210106, 2.9369758404791355, -33.26139896735549, 11.124330721795559, 25.8485314771533, -8.164523649960756, -63.50317295640707, -16.77454110980034, -229.75386812537909, -26.381442945450544, 3.839514035731554, -100.28541912138462, -235.9925157763064, -38.255430437624454, -30.16929268836975, 7.259460993111134, -29.685310676693916, -270.1776428222656, -22.42017835378647, -61.324872333556414, 14.543782837688923, 50.1080220323056, 12.103032797574997, 10.335029158741236, -38.80681148171425, -28.07571342587471, -37.30517004430294, -47.593072559684515, -14.645664505660534, 2.0446625128388405, -11.66331447288394, 38.516977194696665, -49.01576463133097, -19.73753535747528, -24.004242904484272, -63.170233868062496, -264.04107531160116, -52.04234063625336, 33.82710711285472, 8.611198835074902, 16.250967418774962, 20.508184239268303, -39.28790857642889, -15.782118923962116, -13.694895647466183, 2.1327616460621357, -6.491706840693951, -38.55605360493064, -17.90838808566332, 6.541351042687893, 25.683501198887825, -21.06308514624834, 15.542668864130974, 45.18516059219837, 1.9609991945326328, -21.170908574014902, 20.02617769688368, 16.079550229012966, -11.938999496400356, -11.125982288271189, 36.3285245783627, -1.389684483408928, 31.516157373785973, 25.851992323994637, 37.24491488933563, -396.8196604177356, 16.28623278439045, -53.66754537820816, -50.057167530059814, 15.001701418310404, -7.838692590594292, 24.642822831869125, -49.37518520094454, -4.750605173408985, 7.002717170864344, 29.275988694280386, -12.705669164657593, 28.225627958774567, -24.771734945476055, 47.30404480546713, 11.961838439106941, -27.563473604619503, -20.959512017667294, -59.963329531252384, -26.184513419866562, 2.7994078248739243, -24.328667640686035, 28.357144072651863, 47.38050937280059, 19.792393036186695, -11.405876189470291, -24.985907830297947, -53.903051264584064, 6.216542467474937, 10.863251428119838, 10.84695402532816, -12.301292933523655, -1.3692583590745926, -21.741091445088387, -3.0602282136678696, -29.66082038730383, -24.78466386348009, 28.18012983724475, -10.089626587927341, 22.09381247125566, 10.050347588956356, -2.201022520661354, 5.457648284733295, -46.20990313589573, -4.060124408453703, 6.482288245111704, -50.27257068455219, -21.97840727865696, 45.602968007326126, -200.66636798903346, 12.46907563880086, -40.40585024654865, -63.830036260187626, 7.4226566180586815, -2.8571251407265663, 26.776381015777588, 19.249361228197813, -99.96770422160625, -13.70282108336687, -8.152322437614202, -0.5733847245573997, -15.190036095678806, 12.062639184296131, -10.586443550884724, 15.130238331854343, -21.010427474975586, -39.62017249315977, 0.6876778975129128, 18.90839572250843, -73.86264740303159, -47.849436324089766, 30.540697310119867, -27.864328905940056, 6.026268854737282, 34.382574908435345, -48.32205164805055, 6.943138554692268, 9.694913778454065, 14.695024468004704, -42.70453691482544, -11.348195470869541, -61.678619369864464, -101.21253764629364, -308.15961553528905, -7.5669143460690975, -28.122514635324478, 32.70751732587814, 7.3873192965984344, -7.658987835049629, 44.68352761864662, -20.7434140779078, -36.47723522782326, -10.113737486302853, 27.07493787817657, 25.364373948425055, -14.416874293237925, 7.8825788497924805, -3.1877712346613407, 17.30786580219865, 5.331151328980923, 23.028691716492176, -57.7616341561079, -26.160784512758255, -33.54419367015362, -8.016968488693237, 20.10043467581272, -0.51927150785923, 22.41607318073511, -52.79653510451317, 15.395132310688496, 8.746078081429005, 27.070264719426632, 14.074891529977322, -1.1220132075250149, 37.05194462835789, -12.65094829723239, -118.37367201596498, -56.6575703471899, 14.9801076464355, -30.60198850184679, 49.04529934749007, -34.9073517229408, -11.114822581410408, -29.61400281637907, -47.774351451545954, 19.431592874228954, -18.760017722845078, 3.5742100551724434, 18.69056896492839, -39.69593469053507, -0.14419493079185486, -6.121384933590889, -32.73808452486992, -12.32566349953413, -8.655276156961918, -166.8277243450284, -15.534316157922149, -234.0898683667183, -0.034836530685424805, -14.958908312022686, -68.29458287730813, -84.12590765208006, -32.50900027528405, -20.196064326912165, 7.870629854500294, -32.69878939539194, 3.804912231862545, -14.64378572255373, 28.747874839231372, 19.375321850180626, 24.03474049270153, 56.47788613289595, 3.2228367254137993, -13.68527253717184, -21.36372059956193, -2.5250768065452576, 0.7639082111418247, -70.94089240580797, -37.538855385035276, 7.32908071577549, -6.96601327508688, 34.66069819405675, -20.810506340116262, 1.4592164941132069, -3.538090243935585, -25.59775047004223, -25.455654494464397, 48.91914625838399, 21.9945869743824, -60.188078701496124, -26.203362211585045, -0.37447676807641983, 27.95844230055809, -256.36899814382195, 41.42000553756952, -33.510892033576965, 25.210662096738815, -27.97027826681733, -6.473860703408718, 6.40834766626358, 15.428514774888754, 37.17896209657192, 9.285713896155357, 28.938067741692066, 22.373379562050104, 5.349686797708273, -204.63451924175024, -5.20129257440567, -38.21907636523247, 3.905650343745947, 7.84785608574748, -0.5093568190932274, -5.6092083640396595, 11.8225142583251, 5.642482526600361, 24.07854649424553, -72.74913135170937, -26.58575900644064, -34.892452113330364, -53.99688698351383, -80.03570207208395, -54.21973887830973, -113.19345223903656, 8.902528896927834, 31.733479030430317, 68.01677906885743, 11.563353614881635, -48.47613422572613, -21.01081307977438, 43.30995300412178, -7.216357439756393, -26.254716634750366, 48.8309468254447, -5.927438244223595, 5.840942654758692, -13.39653004705906, 14.284673649817705, -214.59156251698732, 35.88712737336755, 5.328950829803944, -6.702347092330456, -31.702155899256468, -81.63907559029758, 13.279758960008621, -52.252165637910366, -9.26209906116128, 29.67569126188755, 16.57156340777874, 26.285923775285482, -20.40128563530743, 32.008573561906815, -205.02162943407893, 0.8345574736595154, 43.51537299901247, -47.722312062978745, -37.399104461073875, -1.3464351370930672, -30.99438349530101, -65.01027026027441, -65.50180842727423, 3.051436100155115, 5.3564820401370525, -43.67251118272543, 18.023547038435936, 12.24844541028142, -6.278627775609493, 8.786798175424337, -5.834719277918339], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4199429475329834, "mean_inference_ms": 4.553949555849793, "mean_action_processing_ms": 4.2096759857473085, "mean_env_wait_ms": 3.230324777704225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10090080, "timesteps_this_iter": 131040, "agent_timesteps_total": 10090080, "timers": {"sample_time_ms": 29704.231, "sample_throughput": 4411.493, "load_time_ms": 23.494, "load_throughput": 5577677.948, "learn_time_ms": 14908.561, "learn_throughput": 8789.581, "update_time_ms": 2.214}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.646977960169688e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 131.35896569681617, "policy_loss": 0.0016538936666017482, "vf_loss": 26.26964178392964, "vf_explained_var": 0.2699224954223975, "kl": 0.002367791333255965, "entropy": -0.4977927390606173, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10090080, "num_agent_steps_sampled": 10090080, "num_steps_trained": 10090080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10090080}, "done": false, "episodes_total": 20480, "training_iteration": 77, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-21-03", "timestamp": 1691022063, "time_this_iter_s": 39.56753063201904, "time_total_s": 2386.2550258636475, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2386.2550258636475, "timesteps_since_restore": 10090080, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 44.23571428571429, "ram_util_percent": 51.45}}
{"episode_reward_max": 68.01677906885743, "episode_reward_min": -256.36899814382195, "episode_reward_mean": -13.738018237948417, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.747874839231372, 19.375321850180626, 24.03474049270153, 56.47788613289595, 3.2228367254137993, -13.68527253717184, -21.36372059956193, -2.5250768065452576, 0.7639082111418247, -70.94089240580797, -37.538855385035276, 7.32908071577549, -6.96601327508688, 34.66069819405675, -20.810506340116262, 1.4592164941132069, -3.538090243935585, -25.59775047004223, -25.455654494464397, 48.91914625838399, 21.9945869743824, -60.188078701496124, -26.203362211585045, -0.37447676807641983, 27.95844230055809, -256.36899814382195, 41.42000553756952, -33.510892033576965, 25.210662096738815, -27.97027826681733, -6.473860703408718, 6.40834766626358, 15.428514774888754, 37.17896209657192, 9.285713896155357, 28.938067741692066, 22.373379562050104, 5.349686797708273, -204.63451924175024, -5.20129257440567, -38.21907636523247, 3.905650343745947, 7.84785608574748, -0.5093568190932274, -5.6092083640396595, 11.8225142583251, 5.642482526600361, 24.07854649424553, -72.74913135170937, -26.58575900644064, -34.892452113330364, -53.99688698351383, -80.03570207208395, -54.21973887830973, -113.19345223903656, 8.902528896927834, 31.733479030430317, 68.01677906885743, 11.563353614881635, -48.47613422572613, -21.01081307977438, 43.30995300412178, -7.216357439756393, -26.254716634750366, 48.8309468254447, -5.927438244223595, 5.840942654758692, -13.39653004705906, 14.284673649817705, -214.59156251698732, 35.88712737336755, 5.328950829803944, -6.702347092330456, -31.702155899256468, -81.63907559029758, 13.279758960008621, -52.252165637910366, -9.26209906116128, 29.67569126188755, 16.57156340777874, 26.285923775285482, -20.40128563530743, 32.008573561906815, -205.02162943407893, 0.8345574736595154, 43.51537299901247, -47.722312062978745, -37.399104461073875, -1.3464351370930672, -30.99438349530101, -65.01027026027441, -65.50180842727423, 3.051436100155115, 5.3564820401370525, -43.67251118272543, 18.023547038435936, 12.24844541028142, -6.278627775609493, 8.786798175424337, -5.834719277918339], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402988551735347, "mean_inference_ms": 4.544229068159173, "mean_action_processing_ms": 4.154962784994835, "mean_env_wait_ms": 3.2007768677574755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10221120, "timesteps_this_iter": 131040, "agent_timesteps_total": 10221120, "timers": {"sample_time_ms": 27282.456, "sample_throughput": 4803.087, "load_time_ms": 21.752, "load_throughput": 6024392.528, "learn_time_ms": 14930.927, "learn_throughput": 8776.414, "update_time_ms": 2.228}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.323488980084844e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 135.381069480025, "policy_loss": 0.0023555334637294896, "vf_loss": 27.07335134390007, "vf_explained_var": 0.21601783545641062, "kl": 0.0022310778787810234, "entropy": -0.5073576535375315, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10221120, "num_agent_steps_sampled": 10221120, "num_steps_trained": 10221120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10221120}, "done": false, "episodes_total": 20480, "training_iteration": 78, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-21-18", "timestamp": 1691022078, "time_this_iter_s": 15.356695652008057, "time_total_s": 2401.6117215156555, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2401.6117215156555, "timesteps_since_restore": 10221120, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 14.427272727272724, "ram_util_percent": 51.70000000000002}}
{"episode_reward_max": 67.37849466875196, "episode_reward_min": -330.23502277582884, "episode_reward_mean": -15.537247468571877, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.296838842332363, -45.701870165765285, -26.877975411713123, 23.147431418299675, 23.870992932468653, -10.15154828503728, 43.81680643558502, 4.434342697262764, 0.5575022846460342, -51.01794610917568, -23.80437077023089, 0.8794334605336189, -53.81464126706123, -18.463711224496365, 10.30065469071269, 13.673945181071758, -193.53007423132658, 9.13294081762433, -50.78607288002968, 47.17498630285263, 8.015586350113153, 22.372213825583458, -45.69447907060385, -21.927860479801893, 38.3583487868309, 2.1639987230300903, -43.60991497337818, -29.957821927964687, -32.099515337496996, -4.471967749297619, 2.3708106726408005, -283.1625210046768, -31.261593028903008, -0.4198024645447731, -74.91288446635008, -53.273076424375176, 48.17690281569958, 22.609401755034924, 27.986859045922756, -8.613608174026012, -47.9191456399858, -64.47163129597902, -2.460503913462162, -62.217384576797485, -26.228842541575432, -48.898909125477076, -22.27864271402359, -14.019974663853645, -24.23955811560154, 26.360729973763227, -29.77875564992428, -15.177379801869392, 2.7653692066669464, 30.853795781731606, -19.780924305319786, -17.271334322169423, -56.2861033603549, 4.511937398463488, -17.44727937504649, 16.38076431490481, -38.60274017602205, -37.037012577056885, -79.17973671853542, -73.73888492584229, -25.68682723492384, -12.417925011366606, 4.563983291387558, -43.44753537606448, 23.223842667415738, -0.9393602646887302, 30.189189914613962, 56.95148166269064, 28.26137074828148, -71.8132103830576, -15.68326485157013, -32.67742921411991, 30.026666067540646, -265.3551154322922, -43.020984910428524, -20.54954046756029, 37.853253334760666, 33.64871285110712, -43.17656108736992, -13.902087099850178, -33.104279302060604, 8.880498748272657, -42.61838471144438, 37.26692374050617, -1.2561678364872932, 6.301629975438118, 33.72066827863455, 15.331949472427368, -78.13288848847151, 5.007100850343704, 25.230950608849525, -143.80545619875193, 11.00406651943922, 16.292045667767525, -9.409155147150159, -9.66924238204956, -28.245924148708582, 0.5371731445193291, -45.335318475961685, -41.1740296036005, 1.5218804515898228, -17.983379624783993, -63.77944214642048, -115.20868001878262, -4.542551945894957, 11.224112138152122, 48.87828376889229, -18.62024748325348, 14.52949444949627, 23.188915967941284, 0.0016260966658592224, 26.575079064816236, -67.9579709470272, -38.004088915884495, 10.201286427676678, -23.26196724921465, 22.081437073647976, -17.69775303453207, 14.228173732757568, 4.086827993392944, 40.89210567250848, -6.376985549926758, -30.129820864647627, 24.872739985585213, -18.207009561359882, 3.944177497178316, -69.0590799599886, 35.15248776227236, 34.18298990651965, -35.83441387116909, -25.174492552876472, 14.82600124180317, -31.037933023646474, -37.992537409067154, -72.16044644266367, 13.508359223604202, 4.779904004186392, -148.32663632929325, 10.381931148469448, -30.28328385949135, 10.460623398423195, -6.504713378846645, -45.35867242515087, 14.711935304105282, 24.176348350942135, -31.426252365112305, -12.522801768034697, 33.9969127625227, -62.63358102738857, -52.49024423956871, -16.42653426527977, -74.38839577138424, 35.18090479820967, 17.475408867001534, -263.8275927975774, -50.2385035045445, 28.845034457743168, -48.8029112406075, -28.60165996849537, 21.157980486750603, -9.463001549243927, 47.254982359707355, 22.800462529063225, -14.039834268391132, -45.137505762279034, 17.388205967843533, -7.367504723370075, -26.118851494044065, 37.52922584861517, -30.039314597845078, 24.750977888703346, 26.605961050838232, -33.85424030944705, 26.299337048083544, -8.090365439653397, 3.975425735116005, 53.04367070645094, -6.212756842374802, -12.0192359238863, 31.964081324636936, -20.103686332702637, -20.096476048231125, -26.768554650247097, 16.647112227976322, -66.7194798886776, -76.230338960886, -43.17250841110945, 8.787359468638897, 20.10587610118091, -19.933160066604614, 8.186050305142999, 30.056245926767588, 3.12213471904397, 33.39196003228426, -24.089591808617115, 23.442741859704256, -68.27139748632908, 10.977215260267258, 17.9209972769022, 31.578624416142702, 67.37849466875196, -20.615695036947727, -2.113715283572674, 4.616610325872898, -66.67208056151867, -47.919460475444794, 35.13321040198207, -76.18563655391335, -13.836480721831322, 15.219779998064041, -17.55151254683733, -8.330037716776133, -62.98179329931736, 9.91746175289154, -4.091098070144653, -7.451172683387995, -62.4374410584569, -57.32228386029601, -85.35782220959663, -34.993697326630354, -8.333275154232979, 16.2747290879488, 9.868907436728477, -46.64989238977432, -10.784472782164812, -30.584584698081017, 1.2295066975057125, -53.243243128061295, 27.90778037905693, 12.241827182471752, -21.81059679016471, -18.499997198581696, -11.246487863361835, 0.429343044757843, -45.2059091180563, -19.545527286827564, 12.40125934779644, 12.386208228766918, 6.901274807751179, -30.638142615556717, -28.99269475787878, -20.645081363618374, -62.85271244496107, 41.6376547254622, -44.72855622321367, -54.09188747406006, -24.67387843132019, -14.71794480085373, 22.17793346568942, -38.401644852012396, 0.9341755956411362, 0.4298832844942808, -5.550745040178299, -27.861535161733627, 17.943145383149385, -62.51789000630379, -14.519317589700222, -42.34367898106575, 0.22280360758304596, -25.255910456180573, -2.1704802066087723, 34.265416856855154, 3.9601180851459503, -58.730665512382984, -5.016408249735832, 16.362378166988492, 3.7567049488425255, -24.871574066579342, -40.46060186624527, -46.14613153040409, -8.761068686842918, -52.24898337572813, 11.477338075637817, 33.330180674791336, -4.969017937779427, 4.168682560324669, -85.92731419950724, -54.29945829510689, -83.2656092569232, 17.390610672533512, -63.43694885075092, 18.17595149949193, -14.986562125384808, -0.6957854963839054, -51.253461576998234, 18.963613845407963, 11.57948486506939, -9.656566865742207, -81.66625656187534, -25.00180847942829, 30.96331577003002, 0.3607957921922207, 21.452486649155617, -51.81981795281172, 20.916262740269303, 52.27326083369553, 6.146683137863874, 44.61294128373265, -45.58955371007323, -17.52821773290634, 14.817823518067598, -46.05642209947109, -12.057456485927105, -50.05717821419239, 20.35526356846094, 7.935806447640061, 25.461815048009157, 20.437789257615805, -33.55260377377272, -32.95249603688717, 19.869695082306862, 56.08429021388292, -8.436842255294323, -42.45536655187607, 37.91700656712055, -11.833317145705223, -35.37857909500599, 4.445068642497063, 7.5782870799303055, 7.078820649534464, -45.726749151945114, -39.00539989024401, 10.79159802570939, -52.40582923591137, -19.33222757279873, -68.53019113838673, 1.4453268200159073, -12.270011588931084, -21.933800905942917, 4.151398278772831, -16.499938026070595, -276.76532743126154, -50.29917161911726, -31.163036935031414, -58.57255647331476, 10.811076126992702, 62.88955836184323, -10.874941512942314, 14.40553192794323, 36.25327713787556, -16.911155208945274, 8.319359615445137, 31.601353257894516, 25.685865953564644, 59.816051818430424, -5.847255192697048, 34.895380318164825, -45.85620437562466, -4.616758605465293, -26.34197274595499, -42.94398072361946, 22.65965999662876, -22.650302425026894, -9.271328836679459, 5.507079757750034, 15.372893817722797, -69.72626021504402, 38.3650656118989, 5.133851200342178, -15.15352476388216, 32.0154836922884, -9.620411645621061, -112.71683585643768, 8.383350729942322, 25.358017183840275, 11.900361619889736, 30.585583437234163, -19.63198385387659, 17.200981467962265, 3.1375866681337357, 12.383745361119509, -0.48275963962078094, -31.611000061035156, -82.32313947379589, -62.66336268931627, -10.749790292233229, -199.61612491682172, 12.227802783250809, -23.904906556010246, -23.804619900882244, -23.952223401516676, -19.81930584460497, 26.75944823771715, -50.23259458318353, -0.740137942135334, 9.233300268650055, -38.80216635018587, -36.68318843841553, -49.56952741742134, -15.976552844047546, 43.76522473245859, -17.000843480229378, 27.590269722044468, 22.89054961502552, -110.53857423365116, -125.19700290262699, -17.256686616688967, -103.944917909801, 13.209937922656536, -12.38501413166523, 19.75307720527053, 32.063162330538034, 27.06016905605793, -5.099058482795954, -16.00289760529995, 56.422386042773724, -7.40923710539937, -37.901068015024066, -44.00524378567934, 7.243360284715891, -15.842011479660869, -14.329174101352692, -43.30648200586438, -66.78070164471865, 30.083003452047706, -26.504427425563335, -232.7215933315456, -12.547349855303764, -93.4876922890544, -83.58561810106039, 59.87104279175401, -9.342389687895775, -14.60627680271864, 5.386588457971811, -10.313061270862818, -58.75098581984639, 23.664304114878178, 13.571069167926908, -24.49022462964058, -15.534730844199657, -34.557554110884666, 20.706941831856966, -40.5933756865561, -9.349531434476376, 7.942093715071678, -23.27649111300707, -48.27251588925719, 55.08762726560235, 18.586021676659584, 30.127703689038754, 4.8174993097782135, -3.021834369748831, 7.935137445107102, -3.3585666827857494, 23.624294823035598, 25.87740159779787, -24.61733704805374, 41.257697477936745, 4.604964099824429, 4.863315299153328, 15.028024170547724, -37.29815608263016, -8.059778198599815, -84.43538080900908, 46.33748610317707, -22.05709191597998, -14.397953428328037, -50.9012511074543, 2.240235723555088, -3.952673837542534, 20.91832122206688, -45.52794160693884, -20.261578269302845, -287.94698798656464, -19.379578184336424, -12.100485801696777, 15.58940453082323, -4.417797841131687, -0.281157411634922, -40.85002191364765, -5.920457728207111, -330.23502277582884, -7.613573849201202, -4.300014764070511, 29.048409931361675, 26.37367805838585], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420774513285733, "mean_inference_ms": 4.554022306218488, "mean_action_processing_ms": 4.209732227357752, "mean_env_wait_ms": 3.2304392722486965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10352160, "timesteps_this_iter": 131040, "agent_timesteps_total": 10352160, "timers": {"sample_time_ms": 29711.112, "sample_throughput": 4410.471, "load_time_ms": 23.46, "load_throughput": 5585647.768, "learn_time_ms": 14937.041, "learn_throughput": 8772.822, "update_time_ms": 2.228}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.61744490042422e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 147.6930230729503, "policy_loss": -0.000534065506282798, "vf_loss": 29.538629583133165, "vf_explained_var": 0.23949689794612186, "kl": 0.0022682896671079246, "entropy": -0.5095953238480407, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10352160, "num_agent_steps_sampled": 10352160, "num_steps_trained": 10352160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10352160}, "done": false, "episodes_total": 20960, "training_iteration": 79, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-21-58", "timestamp": 1691022118, "time_this_iter_s": 39.33606147766113, "time_total_s": 2440.9477829933167, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2440.9477829933167, "timesteps_since_restore": 10352160, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 44.4375, "ram_util_percent": 51.47500000000001}}
{"evaluation": {"episode_reward_max": -197.9628921598196, "episode_reward_min": -197.9628921598196, "episode_reward_mean": -197.9628921598196, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.9628921598196], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 59.87104279175401, "episode_reward_min": -330.23502277582884, "episode_reward_mean": -20.572077674437313, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.61612491682172, 12.227802783250809, -23.904906556010246, -23.804619900882244, -23.952223401516676, -19.81930584460497, 26.75944823771715, -50.23259458318353, -0.740137942135334, 9.233300268650055, -38.80216635018587, -36.68318843841553, -49.56952741742134, -15.976552844047546, 43.76522473245859, -17.000843480229378, 27.590269722044468, 22.89054961502552, -110.53857423365116, -125.19700290262699, -17.256686616688967, -103.944917909801, 13.209937922656536, -12.38501413166523, 19.75307720527053, 32.063162330538034, 27.06016905605793, -5.099058482795954, -16.00289760529995, 56.422386042773724, -7.40923710539937, -37.901068015024066, -44.00524378567934, 7.243360284715891, -15.842011479660869, -14.329174101352692, -43.30648200586438, -66.78070164471865, 30.083003452047706, -26.504427425563335, -232.7215933315456, -12.547349855303764, -93.4876922890544, -83.58561810106039, 59.87104279175401, -9.342389687895775, -14.60627680271864, 5.386588457971811, -10.313061270862818, -58.75098581984639, 23.664304114878178, 13.571069167926908, -24.49022462964058, -15.534730844199657, -34.557554110884666, 20.706941831856966, -40.5933756865561, -9.349531434476376, 7.942093715071678, -23.27649111300707, -48.27251588925719, 55.08762726560235, 18.586021676659584, 30.127703689038754, 4.8174993097782135, -3.021834369748831, 7.935137445107102, -3.3585666827857494, 23.624294823035598, 25.87740159779787, -24.61733704805374, 41.257697477936745, 4.604964099824429, 4.863315299153328, 15.028024170547724, -37.29815608263016, -8.059778198599815, -84.43538080900908, 46.33748610317707, -22.05709191597998, -14.397953428328037, -50.9012511074543, 2.240235723555088, -3.952673837542534, 20.91832122206688, -45.52794160693884, -20.261578269302845, -287.94698798656464, -19.379578184336424, -12.100485801696777, 15.58940453082323, -4.417797841131687, -0.281157411634922, -40.85002191364765, -5.920457728207111, -330.23502277582884, -7.613573849201202, -4.300014764070511, 29.048409931361675, 26.37367805838585], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404220463884952, "mean_inference_ms": 4.544384818478012, "mean_action_processing_ms": 4.155491142362027, "mean_env_wait_ms": 3.2011905240262264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10483200, "timesteps_this_iter": 131040, "agent_timesteps_total": 10483200, "timers": {"sample_time_ms": 27301.198, "sample_throughput": 4799.789, "load_time_ms": 21.809, "load_throughput": 6008586.126, "learn_time_ms": 14934.902, "learn_throughput": 8774.078, "update_time_ms": 2.201}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.30872245021211e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 143.49680543403312, "policy_loss": 0.00520623096177203, "vf_loss": 28.693640356850025, "vf_explained_var": 0.2637242354372496, "kl": 0.0022935467936168676, "entropy": -0.5149691904958431, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10483200, "num_agent_steps_sampled": 10483200, "num_steps_trained": 10483200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10483200}, "done": false, "episodes_total": 20960, "training_iteration": 80, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-22-13", "timestamp": 1691022133, "time_this_iter_s": 14.991827011108398, "time_total_s": 2455.939610004425, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2455.939610004425, "timesteps_since_restore": 10483200, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 13.999999999999998, "ram_util_percent": 51.66363636363638}}
{"episode_reward_max": 65.47361319512129, "episode_reward_min": -445.9136379659176, "episode_reward_mean": -10.940302579145646, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.45589679852128, -12.228967767208815, -76.17499189078808, -22.99392155557871, 22.44759949296713, 17.851967591792345, 14.458568140864372, -43.61657864227891, 0.5645787194371223, 21.023510955274105, 17.66977844387293, 22.249030515551567, 16.2856662645936, 22.82315582036972, -59.4887264855206, 9.214399419724941, 22.41699144244194, -39.952314116060734, 52.40706595033407, 0.13052864372730255, -14.144414953887463, 24.951621524989605, -5.551720730960369, 43.43416150659323, -5.602465186268091, -28.11312161758542, 15.223426334559917, 19.821823939681053, -48.64765910804272, 27.23814109712839, -21.14759792946279, 3.116844404488802, -24.003241561353207, -8.576276127249002, 26.671547435224056, -27.767721690237522, 2.718771032989025, 27.794807836413383, -58.75586976855993, -49.16358360648155, -28.6985647007823, 46.142691403627396, -44.43255992233753, 39.10116809606552, 5.771530799567699, -38.338877610862255, -48.83305263519287, -6.0889989752322435, 15.377326786518097, -22.904700130224228, -15.398166382685304, 28.659383315593004, -13.293506614863873, -7.578020840883255, 12.53939414396882, 62.74140751361847, -12.631562203168869, -8.002026818692684, -59.233488857746124, 1.7915312126278877, -44.95683906599879, -0.4326311685144901, 6.8596033826470375, -79.41858942434192, -39.80694130808115, -31.164295122027397, 0.5065580233931541, 32.57428281754255, 1.0301361307501793, -11.970246192067862, 45.269596830010414, -32.75552438944578, 30.1892745308578, -27.449142519384623, 57.358220271766186, 40.00904677435756, 34.205205246806145, 0.9356801882386208, -30.99356223642826, -32.928381364792585, -22.99619622528553, -1.489843737334013, -73.00472754985094, -42.52328508347273, 2.089145429432392, -44.29463514685631, 13.083880975842476, -24.81992007791996, 9.114620499312878, -310.585017375648, -27.981571838259697, -47.231494411826134, -14.055038690567017, 8.66531540080905, 41.86926343291998, -22.76712206751108, -21.968593582510948, 3.0229456052184105, 32.617678977549076, -2.5280991196632385, -4.022731050848961, -36.84129071235657, -445.9136379659176, -5.7887570932507515, 8.896332781761885, -41.14483316242695, 24.50193254649639, 32.687093019485474, 11.503742419183254, 37.79247055016458, 21.75422838330269, 46.03834755718708, 44.66432239860296, -30.903412628918886, -62.255522556602955, 5.822368070483208, -20.15956836938858, 31.200494796037674, -5.165970660746098, 4.756569605320692, -7.253685241565108, -24.526509419083595, 8.43706851452589, 0.29622239619493484, -14.501447286456823, 51.04599450528622, 1.0014884918928146, -45.86450209468603, -58.76238642632961, 11.65508009493351, 2.534548796713352, -3.855483315885067, -18.508069522678852, -46.3102294318378, 36.52066294848919, -51.84517280757427, -17.95129595696926, -13.551952362060547, -1.2283621057868004, 25.25287253409624, -0.7936388030648232, -22.2364644408226, -4.22241135686636, 17.191417522728443, -0.9754800796508789, -19.51906643807888, 28.165170561522245, -17.041517317295074, -37.16983785480261, -20.351896956562996, 52.364594012498856, 20.009395740926266, 22.13681972026825, -35.78189116716385, 4.7560255117714405, 20.94390930235386, -11.680950552225113, 5.7196788638830185, 5.516965363174677, -13.084319494664669, -6.786222353577614, -48.21247439831495, 34.813209883868694, 4.075284641236067, -40.81516566127539, -26.461144782602787, -7.659051060676575, -20.022283472120762, -10.669689886271954, -9.646137408912182, 12.377733148634434, -17.953744500875473, 55.37266182154417, 3.204755797982216, -43.53193263337016, -288.1181552708149, 5.38419920951128, -7.465778104960918, 53.44323940202594, -52.59707707166672, 34.68102454394102, 13.60035202652216, -52.28111995756626, 8.581881284713745, -1.0103980377316475, -60.371634520590305, -48.4888695217669, -8.10530998930335, 8.972195491194725, 5.798477649688721, -23.622191287577152, -12.383096888661385, -46.46289773285389, 31.338640585541725, -20.206413254141808, 19.495058618485928, 1.550701841711998, 19.303938075900078, 6.571480138227344, 19.682633444666862, -39.42587447166443, -6.708152316510677, 22.009734101593494, -18.35323601961136, -1.11522526293993, -18.05201342701912, -42.065270110964775, -33.89927925169468, -7.4515058398246765, 17.024682693183422, -332.40279416553676, -246.8902356773615, -27.605092894285917, -252.34336955100298, 17.430103480815887, -6.88946964032948, 14.677024334669113, 48.54410284012556, -34.1773244664073, 3.106164276599884, 19.84710841625929, 57.610384434461594, 1.543401800096035, -63.8098353818059, -8.79280461370945, -17.042421892285347, -18.311821199953556, -49.50835237838328, 43.569010481238365, -9.298470169305801, -40.497257962822914, -16.009115325286984, 20.04412415623665, -1.3966184742748737, -36.61475505679846, -13.971795588731766, 4.81122038513422, 18.043767631053925, 18.6496209949255, 20.675346925854683, 7.489495977759361, 10.433070376515388, 46.16372024640441, -0.8585478588938713, -24.594845786690712, -9.663355687633157, -19.735498376190662, 6.37155144661665, -49.181462578475475, 20.350587353110313, -82.30802970379591, -20.068560160696507, -19.344367988407612, 13.803737044334412, 20.933379329741, 37.42380994558334, -29.07238271832466, -32.024299532175064, 20.781628593802452, -42.77272937446833, -5.2694838009774685, -5.537749540060759, 38.405798237770796, 33.12467485666275, 31.236634377390146, -17.30394048243761, -23.574211418628693, -9.661429278552532, 45.63435173779726, -39.7194752022624, 22.12052307277918, -5.885282054543495, 12.208615511655807, 60.60168690234423, -9.727951191365719, 11.52412473782897, -69.68256499618292, 42.24589515849948, -20.584821231663227, 12.089446440339088, -53.268322825431824, -17.530017092823982, 25.055591978132725, 9.065200991928577, -46.1292688138783, 14.972241818904877, -16.21691733598709, -12.433668944984674, -51.64831122010946, -14.737701430916786, -12.977149441838264, -2.2614680640399456, 22.940521873533726, -28.582917027175426, 4.240216292440891, 14.412587501108646, -58.55119610577822, -71.29113521426916, -31.896322248503566, 5.7045580111444, -74.87259773537517, 9.19528042897582, 0.710377462208271, -4.7199117206037045, -16.341791950166225, -1.0538797676563263, 12.167382068932056, -22.85045040398836, 16.364839676767588, 65.47361319512129, 2.997456930577755, -57.4713573679328, -53.469502314925194, 0.46598898619413376, -8.49857809022069, 5.3402104601264, -63.36283637583256, -52.352533338591456, -11.31780281662941, -3.833280712366104], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4211187493240995, "mean_inference_ms": 4.5535614714165495, "mean_action_processing_ms": 4.20941222943365, "mean_env_wait_ms": 3.229816301270843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10614240, "timesteps_this_iter": 131040, "agent_timesteps_total": 10614240, "timers": {"sample_time_ms": 29708.739, "sample_throughput": 4410.823, "load_time_ms": 23.339, "load_throughput": 5614617.005, "learn_time_ms": 14941.943, "learn_throughput": 8769.944, "update_time_ms": 2.221}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.654361225106055e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 135.24400553621345, "policy_loss": -0.0015107270311715713, "vf_loss": 27.049787035979676, "vf_explained_var": 0.2207621597688258, "kl": 0.0021759616995529964, "entropy": -0.5252430383449814, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10614240, "num_agent_steps_sampled": 10614240, "num_steps_trained": 10614240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10614240}, "done": false, "episodes_total": 21280, "training_iteration": 81, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-22-52", "timestamp": 1691022172, "time_this_iter_s": 39.3514666557312, "time_total_s": 2495.2910766601562, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2495.2910766601562, "timesteps_since_restore": 10614240, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 44.12142857142857, "ram_util_percent": 50.942857142857136}}
{"episode_reward_max": 57.18182398378849, "episode_reward_min": -612.5869169607759, "episode_reward_mean": -15.504520608473104, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.168589681386948, 54.28120680898428, 27.850283049046993, 23.88349161669612, 9.992367401719093, -17.77559643983841, -10.146482288837433, -85.40013454854488, 18.57639130949974, -105.06655971705914, 18.48554489389062, -0.6208590939640999, 28.294406473636627, -612.5869169607759, 4.274925794452429, -26.691675543785095, -18.327953919768333, -33.89039854332805, -86.94843670725822, -178.73320916295052, -42.45737282931805, -25.459036767482758, 5.910686232149601, 34.75969677045941, 1.6816129386425018, -13.008148852735758, 15.60945263132453, -0.381015844643116, -9.824442997574806, -15.774666525423527, 50.79575341939926, -39.019834861159325, -24.38971707224846, -4.170882441103458, -38.12231221795082, 25.454549305140972, -47.93670175969601, 15.971930798143148, -33.32786168158054, -39.961442194879055, -19.15201285481453, 11.902459643781185, 24.59984204918146, -36.855084642767906, -9.181778639554977, -92.92244477570057, -25.184709303081036, 36.557959616184235, 30.129557192325592, 36.014640249311924, -39.35894976183772, -43.10109094530344, -11.972603186964989, -26.852702252566814, -37.12944208085537, -13.04620872437954, -53.27583511918783, 10.409598756581545, 17.81598310917616, -69.51383608207107, -17.43397869169712, -2.257163904607296, -9.96827358007431, -12.515957035124302, 7.461415357887745, -72.3650407269597, -26.809374660253525, 15.940048538148403, -7.428294628858566, 3.5134189911186695, -29.318833015859127, 37.51957584172487, 19.65473233908415, -39.347027376294136, -15.767208632081747, -32.19359262287617, -29.312503438442945, -3.945900224149227, 0.46135421842336655, -72.63094653002918, -27.587949097156525, -5.7570940144360065, -13.721937090158463, -25.27969240397215, -45.07091497629881, -38.97329169511795, 14.050362043082714, 3.9556578397750854, -40.75447019934654, -32.58183899521828, 4.424986556172371, -44.1687025539577, 8.593902096152306, 35.93652915209532, 1.0710113048553467, -13.634620286524296, 2.540909565985203, -15.966863077133894, -38.24364810436964, -30.28693937510252, 5.912630505859852, 28.58202861994505, -36.19719137251377, 16.23442354798317, -4.073727425187826, -8.162200581282377, -25.886477753520012, -0.9515600055456161, 46.534874107688665, -36.481548212468624, -17.593794979155064, -66.51057627797127, 16.678510431200266, -27.199939101934433, 17.994907040148973, -12.241536792367697, -64.28216637857258, 39.06152747571468, 20.372990362346172, 28.871051363646984, -31.360684417188168, -41.0535854101181, -5.09182090125978, 23.74272335320711, 36.93567007407546, -19.59442028403282, -19.6505034416914, 14.593376448377967, -27.914357855916023, -7.978526748716831, -67.74152426049113, 4.253160230815411, -51.650443613529205, -6.092295244336128, 5.598440375179052, -14.53506126627326, -29.228966258466244, -31.783788457512856, -49.8523456081748, -13.30651980638504, -44.15029386430979, -39.82010483369231, -52.83008171617985, -46.106839552521706, -4.291954353451729, -18.643046785145998, -8.96092364937067, -33.48378536105156, 13.952398747205734, 12.119192987680435, -24.344402484595776, -37.39239600300789, 38.11013450101018, 49.98028737306595, 19.39504384994507, 21.954646963626146, -39.892943531274796, 2.74845177680254, 25.137133114039898, -42.23748581856489, -24.027049005031586, 46.330399714410305, -8.797744184732437, -64.97215780615807, -30.24721708148718, -3.1144347861409187, -1.8783107846975327, 17.86801291257143, -9.188499473035336, 3.3035102672874928, -32.99308369681239, -0.6787205785512924, -2.167189620435238, 37.73801389336586, 0.4179456755518913, -37.368742011487484, -6.923511527478695, -29.862164475023746, -298.250072658062, 14.0033505782485, -20.33014165237546, 0.1149216154590249, -25.000316262245178, 34.49631603062153, -47.347714841365814, -18.823179811239243, 26.43452525883913, -5.052969813346863, -0.33327316492795944, 19.74910567328334, -12.467056594789028, -69.10380764305592, 11.954538352787495, -70.60824842751026, -19.679382283240557, 33.03480353206396, -52.107010036706924, -1.525313712656498, -134.2778326123953, 57.18182398378849, 32.24075420945883, 4.372953213751316, -43.298118986189365, 4.268330350518227, -0.5571973621845245, 39.14771547168493, -36.19800343364477, -5.289444379508495, 22.504354789853096, 13.9604527130723, -29.502407737076283, 7.9279976189136505, 17.91242927312851, 5.378586187958717, -36.08768533915281, 21.34620951861143, -1.353450957685709, -42.87516684085131, 27.797288976609707, 1.5348710268735886, 17.965893095359206, -3.012210436165333, 51.336388133466244, 47.98440657183528, -23.835025522857904, 10.34437132626772, -4.2970001846551895, -48.725058602169156, -6.821921139955521, -0.03506852686405182, -40.73803171515465, -4.305085182189941, 6.597918301820755, -32.3288286998868, -52.22999884188175, 19.612459249794483, -9.374416157603264, 45.87974466383457, -35.489294335246086, -11.539392091333866, -51.524729523807764, -22.700440928339958, 21.577333621680737, -29.636238664388657, -1.6608111578971148, -64.71830420196056, -42.78320783376694, 20.267918050289154, 21.0403861887753, 22.917065296322107, 11.445315033197403, -58.70057741180062, -55.28889021277428, -33.62483559548855, -32.21424137055874, 36.050911001861095, 32.3676686771214, -5.141692951321602, -21.57773656398058, 1.2654299326241016, 27.082024715840816, 34.142592545598745, -22.71606943756342, 14.784402526915073, -12.51071147620678, -43.97608483210206, -38.222278885543346, -3.2626192457973957, 12.615156054496765, 9.747760482132435, 14.322475891560316, 26.93578341603279, -29.10724014788866, -11.86432459950447, 14.565721854567528, 26.993170458823442, 2.3207390643656254, -62.005501218140125, 17.651234939694405, -40.23381622508168, -22.9403908662498, 12.24070793017745, 23.986571233719587, 3.0053661838173866, 42.115884594619274, -11.285338126122952, 22.849573269486427, -18.712024122476578, 7.625068411231041, -254.1350391432643, -0.668659221380949, -1.8189537301659584, 10.81807143241167, -40.97364082932472, 3.528622791171074, 5.667324177920818, 14.995448481291533, 6.056990131735802, 24.158023603260517, 20.3712727278471, -11.134918421506882, -27.825245164334774, -5.489400003105402, -10.714781500399113, 17.092644333839417, -27.34853845834732, -9.614499863237143, -9.561197428032756, -8.094140883535147, 45.13648145273328, 46.715069718658924, -42.39655428379774, -36.57036807388067, -8.948192685842514, -23.72088086605072, -24.394669227302074, -58.35883083939552, 4.677835486829281, 27.91808919608593, -4.536224033683538, -10.616539298556745, -72.08369168639183, -66.01549619436264, -19.928710274398327, 31.80575611256063, 19.572658628225327, 4.309077255427837, 12.024229921400547, 13.837587215006351, -22.217317640781403, 16.372374296188354, 1.957521852105856, -9.16604420542717, -9.3414586186409, -30.626565396785736, -61.221073396503925, 9.64756329357624, -11.42120610922575, -6.99546043202281, -7.079956091940403, -37.45212070643902, -51.204784378409386, 5.636645115911961, -28.192976627498865, -33.50662936270237, -50.55575440824032, 20.51532793045044, 2.6516750045120716, 34.14082011580467, -57.647717296145856, 46.583178631961346, -5.466002445667982, -34.910002402961254, -0.2878185659646988, -20.467184839770198, -16.51578190922737, 27.47827260196209, -263.7183519899845, -34.639929600059986, -33.9677803888917, -17.098511084914207, 37.15230065211654, -51.128748927265406, -81.32423344627023, -5.6311831176280975, -17.370061434805393, -55.501135028898716, -9.169054597616196, -82.1361983269453, -3.74771149456501, -18.736043818295002, 7.21952673047781, 10.657924085855484, -235.73452624678612, -38.10853768885136, -21.015874482691288, 18.09084604680538, -1.3375204354524612, 24.190788872539997, -268.9002643972635, 10.030844777822495, -48.1159850358963, -104.87286915630102, -15.581491440534592, -54.12036956101656, 4.451764326542616, -14.953924909234047, -4.218488596379757, -28.303525617346168, -3.632939327508211, 6.178520999848843, -10.751538090407848, -19.347819946706295, -44.22031608223915, 2.585403010249138, -25.012683618813753, 8.868964783847332, -14.562642939388752, -43.72779943794012, -212.8604964055121, -6.513185393065214, -83.19283330440521, 31.954194515943527, 4.16031152009964, -60.17498730123043, -17.040513690561056, 3.3340766951441765, 11.521492712199688, 13.063600234687328, -22.06141459941864, -24.62541338801384, -151.92062873393297, -48.22471385449171, -14.158513478934765, 51.68911875784397, 31.176048908382654, -10.683099914342165, 7.4481596276164055, -32.740717351436615, -10.915094375610352, 39.06779507920146, -44.22921062540263, -19.38990145176649, 13.435225330293179, -33.56604554504156, 3.784313566982746, 25.398426972329617, -5.2352000400424, -1.6254348382353783, -45.468242187052965, -60.249793365597725, -38.45316367968917, -284.4207646846771, -1.2682855501770973, 15.765200108289719, 14.592323191463947, 12.21360744535923, -19.916675232350826, -16.012669637799263, -37.89151794463396, -43.08964663743973, 9.686522517353296, -33.17110240086913, -26.11737848073244, -10.12896678596735, 4.500080492347479, 10.337674830108881, -33.297520101070404, 9.423226706683636, -15.975713700056076, -47.11910681799054, 14.175984121859074, -6.551571734249592, -13.595773980021477, 1.9705457761883736, 24.695718355476856, 11.62261800840497, 2.6884150356054306, -14.761143781244755, -9.218723066151142, -7.4966043047606945, 15.943644419312477, -21.52966619282961, -37.76255887746811, -43.57089287042618, 16.472724303603172, 17.538488522171974, -59.58026148378849, -38.53833641856909, 37.84113975986838, 16.29015400260687, -30.023402512073517, 51.943834617733955, 22.47856544703245, -14.592101320624352, 34.50058898702264, -45.09683512151241, -40.26281055808067, -43.16066012531519, -10.665576465427876], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420652077083859, "mean_inference_ms": 4.55317456699997, "mean_action_processing_ms": 4.209101422206903, "mean_env_wait_ms": 3.2294637709235445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10745280, "timesteps_this_iter": 131040, "agent_timesteps_total": 10745280, "timers": {"sample_time_ms": 29741.245, "sample_throughput": 4406.003, "load_time_ms": 23.178, "load_throughput": 5653536.934, "learn_time_ms": 14932.488, "learn_throughput": 8775.496, "update_time_ms": 2.215}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.271806125530275e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 130.60106247468752, "policy_loss": 0.0016370386439266338, "vf_loss": 26.118048401289087, "vf_explained_var": 0.28487123928189706, "kl": 0.0024128955769794702, "entropy": -0.5275080102532568, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10745280, "num_agent_steps_sampled": 10745280, "num_steps_trained": 10745280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10745280}, "done": false, "episodes_total": 21760, "training_iteration": 82, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-23-32", "timestamp": 1691022212, "time_this_iter_s": 39.43493151664734, "time_total_s": 2534.7260081768036, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2534.7260081768036, "timesteps_since_restore": 10745280, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 44.058928571428574, "ram_util_percent": 51.376785714285724}}
{"episode_reward_max": 51.943834617733955, "episode_reward_min": -284.4207646846771, "episode_reward_mean": -17.667379456022754, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.030844777822495, -48.1159850358963, -104.87286915630102, -15.581491440534592, -54.12036956101656, 4.451764326542616, -14.953924909234047, -4.218488596379757, -28.303525617346168, -3.632939327508211, 6.178520999848843, -10.751538090407848, -19.347819946706295, -44.22031608223915, 2.585403010249138, -25.012683618813753, 8.868964783847332, -14.562642939388752, -43.72779943794012, -212.8604964055121, -6.513185393065214, -83.19283330440521, 31.954194515943527, 4.16031152009964, -60.17498730123043, -17.040513690561056, 3.3340766951441765, 11.521492712199688, 13.063600234687328, -22.06141459941864, -24.62541338801384, -151.92062873393297, -48.22471385449171, -14.158513478934765, 51.68911875784397, 31.176048908382654, -10.683099914342165, 7.4481596276164055, -32.740717351436615, -10.915094375610352, 39.06779507920146, -44.22921062540263, -19.38990145176649, 13.435225330293179, -33.56604554504156, 3.784313566982746, 25.398426972329617, -5.2352000400424, -1.6254348382353783, -45.468242187052965, -60.249793365597725, -38.45316367968917, -284.4207646846771, -1.2682855501770973, 15.765200108289719, 14.592323191463947, 12.21360744535923, -19.916675232350826, -16.012669637799263, -37.89151794463396, -43.08964663743973, 9.686522517353296, -33.17110240086913, -26.11737848073244, -10.12896678596735, 4.500080492347479, 10.337674830108881, -33.297520101070404, 9.423226706683636, -15.975713700056076, -47.11910681799054, 14.175984121859074, -6.551571734249592, -13.595773980021477, 1.9705457761883736, 24.695718355476856, 11.62261800840497, 2.6884150356054306, -14.761143781244755, -9.218723066151142, -7.4966043047606945, 15.943644419312477, -21.52966619282961, -37.76255887746811, -43.57089287042618, 16.472724303603172, 17.538488522171974, -59.58026148378849, -38.53833641856909, 37.84113975986838, 16.29015400260687, -30.023402512073517, 51.943834617733955, 22.47856544703245, -14.592101320624352, 34.50058898702264, -45.09683512151241, -40.26281055808067, -43.16066012531519, -10.665576465427876], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403223034486602, "mean_inference_ms": 4.541999651252621, "mean_action_processing_ms": 4.1530007878313935, "mean_env_wait_ms": 3.199374058565292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 10876320, "timesteps_this_iter": 131040, "agent_timesteps_total": 10876320, "timers": {"sample_time_ms": 27320.864, "sample_throughput": 4796.334, "load_time_ms": 21.054, "load_throughput": 6223888.058, "learn_time_ms": 14929.929, "learn_throughput": 8777.001, "update_time_ms": 2.192}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.1359030627651375e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 128.18914573675974, "policy_loss": -0.000910014753010854, "vf_loss": 25.638205217204213, "vf_explained_var": 0.28398065990017307, "kl": 0.002181840375588212, "entropy": -0.5343106707364428, "entropy_coeff": 0.001}}}, "num_steps_sampled": 10876320, "num_agent_steps_sampled": 10876320, "num_steps_trained": 10876320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 10876320}, "done": false, "episodes_total": 21760, "training_iteration": 83, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-23-47", "timestamp": 1691022227, "time_this_iter_s": 15.208680152893066, "time_total_s": 2549.9346883296967, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2549.9346883296967, "timesteps_since_restore": 10876320, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 13.840909090909092, "ram_util_percent": 51.70000000000002}}
{"episode_reward_max": 63.3016741015017, "episode_reward_min": -342.51844976097345, "episode_reward_mean": -15.149330588335093, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.11014422774315, 15.376841463148594, 1.5765047147870064, -73.4079389423132, 17.443574830889702, -20.43660495430231, -63.76500953733921, -22.823916509747505, -0.5709722265601158, -26.13075815886259, -38.15962912887335, -36.125310227274895, 33.26831068098545, 18.501181408762932, -9.658143885433674, -93.36602908372879, -11.5790956877172, -4.522679556161165, -62.788829796016216, 31.953709058463573, -26.819315852597356, -20.40519092231989, -34.79027424752712, 9.069582298398018, -26.1958529073745, -3.7338567543774843, 11.747261703014374, -250.35234121233225, -5.284583028405905, 13.90546990185976, 0.5021954625844955, -3.9363544061779976, -8.766846857964993, 30.48437661677599, 14.289911359548569, 17.736134430393577, -27.83898014575243, -54.428531005978584, 32.409178502857685, -41.171027995646, -80.76169529557228, -17.092741139233112, 62.41974513232708, -4.3941009640693665, 0.022178925573825836, -34.972847297787666, -13.636256728321314, 21.195034112781286, -24.501862466335297, 43.340043887495995, 10.820557072758675, -42.621674947440624, 3.821043636649847, -21.31806979328394, -77.46119540929794, 10.824689835309982, -27.062682151794434, -22.15757578611374, -12.087450552731752, -62.22751486673951, -39.10008234530687, -100.1840301901102, -17.37523078173399, 4.312565207481384, -24.080804705619812, -95.15622594952583, 2.188182957470417, 15.629968151450157, 8.949342165142298, 2.6671614572405815, 21.44008605927229, 8.69615363329649, -34.0597160756588, -15.653778076171875, -342.51844976097345, 19.377812512218952, -10.630686603486538, 18.662881150841713, -9.151834473013878, -52.02087961882353, -74.88234247267246, -9.385322760790586, -10.774724662303925, 35.534432642161846, 34.321757294237614, 13.259098701179028, 26.045214965939522, -11.26995101571083, -29.361226700246334, -177.67448669672012, -32.373252503573895, -11.398963488638401, 25.37781322747469, -1.6865958236157894, 15.50051137804985, -136.48884335905313, -20.402080193161964, 8.745832338929176, -42.33685133419931, 27.38802655786276, 0.2664472758769989, -52.516882568597794, 10.275777593255043, 17.063120059669018, -29.237718865275383, -10.409647442400455, 13.983503207564354, 42.158928491175175, 22.419727690517902, -6.696444101631641, 8.321590688079596, 46.45432789251208, -253.01171634346247, 8.244061477482319, 11.220148339867592, 31.998999051749706, -58.37355088815093, 40.21585191786289, 36.342050947248936, 8.182821661233902, 36.14120188355446, -67.33409159630537, -59.75483995676041, 39.16619700938463, -3.563627876341343, -42.2949133887887, -42.03078491985798, -16.774125941097736, -41.06452541053295, -4.098798930644989, 16.737879298627377, 63.3016741015017, 5.247460126876831, -18.712025083601475, -9.400893904268742, -12.078125789761543, -5.796501472592354, -40.667944913730025, -6.38845045119524, -87.75313843041658, 34.799330200999975, -82.79922829568386, -36.359584767371416, -16.907861683517694, -62.71087299287319, -24.336496494710445, -23.60852701216936, -0.20143026486039162, -67.08407516777515, 1.0160467028617859, 3.053266778588295, -256.9779704660177, 34.00391128659248, -12.197629233822227, -31.91439116001129, -13.09024890512228, 11.966648288071156, -42.68458131700754, -0.06040229648351669, 45.83857384324074, 10.238836750388145, 0.16805697977542877, -47.152493484318256, -2.641008974984288, -56.586480632424355, -63.64514584839344, -21.130006961524487, -39.60236372053623, 23.198328152298927, -73.13860858976841, -44.33568059653044, -47.62593824416399, 32.44017756730318, -11.53555116802454, -9.08882737904787, 8.01146136969328, -17.06858193874359, -3.047350972890854, 5.650061644613743, -17.739551037549973, -22.12356784939766, 31.84904208034277, -3.1689640060067177, -74.8944038823247, -5.344019323587418, 43.686851523816586, 7.032307147979736, -75.40464367717505, -11.163050934672356, 7.881553500890732, -18.609920874238014, -44.82970729470253, -54.04853517562151, 11.293164517730474, -65.90054177492857, -36.34624492749572, -58.3084771335125, 28.606068767607212, 21.19630141556263, -269.9088764972985, 43.463884092867374, -4.124498803168535, -41.72177015990019, -217.38184704259038, 12.300007682293653, -5.253850072622299, -17.67958054691553, 7.958987906575203, 25.536392986774445, -17.441616289317608, -6.697789043188095, -7.729889765381813, -18.34335008263588, 8.222570147365332, 14.0908567532897, -58.52999423444271, -19.808576460927725, -15.543778881430626, -59.100565407425165, -26.160615295171738, 6.928476989269257, -4.35700361430645, 1.8812608383595943, 18.224513340741396, 13.575417139567435, -5.1109877079725266, 6.536467880010605, -77.15807101130486, 45.174976386129856, 40.81575396284461, 5.08485784381628, 5.076303672045469, -5.377182051539421, -19.462248101830482, -62.31743985414505, 11.033700726926327, 43.589309729635715, 15.919496916234493, -211.15030186250806, 26.135532177984715, -38.082421597093344, 36.277481127530336, -11.287886627018452, 39.5104192532599, -51.5419882312417, 15.329588577151299, -14.851787626743317, -10.546336613595486, -5.426994575187564, -2.0738860927522182, -49.04906793497503, -1.7650182098150253, -2.6207915041595697, -8.034475650638342, -28.765512093901634, -82.27559499442577, -3.044090136885643, 7.185829434543848, 9.008050337433815, -60.63541288673878, -17.59463407099247, -4.702051118016243, 18.125909239053726, -24.252719894051552, -46.48227212578058, -35.5391066595912, -43.20052706450224, -60.46842908859253, -15.912075698375702, -3.748938709497452, 14.912835158407688, 15.118260711431503, 3.788285441696644, -64.27596616744995, 0.011691771447658539, -6.496848359704018, -57.96233066916466, 5.487158454954624, 14.84223847091198, -4.31837160885334, 34.86130405217409, 14.47757077217102, -29.34070947021246, -6.958777092397213, -39.94467191398144, -96.30048672109842, -15.01399501413107, -15.590727560222149, 4.181811347603798, 20.992293789982796, 27.60022822022438, 16.574715305119753, 19.367093371227384, 53.44277422875166, 3.87573479488492, 16.27122288942337, -57.721481546759605, -65.53721025213599, 26.138601046055555, -22.044878348708153, -45.64026514440775, 53.29932223260403, 20.270981889218092, -18.323733918368816, 19.525640167295933, -34.31312353909016, -58.49405525624752, -17.41937105357647, -17.130923949182034, -5.314486585557461, 23.83637611567974, 13.760751686990261, -2.2651034593582153, 36.44442314654589, 22.79772326350212, 4.947512559592724, -269.05799371004105, 0.7293271645903587, 42.02997360564768, -22.52012174576521, -94.40372690558434, -66.5533809363842, 30.691378854215145, 3.4973088428378105, -7.171897977590561, 16.018904887139797, -33.90279350429773, -68.21716587245464, -30.432202111929655, -19.189782859757543, -28.355070322752, -0.12368682026863098, -54.40760414302349, -24.305939558893442, -0.8738512471318245, -23.890579119324684, 5.471793569624424, -37.218291252851486, 2.1425937190651894, 23.045300267636776, 53.06162567809224, -33.51727068051696, 16.435761496424675, 1.4717379361391068, -51.6852715536952, 31.545625284314156, 18.76975119113922, -5.916286543011665, -67.8506051003933, -22.501494489610195, 2.1473148725926876, -67.16052445024252, -7.275131054222584, -12.60131761431694, 11.87573429197073, -31.539882883429527, -67.12610064446926, -3.284135229885578, 36.8907199986279, 59.89325040578842, -11.89100657403469, 16.751805022358894, 12.688235193490982, -9.598521932959557, 4.826312392950058, -31.9490130469203, -3.3483250588178635, -2.6625764593482018, -32.18361481279135, -38.22636880725622, -3.3140585869550705, -4.300766177475452, -22.368121199309826, 44.72194556519389, 36.77976220846176, 15.34744045138359, -14.802193533629179, 0.07319601625204086, -69.7476298622787, -74.92500350996852, -21.65078105032444, -42.81340308487415, 16.970114398747683, 32.54439914226532, -31.624730058014393, 10.481589397415519, -15.815637566149235, -10.998350329697132, -12.33501835539937, -6.777813332155347, -36.083298951387405, -37.026487566530704, 20.82271971553564, -49.38282714784145, -5.162963695824146, -57.31505908071995, -3.378583736717701, -5.97700122743845, 0.05622177571058273, 40.4193224683404, -3.570609800517559, -4.251857973635197, -33.84129220992327, -69.98286765813828, 36.257048435509205, 8.45855026692152, -11.67063444107771, -48.10414660722017, -37.26853162795305, -61.361364990472794, 42.80772920511663, 20.851104497909546, 19.549628295004368, -3.889384515583515, -6.400689944624901, 15.78781758248806, -80.00012771785259, -10.884257033467293, -57.43459817767143, 2.371776554733515, -39.94679593294859, -14.611150808632374, 4.814780551940203, 16.12981043383479, -69.70677683502436, 0.8775577191263437, -59.06919704377651, -20.047071628272533, -0.6616669744253159, -85.79799401760101, 1.4376431033015251, -20.19681329280138, -83.682797588408, -10.86830723285675, -4.119275622069836, 43.824634440243244, 21.898277543485165, -23.121666960418224, 6.414713054895401, 10.551976293325424, -76.05200157314539, -15.155763819813728, 6.31021274253726, -39.857888892292976, -57.50165571272373, 23.92974418401718, 17.102369159460068, -51.01102278381586, -19.74518009647727, 24.026693627238274, -18.430711090564728, -14.719245694577694, 12.367394372820854, -57.20981828123331, 8.33326806128025, 0.5322244837880135, -26.89037987589836, -23.992062963545322, 22.645531341433525, 33.748115822672844, -21.626578129827976, 27.73234134912491, 2.493812032043934, -47.457931127399206, 9.643566727638245, -18.854132555425167, 4.030232552438974, 16.197972767055035, -24.424778945744038, 26.14557706564665, -30.185976173728704, -44.422667257487774, 10.18952064961195, -27.586531914770603, -25.12728452309966, 0.20923608541488647, 51.7633948251605, -53.446486838161945, 35.490822821855545, 40.086632549762726], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420003912960557, "mean_inference_ms": 4.553299150512087, "mean_action_processing_ms": 4.208751312847749, "mean_env_wait_ms": 3.228934786265116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11007360, "timesteps_this_iter": 131040, "agent_timesteps_total": 11007360, "timers": {"sample_time_ms": 29731.573, "sample_throughput": 4407.436, "load_time_ms": 22.854, "load_throughput": 5733771.864, "learn_time_ms": 14934.382, "learn_throughput": 8774.384, "update_time_ms": 2.199}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0679515313825687e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 127.84900917461526, "policy_loss": 0.0032819757262431267, "vf_loss": 25.56597833052331, "vf_explained_var": 0.3479789706968492, "kl": 0.0024624376099556668, "entropy": -0.5419446029116176, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11007360, "num_agent_steps_sampled": 11007360, "num_steps_trained": 11007360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11007360}, "done": false, "episodes_total": 22240, "training_iteration": 84, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-24-26", "timestamp": 1691022266, "time_this_iter_s": 39.42978811264038, "time_total_s": 2589.364476442337, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2589.364476442337, "timesteps_since_restore": 11007360, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 44.09285714285714, "ram_util_percent": 51.63928571428572}}
{"evaluation": {"episode_reward_max": -135.73867436870933, "episode_reward_min": -135.73867436870933, "episode_reward_mean": -135.73867436870933, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-135.73867436870933], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 51.7633948251605, "episode_reward_min": -85.79799401760101, "episode_reward_mean": -11.442238519713282, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.65078105032444, -42.81340308487415, 16.970114398747683, 32.54439914226532, -31.624730058014393, 10.481589397415519, -15.815637566149235, -10.998350329697132, -12.33501835539937, -6.777813332155347, -36.083298951387405, -37.026487566530704, 20.82271971553564, -49.38282714784145, -5.162963695824146, -57.31505908071995, -3.378583736717701, -5.97700122743845, 0.05622177571058273, 40.4193224683404, -3.570609800517559, -4.251857973635197, -33.84129220992327, -69.98286765813828, 36.257048435509205, 8.45855026692152, -11.67063444107771, -48.10414660722017, -37.26853162795305, -61.361364990472794, 42.80772920511663, 20.851104497909546, 19.549628295004368, -3.889384515583515, -6.400689944624901, 15.78781758248806, -80.00012771785259, -10.884257033467293, -57.43459817767143, 2.371776554733515, -39.94679593294859, -14.611150808632374, 4.814780551940203, 16.12981043383479, -69.70677683502436, 0.8775577191263437, -59.06919704377651, -20.047071628272533, -0.6616669744253159, -85.79799401760101, 1.4376431033015251, -20.19681329280138, -83.682797588408, -10.86830723285675, -4.119275622069836, 43.824634440243244, 21.898277543485165, -23.121666960418224, 6.414713054895401, 10.551976293325424, -76.05200157314539, -15.155763819813728, 6.31021274253726, -39.857888892292976, -57.50165571272373, 23.92974418401718, 17.102369159460068, -51.01102278381586, -19.74518009647727, 24.026693627238274, -18.430711090564728, -14.719245694577694, 12.367394372820854, -57.20981828123331, 8.33326806128025, 0.5322244837880135, -26.89037987589836, -23.992062963545322, 22.645531341433525, 33.748115822672844, -21.626578129827976, 27.73234134912491, 2.493812032043934, -47.457931127399206, 9.643566727638245, -18.854132555425167, 4.030232552438974, 16.197972767055035, -24.424778945744038, 26.14557706564665, -30.185976173728704, -44.422667257487774, 10.18952064961195, -27.586531914770603, -25.12728452309966, 0.20923608541488647, 51.7633948251605, -53.446486838161945, 35.490822821855545, 40.086632549762726], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402375761821173, "mean_inference_ms": 4.5415097989745234, "mean_action_processing_ms": 4.152004616131818, "mean_env_wait_ms": 3.198426824300419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11138400, "timesteps_this_iter": 131040, "agent_timesteps_total": 11138400, "timers": {"sample_time_ms": 27329.01, "sample_throughput": 4794.905, "load_time_ms": 21.323, "load_throughput": 6145582.825, "learn_time_ms": 14938.395, "learn_throughput": 8772.027, "update_time_ms": 2.191}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0339757656912844e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 123.8745275711943, "policy_loss": -0.0020593130385025177, "vf_loss": 24.77642154009966, "vf_explained_var": 0.34143205173981234, "kl": 0.002302207002636566, "entropy": -0.5436634498257791, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11138400, "num_agent_steps_sampled": 11138400, "num_steps_trained": 11138400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11138400}, "done": false, "episodes_total": 22240, "training_iteration": 85, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-24-41", "timestamp": 1691022281, "time_this_iter_s": 15.077262163162231, "time_total_s": 2604.4417386054993, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2604.4417386054993, "timesteps_since_restore": 11138400, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 13.740909090909092, "ram_util_percent": 51.60454545454545}}
{"episode_reward_max": 76.88415203988552, "episode_reward_min": -983.5463460609317, "episode_reward_mean": -24.717038705795616, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.7976880967617, 22.21489618718624, 19.517081782221794, -35.50657971203327, -10.07929541170597, 36.860459215939045, 25.856501631438732, -11.193581640720367, -5.200669050216675, -8.81849692761898, -1.5418317690491676, -24.078160874545574, -5.845799081027508, 12.116844929754734, -63.97704751230776, -16.611540339887142, 24.86930724233389, -14.344525761902332, 1.4018377587199211, 76.88415203988552, 9.411684140563011, -21.39603652060032, -53.79222455620766, 0.7618522644042969, -23.12317632138729, -59.4261056445539, 3.3766785487532616, -10.039426736533642, -13.601377159357071, -310.65572242438793, -23.50011844933033, 19.23051044717431, 5.326442912220955, -38.700021512806416, 35.74769025295973, 6.583800666034222, -23.220733493566513, 1.4189170002937317, -31.311334930360317, 17.823686212301254, -26.502255335450172, -100.14197932183743, -23.773437336087227, -15.272551618516445, 36.2155386954546, -40.86432944983244, -84.56713584810495, -38.28725618124008, 23.31328049302101, -5.611095800995827, -15.088617697358131, 17.314433136954904, 34.691865637898445, 14.78173354268074, -35.29628053307533, -338.4082222133875, 41.1902716383338, -141.00184289366007, 1.4406411722302437, -9.870190672576427, -71.79618746042252, -0.5748349279165268, 19.299343444406986, 17.741541855037212, -0.7600838765501976, -17.32393078878522, -11.925019247457385, 16.647450283169746, -19.159287832677364, -32.685781225562096, -262.2026578336954, 30.059656757861376, -27.232253830879927, -17.51010701060295, -5.517158396542072, -19.399154476821423, -22.59641933441162, -30.437438905239105, -2.115727089345455, -30.512351728975773, -683.8395662382245, 12.000077053904533, -16.455497466027737, -67.26466065645218, -3.437465324997902, -180.38928934931755, -8.497718647122383, 1.9681400209665298, -42.189448446035385, -42.21218990534544, 23.371691880747676, -25.583799175918102, -18.53183775395155, 1.5403127074241638, -279.3103010356426, -102.85594968497753, 4.433997176587582, -6.73802849650383, -18.264277204871178, -44.47649347037077, 34.2979222163558, -8.893920846283436, -27.084216967225075, 0.9627496190369129, -85.34376857429743, 29.437267638742924, -50.27268128097057, -22.691153027117252, -15.1565620303154, 47.9491103105247, -22.465259604156017, -10.801331885159016, 13.083973783999681, 43.13659606128931, 26.765451416373253, 33.43098383396864, -0.8007996715605259, -6.647897578775883, 38.81178844720125, -10.98695695400238, -16.43120924383402, 24.440050341188908, -6.180294439196587, 40.55200406163931, 20.47908628731966, 26.22094864398241, -9.696088373661041, -54.62482737749815, 7.7918978706002235, -50.75238437950611, -30.287095673382282, -80.791155166924, -11.809652376919985, -10.226516902446747, 6.333146281540394, -47.25034248828888, 19.784345850348473, -11.903381437063217, -13.58710665255785, -2.5921403020620346, 33.41428888589144, 0.132407546043396, -2.6775976419448853, 66.01535444706678, -11.692837588489056, 3.3379140570759773, 49.300966054201126, -4.5970791801810265, -9.676910787820816, 32.417931862175465, -30.191588029265404, 37.5462192222476, -75.92057751864195, -14.48365867137909, -89.53746365010738, -1.1170222610235214, 17.139642730355263, -4.239112854003906, 6.613960966467857, -46.88962762802839, -11.340923182666302, 34.05795172601938, -52.84690560773015, -153.44291724264622, -16.84828519076109, -37.6347366347909, 22.257702581584454, 10.68027988448739, -46.80556412041187, 2.2989467345178127, -11.340575143694878, 40.77878899127245, -983.5463460609317, -38.3799854516983, -3.1714993119239807, -18.286936789751053, -23.7225299552083, 3.46896018832922, 23.039777675643563, -1.153583638370037, -20.89023007452488, -18.52377048879862, -65.26403805613518, 38.606037721037865, -14.564880631864071, 38.712255358695984, 19.891487427055836, 6.989019826054573, -838.4755606763065, -44.51247165352106, 38.623862594366074, 3.046057317405939, -9.554590947926044, -96.41685225814581, 9.569567382335663, -9.774720385670662, 60.31559922173619, -32.903105948120356, -5.906927578151226, -19.458466425538063, -4.9477765038609505, 28.647898241877556, -80.46274273097515, 44.76897398382425, 37.0387265086174, -9.442900121212006, 14.972247339785099, 16.981427788734436, -18.042540691792965, -4.721744619309902, -36.999243408441544, 55.820629347115755, -38.25005500018597, -68.31350653991103, -0.46950366348028183, -61.37131787836552, 45.66809371858835, -40.531891476362944, 14.46863130480051, -16.658822804689407, -12.227613750845194, 55.550628907978535, -33.720090582966805, -9.548438996076584, 32.48388651013374, 41.392521580681205, 10.608163855969906, -37.576403461396694, -95.46183705329895, -60.52440033480525, -40.66661669686437, 29.182151213288307, -14.793121635913849, -30.110444501042366, 12.506231784820557, 4.131370835006237, -31.397367345169187, 1.257905725389719, -4.214241065084934, -55.67031758278608, -80.24674366228282, -62.81387513130903, -16.524513266980648, -26.168579071760178, -32.51778557896614, 6.005383260548115, -14.967211097478867, -3.7608467787504196, 16.482165075838566, -230.2758762203157, 44.196736603975296, 39.28031277656555, 27.693214058876038, -39.94055815972388, 16.350511249154806, 20.447028405964375, -23.395310513675213, -12.26116667687893, 1.8435219936072826, -38.471290692687035, 35.200228065252304, -58.79619061946869, -89.30737817659974, -14.461732015013695, -62.60088858380914, -100.19326058030128, -0.3965563029050827, -21.181400425732136, -662.1165533959866, -15.365743860602379, -336.73756106197834, 5.2164027988910675, 20.986738871783018, 15.172625869512558, -37.79417256265879, 44.940512739121914, -47.39236392080784, -262.4354674965143, 14.99596056342125, -30.48323929309845, 11.773742750287056, 4.376456394791603, -7.561516724526882, -30.873862579464912, 31.032393008470535, -30.74634851515293, -16.73290178179741, 26.62586174160242, -21.81237967312336, -60.895330876111984, -93.91307613998652, 10.18994216620922, -33.91618826985359, 14.979178346693516, 27.048136666417122, -7.305934198200703, 10.105972059071064, -48.789425916969776, -2.7013339549303055, 24.955184556543827, 38.41744342446327, -27.10502526164055, -60.06034715473652, 42.884417712688446, 18.152600452303886, 27.93569654971361, -48.044693518429995, -27.80578511580825, 30.29691395908594, -3.315534070134163, -5.505140990018845, 33.745834320783615, 27.514942407608032, -20.205140501260757, -45.12340904772282, -11.041420429944992, -14.530651189386845, -269.3338306695223, -3.265309687703848, 9.838786825537682, -3.196860149502754, 32.22438935935497, 20.44461416453123, -55.52356418222189, -34.31495461985469, -2.1959905475378036, -66.08794040232897, 19.356982298195362, 10.946305744349957, -19.232654832303524, -64.84369519352913, -34.43625204265118, 24.304753828793764, 6.706461325287819, -30.239457961171865, 11.875224322080612, 0.2902108207345009, 35.63695224747062, -7.9279711320996284, -17.206547547131777, 31.001196324825287, 36.96051308512688, -28.73617422580719, 18.162583708763123, -42.6360243037343, 34.274582013487816, -14.017109161242843, 14.632931038737297, -40.1348292529583, 12.283148355782032, 3.1155296117067337, -105.44449263066053, -12.313089471310377, -17.803875096142292, -268.2886782735586, -9.009883284568787, -22.116491869091988, -25.011004962027073, -20.496666818857193, 37.040292993187904, 49.71031258255243, 15.150235138833523, -3.3561861850321293, -25.744043178856373, -7.308145798742771, -27.9659476429224, -20.575450859963894, -116.31821251660585, -47.66103933751583, -50.3884831815958, -47.02640190720558, 41.57612854242325, -42.82108850777149, -45.20272870361805, -28.73468992859125, -78.5921677723527, 37.53024345636368, -41.26970048248768, -49.62343490868807, -67.49113072827458, 14.09403232485056, -13.837585397064686, 6.2929414585232735, 39.91644524410367, -1.136577621102333, 58.43496935069561, -0.04807664453983307, -48.76847790181637, 0.061651792377233505, 10.426958836615086, -11.797842159867287, 1.266392558813095, 2.843690738081932, 35.886118959635496, -32.216606482863426, -25.282806806266308, -350.3233005851507, -11.841342635452747, -30.34751619771123, 16.74087480455637, 2.2881279103457928, -57.64344288408756, 68.21205610781908, -15.499977879226208, -46.792529076337814, -61.65807265043259, 19.533497400581837, 13.082241743803024, 21.632683627307415, -29.958147456869483, -33.099631160497665, 39.74301495030522, -1.8462285473942757, -68.8946583867073, 30.892765264958143, -39.20713781937957, -155.0036386847496, -42.95531179010868, 20.939607814885676, -5.396845377981663, -62.40023900195956, 12.136175941675901, -88.86568093299866, -7.941962815821171, 21.06139075756073, -59.24430017918348, -10.987591601908207, 32.96722348034382, -51.34278606623411, -84.03553757071495, 48.15386886894703, 2.3896311670541763, 22.266617447137833, 34.40917567908764, -60.3475594073534, -51.176279943436384, 24.7238025739789, -21.785983338952065, -41.77972834557295, -7.468122825026512, -0.7542437836527824, 22.841015903279185, 0.09307950735092163, -14.094543360173702, 0.3356831446290016, -19.398948406800628, -60.791023045778275, -13.50117076933384, 4.589652545750141, -22.296518072485924, 3.449060209095478, -66.41027718782425, 1.1210237555205822, -37.66411682218313, -5.173437744379044, -57.716552034020424, -18.447054781019688, -54.20437406748533, 11.801357202231884, 22.676699792966247, -36.28688628971577, -119.12073001265526, -0.554795429110527, -2.9780050441622734, -537.4548122361302, 27.537061534821987, 16.35341554135084, 28.523651625961065, -47.350812543183565, -27.167051076889038, 2.8226893469691277, -37.9684502966702, -38.5858142003417, -38.27449069917202, 10.506813161075115, -16.44157375395298, 14.823013074696064, 28.4787383005023, -34.477242700755596, -22.10050917044282], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42042066584924, "mean_inference_ms": 4.553765558863966, "mean_action_processing_ms": 4.209014857957388, "mean_env_wait_ms": 3.2303879334368704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11269440, "timesteps_this_iter": 131040, "agent_timesteps_total": 11269440, "timers": {"sample_time_ms": 29756.909, "sample_throughput": 4403.683, "load_time_ms": 23.216, "load_throughput": 5644357.776, "learn_time_ms": 14932.451, "learn_throughput": 8775.518, "update_time_ms": 2.18}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.169878828456422e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 134.80823946181667, "policy_loss": 0.00184181475200524, "vf_loss": 26.959257368545806, "vf_explained_var": 0.3752427149203516, "kl": 0.0022634690777199613, "entropy": -0.5491041444963024, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11269440, "num_agent_steps_sampled": 11269440, "num_steps_trained": 11269440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11269440}, "done": false, "episodes_total": 22720, "training_iteration": 86, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-25-21", "timestamp": 1691022321, "time_this_iter_s": 39.58631181716919, "time_total_s": 2644.0280504226685, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2644.0280504226685, "timesteps_since_restore": 11269440, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 44.512499999999996, "ram_util_percent": 51.32857142857142}}
{"episode_reward_max": 68.21205610781908, "episode_reward_min": -537.4548122361302, "episode_reward_mean": -21.637960482528435, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.09403232485056, -13.837585397064686, 6.2929414585232735, 39.91644524410367, -1.136577621102333, 58.43496935069561, -0.04807664453983307, -48.76847790181637, 0.061651792377233505, 10.426958836615086, -11.797842159867287, 1.266392558813095, 2.843690738081932, 35.886118959635496, -32.216606482863426, -25.282806806266308, -350.3233005851507, -11.841342635452747, -30.34751619771123, 16.74087480455637, 2.2881279103457928, -57.64344288408756, 68.21205610781908, -15.499977879226208, -46.792529076337814, -61.65807265043259, 19.533497400581837, 13.082241743803024, 21.632683627307415, -29.958147456869483, -33.099631160497665, 39.74301495030522, -1.8462285473942757, -68.8946583867073, 30.892765264958143, -39.20713781937957, -155.0036386847496, -42.95531179010868, 20.939607814885676, -5.396845377981663, -62.40023900195956, 12.136175941675901, -88.86568093299866, -7.941962815821171, 21.06139075756073, -59.24430017918348, -10.987591601908207, 32.96722348034382, -51.34278606623411, -84.03553757071495, 48.15386886894703, 2.3896311670541763, 22.266617447137833, 34.40917567908764, -60.3475594073534, -51.176279943436384, 24.7238025739789, -21.785983338952065, -41.77972834557295, -7.468122825026512, -0.7542437836527824, 22.841015903279185, 0.09307950735092163, -14.094543360173702, 0.3356831446290016, -19.398948406800628, -60.791023045778275, -13.50117076933384, 4.589652545750141, -22.296518072485924, 3.449060209095478, -66.41027718782425, 1.1210237555205822, -37.66411682218313, -5.173437744379044, -57.716552034020424, -18.447054781019688, -54.20437406748533, 11.801357202231884, 22.676699792966247, -36.28688628971577, -119.12073001265526, -0.554795429110527, -2.9780050441622734, -537.4548122361302, 27.537061534821987, 16.35341554135084, 28.523651625961065, -47.350812543183565, -27.167051076889038, 2.8226893469691277, -37.9684502966702, -38.5858142003417, -38.27449069917202, 10.506813161075115, -16.44157375395298, 14.823013074696064, 28.4787383005023, -34.477242700755596, -22.10050917044282], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402417536815805, "mean_inference_ms": 4.541743388313978, "mean_action_processing_ms": 4.151773389666173, "mean_env_wait_ms": 3.1994728997607678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11400480, "timesteps_this_iter": 131040, "agent_timesteps_total": 11400480, "timers": {"sample_time_ms": 27314.762, "sample_throughput": 4797.406, "load_time_ms": 21.564, "load_throughput": 6076833.052, "learn_time_ms": 14935.453, "learn_throughput": 8773.755, "update_time_ms": 2.163}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.584939414228211e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 142.85344496189305, "policy_loss": 0.0030020549072110833, "vf_loss": 28.567142531008702, "vf_explained_var": 0.26795780210084813, "kl": 0.0020695360607758005, "entropy": -0.5449155229394154, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11400480, "num_agent_steps_sampled": 11400480, "num_steps_trained": 11400480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11400480}, "done": false, "episodes_total": 22720, "training_iteration": 87, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-25-36", "timestamp": 1691022336, "time_this_iter_s": 15.194740772247314, "time_total_s": 2659.2227911949158, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2659.2227911949158, "timesteps_since_restore": 11400480, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 13.831818181818182, "ram_util_percent": 51.650000000000006}}
{"episode_reward_max": 75.91710793226957, "episode_reward_min": -1414.0993880927563, "episode_reward_mean": -52.242265233110324, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.594814762473106, 24.582485266029835, 36.881355088204145, -91.62129694223404, -5.0283599980175495, -44.65125098079443, -30.966882526874542, 27.815301530063152, -27.95157627761364, -61.72256316244602, 15.427845947444439, -15.093408077955246, 17.51202291995287, -15.433145478367805, 43.082287169992924, -6.672350376844406, 33.94667263701558, 7.589830845594406, -134.3406729772687, -12.463030472397804, 29.87418507412076, -10.133612416684628, 19.591348379850388, -172.03230655938387, 29.164103038609028, -26.776719070971012, 7.804522842168808, 41.05520858243108, 12.3009575009346, -1.3339399173855782, -3.0587660297751427, -79.33795138821006, -35.40606577694416, 49.87557991221547, -205.1995346620679, 30.929648086428642, -555.9355641379952, 15.784375056624413, 17.89672326296568, -30.64383358694613, -2.6805785968899727, 17.694252781569958, -511.3368945494294, 8.670203037559986, -67.63940525986254, 17.09970623999834, 1.6307590082287788, -38.42013257741928, 5.203024342656136, 14.089712232351303, -24.05498617887497, 16.975479129701853, -69.67153852805495, -164.33212372660637, -104.4305239468813, -5.966199956834316, -21.40694846212864, 71.86000280454755, -58.78264781460166, 30.024137876927853, 4.604820780456066, -29.34285570681095, 4.350288838148117, -10.80978949368, 49.67388241365552, -79.1960252635181, -101.86851029098034, -1039.4257083013654, -75.96203450858593, -2.424620106816292, -48.09238541126251, -13.699933841824532, -11.389043468981981, -53.05973231047392, -94.88258899748325, 36.655418172478676, 49.88267882168293, -4.114292345941067, -36.65229192376137, -310.5000061094761, -13.58717629313469, 15.46875873208046, -22.662693597376347, -2.376889180392027, -20.659728795289993, -78.33918045461178, -18.591367192566395, 60.424366258084774, 7.0187428295612335, 27.732708886265755, -11.110563024878502, -26.141333110630512, -219.57916527986526, -429.8916519731283, 0.45491649210453033, -453.8633436411619, -42.63793373852968, -0.409273486584425, -29.23762921988964, -21.836657389998436, -52.767647080123425, 26.276464819908142, -13.822952434420586, 55.74598202109337, 7.347056582570076, -284.9857759028673, -45.08878695964813, 11.23402288556099, -56.80122882127762, 3.0388569608330727, -19.36422081105411, -5.9523361176252365, -44.05512227118015, 3.9622949436306953, 7.526206821203232, -104.98697358369827, -47.60781916230917, 13.745468594133854, -6.115522297099233, 34.38678960502148, 13.132146932184696, -27.518549017608166, 47.42817481048405, -0.9825924634933472, -11.702147088944912, -28.524532601237297, 56.608075104653835, -103.76435408741236, -101.95629757642746, 15.024648308753967, -18.49731457233429, 13.137423366308212, -34.95450899749994, -335.3843276500702, 53.271371360868216, 32.25983648002148, 25.134139955043793, 4.4750006422400475, 29.272853150963783, -23.73933633416891, -284.500252276659, -11.530371509492397, -68.37014301866293, -8.450224079191685, 37.15708937495947, -84.47890091687441, 5.796532642096281, 1.8074169009923935, -31.33328542113304, 16.167323276400566, -64.13820919394493, -508.68190912157297, -7.697602674365044, 7.024778903461993, -2.8944616243243217, -42.23034720122814, 29.44954364001751, 17.46271800994873, -228.05573531240225, 42.9756759442389, 38.542536184191704, -15.729164127260447, -45.071758300065994, 38.66205284744501, -339.08241376280785, 45.85339319333434, 12.971886195242405, -150.59953425824642, 13.148974068462849, -463.33311872184277, -370.97868705540895, -48.98959991335869, 27.07200963050127, 65.15833188593388, -0.028179027140140533, -134.85816951096058, -14.648649536073208, -13.220958843827248, -26.919724188745022, -712.8887455761433, -29.794591538608074, -41.13456427678466, -131.30402674525976, 41.736507430672646, 41.536531537771225, 13.67520571500063, -15.118080236017704, 27.661214984953403, -20.326236359775066, 24.155865885317326, -10.719919487833977, -1.9692178070545197, -24.553763434290886, 61.133466608822346, 8.921811267733574, -83.87223979830742, 3.0547593981027603, -0.8301792740821838, 56.28520444780588, -30.538368090987206, 29.160168439149857, 7.038978334516287, -17.487191267311573, -14.531076438724995, -16.25889015942812, -77.34727127850056, -23.246805749833584, -34.64095205068588, 26.235150162130594, 17.410873882472515, -1.6060712784528732, -30.050741404294968, -10.720874398946762, 23.991965912282467, -8.871704079210758, 15.900122731924057, -15.46854180842638, 54.381406212225556, 26.771963141858578, -31.496459394693375, -23.1878260076046, -45.96027612686157, 3.4538922049105167, -28.6482807174325, 12.778386630117893, -950.8102236241102, 3.4215468764305115, -169.55416566878557, 42.96207484602928, 75.91710793226957, -32.15588828921318, -72.81178572773933, -174.86006696522236, -581.2014713361859, 53.405658066272736, -99.83605547249317, 17.29929754883051, -62.2255474627018, 46.749284870922565, -52.199950486421585, -23.66118725389242, -46.48648039996624, -15.054412793368101, -18.01546762883663, 40.18263364583254, -63.704527884721756, -0.75522730499506, 42.1734087690711, -5.660075921565294, -9.58751917630434, -16.159944497048855, 14.237428769469261, 17.715904414653778, -43.88942411541939, -40.65316612273455, -631.1323471665382, -85.0669751316309, 20.65753671526909, -2.3777949661016464, -57.271207101643085, -436.32680105417967, -32.38044647872448, -15.0382136143744, -7.619077555835247, -52.400902301073074, -273.18389746546745, 42.994947142899036, -1414.0993880927563, -14.828903287649155, -32.2116708047688, -65.9456567466259, 4.530705275014043, 20.674222886562347, -310.0960302837193, -32.02659937739372, -13.46939541399479, 37.31917844712734, 23.71882137656212, 6.024523489177227, -69.23425441235304, 6.696420542895794, -31.8332709223032, -109.21795514971018, -41.848790384829044, -3.125044383108616, 19.940171413123608, -50.35796997696161, -65.06770658493042, 42.4829024001956, 21.785614475607872, -50.70512345433235, 18.392564183101058, 25.042081721127033, -303.88891792297363, -45.652072846889496, -50.35906334966421, -43.719434924423695, -51.09439466521144, 35.406313717365265, -18.902547620236874, -83.33091891556978, -10.776325274258852, -13.919060485437512, 8.731544509530067, 8.52838858217001, -29.200243644416332, 28.37295038253069, -13.66434509307146, 13.078986033797264, -5.337637081742287, 19.259129147976637, 36.440225914120674, -28.516131341457367, 5.066550405696034, 7.804425060749054, -34.51438230648637, -42.761276073753834, 15.254687570035458, -29.735164802521467, -24.065572559833527, 15.377546660602093, -314.7539388015866, -46.435038395226, -38.00931406021118, -183.82470819354057, 17.88820308446884, -10.900536350905895, -8.534901931881905, -1.6080218255519867, -245.077317468822, 3.0663496553897858, -85.25415760278702, 15.165724985301495, 9.592227935791016, -32.651705741882324, 20.310440741479397, -181.97012567520142, -276.4203631877899, 25.6721977815032, 13.03370701521635, -8.20984111726284, -43.266106843948364, -62.422423020005226, -5.433868810534477, -46.1469334885478, -19.510977804660797, -60.417335133999586, 9.013511693105102, -49.65782833099365, -739.4997968226671, -34.45031639933586, 31.470373183488846, -34.420564614236355, -21.41939975321293, -9.976186314597726, -4.4151281863451, -5.181053057312965, -39.11984132230282, 8.761888027191162, -63.719349378719926, -0.14027037471532822, 49.19204430282116, -75.75984746962786, -35.250158205628395, 26.806166261434555, -295.8182530775666, 44.92250852659345, -50.6699895337224, 40.16102735698223, -565.1617735177279, 24.953728713095188, -10.388689301908016, 40.78152385354042, 52.25474393367767, -310.4306045882404, 6.549544110894203, 19.592590264976025, 46.39911739528179, -134.75978706032038, -7.439629949629307, 11.184087559580803, 12.939490171149373, 27.428040504455566, -13.514990963041782, -40.33421430364251, -3.140095964074135, 49.191833920776844, 28.722081223502755, -31.403794586658478, -38.732418820261955, -65.71035879850388, -26.597145587205887, -38.64613450318575, -35.85651387274265, -40.083521872758865, -14.676805093884468, -85.15766631811857, -21.239390149712563, -85.32589372992516, 18.46950263530016, -42.08100326359272, -7.525820516049862, -8.928970873355865, -59.34672547876835, -40.03594513237476, 18.089083217084408, -298.44841104745865, -140.230525739491, 5.305842656642199, 9.09579985588789, -5.391622591763735, 29.494938619434834, -33.28213243186474, -20.609551820904016, 15.397147916257381, -417.69902725704014, -40.45727036893368, -708.8498254418373, -59.02171189337969, -13.08715607225895, -119.1714453175664, -122.58676476031542, -34.839030250906944, 22.879921566694975, -7.4986627995967865, -6.445082016289234, -0.693932332098484, -48.63490787893534, 17.149332493543625, -106.06505364179611, -37.37009438872337, -277.34598068892956, -402.1940766647458, 1.0581079050898552, -457.5637876391411, 2.0226250663399696, -86.36272758245468, -32.22707484290004, -263.181609146297, 4.5567936450243, 23.43484876304865, -190.58691303431988, 12.213558964431286, 19.60950657725334, -22.214267134666443, -4.795801818370819, -35.96869194507599, -429.35003113374114, -20.856756389141083, 42.67930753715336, -35.436376847326756, -26.756306566298008, -7.296923644840717, 0.8307230472564697, 52.35910203307867, -4.501649878919125, -47.40052169561386, 21.343633860349655, -12.992554061114788, -127.52812406420708, 23.03922414407134, 32.44066686928272, -30.14309584349394, -110.15080604236573, 26.01643007993698, -28.363353691995144, -61.52644293755293, 2.64527796395123, -58.18142060190439, -15.06111916154623, -19.446939799934626, -8.287830919027328, -11.683294093236327, -90.5599692761898, 8.79837928712368, -71.7404655739665, -18.03171595931053, -42.951355680823326, -119.2913273870945, 5.157314956188202], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419627725874169, "mean_inference_ms": 4.5536908659181305, "mean_action_processing_ms": 4.208934033477528, "mean_env_wait_ms": 3.2304158841310477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11531520, "timesteps_this_iter": 131040, "agent_timesteps_total": 11531520, "timers": {"sample_time_ms": 29725.405, "sample_throughput": 4408.35, "load_time_ms": 22.575, "load_throughput": 5804651.947, "learn_time_ms": 14930.176, "learn_throughput": 8776.856, "update_time_ms": 2.157}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2924697071141055e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 168.83370574183772, "policy_loss": -3.585216236057988e-05, "vf_loss": 33.76622038331938, "vf_explained_var": 0.1793320813486653, "kl": 0.002607003843107884, "entropy": -0.55734344398249, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11531520, "num_agent_steps_sampled": 11531520, "num_steps_trained": 11531520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11531520}, "done": false, "episodes_total": 23200, "training_iteration": 88, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-26-16", "timestamp": 1691022376, "time_this_iter_s": 39.41487526893616, "time_total_s": 2698.637666463852, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2698.637666463852, "timesteps_since_restore": 11531520, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 44.160714285714285, "ram_util_percent": 51.59464285714286}}
{"episode_reward_max": 68.3648485429585, "episode_reward_min": -1195.4043258205056, "episode_reward_mean": -39.065924611959296, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.19483610987663, -14.87476696074009, -364.3966825455427, 58.8610777258873, -115.535276286304, -11.575133450329304, 0.1514313891530037, 8.931500114500523, -964.608446225524, -3.4030529782176018, -23.489002361893654, 8.677672615274787, -108.21192766726017, -20.485053300857544, -12.353333681821823, 19.65262309461832, -19.713768884539604, -33.955503195524216, -17.452125146985054, -10.322535324841738, -3.9640417471528053, -18.865185916423798, -11.233469344675541, -49.976385712623596, -6.21429980546236, -66.72547141462564, -26.185215763747692, 42.328842267394066, 2.2311162054538727, -72.4660212174058, -23.811279609799385, 4.321084842085838, -9.247812055051327, -40.42019807547331, 12.371604189276695, -34.91249265521765, -4.254361033439636, -24.83273946493864, -41.50988586246967, -50.13407843746245, -21.946590706706047, 46.98592549562454, -32.547813571989536, -19.28840073943138, -61.890911400318146, -115.14457757771015, -40.427850970998406, -3.7172051817178726, 21.420814014971256, -36.57803114876151, -58.09136760234833, -41.56682484596968, -6.050112470984459, -20.651039391756058, -358.3785199150443, -6.617952480912209, -23.921874180436134, 26.2888365611434, -18.079238526523113, -0.35492004454135895, -20.105148620903492, -56.27913295477629, -395.1100149899721, -39.262274011969566, 9.951805025339127, -33.982137605547905, 12.054934956133366, -61.68960899114609, -31.38316248357296, -9.725198239088058, -42.953655265271664, -17.63995234668255, -37.04330501332879, 20.26997884735465, 37.28187832981348, -3.7808939665555954, -22.99155744165182, -8.160687617957592, -21.41886679083109, -17.589989483356476, 1.9454978331923485, 32.29654650390148, -16.02542681246996, -93.3765057772398, -58.83477134257555, -29.982978265732527, -119.93676498532295, -38.91118090599775, -10.01565483585, 38.86216900497675, 16.26500064879656, -37.76907375454903, -22.393443524837494, -36.58603612333536, -13.528416380286217, -22.97070935368538, -132.25649747997522, -50.45772831141949, -2.3295943662524223, -32.56992156431079, 3.415345937013626, -441.4723599553108, -113.96022167801857, -4.1543138064444065, -28.798310667276382, 9.129763044416904, 10.421604312956333, -55.18568234145641, 16.02432445436716, -197.50527998059988, 3.0881981551647186, 12.678493469953537, -41.60486342012882, 31.81558907032013, -36.96382972598076, -65.46953715384007, 23.88430155441165, -4.593558888882399, -23.818431854248047, -16.915293268859386, -113.31641927361488, 39.18845222890377, -1.2885211296379566, -63.15946730226278, -106.20020745694637, -3.548060543835163, -42.26296256110072, 26.879324480891228, -83.34622466936707, -73.15487720817327, -11.676688488572836, 52.08169013261795, -56.32208336144686, 42.904442423954606, -46.385062500834465, 44.53802212327719, 28.88053322583437, -0.5536300800740719, -117.99121926724911, 21.923499584197998, -16.33125063031912, 15.120191916823387, -3.5233305916190147, -48.63816115260124, 2.5296080484986305, -28.507059078663588, -115.9443137794733, -18.744950637221336, -104.57653048634529, -16.878170534968376, -44.921004608273506, -5.015262752771378, -87.5274061113596, -20.480286240577698, -59.72437912598252, 13.620663683861494, -561.86426063627, 21.180105473846197, 47.361736476421356, -109.96421242505312, -31.721246495842934, 23.693511091172695, -21.816070821136236, -21.49907574802637, 3.373466193675995, -75.70358218252659, 31.961646892130375, 7.50062569975853, -16.22517668455839, 14.718140169978142, -23.737599082291126, -76.59238082170486, -17.830029897391796, 52.32096302509308, 44.73032061010599, -0.44852011650800705, 27.180857487022877, -39.94759791344404, -11.381650306284428, 16.782561659812927, 41.72823839634657, -60.50287684798241, -46.359415769577026, -45.89888747781515, -41.1943588629365, 22.070732299238443, -28.991277292370796, -56.001000732183456, -62.268126256763935, 26.739142663776875, 37.782976657152176, 22.50783071666956, -21.448323249816895, -18.9104364477098, 12.646067287772894, 15.978278260678053, 12.281207863241434, -8.223929584026337, -4.595102244988084, -43.498325511813164, -21.11046366393566, -116.27338849008083, -121.4520539753139, 67.43122883141041, -23.639994382858276, -25.9094859957695, -36.174697913229465, -106.95623518526554, -358.8446082174778, -1.4190254919230938, -40.68741175532341, -16.064807802438736, -18.667544823139906, -1.618650920689106, -16.523280829191208, -36.55728064477444, -23.613591849803925, -66.41851453483105, -3.2975939512252808, -31.519328888505697, 62.66035408526659, 49.24867203831673, -276.7203134596348, 11.585355754941702, -67.92781342566013, 14.1089486181736, 9.269974045455456, -146.71916842460632, -48.73287008702755, -25.098180390894413, 6.337269298732281, -50.022954031825066, 21.42739500850439, -14.831497862935066, 15.053024664521217, 23.939836718142033, 16.17004754394293, -13.335506550967693, -48.088588289916515, -11.651777759194374, -73.11523584276438, -16.936552315950394, -36.174723057076335, 29.352315366268158, 18.155661687254906, -316.73282811045647, 60.78750796057284, 55.51743273809552, 68.3648485429585, -32.125857435166836, -32.273382522165775, -123.71678811311722, 51.55411196500063, -1.0833633244037628, -21.879713475704193, -29.169692710042, -57.311365243047476, -30.281814204528928, 12.052647810429335, -65.94385700672865, -34.08409349247813, 23.97658596932888, -29.794004928320646, -19.20603822916746, -7.697676710784435, -6.030580595135689, -44.461121421307325, -57.71942224353552, -122.1902198381722, -80.80917582288384, -61.89643296599388, -54.47892248630524, -95.38645412772894, -30.641409263014793, -44.405171915888786, -12.333798818290234, -18.512193977832794, -103.70857307314873, -83.95001965761185, -5.631038352847099, -70.64404428750277, 14.540955685079098, -86.5315430611372, -101.07466465234756, -42.445526227355, -73.9832177311182, -23.836093939840794, 17.495482724159956, 4.9567576088011265, -262.2580516934395, 45.68619894236326, 34.68817347288132, -9.211194142699242, -25.96697548404336, -28.391044937074184, -91.90542119368911, -116.24545762687922, -384.85821287333965, -22.92369396239519, -58.77632550895214, 33.5071523822844, -157.3329294361174, -120.42365223169327, 20.87783195823431, -44.620350666344166, -30.948972634971142, -59.124484322965145, -64.2796531021595, -64.10858653485775, 19.19522461295128, -57.01531406491995, 4.5264769941568375, 66.34387973695993, -142.88251627981663, -31.75537945330143, -0.16342706978321075, -60.55168774724007, -27.4225931763649, 29.077385921031237, -67.45281713828444, 10.949484676122665, -11.77800888568163, 24.458085786551237, -46.23963375389576, 4.220434591174126, -79.64845430105925, 18.964851908385754, 19.775253608822823, -23.321009941399097, -50.298533007502556, -7.517596885561943, 28.541904024779797, -55.469014927744865, -488.2582985907793, -67.52918932586908, -5.554697155952454, -24.4766388759017, -18.067237332463264, 29.44476991891861, -42.91015038639307, -6.605507269501686, -588.2994957119226, 13.802846230566502, -32.24055026471615, 36.76775688678026, 2.7482252418994904, -45.957893803715706, -86.59617871046066, -24.10031232237816, -26.450586758553982, 9.901542693376541, -14.598747842013836, -11.750783994793892, 38.80172460526228, 1.8212655186653137, 3.944075457751751, 1.8732537105679512, -54.1930131316185, -17.472339119762182, -14.585132580250502, -134.68554297089577, -53.34996508806944, -15.758290380239487, -87.05403742194176, -36.839102789759636, 39.07727563381195, 12.984303534030914, 8.868345074355602, -52.98507667332888, -91.78202044591308, -3.0561027228832245, 32.379326805472374, -18.312585309147835, -69.51829591393471, 40.379685293883085, 34.866501439362764, -54.562654895707965, -3.24214493855834, 10.295939296483994, 46.17909065634012, 20.52372784167528, -5.402094408869743, 18.382369481027126, -54.98949517309666, -4.037456184625626, -21.841819006949663, 27.776525616645813, -74.57117563486099, -8.036380022764206, 7.981051187962294, 0.9300599321722984, 6.0365773513913155, -1195.4043258205056, -250.59050334990025, -32.59628066420555, -12.277417903766036, -287.62835136801004, -2.923276722431183, -25.300791665911674, 14.95862264931202, -909.1415256485343, -46.41800496354699, -55.95107863843441, -16.187606371939182, 28.06296567246318, -15.501583509147167, 35.89301215112209, 50.53457816131413, -46.1464849114418, 23.305313035845757, -3.9407591223716736, -83.31878405809402, -24.99983946979046, -49.97092793136835, -14.579300917685032, -21.17490530759096, -87.47937609255314, -51.690953478217125, 18.781801849603653, -176.3779070712626, -16.240380194038153, -11.137871578335762, -2.692739136517048, -8.73220780491829, -19.68014680221677, 4.2284064292907715, 8.630848705768585, 21.100165251642466, 30.525017254054546, 55.08543087542057, -33.98659931868315, 0.4013296104967594, -7.704962372779846, -47.67497330158949, 19.784522742033005, 22.002556703984737, 17.113555677235126, -43.04106159508228, -18.56992445886135, 9.136135555803776, 15.047518819570541, -55.37412090599537, -30.934187658131123, 36.47966302745044, -11.54498453438282, -0.29496796429157257, -18.154184080660343, 30.24582764878869, -32.10217413306236, -44.83342684805393, 19.906042262911797, -79.17977285943925, -1021.7829842865467, -62.285953376442194, -21.170664630830288, -0.7962260767817497, 1.4443809017539024, 6.284937798976898, 18.54290045797825, 5.366980478167534, 40.953457072377205, -3.148560509085655, -10.844157829880714, -31.333873093128204, 49.332849733531475, -86.14145587012172, -46.83222356438637, 31.046845722943544, -80.87336771935225, -15.56876909546554, -29.345555439591408, 23.30363993346691, -10.10451802611351, -71.82070469111204, 28.456509567797184, 1.5262316577136517, 19.772098436951637, -9.203461855649948, 17.016698069870472, -12.59516716003418], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420087824143021, "mean_inference_ms": 4.553837110729853, "mean_action_processing_ms": 4.208943618994695, "mean_env_wait_ms": 3.230495556394535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11662560, "timesteps_this_iter": 131040, "agent_timesteps_total": 11662560, "timers": {"sample_time_ms": 29726.473, "sample_throughput": 4408.192, "load_time_ms": 22.481, "load_throughput": 5828925.182, "learn_time_ms": 14933.839, "learn_throughput": 8774.703, "update_time_ms": 2.17}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.462348535570527e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 161.5163996788854, "policy_loss": -0.004487189945771038, "vf_loss": 32.307214589956416, "vf_explained_var": 0.12904537941819877, "kl": 0.002442822237933008, "entropy": -0.5531238902854235, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11662560, "num_agent_steps_sampled": 11662560, "num_steps_trained": 11662560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11662560}, "done": false, "episodes_total": 23680, "training_iteration": 89, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-26-55", "timestamp": 1691022415, "time_this_iter_s": 39.422019481658936, "time_total_s": 2738.059685945511, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2738.059685945511, "timesteps_since_restore": 11662560, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 44.32142857142857, "ram_util_percent": 51.441071428571426}}
{"evaluation": {"episode_reward_max": -237.0217222943902, "episode_reward_min": -237.0217222943902, "episode_reward_mean": -237.0217222943902, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-237.0217222943902], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940891909908939, "mean_inference_ms": 3.8593263178319486, "mean_action_processing_ms": 1.2365680831771988, "mean_env_wait_ms": 199.108510346084, "mean_env_render_ms": 3.0517983031677796}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 55.08543087542057, "episode_reward_min": -1195.4043258205056, "episode_reward_mean": -47.8830357886292, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.52372784167528, -5.402094408869743, 18.382369481027126, -54.98949517309666, -4.037456184625626, -21.841819006949663, 27.776525616645813, -74.57117563486099, -8.036380022764206, 7.981051187962294, 0.9300599321722984, 6.0365773513913155, -1195.4043258205056, -250.59050334990025, -32.59628066420555, -12.277417903766036, -287.62835136801004, -2.923276722431183, -25.300791665911674, 14.95862264931202, -909.1415256485343, -46.41800496354699, -55.95107863843441, -16.187606371939182, 28.06296567246318, -15.501583509147167, 35.89301215112209, 50.53457816131413, -46.1464849114418, 23.305313035845757, -3.9407591223716736, -83.31878405809402, -24.99983946979046, -49.97092793136835, -14.579300917685032, -21.17490530759096, -87.47937609255314, -51.690953478217125, 18.781801849603653, -176.3779070712626, -16.240380194038153, -11.137871578335762, -2.692739136517048, -8.73220780491829, -19.68014680221677, 4.2284064292907715, 8.630848705768585, 21.100165251642466, 30.525017254054546, 55.08543087542057, -33.98659931868315, 0.4013296104967594, -7.704962372779846, -47.67497330158949, 19.784522742033005, 22.002556703984737, 17.113555677235126, -43.04106159508228, -18.56992445886135, 9.136135555803776, 15.047518819570541, -55.37412090599537, -30.934187658131123, 36.47966302745044, -11.54498453438282, -0.29496796429157257, -18.154184080660343, 30.24582764878869, -32.10217413306236, -44.83342684805393, 19.906042262911797, -79.17977285943925, -1021.7829842865467, -62.285953376442194, -21.170664630830288, -0.7962260767817497, 1.4443809017539024, 6.284937798976898, 18.54290045797825, 5.366980478167534, 40.953457072377205, -3.148560509085655, -10.844157829880714, -31.333873093128204, 49.332849733531475, -86.14145587012172, -46.83222356438637, 31.046845722943544, -80.87336771935225, -15.56876909546554, -29.345555439591408, 23.30363993346691, -10.10451802611351, -71.82070469111204, 28.456509567797184, 1.5262316577136517, 19.772098436951637, -9.203461855649948, 17.016698069870472, -12.59516716003418], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4031359289327465, "mean_inference_ms": 4.542375570200381, "mean_action_processing_ms": 4.15205830467016, "mean_env_wait_ms": 3.200261247937133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11793600, "timesteps_this_iter": 131040, "agent_timesteps_total": 11793600, "timers": {"sample_time_ms": 29730.077, "sample_throughput": 4407.658, "load_time_ms": 22.478, "load_throughput": 5829691.823, "learn_time_ms": 14934.678, "learn_throughput": 8774.21, "update_time_ms": 2.199}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.2311742677852636e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 136.84230495041095, "policy_loss": 0.0018399604169871892, "vf_loss": 27.36606189085164, "vf_explained_var": 0.352616150426181, "kl": 0.0021715454761803443, "entropy": -0.5595584448734064, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11793600, "num_agent_steps_sampled": 11793600, "num_steps_trained": 11793600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11793600}, "done": false, "episodes_total": 23680, "training_iteration": 90, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-27-10", "timestamp": 1691022430, "time_this_iter_s": 14.99890923500061, "time_total_s": 2753.0585951805115, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2753.0585951805115, "timesteps_since_restore": 11793600, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 13.854545454545455, "ram_util_percent": 51.70000000000002}}
{"episode_reward_max": 99.3782065846026, "episode_reward_min": -811.9421904981136, "episode_reward_mean": -28.550398506891604, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-291.744982637465, -88.86699333414435, 61.19056610018015, 6.115157172083855, -30.51741673797369, -295.47759068757296, 21.683012813329697, -70.18352956324816, -34.909068033099174, -23.353146642446518, 11.542947417125106, 12.79579222947359, -8.682469077408314, -43.72548793256283, 47.13874462246895, 48.77259761840105, -28.712842117995024, -34.0127192735672, 8.780154637992382, 10.487494483590126, 5.81447871774435, 14.680221423506737, -66.6077931523323, -4.9308679439127445, -6.0698131918907166, -39.3615246117115, -49.00635026395321, 33.69899670779705, -341.1192874982953, -63.483483232557774, -29.91533938795328, -41.31006507575512, 29.355854362249374, -56.23884502053261, -24.755259159952402, -1.7337929159402847, -16.87273545563221, -38.94900023192167, -14.764542572200298, 33.024537459015846, -45.92201296240091, 8.43814092874527, -104.77017657458782, -23.937393501400948, -13.077982515096664, 2.95369391143322, -73.48142889142036, -6.913390330970287, 26.14517753943801, -30.31596700102091, -67.93245818093419, -38.38868661224842, -0.8974916636943817, -38.10785147547722, -46.28172147274017, -43.96097827702761, -41.11057787388563, -246.77680680155754, -472.65173603594303, 37.90111128985882, 20.382710361853242, -55.78569658100605, -37.21300710737705, -6.25099541246891, 13.425565712153912, -55.23754585534334, 10.239109501242638, -12.543977811932564, -73.72265464067459, -108.89237751066685, -362.40063475072384, 25.487803233787417, 7.890927828848362, -5.93722203373909, -49.81664754450321, -59.0390732139349, -32.96523103304207, -23.30881007388234, 15.218962863087654, 34.69923731684685, 19.886197589337826, 25.381221175193787, -46.05577380955219, -473.82260797917843, -52.110018353909254, -136.14230455458164, -27.89111513644457, -41.00712858885527, -33.517768532037735, -70.56579039245844, 10.947554476559162, -33.02358844131231, 27.1129282489419, -20.032330244779587, -80.08743730932474, -50.04808393120766, 4.738754011690617, -12.468898460268974, -20.700582593679428, -11.49565852433443, -106.377571426332, -106.30963590741158, -7.505270216614008, -41.20270097255707, -0.2230968475341797, -21.956491254270077, 6.814053550362587, 5.090463362634182, -28.14241659641266, 17.96601866185665, -40.35838934779167, -117.13148535788059, -77.86659417301416, -12.609106622636318, 32.8873930349946, -7.456794552505016, -85.686031203717, -8.731760792434216, -83.69690772145987, -94.82307813316584, 29.359792552888393, -102.62102441489697, 50.00741834193468, -73.84401386231184, 16.687002956867218, -11.61848945915699, -29.77170518413186, 21.117106769233942, -42.126352936029434, -7.392675019800663, 2.243330165743828, 24.663320139050484, 6.155983589589596, 0.8667927980422974, 9.323849216103554, -17.767334163188934, -20.846551179885864, -58.69890822842717, -80.13413447141647, -77.06053018569946, -57.12786513566971, -32.605922028422356, 14.031006470322609, 2.615349840372801, -69.89970967173576, -0.7944380007684231, -7.893506111577153, -25.834706872701645, -24.181545842438936, -47.95276975631714, 7.374452754855156, -34.21347650885582, -72.60674046725035, 5.669818617403507, 18.116027042269707, -10.907046906650066, 25.94783627986908, -83.9523453488946, 41.79403007030487, -36.054317116737366, -42.82343860156834, -18.215826593339443, -18.318448923528194, -11.488091364502907, -40.5340396091342, -43.71283480525017, -110.17756367474794, -90.17000554129481, 1.4297013357281685, 8.058337353169918, -63.79691947251558, -26.106476463377476, -28.282272150740027, 55.41551090031862, 34.72092658281326, 43.07132409512997, -18.512303344905376, 16.01202993839979, -14.098650511354208, 44.945184130221605, -90.49277395009995, -5.324397385120392, -66.95296542346478, 15.44581476598978, 13.274537771940231, 22.28465010225773, -54.14640597254038, -77.7937633022666, 20.450019873678684, -46.91281946748495, -95.82817403972149, -22.01509737968445, 21.2130563929677, -2.8743705451488495, -18.401454597711563, -25.38418038189411, 23.396962605416775, 19.312587931752205, -4.326803985983133, -54.055732637643814, -73.64363485574722, -6.370012924075127, -80.93792217969894, -17.843970492482185, 25.874057222157717, -108.55779055505991, -52.76457977294922, 0.18535469472408295, -6.321923963725567, -14.449194148182869, -130.20770708099008, -27.050890505313873, -23.348468497395515, 99.3782065846026, 43.31238807365298, -88.0246759802103, -90.27095668017864, -20.056997552514076, -13.187489867210388, -290.0633688941598, 14.538422856479883, 42.6682785525918, 17.1647497266531, -52.1847093552351, 60.48208640143275, 26.479821756482124, -61.49041620641947, -43.054006235674024, 8.028043925762177, 36.15422125160694, 27.269419126212597, 33.92413103580475, -51.616757586598396, -6.193913072347641, -7.991526059806347, 33.59981718286872, -85.16938953101635, 34.64796435646713, 6.370797723531723, -2.2785910069942474, 27.197306752204895, -31.399236865341663, 24.885284334421158, -331.1746792718768, -69.10572149604559, -67.48225346207619, -12.406342849135399, -324.60807924717665, -14.45008783787489, 37.29299395531416, 7.430935263633728, 39.421524584293365, 49.05520275980234, -21.271969951689243, -40.00736556947231, -2.7334989830851555, 28.098542422056198, 27.610710062086582, -49.354970909655094, 40.943459045141935, -30.877627834677696, -36.49688075855374, -22.989274092018604, -21.326783053576946, 10.283055767416954, 1.6059972792863846, 17.890283949673176, 13.40969042479992, -33.677693136036396, 4.923939399421215, 13.840630427002907, -14.075853683054447, 32.590059485286474, 7.430875301361084, 17.182138990610838, 33.81156971305609, -16.81900619342923, 12.345456905663013, 3.195785030722618, 55.8861558586359, -108.21218618378043, 5.147115148603916, -84.05224163085222, -34.96964839100838, 32.93727447465062, -36.32878951728344, -13.859269008040428, -4.438572131097317, 15.4009333178401, -95.79257269948721, -95.75717557966709, -17.36719434708357, -5.666519157588482, -99.65499649941921, -15.277975991368294, -23.10612939298153, -25.80969648063183, -46.686721339821815, 19.80258446186781, -7.4554853066802025, -337.89783273637295, -86.71868341229856, -9.445508748292923, -126.51851630397141, 25.685408487915993, -44.27050970494747, 26.715918507426977, 3.2022183761000633, -64.29721640795469, -29.479034170508385, -58.71500501036644, 2.7063297107815742, 16.09504347294569, 45.85435600578785, -5.411087900400162, -67.89869316667318, -23.0339163467288, -27.800462499260902, -54.00344389677048, -5.724508985877037, -4.530399307608604, -15.283139683306217, -111.19024724513292, -45.0028534270823, 28.5700893253088, -15.862193867564201, -30.323892056941986, 9.039739988744259, -100.85790628194809, -25.323598936200142, 31.226515877991915, -34.457985416054726, -25.625101141631603, 46.430665615946054, -31.78275828808546, -127.6165499985218, -68.23912052065134, 21.318846754729748, 6.709323398768902, -14.340103767812252, 42.92324685305357, -47.807467207312584, -57.80686901882291, 21.501156786456704, 14.329306542873383, -103.06530950963497, -43.72990697622299, -88.56971390545368, -32.964965142309666, 8.826813019812107, -5.83001484721899, -35.815640673041344, -12.816730044782162, 3.4344848841428757, 30.167286328971386, 29.796363160014153, 17.00894142128527, -57.24381686747074, -66.10505679994822, -9.376017354428768, 25.794855419546366, -47.34566888213158, -19.027834318578243, 4.9908677116036415, -11.74783942103386, -366.0086361132562, -31.69216787070036, -46.80240698158741, 36.63849185407162, -28.122195109725, -47.18011946231127, 0.08858906477689743, 3.3032554611563683, -160.5065400749445, -110.86412912607193, 0.8878327421844006, 8.189809322357178, -51.61043185740709, -3.782752826809883, 56.162489511072636, -180.84568958729506, 35.12223765999079, -60.23880009353161, 14.378554433584213, -31.313246361911297, 28.410731218755245, 31.354659095406532, -13.701608441770077, 15.336188167333603, 27.637881472706795, -53.53485582768917, 2.467419110238552, -86.9037089124322, -9.39745444059372, -29.094930052757263, 11.014868550002575, 49.19379485398531, -72.69858454912901, -7.146796077489853, -811.9421904981136, 25.080915600061417, 36.651465609669685, -37.56521372497082, 7.430330168455839, -323.21044436097145, 30.657979361712933, 32.96785894036293, -51.85733326151967, 35.48086602985859, -123.75989601016045, 29.625683419406414, 38.11901193112135, 33.66178949922323, 33.17497204616666, -129.96269243583083, 3.447053998708725, -23.368192598223686, -1.3923584520816803, -77.13089856505394, -5.067377798259258, -26.047570630908012, 33.834354143589735, -15.528039947152138, -9.5002216771245, 5.2981041893363, -32.795478373765945, 42.05096201598644, 7.822611540555954, -3.6397672966122627, -32.265145774930716, -38.46815729141235, -4.568210454657674, -49.958783343434334, -23.37613744288683, -54.36646220088005, 23.86146279424429, -25.828246407210827, -25.360592491924763, -22.220304826274514, 16.691838949918747, 48.91525961086154, -42.745313584804535, 27.420072823762894, -194.49248339235783, 29.458548299968243, 16.05429795384407, -36.08391276746988, -156.00691364705563, 46.751946564763784, -1.96851297467947, 42.645719826221466, -5.662334851920605, 2.1825009286403656, 35.870589062571526, -6.1966841742396355, 54.49850423634052, -34.45005199685693, -53.278417468070984, -122.7296025454998, -32.98466669768095, 20.50370167940855, -18.084662042558193, -5.0769920609891415, 34.026653707027435, -60.061668522655964, -3.098388336598873, 41.265173479914665, 43.77670609951019, -118.44197955727577, 27.540178887546062, -34.58149384893477, 0.9220868200063705, -40.46318979933858, -7.187426760792732, 59.95814973115921, -53.363070607185364, 10.979148730635643, -38.9974083378911, 3.44394214451313, -38.26663950830698], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418694524105114, "mean_inference_ms": 4.554052256420584, "mean_action_processing_ms": 4.20892523253074, "mean_env_wait_ms": 3.2311204348475426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 11924640, "timesteps_this_iter": 131040, "agent_timesteps_total": 11924640, "timers": {"sample_time_ms": 29718.783, "sample_throughput": 4409.333, "load_time_ms": 22.285, "load_throughput": 5880299.483, "learn_time_ms": 14936.146, "learn_throughput": 8773.347, "update_time_ms": 2.204}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6155871338926318e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 139.29014597465473, "policy_loss": 0.0036265167016586255, "vf_loss": 27.853842270417026, "vf_explained_var": 0.3947929528451735, "kl": 0.002189270132695529, "entropy": -0.5608142097363763, "entropy_coeff": 0.001}}}, "num_steps_sampled": 11924640, "num_agent_steps_sampled": 11924640, "num_steps_trained": 11924640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 11924640}, "done": false, "episodes_total": 24160, "training_iteration": 91, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-27-49", "timestamp": 1691022469, "time_this_iter_s": 39.24451184272766, "time_total_s": 2792.303107023239, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2792.303107023239, "timesteps_since_restore": 11924640, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 44.25, "ram_util_percent": 51.11785714285715}}
{"episode_reward_max": 59.95814973115921, "episode_reward_min": -811.9421904981136, "episode_reward_mean": -24.012904283050446, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.84568958729506, 35.12223765999079, -60.23880009353161, 14.378554433584213, -31.313246361911297, 28.410731218755245, 31.354659095406532, -13.701608441770077, 15.336188167333603, 27.637881472706795, -53.53485582768917, 2.467419110238552, -86.9037089124322, -9.39745444059372, -29.094930052757263, 11.014868550002575, 49.19379485398531, -72.69858454912901, -7.146796077489853, -811.9421904981136, 25.080915600061417, 36.651465609669685, -37.56521372497082, 7.430330168455839, -323.21044436097145, 30.657979361712933, 32.96785894036293, -51.85733326151967, 35.48086602985859, -123.75989601016045, 29.625683419406414, 38.11901193112135, 33.66178949922323, 33.17497204616666, -129.96269243583083, 3.447053998708725, -23.368192598223686, -1.3923584520816803, -77.13089856505394, -5.067377798259258, -26.047570630908012, 33.834354143589735, -15.528039947152138, -9.5002216771245, 5.2981041893363, -32.795478373765945, 42.05096201598644, 7.822611540555954, -3.6397672966122627, -32.265145774930716, -38.46815729141235, -4.568210454657674, -49.958783343434334, -23.37613744288683, -54.36646220088005, 23.86146279424429, -25.828246407210827, -25.360592491924763, -22.220304826274514, 16.691838949918747, 48.91525961086154, -42.745313584804535, 27.420072823762894, -194.49248339235783, 29.458548299968243, 16.05429795384407, -36.08391276746988, -156.00691364705563, 46.751946564763784, -1.96851297467947, 42.645719826221466, -5.662334851920605, 2.1825009286403656, 35.870589062571526, -6.1966841742396355, 54.49850423634052, -34.45005199685693, -53.278417468070984, -122.7296025454998, -32.98466669768095, 20.50370167940855, -18.084662042558193, -5.0769920609891415, 34.026653707027435, -60.061668522655964, -3.098388336598873, 41.265173479914665, 43.77670609951019, -118.44197955727577, 27.540178887546062, -34.58149384893477, 0.9220868200063705, -40.46318979933858, -7.187426760792732, 59.95814973115921, -53.363070607185364, 10.979148730635643, -38.9974083378911, 3.44394214451313, -38.26663950830698], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401876234119283, "mean_inference_ms": 4.5428008778009925, "mean_action_processing_ms": 4.152129589838228, "mean_env_wait_ms": 3.201225065195274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12055680, "timesteps_this_iter": 131040, "agent_timesteps_total": 12055680, "timers": {"sample_time_ms": 27295.283, "sample_throughput": 4800.829, "load_time_ms": 20.858, "load_throughput": 6282473.846, "learn_time_ms": 14939.412, "learn_throughput": 8771.429, "update_time_ms": 2.186}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.077935669463159e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 134.08653917764744, "policy_loss": 0.002557944461022325, "vf_loss": 26.81418011094507, "vf_explained_var": 0.41132351724050376, "kl": 0.0023868607710145653, "entropy": -0.5701536577875896, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12055680, "num_agent_steps_sampled": 12055680, "num_steps_trained": 12055680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12055680}, "done": false, "episodes_total": 24160, "training_iteration": 92, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-28-05", "timestamp": 1691022485, "time_this_iter_s": 15.201807022094727, "time_total_s": 2807.504914045334, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2807.504914045334, "timesteps_since_restore": 12055680, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 13.813636363636364, "ram_util_percent": 51.599999999999994}}
{"episode_reward_max": 69.61559479683638, "episode_reward_min": -514.3511467054486, "episode_reward_mean": -21.4057027560911, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.439196363091469, 0.4016289487481117, -65.1650357618928, 46.7185977473855, -64.31956654600799, 4.759661770425737, -10.970713660120964, -304.2562352605164, -96.65575844049454, -67.70705856382847, -52.65732182562351, 2.223845161497593, -21.690117120742798, -34.38130009919405, -48.741410329937935, -52.90378428995609, 54.593828581273556, 30.656044483184814, 22.675175067037344, 49.185755824670196, -68.34751122444868, -30.969955280423164, -26.82414849102497, -50.71974402666092, -65.17591441050172, 0.8539373949170113, -40.380263678729534, -1.9797373190522194, -43.90267010033131, -24.54042623192072, 7.933568134903908, -66.69815807789564, 7.1247880309820175, -13.456524558365345, 8.141884204000235, -2.572420656681061, 12.554254040122032, -40.669174414128065, 63.70087406411767, -10.198336392641068, -40.60068949311972, 17.070538006722927, -45.695232175290585, -37.15568996220827, -60.1521025672555, 52.031697791069746, -29.87545169889927, -31.470185562968254, 7.5256651900708675, -49.346876084804535, 23.50170780904591, -6.050175718963146, -1.4058932736515999, -30.08379440754652, 16.400924026966095, -101.49059849977493, -37.408695727586746, -18.776709228754044, 2.5721933990716934, 14.281111799180508, 21.90155802667141, -32.69669754803181, -21.332281202077866, -11.099816434085369, 26.824988961219788, -12.36792729049921, -91.67698764801025, -72.76062446832657, -4.801747128367424, 14.222846940159798, 7.851744972169399, -46.88501641154289, 20.058236252516508, 34.75151789188385, 14.600848205387592, -104.79977938905358, 57.006702326238155, -73.75520038604736, 10.84781027585268, -0.12313958257436752, -71.96875895559788, 17.55966215953231, 32.1389918923378, -39.26810235530138, -82.28543482720852, 19.452702667564154, 16.826798640191555, -33.99543956667185, -28.676264978945255, 1.064402025192976, -11.962894067168236, -10.277921825647354, 2.7953221388161182, 10.711811758577824, 49.592588517814875, -9.863164000213146, 3.2337148636579514, -0.1086626872420311, -75.04471769928932, -2.187497265636921, -24.673859119415283, -40.308662571012974, -21.24153795093298, -23.988121960312128, 32.24535922333598, -80.53700997680426, -2.212732531130314, -36.92343061417341, -4.684161826968193, 6.666893497109413, -9.080791495740414, -110.80936805903912, -21.152461998164654, -43.607901610434055, -117.06222194433212, -93.39446046203375, -33.75355005264282, 15.349222555756569, -15.117914356291294, -21.114200487732887, 23.184757091104984, -23.505479834973812, -19.251292288303375, 34.11337053775787, -103.29185943305492, -8.902633264660835, -7.16185749322176, -79.30847743153572, -46.08859384059906, -50.33950186148286, -57.7002062574029, -51.49086017161608, 12.840680941939354, -61.93185493350029, -70.48488944023848, -23.22820984572172, -14.700959421694279, -37.67251034453511, 7.829965814948082, 23.62704836577177, 0.20183821767568588, 24.63396792858839, -27.002524442970753, 27.514411829411983, -23.951941534876823, -65.90546576678753, 14.531145233660936, -121.77339299023151, -27.71278015524149, -93.43376986682415, -30.568196214735508, -27.43051863461733, -20.729791209101677, 19.610738199204206, -20.059596493840218, -23.56448007375002, -84.84033294767141, -55.1554422006011, -29.039545079693198, -32.09026248008013, -58.99867118895054, -25.9204288572073, 23.56275513395667, -75.27798427641392, -8.504191353917122, -75.79317867383361, -80.43552546203136, -12.231655642390251, 10.335721909999847, -0.8088246174156666, 45.36413833685219, 3.305205762386322, -26.787568032741547, -26.000621892511845, -27.99944305419922, -103.1600247696042, -34.295532554388046, 0.6582504063844681, -30.61796874552965, -31.113962281495333, -71.00189636647701, 19.14583119750023, -4.541953772306442, -105.32716646045446, -41.42843613028526, -3.677320532500744, 30.54540292173624, -123.72059828788042, -55.79221814870834, 39.34871815145016, 6.865191586315632, 5.748289190232754, -3.4045794382691383, 20.825339771807194, -4.388978824019432, 18.210954308509827, 30.115570560097694, 30.698932863771915, 21.029065884649754, 47.510671347379684, -63.20146622508764, -26.0438652895391, -55.18035015463829, -54.27929297089577, -123.45319748669863, -100.75330422818661, -28.93560554087162, -88.01655359566212, -28.640801534056664, -8.996501687914133, 44.47661891579628, -57.12727947533131, 12.374723471701145, 8.234192162752151, 21.43030595779419, 12.850151687860489, -1.4461551010608673, -80.4069384932518, 37.232967272400856, 8.928664349019527, -34.594776660203934, 36.14906206354499, 14.850205212831497, -24.741620644927025, -72.07155124098063, 2.412133663892746, -42.371511057019234, 22.04938578605652, -4.842623248696327, 0.46737316250801086, -1.1721007376909256, 54.19912773370743, 9.888900220394135, -3.6003654673695564, 14.803020790219307, -67.11787183023989, -70.77271077036858, -47.02749862521887, 27.07408105581999, 40.64976352453232, 30.406248092651367, -514.3511467054486, -33.5112661793828, -48.92648674547672, -44.825143590569496, -9.475986529141665, 10.820166692137718, -29.458635225892067, -21.8084684535861, -67.49246693775058, -104.78921164385974, 9.248284138739109, -18.71198181807995, -17.202844344079494, 25.55596260726452, -43.549829445779324, -96.92303868383169, 45.08305912464857, -16.357805095613003, -29.88430253788829, -68.67425161600113, 30.6712309345603, -65.33153255656362, 1.6133209764957428, -42.206953443586826, 40.25136394798756, -108.74827095679939, -81.02972613275051, -21.638540379703045, -18.39185155555606, -19.53906263411045, -24.687618404626846, -32.2914709225297, -33.96293902397156, -1.6321267411112785, -7.5688380897045135, -24.362440049648285, 25.807219825685024, -6.819199830293655, 13.288493394851685, -91.08608121424913, 0.2806649934500456, -69.5557213947177, -0.23519662022590637, 18.86139691621065, 11.19478751718998, 35.91955293715, 18.88615144789219, -3.824434205889702, -11.479945831000805, 13.95581428706646, -23.062709271907806, -56.32089142501354, -81.66538082063198, -118.476368509233, 0.3352324552834034, -82.58681154623628, -68.7892125248909, -48.40545726567507, -8.170401081442833, -74.66357633471489, 25.112075865268707, -59.263151586055756, -7.150493819266558, -22.408315278589725, -81.65243421494961, -94.31218572705984, 6.928820326924324, -63.67906054109335, -12.01120114326477, -41.55845320224762, 14.665459789335728, -34.85979352891445, 2.8160397857427597, -62.03856682777405, -9.349091436713934, -0.5597115531563759, -6.887805677950382, -31.700577840209007, 22.35010663792491, 32.56001041829586, -39.53423549979925, -4.450897231698036, 11.823325350880623, -36.178782150149345, -33.155067801475525, 24.369788382202387, 3.6028718911111355, 9.384492848068476, -18.875154551118612, -14.850121334195137, 36.44703245908022, 23.081460669636726, -8.728847458958626, 2.3569466695189476, -9.728978767991066, 16.709086537361145, 10.930734790861607, 9.266289703547955, -20.739052092656493, 6.3479166850447655, -15.253903593868017, -1.7949539385735989, -0.43616103380918503, -17.398184895515442, 8.134552873671055, -29.076399572193623, -37.56243556365371, 23.356856666505337, -7.756362572312355, -68.06652440875769, -32.26423189043999, -81.65084464848042, 24.71686813980341, 2.4454672876745462, -60.01295083016157, 45.47885812073946, -90.92213951051235, -54.00923869013786, -44.22244307398796, 37.24010122194886, -87.97275745868683, 3.7676346004009247, -5.886176183819771, -46.06710874289274, -28.356204707175493, 5.609862446784973, -62.988425604999065, 69.61559479683638, -9.053535223007202, -25.527045041322708, 1.6135519742965698, -28.823593435809016, -43.03574642539024, 1.1785087659955025, -79.72819058597088, -78.50058652460575, 1.3755997121334076, -251.13522292673588, 40.88325957208872, -33.04398933053017, 29.38039216771722, 29.307689253240824, -20.569821015000343, -68.25736097991467, -10.849415585398674, 7.528369570150971, -42.0251846909523, 2.410700500011444, -24.409989781677723, 4.678316622972488, 38.42082503065467, -52.89741478860378, -29.050993144512177, -24.47956746816635, -36.15493976324797, 44.805925676599145, -7.014037095010281, -53.42930670827627, -8.778828538954258, -55.138180404901505, 0.6135113835334778, -95.39565532654524, -79.95143686234951, -32.54526872932911, -40.31163664907217, -73.69046647846699, -42.852411944419146, 27.742327947169542, -21.353215843439102, 41.32394618541002, -38.39841987192631, -63.20032751560211, -65.87326980754733, 14.138534218072891, -89.98317694664001, -32.59689852595329, -82.01804578304291, 24.020517505705357, -39.18863455951214, 3.8475928530097008, 42.26886719837785, -25.88627953082323, 4.051409274339676, -13.9816230610013, 12.988168761134148, 53.92786931246519, 17.46261541545391, 57.685714438557625, 13.586539342999458, -18.216728284955025, 27.85750449076295, -21.507019884884357, -6.224707558751106, 17.809901513159275, 0.9492675773799419, -31.4189258441329, 31.203548565506935, -22.086351618170738, -8.622293561697006, 51.54202016070485, -7.807238861918449, -65.91470661014318, -31.19508558511734, -8.546311788260937, -32.82328201085329, -101.41782693564892, 34.66832557320595, -59.24451130628586, -18.95553072169423, -34.323392279446125, -55.84262950718403, -40.58459374308586, 29.013658426702023, 6.112282283604145, -29.26494923606515, 37.7837383672595, -25.982391469180584, -25.40341980010271, -60.618777476251125, 25.0086171887815, -11.851991731673479, -69.35175632685423, -2.0839792042970657, -34.12054102122784, -8.32968606799841, -17.2777189463377, -40.98571968078613, -107.4724433273077, -4.9607345294207335, -21.22734196484089, -6.356903925538063, -8.723508009687066, -8.262903772294521, -29.172090120613575, 17.211420323699713, -44.68703039735556, -52.36916347593069, 25.784107476472855, -12.27582697197795], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418836148310506, "mean_inference_ms": 4.553986536166465, "mean_action_processing_ms": 4.208974766949695, "mean_env_wait_ms": 3.2313061572435515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12186720, "timesteps_this_iter": 131040, "agent_timesteps_total": 12186720, "timers": {"sample_time_ms": 29726.053, "sample_throughput": 4408.254, "load_time_ms": 23.039, "load_throughput": 5687692.117, "learn_time_ms": 14942.191, "learn_throughput": 8769.798, "update_time_ms": 2.191}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.0389678347315795e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 133.90415907057636, "policy_loss": 0.0015368647794775686, "vf_loss": 26.77871813483563, "vf_explained_var": 0.38627252345871327, "kl": 0.002641001112912352, "entropy": -0.5771186275935087, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12186720, "num_agent_steps_sampled": 12186720, "num_steps_trained": 12186720, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12186720}, "done": false, "episodes_total": 24640, "training_iteration": 93, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-28-44", "timestamp": 1691022524, "time_this_iter_s": 39.55498743057251, "time_total_s": 2847.0599014759064, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2847.0599014759064, "timesteps_since_restore": 12186720, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 44.214285714285715, "ram_util_percent": 51.57321428571429}}
{"episode_reward_max": 57.685714438557625, "episode_reward_min": -107.4724433273077, "episode_reward_mean": -17.137015856839717, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.04398933053017, 29.38039216771722, 29.307689253240824, -20.569821015000343, -68.25736097991467, -10.849415585398674, 7.528369570150971, -42.0251846909523, 2.410700500011444, -24.409989781677723, 4.678316622972488, 38.42082503065467, -52.89741478860378, -29.050993144512177, -24.47956746816635, -36.15493976324797, 44.805925676599145, -7.014037095010281, -53.42930670827627, -8.778828538954258, -55.138180404901505, 0.6135113835334778, -95.39565532654524, -79.95143686234951, -32.54526872932911, -40.31163664907217, -73.69046647846699, -42.852411944419146, 27.742327947169542, -21.353215843439102, 41.32394618541002, -38.39841987192631, -63.20032751560211, -65.87326980754733, 14.138534218072891, -89.98317694664001, -32.59689852595329, -82.01804578304291, 24.020517505705357, -39.18863455951214, 3.8475928530097008, 42.26886719837785, -25.88627953082323, 4.051409274339676, -13.9816230610013, 12.988168761134148, 53.92786931246519, 17.46261541545391, 57.685714438557625, 13.586539342999458, -18.216728284955025, 27.85750449076295, -21.507019884884357, -6.224707558751106, 17.809901513159275, 0.9492675773799419, -31.4189258441329, 31.203548565506935, -22.086351618170738, -8.622293561697006, 51.54202016070485, -7.807238861918449, -65.91470661014318, -31.19508558511734, -8.546311788260937, -32.82328201085329, -101.41782693564892, 34.66832557320595, -59.24451130628586, -18.95553072169423, -34.323392279446125, -55.84262950718403, -40.58459374308586, 29.013658426702023, 6.112282283604145, -29.26494923606515, 37.7837383672595, -25.982391469180584, -25.40341980010271, -60.618777476251125, 25.0086171887815, -11.851991731673479, -69.35175632685423, -2.0839792042970657, -34.12054102122784, -8.32968606799841, -17.2777189463377, -40.98571968078613, -107.4724433273077, -4.9607345294207335, -21.22734196484089, -6.356903925538063, -8.723508009687066, -8.262903772294521, -29.172090120613575, 17.211420323699713, -44.68703039735556, -52.36916347593069, 25.784107476472855, -12.27582697197795], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401571644699711, "mean_inference_ms": 4.542044328146973, "mean_action_processing_ms": 4.1513793234811605, "mean_env_wait_ms": 3.2008243577548807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12317760, "timesteps_this_iter": 131040, "agent_timesteps_total": 12317760, "timers": {"sample_time_ms": 27315.581, "sample_throughput": 4797.262, "load_time_ms": 21.242, "load_throughput": 6168897.186, "learn_time_ms": 14936.103, "learn_throughput": 8773.373, "update_time_ms": 2.167}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0194839173657898e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 121.12331958835186, "policy_loss": -0.0016549488706273931, "vf_loss": 24.225743926126896, "vf_explained_var": 0.39284669626570945, "kl": 0.002294407934025531, "entropy": -0.5754393641453063, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12317760, "num_agent_steps_sampled": 12317760, "num_steps_trained": 12317760, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12317760}, "done": false, "episodes_total": 24640, "training_iteration": 94, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-28-59", "timestamp": 1691022539, "time_this_iter_s": 15.188644409179688, "time_total_s": 2862.248545885086, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2862.248545885086, "timesteps_since_restore": 12317760, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 13.799999999999999, "ram_util_percent": 51.70000000000002}}
{"evaluation": {"episode_reward_max": 11.701446644961834, "episode_reward_min": 11.701446644961834, "episode_reward_mean": 11.701446644961834, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.701446644961834], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902825731027134, "mean_inference_ms": 3.865901030833367, "mean_action_processing_ms": 1.2385071634372657, "mean_env_wait_ms": 199.33005399024145, "mean_env_render_ms": 3.091726201443097}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 65.29844822734594, "episode_reward_min": -131.2271283864975, "episode_reward_mean": -15.403736677249737, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.725763961672783, -0.5057214647531509, 31.2930543795228, 16.741528242826462, 7.844740638509393, 5.406510300934315, 2.4892569296061993, -105.43741808831692, -41.953606337308884, -23.644674226641655, -3.4115422070026398, 22.476448960602283, 6.05907366424799, 11.26801236718893, -88.66371962055564, -10.99808120727539, -35.312007904052734, 26.974241375923157, -36.84541295468807, -17.35914048552513, -52.70023733377457, -8.914442203938961, 4.81155720166862, 39.352985214442015, 14.20667864382267, 4.741356834769249, -38.371822863817215, 34.301118955016136, 48.396314365789294, -12.907902888953686, 3.551726348698139, 16.16116128116846, -7.683467071503401, 26.751217164099216, -32.05131181329489, 6.953748323023319, 28.37472427263856, 17.708951596170664, 38.15854224190116, -59.394471406936646, -37.887315928936005, 10.536481138318777, 21.917382027953863, 9.185766771435738, -14.987624302506447, 2.4231418147683144, -8.408541601151228, 6.533506892621517, -62.514544090256095, 11.936618655920029, -38.33338689804077, -39.52410711348057, -15.805845633149147, -49.83070435374975, -3.3729863315820694, -11.826791115105152, -14.70756721496582, -66.77698473632336, -9.115412473678589, -19.6302242949605, -2.110611855983734, -56.10258351266384, 47.63278452306986, 11.950038142502308, -129.4289463981986, -22.21154486387968, -8.483307838439941, -40.284785978496075, 11.809196829795837, -15.270247653126717, 54.4620724953711, 8.176561146974564, 8.117583006620407, 37.51825862377882, 10.53500771522522, -10.499959841370583, 3.780355427414179, 20.66789654456079, -43.003632828593254, 3.469922088086605, -11.653339967131615, -12.131812900304794, -21.037168134003878, -86.95773009955883, -68.8585854768753, -113.63663901388645, -4.032635651528835, -52.415234327316284, 3.1188777163624763, 23.44371198490262, -41.11850272491574, -48.93353635072708, -55.259838223457336, -5.588530965149403, 15.000819973647594, -14.384307980537415, 27.662165112793446, -13.461364157497883, -18.799107044935226, -41.8776670768857, 12.253308989107609, -33.291438691318035, 43.15739332139492, 29.06756241619587, -15.802333198487759, -2.394482910633087, 23.820207558572292, 19.128942750394344, 45.295412722975016, -80.18116194009781, -37.155202597379684, 6.622896607965231, 8.84536537528038, -11.709709772840142, -4.504775837063789, -9.41927183419466, -51.97852100431919, -25.600893415510654, 8.235479466617107, -46.362214118242264, -4.284094115719199, 20.17906292527914, 10.494832251220942, -50.16690128296614, -47.01807425916195, -6.5301611460745335, -47.733748495578766, -5.139831461012363, -10.602475441992283, -2.5590240508317947, -3.4336961284279823, 41.41873197257519, -42.93410173803568, -12.191354393959045, -1.0607098266482353, 1.4880411438643932, -26.357121095061302, -50.28406736254692, -7.596654489636421, -2.779780976474285, 21.89473221823573, -36.94649813324213, -59.54025957733393, -27.58457938209176, -34.15823629498482, -6.453050918877125, -56.055656246840954, -67.32830449938774, -8.702094100415707, 11.86274141818285, -77.65155228972435, -13.641927052289248, -107.46490583568811, -8.1814643740654, 18.5878844037652, -110.91874798387289, 22.622383154928684, -2.003820575773716, -13.60919265449047, -55.09494471549988, -7.40056400001049, -47.872500747442245, -3.010736547410488, 42.143815606832504, 18.36697906255722, -71.05553627759218, -50.77531211823225, -58.66718997806311, 6.611673150211573, 26.410243971273303, -12.518482252955437, 6.97704067081213, -29.45115216076374, -29.281480066478252, 5.18131210654974, -49.43965922296047, 5.759467404335737, -15.226674884557724, -64.04239328950644, -87.80273497104645, 1.1548589169979095, 5.740943416953087, 0.7575507313013077, -58.09639262035489, -8.476269725710154, -22.680374938994646, 5.028349667787552, -82.78922860324383, -67.55797843635082, 11.802125860005617, -24.379785515367985, -2.0490275602787733, -77.11012114584446, 44.596385445445776, 4.663972686976194, 0.3038247488439083, -23.627618946135044, 0.8530953079462051, -23.414721496403217, -7.767400410026312, 37.852057956159115, -27.61440692283213, -51.087426111102104, -11.35304844379425, 0.012987855821847916, 33.01176483184099, 37.28126002848148, -45.83127933740616, 24.491471491754055, 7.874136306345463, 7.726069077849388, -3.8440570905804634, 65.29844822734594, 35.00792072340846, -7.444579474627972, 5.692913547158241, 18.168930113315582, 48.63778346031904, 3.477614402770996, -3.9195921272039413, -1.4887890219688416, -48.314805671572685, 18.755705006420612, -64.80070016533136, 32.38209041953087, -29.886173330247402, 12.274484135210514, -20.36552105844021, -35.00003473460674, -7.530913889408112, 32.81918506324291, 0.030201897025108337, 1.3164273351430893, -16.702056229114532, -26.30529797822237, -12.566901832818985, -63.18426859378815, -37.204321801662445, -87.42325554043055, -63.45505369454622, -34.4202771037817, 8.758737713098526, 41.21658929437399, -7.010202705860138, 1.41053107380867, 7.684074692428112, 20.539795599877834, -27.29434661567211, 27.915297605097294, 2.413882791996002, -27.383215487003326, 28.090714044868946, 8.495579645037651, -58.83431711792946, 18.87524652481079, -111.67096849530935, -16.391646288335323, 1.184222787618637, 19.96706235036254, -5.269246146082878, -41.190945252776146, -72.65295261144638, -3.5739164650440216, -42.506112307310104, -41.02707324922085, -9.858502067625523, -27.775204248726368, -11.723804034292698, -3.6368795707821846, -22.359876427799463, -1.9715096801519394, 1.049119345843792, -35.381342366337776, -0.32240179926157, -116.40513346344233, -3.662962093949318, -43.947205163538456, 32.16958409920335, 5.803251165896654, -39.93884348869324, -21.399849090725183, -14.56822208315134, -0.8507670536637306, -0.3138725757598877, -131.2271283864975, -40.194062292575836, -12.026416838169098, -83.37336030602455, -26.284939758479595, 28.079126611351967, -48.5989049077034, -56.683224245905876, 3.4878235310316086, -26.053447049111128, 57.81690962612629, -1.2203385084867477, 12.57960931956768, 5.348033659160137, -73.47940307110548, 36.975808680057526, -87.77208018675447, 22.19578516110778, 2.3572788536548615, -12.823477908968925, 40.079223059117794, -15.414040349423885, -20.35002388432622, 39.34759875386953, 6.6290671564638615, 5.536902770400047, -19.00913528725505, -36.32572944462299, -25.012070022523403, -43.155696015805006, -55.57690900284797, -50.306951716542244, 9.492320101708174, 21.17852471768856, 0.5854368433356285, 22.553480498492718, 16.42991640046239, 33.6547159999609, 43.58057099580765, -20.62202448397875, 37.529991483315825, -15.18703719228506, 11.553294248878956, -15.698401898145676, 36.134084574878216, 9.2099180072546, -9.143609818071127, 15.310154564678669, 38.15944700688124, -38.89870123565197, 36.218586288392544, 18.093842290341854, 1.1269413977861404, -1.2096098102629185, -26.4853532910347, -10.042227853089571, 51.079869121313095, -92.24527382850647, -70.20313312113285, -38.96580286324024, 36.370572447776794, -56.07893957942724, 51.50275285542011, 21.132591634988785, 27.315017998218536, -50.43076513707638, -10.079480163753033, -6.959180258214474, -39.84697074443102, -101.76382177323103, -42.475964397192, 32.61419219337404, -0.7884509935975075, -20.657062247395515, -15.606125548481941, 34.593382246792316, 20.621472530066967, -3.250521793961525, -49.26782564818859, -45.95262397825718, -55.717173881828785, -29.664643973112106, -23.79876596108079, -78.89854166656733, -43.3632100969553, -45.962397180497646, -7.465349495410919, -39.4845008328557, 32.00088391453028, -36.10986348986626, 10.382288418710232, -0.8960069864988327, -18.2594198808074, -63.04164608567953, 28.581779845058918, -3.770576551556587, -12.046823762357235, -17.330302000045776, -30.292783811688423, -74.26111917942762, -20.248766727745533, -7.156533434987068, -7.351954698562622, -79.65971429646015, -30.48825125209987, 9.224389605224133, -54.08135437965393, -71.91171873360872, -16.762670546770096, -53.048805214464664, 5.086372368037701, -99.3625548556447, -1.9666171818971634, -38.01018571853638, -20.14463270455599, -86.47863352298737, -9.353445038199425, 27.35940006747842, -44.425261333584785, 19.05491629242897, 9.65200049430132, -1.9083299785852432, -28.14081245660782, -15.388404682278633, 0.4863302484154701, -86.3332466557622, -47.723225980997086, -27.657020442187786, -59.44960418343544, 12.244269028306007, -4.260655388236046, -8.538554929196835, -18.521631933748722, 31.044666543602943, -1.99225814640522, -29.131642162799835, -2.9212734661996365, 21.183949060738087, -53.57671709358692, 4.662613287568092, -1.2861177623271942, -10.261555224657059, -34.226508751511574, 21.14320058748126, -42.40132541116327, -19.66198894381523, 16.972019337117672, -34.03887840360403, -15.123171247541904, -45.68372239172459, -19.878384456038475, -32.40849018096924, -24.012991204857826, -74.44170105457306, -8.459390047937632, 38.57140003144741, -10.713213324546814, -0.9664796367287636, -81.15394131839275, -30.986295491456985, -8.963861670345068, -47.827785938978195, 51.738762844353914, -86.43820424377918, 12.835763663053513, -60.06243005953729, -1.4235525503754616, -65.67380383610725, -82.14527261257172, -107.70040805637836, -69.25029531121254, -61.58522292971611, -35.038212314248085, 14.524775072932243, -73.23258851654828, -8.13209755718708, -12.972491800785065, -39.77144564688206, -25.988440200686455, -5.619692899286747, -40.039466224610806, -49.74227938428521, 15.352968782186508, -67.52072887122631, 41.48022944480181, 0.3640293478965759, -7.392762467265129, -25.967737779021263, 12.972471177577972, -93.95946614444256, -4.471564557403326, -22.7057154327631, 24.732377715408802, -27.6089775711298, -40.69745459407568, -79.38374781608582], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427219121596393, "mean_inference_ms": 4.561417592689987, "mean_action_processing_ms": 4.211916718839272, "mean_env_wait_ms": 3.2361375678324737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12448800, "timesteps_this_iter": 131040, "agent_timesteps_total": 12448800, "timers": {"sample_time_ms": 29897.282, "sample_throughput": 4383.007, "load_time_ms": 23.185, "load_throughput": 5651984.659, "learn_time_ms": 15002.065, "learn_throughput": 8734.798, "update_time_ms": 2.181}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0097419586828949e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 110.71957327027049, "policy_loss": -0.0011024233567603207, "vf_loss": 22.144437027661176, "vf_explained_var": 0.4818929996755388, "kl": 0.002405943893676179, "entropy": -0.5804599206293782, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12448800, "num_agent_steps_sampled": 12448800, "num_steps_trained": 12448800, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12448800}, "done": false, "episodes_total": 25120, "training_iteration": 95, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-30-45", "timestamp": 1691022645, "time_this_iter_s": 105.95960998535156, "time_total_s": 2968.2081558704376, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2968.2081558704376, "timesteps_since_restore": 12448800, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 38.792052980132446, "ram_util_percent": 65.6271523178808}}
{"episode_reward_max": 51.738762844353914, "episode_reward_min": -107.70040805637836, "episode_reward_mean": -25.062584627317264, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.046823762357235, -17.330302000045776, -30.292783811688423, -74.26111917942762, -20.248766727745533, -7.156533434987068, -7.351954698562622, -79.65971429646015, -30.48825125209987, 9.224389605224133, -54.08135437965393, -71.91171873360872, -16.762670546770096, -53.048805214464664, 5.086372368037701, -99.3625548556447, -1.9666171818971634, -38.01018571853638, -20.14463270455599, -86.47863352298737, -9.353445038199425, 27.35940006747842, -44.425261333584785, 19.05491629242897, 9.65200049430132, -1.9083299785852432, -28.14081245660782, -15.388404682278633, 0.4863302484154701, -86.3332466557622, -47.723225980997086, -27.657020442187786, -59.44960418343544, 12.244269028306007, -4.260655388236046, -8.538554929196835, -18.521631933748722, 31.044666543602943, -1.99225814640522, -29.131642162799835, -2.9212734661996365, 21.183949060738087, -53.57671709358692, 4.662613287568092, -1.2861177623271942, -10.261555224657059, -34.226508751511574, 21.14320058748126, -42.40132541116327, -19.66198894381523, 16.972019337117672, -34.03887840360403, -15.123171247541904, -45.68372239172459, -19.878384456038475, -32.40849018096924, -24.012991204857826, -74.44170105457306, -8.459390047937632, 38.57140003144741, -10.713213324546814, -0.9664796367287636, -81.15394131839275, -30.986295491456985, -8.963861670345068, -47.827785938978195, 51.738762844353914, -86.43820424377918, 12.835763663053513, -60.06243005953729, -1.4235525503754616, -65.67380383610725, -82.14527261257172, -107.70040805637836, -69.25029531121254, -61.58522292971611, -35.038212314248085, 14.524775072932243, -73.23258851654828, -8.13209755718708, -12.972491800785065, -39.77144564688206, -25.988440200686455, -5.619692899286747, -40.039466224610806, -49.74227938428521, 15.352968782186508, -67.52072887122631, 41.48022944480181, 0.3640293478965759, -7.392762467265129, -25.967737779021263, 12.972471177577972, -93.95946614444256, -4.471564557403326, -22.7057154327631, 24.732377715408802, -27.6089775711298, -40.69745459407568, -79.38374781608582], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410778433067433, "mean_inference_ms": 4.549680970621035, "mean_action_processing_ms": 4.154886319231722, "mean_env_wait_ms": 3.2053781199493177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12579840, "timesteps_this_iter": 131040, "agent_timesteps_total": 12579840, "timers": {"sample_time_ms": 33969.068, "sample_throughput": 3857.627, "load_time_ms": 22.999, "load_throughput": 5697550.296, "learn_time_ms": 14990.941, "learn_throughput": 8741.279, "update_time_ms": 2.189}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.0487097934144744e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 114.54595503155383, "policy_loss": -0.005113784280664285, "vf_loss": 22.91372223310573, "vf_explained_var": 0.5070807557806747, "kl": 0.0024485181293977714, "entropy": -0.5829659303029379, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12579840, "num_agent_steps_sampled": 12579840, "num_steps_trained": 12579840, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12579840}, "done": false, "episodes_total": 25120, "training_iteration": 96, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-31-01", "timestamp": 1691022661, "time_this_iter_s": 15.206223964691162, "time_total_s": 2983.414379835129, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2983.414379835129, "timesteps_since_restore": 12579840, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 14.409090909090908, "ram_util_percent": 51.20000000000002}}
{"episode_reward_max": 73.09541196003556, "episode_reward_min": -1074.8319055046886, "episode_reward_mean": -24.447433415132885, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.60812769085169, -26.688208654522896, -54.89835249632597, 16.20057839155197, -36.97332251816988, -4.227649949491024, -21.93595714122057, -31.20230497419834, 23.88423679769039, -20.28452779725194, -37.13684446364641, -53.739752888679504, -13.109297417104244, -17.17832337319851, 53.47312257438898, -48.85041381418705, -7.287160933017731, -38.38816203549504, -113.70855301618576, -8.203342117369175, 25.9087897464633, 28.134967520833015, -38.34078735113144, -4.874066486954689, -31.265631437301636, -9.303867816925049, 33.07648308575153, -16.1600032299757, 21.78502031415701, 35.36401894688606, 21.302228085696697, 26.697248993441463, 11.02457144856453, -217.22678191959858, -41.08068234845996, -69.02113116532564, -81.902393437922, -66.0658169388771, -13.891975700855255, -27.53202921152115, 33.68625086545944, -35.359913267195225, 15.314472667872906, -9.489578194916248, -81.3623586371541, -26.886610478162766, 13.461329691112041, -82.35073384642601, -10.626267906278372, 35.90760963410139, -13.792591735720634, -2.363790772855282, 20.642434410750866, -1.1096744760870934, 19.480793058872223, 23.715184792876244, 6.231599561870098, -7.08821427077055, -9.55930033326149, -37.834139838814735, 22.272422403097153, -9.39394062757492, -40.78445956110954, -41.50372449308634, -19.577903602272272, -33.03803890943527, 1.5398251228034496, 48.69718172773719, -50.50613967329264, -23.932503081858158, 5.82293027639389, -87.64124215207994, -21.729085877537727, -27.442103058099747, -50.01592954993248, -69.36599127948284, -62.16669934988022, 24.258551321923733, 0.7195844575762749, -12.978338584303856, -12.490073900669813, -67.06079018115997, 6.53283403813839, -1.6644180417060852, -111.37388776987791, 19.707223296165466, 40.27215676382184, 27.935063801705837, -19.016744926571846, -20.110197700560093, -31.182872481644154, 1.8615144789218903, 15.916733495891094, 33.86191687360406, -9.45666977763176, 31.411867305636406, 36.714471250772476, -43.4916699975729, -57.277169562876225, 41.83450047671795, -101.08300614356995, 13.226589977741241, 15.034316774457693, 17.356345288455486, -508.11170729249716, -10.424598634243011, 11.473364263772964, -56.02200781553984, 9.796445170417428, 19.11748117953539, -107.29208274930716, -13.476996138691902, -36.90860965847969, -47.58466216921806, -10.459111496806145, -24.713118821382523, -57.022669821977615, -19.6585598513484, -25.884848549962044, -19.171327479183674, 14.319028235971928, -12.535529896616936, 70.54708810150623, -20.462226450443268, -15.47732151299715, -45.302913857623935, 2.594513200223446, -62.64849080890417, -35.412870302796364, -73.84418819844723, -81.74213691800833, -48.96125604957342, -41.616445526480675, -45.79425959289074, -21.581079833209515, 10.5451133325696, -66.16705407202244, -44.60477200895548, -28.26854108273983, -0.9513546973466873, -32.63966329395771, 43.76217871159315, -96.26861058920622, -44.49327151477337, -5.366331443190575, -10.0210732370615, -55.45857422426343, 20.61561793088913, -287.0668422728777, -18.28337086364627, -64.79593863710761, -15.062292709946632, -61.27443830668926, -4.0952225886285305, 15.12064804136753, -81.12353038787842, -38.82108935713768, 11.744566455483437, 40.28008696436882, -30.012421250343323, -7.426337264478207, 37.82692288607359, -18.04029158130288, -12.884037524461746, -57.13150589168072, -0.3367335721850395, -10.82689567655325, -29.542600490152836, 44.0011804997921, -19.415368601679802, -58.91788585484028, -25.914239928126335, -17.773184210062027, -22.616101808845997, -1.9107044488191605, -141.1570815294981, -34.995334301143885, -26.064395129680634, 28.97140585631132, 24.084058798849583, -45.18375192582607, -93.49726758897305, 6.857000917196274, -39.54045329988003, -17.078002102673054, -10.48969016969204, -53.19451803714037, -86.77033984661102, -126.54808782041073, -57.12264819443226, 3.0610473304986954, -58.95244853198528, 14.46570061147213, 23.16772011294961, -7.113704800605774, -163.71313236653805, -9.231607414782047, 18.023449048399925, -3.9597662538290024, 42.86049138382077, 15.728753078728914, -29.8821407482028, -47.07831583917141, -4.3836797922849655, -77.36721311509609, -2.0019828639924526, 18.88755115494132, -87.56299448013306, -28.934835590422153, -12.11288721114397, -11.044714070856571, 19.272321801632643, 20.41821877285838, 9.873688727617264, -0.5963069349527359, -57.34167370200157, -17.534874215722084, 52.377570778131485, -45.84244100190699, 22.939944840967655, 39.424922965466976, -72.62702560424805, 7.644099421799183, -102.30957069993019, 21.085834316909313, -186.92141737043858, 21.584177516400814, -1.5633636303246021, -102.53030064702034, 29.021939620375633, -44.704028122127056, -93.97418014705181, 11.824728885665536, -13.094343114644289, -16.69684025645256, -93.92294431477785, -30.653559118509293, 9.694377396255732, -29.968473497778177, -54.3386407494545, -7.742967680096626, -28.4087497536093, -14.879282802343369, -28.670397274196148, -5.623167607933283, -50.754313100129366, 21.503463841974735, -25.77629779279232, -74.29228095710278, -141.58261965215206, -10.898599952459335, -62.063401237130165, 37.864355362951756, 28.1557689383626, 6.278399758040905, -19.089230626821518, -13.921722538769245, -54.80245926603675, -22.748290039598942, 31.641431741416454, -13.141532879322767, -13.264677569270134, 10.534001227468252, -71.32183996587992, -17.518015198409557, -55.64389691501856, -21.72760871052742, 18.206592302769423, 53.43191000446677, 30.547963932156563, -38.48631627857685, -136.65623071789742, 13.768244296312332, 31.092654664069414, 24.39727959409356, -74.94498473405838, -47.32354952022433, -79.73038366436958, -47.90298369899392, 52.23404077067971, -39.89563523232937, -41.04736649990082, -9.44839908927679, -2.584764949977398, -80.93958506733179, 34.46248232573271, -18.929961279034615, -41.30017077922821, -26.561846524477005, 15.23987976461649, 5.486409455537796, -62.55431295186281, -51.53005297482014, -106.14863431453705, -78.861497849226, 14.321991927921772, -8.491088815033436, -46.537684202194214, 12.468994311988354, 13.30379804968834, -43.915305783972144, -44.59278906881809, 31.625225327908993, -12.377368353307247, 6.330947555601597, -229.22393630445004, -196.01845628023148, -5.344523534178734, -6.410164080560207, 32.66131189092994, 13.887458771467209, 16.861300602555275, 16.648521676659584, -35.56741479039192, 40.17239712178707, 39.191295225173235, -0.053366467356681824, -38.126294538378716, 11.296907238662243, -7.782313525676727, 8.697930283844471, 12.518581449985504, -0.7322787344455719, 2.1714231222867966, -20.817017015069723, 5.359073095023632, -87.66073948144913, -70.75004487484694, 5.273142635822296, 16.85493092238903, -70.05177475512028, -1.2939139679074287, -18.113942753523588, -16.9176759775728, -0.40547090023756027, 14.420155178755522, -20.178300015628338, -61.093924924731255, 39.43218696117401, -18.939799711108208, 14.681483179330826, 1.6165330912917852, 16.6615988984704, -35.20884948968887, -60.34760034829378, -74.79228734970093, 25.09264136105776, 23.87747509777546, -20.110127694904804, 11.746895730495453, -72.18404127657413, -26.173314779996872, -7.565122827887535, -30.52046349644661, 39.151833549141884, -98.7578664124012, -37.915711387991905, -96.7824230324477, -0.43893109261989594, -11.681394532322884, -46.9593959748745, -28.953782945871353, -24.16520967334509, 50.03881822526455, 2.8454211056232452, -44.15441669523716, -1074.8319055046886, -68.45552061498165, -4.822724804282188, 18.789810210466385, -18.10396557301283, 9.82074198871851, -118.92960187420249, -80.91412337124348, -27.426738269627094, -15.400335036218166, -34.014298528432846, 32.93255092203617, 2.91034247726202, 25.80309620499611, -1.9800856336951256, 24.698655895888805, 4.686327651143074, -47.69487391412258, -13.696914620697498, 73.09541196003556, 2.1855480149388313, 18.59606920182705, 32.0642486512661, 32.18329317495227, -5.355838757008314, -30.628070384263992, 19.620231669396162, -15.179944943636656, -57.3606818318367, -3.9336155503988266, -30.899893671274185, 7.151272244751453, 11.714865759015083, -85.23970912396908, -30.163667172193527, -40.912347964942455, -39.08097245171666, -52.20530255883932, 27.748561423271894, 15.628953330218792, 14.095607310533524, -53.54423596709967, 10.118134744465351, -22.64264852553606, 9.323314249515533, 6.78045454621315, -6.171190224587917, 32.1396993920207, -46.98871060460806, -29.315264351665974, 16.688911877572536, -84.9360888376832, -148.0050551444292, 17.04497406631708, -2.304685488343239, 8.282257318496704, -21.199504904448986, -123.20822076499462, -53.1835982427001, -53.34605345129967, -32.85768769681454, -77.85559937357903, 15.858854964375496, -76.29166799038649, -68.42701739631593, -7.17769718170166, -7.901172552257776, 22.234152302145958, -91.23850084841251, -103.60301785171032, -24.11326054111123, -49.651497676968575, -34.182947639375925, 43.288104416802526, -22.56265003979206, -42.361929930746555, -55.82447766140103, 15.163487948477268, -34.04282492399216, -39.69105206057429, -43.363401578739285, 2.001169040799141, -112.74780988693237, -19.257817074656487, -4.8022445142269135, 34.45127411186695, 31.20164106041193, 24.754433684051037, -59.24780932068825, -142.95067273825407, -42.808336675167084, -12.087647153064609, -4.386356487870216, -49.30834338068962, -0.5593606010079384, -102.56396072357893, 61.0670223236084, 39.03237225860357, -1.2128288447856903, -62.14770895987749, -41.18870623409748, -32.91859921813011, -20.169675201177597, 17.70357036590576, 17.634271185845137, 12.128467474132776, 1.0519758388400078, -91.079050719738, 8.078512109816074, -22.807833325117826, -23.65290954709053, -10.496819168329239, 6.807846590876579, -72.02578997612], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425848538004357, "mean_inference_ms": 4.561972258157394, "mean_action_processing_ms": 4.21180946781294, "mean_env_wait_ms": 3.236166720900555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12710880, "timesteps_this_iter": 131040, "agent_timesteps_total": 12710880, "timers": {"sample_time_ms": 36384.656, "sample_throughput": 3601.518, "load_time_ms": 24.58, "load_throughput": 5331204.519, "learn_time_ms": 14999.881, "learn_throughput": 8736.069, "update_time_ms": 2.23}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5243548967072372e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 132.08450126190326, "policy_loss": 0.0029803889230126633, "vf_loss": 26.413333629621828, "vf_explained_var": 0.4530020735383461, "kl": 0.002025250406617653, "entropy": -0.5866276602591237, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12710880, "num_agent_steps_sampled": 12710880, "num_steps_trained": 12710880, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12710880}, "done": false, "episodes_total": 25600, "training_iteration": 97, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-31-40", "timestamp": 1691022700, "time_this_iter_s": 39.57513380050659, "time_total_s": 3022.9895136356354, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3022.9895136356354, "timesteps_since_restore": 12710880, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 44.232142857142854, "ram_util_percent": 51.314285714285724}}
{"episode_reward_max": 59.72094116359949, "episode_reward_min": -264.4345853924751, "episode_reward_mean": -23.199983286269706, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.30346843600273, -6.13128063455224, 31.922183647751808, -19.245993182063103, 36.737592689692974, 31.67176077514887, -59.496480226516724, 5.526254765689373, 2.7406645007431507, -53.469858311116695, -98.70708620548248, -29.42276880890131, -8.65634299069643, -12.232000529766083, -18.363630052655935, 6.796945221722126, -19.955724596977234, 35.68548923358321, -21.23339408636093, 9.02640999853611, -3.4375224485993385, -14.725668296217918, 38.46642762422562, -63.54792258888483, -21.202150844037533, -7.43926578015089, -1.8471856825053692, -62.98898962140083, -128.5576758608222, -29.345647152513266, -39.06077638268471, -17.524850875139236, -146.2185965999961, -6.559881828725338, 34.59055299125612, -31.410392723977566, -121.99844293296337, 10.061814621090889, 10.144864186644554, 32.541724652051926, -37.036897487938404, -24.11977970600128, 22.538452818989754, -32.66884047910571, -57.7423729673028, -50.384216874837875, 6.813242711126804, -87.07254514098167, 5.8665322214365005, -18.707136318087578, -21.619186133146286, 8.819407127797604, -23.41525800526142, -66.31064693629742, 6.356218531727791, -21.34283936023712, -27.59347914159298, -14.45790682733059, -120.14072060585022, 4.7388418316841125, 9.79215445369482, -25.337054200470448, 8.063166622072458, -18.308587059378624, -24.05000877380371, 29.63325795531273, -36.37631464749575, -6.792522341012955, -18.403197392821312, 26.41202710196376, 15.328858807682991, -13.155201576650143, -103.29964706301689, 22.51803944259882, -6.952699970453978, -26.316794529557228, 32.30700896680355, 7.193122416734695, -122.58165648579597, -13.279818698763847, 27.557951275259256, -18.995728455483913, -30.5926710665226, -32.735237900167704, 20.97114134579897, -71.76466607302427, 57.10982748866081, -66.66333495080471, 18.96367120742798, -52.28026020526886, 12.950694620609283, -58.3525777310133, -49.208740435540676, 48.66836952790618, -74.90294915437698, -155.95081319659948, -52.75331877171993, 9.401821486651897, -32.33831808716059, -20.499783471226692, -10.556845642626286, -25.015224531292915, 39.63945532217622, -40.39371843636036, -42.00013720244169, 40.215857814997435, -122.34270208328962, -37.80031195282936, 33.25607096403837, -1.0722972825169563, -75.22187425196171, -49.8971189185977, 52.95567728206515, -11.520744800567627, -111.61920453608036, 3.719829522073269, -65.71752236038446, 14.81162153556943, -13.59449191391468, 16.972107708454132, -94.32157153636217, -34.1479322090745, -0.18408982455730438, -32.04275722801685, -2.720698021352291, 59.72094116359949, -19.388399221003056, -24.215396873652935, -43.45753889903426, 2.642371654510498, -30.777588725090027, -14.73553241789341, -32.435367710888386, 29.057544268667698, -2.499199718236923, 6.136603131890297, 27.926480423659086, -78.74582913890481, -43.50519708171487, -1.6225720271468163, -16.180823773145676, 2.825058087706566, 2.1968145444989204, -7.728495851159096, -20.069512963294983, -3.1147250905632973, 25.960136272013187, 10.194627448916435, 18.378080423921347, 39.26855689287186, 4.9818421602249146, -57.345273898914456, 41.41502998024225, -19.469366505742073, 20.497958824038506, -68.25058468431234, 17.49182191863656, -8.080286122858524, -0.3918217532336712, -42.415565587580204, 15.87963155284524, -109.81314822286367, -0.3910326510667801, -17.786409705877304, 11.7624087408185, -47.7544719055295, -1.1384348720312119, -0.6168022006750107, 23.28785827755928, -15.02428363263607, -13.598632268607616, -82.62138995528221, -12.68994078040123, 24.528842471539974, -56.526550978422165, -27.7526822835207, -49.51456541568041, -60.57122729718685, -77.19213831424713, -73.75754734873772, -75.6550565212965, 31.724583823233843, -21.50942002236843, 21.103001937270164, 31.8602946549654, -105.10165325552225, -72.2668666318059, -151.9944993853569, -95.64471304416656, 26.312823303043842, -26.91667302325368, -46.02542507648468, -13.16376506537199, 26.184237979352474, -68.11922499537468, 7.140121653676033, 9.164284825325012, -83.87025234103203, -19.180299274623394, 7.8860838040709496, -18.124749339185655, 14.655549231916666, 15.745799839496613, -196.60253630578518, -20.11225041002035, -74.45884358882904, -68.42796774208546, 26.175594195723534, 17.42414429783821, -30.050769366323948, -34.007893569767475, -131.58672304451466, -93.09296420961618, -86.75198663026094, 4.822610020637512, -94.60728376358747, 6.6905804090201855, -72.70383328199387, -44.46617425978184, 11.52710173279047, -38.83502974361181, 21.829471588134766, -71.83646443486214, 13.603611193597317, 21.627403780817986, 18.641599375754595, 4.614452078938484, -12.907263115048409, -16.294102795422077, 10.289349965751171, -13.797318935394287, 22.166313983500004, -4.319239154458046, -77.6983591914177, 9.401785001158714, -6.353007283061743, 23.67973866313696, -41.623456325381994, -3.4739712923765182, -18.109135150909424, 59.09156205505133, -76.30670075491071, -6.9821541756391525, 43.33778593689203, -15.071321822702885, -7.1599787548184395, 19.4765642285347, -105.30202313885093, -6.161383144557476, -91.41337691247463, -4.7387846782803535, -2.9571096003055573, -25.96259507536888, -45.1006261408329, 7.6002306416630745, 11.123417798429728, 24.26604064553976, -60.67820754647255, -12.939401537179947, -4.676285274326801, 20.815338477492332, -62.90873111784458, -97.88239743188024, -43.91665584594011, 40.639910861849785, -30.09433712810278, -57.10576053708792, -8.978673070669174, -44.80467991530895, -2.4273708537220955, -40.4837823882699, -44.83190484344959, -71.62876568734646, -39.08583415299654, 41.56407182663679, -30.563640624284744, -145.7704913392663, -97.0349975079298, -12.080873101949692, 27.212012335658073, -20.467690892517567, 19.404496550559998, -78.85966784507036, 20.940457746386528, -75.07591408491135, -44.64306019991636, 5.929081968963146, 21.05302905291319, -58.36595904827118, -119.84761303663254, 20.239940710365772, -7.958148933947086, 3.4395473152399063, -96.6126803457737, 0.026874441653490067, -22.40776015818119, -37.87578012421727, -23.81377300620079, -264.4345853924751, -42.19561279937625, 18.20513878762722, -72.61951832473278, -153.4837983250618, 28.526450872421265, 19.691840387880802, -57.72454708814621, -101.25455836951733, -7.670358881354332, -17.170369535684586, 27.548129089176655, -76.25528443232179, -7.445849046111107, -47.04511530697346, -24.56197489798069, 9.435243256390095, 27.11969832330942, 9.05293002165854, 34.93181358277798, -16.461945712566376, -44.20770201832056, 47.998906284570694, -101.3201003819704, -61.61087957769632, -62.832941457629204, -40.25040499866009, -97.26469198614359, 20.83121084421873, -8.516661658883095, 38.41675089299679, -46.890029080212116, -18.344812627881765, -13.950633957982063, 45.13226574473083, 10.138023868203163, -1.7717854380607605, 18.43431130051613, -51.585120633244514, 7.629642192274332, -4.166021276265383, -17.045427061617374, -12.891124859452248, -52.93375116586685, -91.4158778898418, -9.230842009186745, -70.99343730509281, 41.210006192326546, 27.956392258405685, -23.361211597919464, -7.40585220977664, 0.9900852516293526, 5.886585149914026, -86.3117838576436, -134.45624782145023, -1.9089403003454208, 5.462555512785912, -45.358294170349836, -51.158237278461456, -40.909561797976494, 12.022930577397346, -81.80908922851086, -52.06995781511068, -3.0143783912062645, -12.693519972264767, 3.022856183350086, 14.378924831748009, -22.578486807644367, 7.379731059074402, -15.922114044427872, -37.483175843954086, -25.035785108804703, 3.1117357164621353, -45.56915385276079, 7.272815026342869, -34.71342672407627, 13.458154834806919, -3.4038234502077103, -36.22485003620386, -53.560301303863525, 23.648980300873518, -0.4141034781932831, -1.1368692517280579, -46.04319692403078, 38.781706511974335, -34.28498129546642, -104.41298389434814, -86.89867421984673, 3.782998725771904, -8.412300454452634, -82.55970215797424, -1.6455320995301008, -106.95537681877613, -77.05250623077154, -172.13364724069834, -189.20701467618346, 5.019774027168751, 10.836791954934597, -51.02574352361262, 39.03034523129463, -19.389878168702126, 17.383433014154434, -3.346469961106777, -73.6443177908659, 32.5779986679554, 37.421356439590454, -15.707982189953327, -12.623292125761509, -30.19659911841154, -12.974069356918335, -40.798788130283356, -52.57746605575085, -82.96722534298897, -7.021206505596638, 18.278323210775852, 39.89984203875065, 47.27436211705208, 1.155665174126625, -170.16933700814843, -93.24957598000765, -17.05077499896288, -97.65595062077045, -106.14563359320164, -127.83946618437767, -11.343794574961066, -89.98259899020195, 27.951573997735977, 12.110207661986351, -5.0697009190917015, -8.61914100497961, -28.620859406888485, -68.42920512706041, -5.9775025099515915, -28.953434087336063, 9.717014353722334, 43.859016507864, -1.381267286837101, 7.836384102702141, -60.83735240250826, 53.918003275990486, -42.50570732541382, 25.76297115534544, 34.916072994470596, 18.44576035812497, -10.225673325359821, 22.941986940801144, 8.926564268767834, -47.58173756301403, -62.419046476483345, -5.57614441215992, -76.95890267193317, -14.013663873076439, 35.785669375211, 49.490160420536995, -21.796825639903545, 39.11223305761814, -11.992784693837166, -11.182209923863411, -5.641491435468197, -18.378995023667812, -15.771808102726936, -53.39242281019688, 21.11174651235342, -80.02264086157084, -6.12001883238554, -25.94060005247593, -18.233359970152378, 28.028847955167294, -121.82198894023895, -113.6913645118475, -131.5232663601637, -6.862413167953491, -30.01589724421501, -3.293565981090069, -1.2105429619550705, 0.8646269850432873, 44.64408801496029, 21.609029047191143, -32.12460200488567, -65.48642276972532, -52.79659616947174, 43.999276738613844], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4257663383078265, "mean_inference_ms": 4.5617994992021895, "mean_action_processing_ms": 4.211729789865914, "mean_env_wait_ms": 3.2362433522108147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12841920, "timesteps_this_iter": 131040, "agent_timesteps_total": 12841920, "timers": {"sample_time_ms": 36417.252, "sample_throughput": 3598.295, "load_time_ms": 25.108, "load_throughput": 5219033.113, "learn_time_ms": 14987.018, "learn_throughput": 8743.567, "update_time_ms": 2.202}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2621774483536186e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 129.21075921173275, "policy_loss": 0.0009077236755761866, "vf_loss": 25.8406558361532, "vf_explained_var": 0.481419724482362, "kl": 0.0025694841903737223, "entropy": -0.5886876886463507, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12841920, "num_agent_steps_sampled": 12841920, "num_steps_trained": 12841920, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12841920}, "done": false, "episodes_total": 26080, "training_iteration": 98, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-32-20", "timestamp": 1691022740, "time_this_iter_s": 39.50626564025879, "time_total_s": 3062.495779275894, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3062.495779275894, "timesteps_since_restore": 12841920, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 43.719298245614034, "ram_util_percent": 51.53859649122808}}
{"episode_reward_max": 53.918003275990486, "episode_reward_min": -189.20701467618346, "episode_reward_mean": -24.78448280496523, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.1368692517280579, -46.04319692403078, 38.781706511974335, -34.28498129546642, -104.41298389434814, -86.89867421984673, 3.782998725771904, -8.412300454452634, -82.55970215797424, -1.6455320995301008, -106.95537681877613, -77.05250623077154, -172.13364724069834, -189.20701467618346, 5.019774027168751, 10.836791954934597, -51.02574352361262, 39.03034523129463, -19.389878168702126, 17.383433014154434, -3.346469961106777, -73.6443177908659, 32.5779986679554, 37.421356439590454, -15.707982189953327, -12.623292125761509, -30.19659911841154, -12.974069356918335, -40.798788130283356, -52.57746605575085, -82.96722534298897, -7.021206505596638, 18.278323210775852, 39.89984203875065, 47.27436211705208, 1.155665174126625, -170.16933700814843, -93.24957598000765, -17.05077499896288, -97.65595062077045, -106.14563359320164, -127.83946618437767, -11.343794574961066, -89.98259899020195, 27.951573997735977, 12.110207661986351, -5.0697009190917015, -8.61914100497961, -28.620859406888485, -68.42920512706041, -5.9775025099515915, -28.953434087336063, 9.717014353722334, 43.859016507864, -1.381267286837101, 7.836384102702141, -60.83735240250826, 53.918003275990486, -42.50570732541382, 25.76297115534544, 34.916072994470596, 18.44576035812497, -10.225673325359821, 22.941986940801144, 8.926564268767834, -47.58173756301403, -62.419046476483345, -5.57614441215992, -76.95890267193317, -14.013663873076439, 35.785669375211, 49.490160420536995, -21.796825639903545, 39.11223305761814, -11.992784693837166, -11.182209923863411, -5.641491435468197, -18.378995023667812, -15.771808102726936, -53.39242281019688, 21.11174651235342, -80.02264086157084, -6.12001883238554, -25.94060005247593, -18.233359970152378, 28.028847955167294, -121.82198894023895, -113.6913645118475, -131.5232663601637, -6.862413167953491, -30.01589724421501, -3.293565981090069, -1.2105429619550705, 0.8646269850432873, 44.64408801496029, 21.609029047191143, -32.12460200488567, -65.48642276972532, -52.79659616947174, 43.999276738613844], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408819994489072, "mean_inference_ms": 4.549282827140703, "mean_action_processing_ms": 4.1532970512539205, "mean_env_wait_ms": 3.2038291651519217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 12972960, "timesteps_this_iter": 131040, "agent_timesteps_total": 12972960, "timers": {"sample_time_ms": 33991.566, "sample_throughput": 3855.074, "load_time_ms": 23.483, "load_throughput": 5580180.944, "learn_time_ms": 14991.536, "learn_throughput": 8740.932, "update_time_ms": 2.211}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.310887241768093e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 128.61852916232158, "policy_loss": -0.002203222286338356, "vf_loss": 25.725319500037845, "vf_explained_var": 0.4408976805252841, "kl": 0.00233949018966934, "entropy": -0.5899378783386668, "entropy_coeff": 0.001}}}, "num_steps_sampled": 12972960, "num_agent_steps_sampled": 12972960, "num_steps_trained": 12972960, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 12972960}, "done": false, "episodes_total": 26080, "training_iteration": 99, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-32-35", "timestamp": 1691022755, "time_this_iter_s": 15.316554069519043, "time_total_s": 3077.812333345413, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3077.812333345413, "timesteps_since_restore": 12972960, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 14.068181818181818, "ram_util_percent": 51.599999999999994}}
{"evaluation": {"episode_reward_max": -26.33329052478075, "episode_reward_min": -26.33329052478075, "episode_reward_mean": -26.33329052478075, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.33329052478075], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902825731027134, "mean_inference_ms": 3.865901030833367, "mean_action_processing_ms": 1.2385071634372657, "mean_env_wait_ms": 199.33005399024145, "mean_env_render_ms": 3.091726201443097}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 74.04964136332273, "episode_reward_min": -196.65622583031654, "episode_reward_mean": -20.7575341910735, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 320, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.79085875861347, 20.243483379483223, -31.951052486896515, -9.962272085249424, -47.442003052681684, 19.929525710642338, -44.35547602176666, 16.589927673339844, -4.029812507331371, -6.6808480098843575, -0.4286779910326004, -33.12479453533888, -132.44654427468777, -25.16915290057659, -112.62466741725802, -17.073664117604494, -36.14195007272065, 5.990154549479485, 65.19968531280756, -20.04521732404828, -8.622063048183918, -68.10204990953207, -90.47485606372356, -47.48312297463417, -15.012340895831585, -84.4111977443099, 43.26545233465731, 61.06525522470474, -101.3095521479845, 24.31229717284441, 37.78465856984258, -36.453487284481525, -80.71165280789137, -6.359571285545826, 11.654730074107647, -90.03901842236519, -13.198630213737488, -0.3794855549931526, -21.660971887409687, 39.15351451188326, -35.27802247554064, -56.56827796250582, 37.63699456304312, -18.562756150960922, -85.32818607240915, -98.23755970597267, -56.91578368842602, -40.76763931661844, -62.789311181753874, -100.95018856227398, 39.99453163892031, -14.576319247484207, 6.836563911288977, -46.394421719014645, -196.65622583031654, -23.448827005922794, 20.61919418722391, -66.06151419878006, -31.013127848505974, -47.78237851150334, -25.287232488393784, -12.163284957408905, -40.30586855113506, -34.71874860674143, -3.620679058134556, -61.803472355008125, -55.38285552710295, -50.89226642996073, -47.07690796069801, -43.970895409584045, 5.29069434851408, 9.672181643545628, -19.074355602264404, 44.35596379637718, 11.887419283390045, -43.36096787452698, 36.91544617898762, 7.671967968344688, -33.901753932237625, -15.580799594521523, -16.830125503242016, -17.906696319580078, 15.6083495169878, -5.257062911987305, -5.04104408621788, 1.6077003851532936, -28.29567727446556, -1.595935381948948, -87.82360168173909, -28.192361250519753, -28.63258621096611, -23.951443649828434, -47.925971092656255, -79.29649949073792, -9.013532251119614, 27.023075565695763, 56.91392317414284, 5.333312653005123, -138.75180622190237, -53.83038628101349, 8.744050186127424, 32.91644328087568, -9.159189827740192, -22.88392484933138, 17.382199227809906, 1.2834170646965504, 50.98979452252388, -10.682988658547401, -82.0682014375925, -107.13155344128609, -9.1547781676054, -1.3709275871515274, 20.42938970774412, -18.014729656279087, -9.42479196190834, -35.93040120601654, 21.181307677179575, -25.258730858564377, -79.8583082407713, 6.374978564679623, 28.84231773018837, -122.15260899066925, -26.091221138834953, -20.699987515807152, -75.75143568217754, -14.309059895575047, 19.65965710580349, 30.80827148631215, -17.669485419988632, -40.279990676790476, -0.08547992259263992, 57.79448688030243, -6.5603659227490425, 23.567123234272003, 42.48933920264244, 27.137582294642925, 8.803113430738449, -33.92284435033798, -10.68231876194477, -2.3263183534145355, -15.091040030121803, 15.50089779496193, -14.741035178303719, -31.868944935500622, 10.69512115418911, 27.998383849859238, -52.4669099599123, -88.06660982221365, -39.91382950544357, 40.70004955679178, -6.5228845700621605, -92.13289575278759, -27.14918197505176, -12.187236361205578, -23.603505194187164, -92.47192979604006, -77.50488767027855, -20.235284060239792, -4.071573078632355, -29.51102963089943, -79.97433647979051, 60.6156050786376, -81.43916214257479, 4.1448338106274605, -50.1328911036253, -12.057292999699712, -43.409889459609985, 58.22193115949631, -135.84997598826885, 14.678335092961788, 19.000021785497665, -1.8036015592515469, -70.37388549000025, -5.0703341364860535, 41.60449701547623, -67.91090274602175, -47.35010427981615, -54.360366970300674, 12.836383767426014, -195.80732676386833, -40.57953056693077, 0.2442321963608265, 13.592916458845139, 7.4116595685482025, -17.846640579402447, -64.40189963579178, -67.64744201302528, 74.04964136332273, 11.128782829269767, 53.87107703089714, -38.58149564266205, -5.8584409188479185, -49.50310018658638, -27.61799607425928, 1.3346498757600784, -57.27637519687414, 1.7196916118264198, -1.2699967101216316, -35.2175075635314, -47.023658722639084, 27.999859489500523, 9.253307059407234, 5.294937931001186, -7.327528215944767, 24.89734804071486, 52.005661230534315, -30.010303780436516, -58.82168726623058, 44.35180540010333, -85.85542767494917, -140.6613253429532, -107.30976691097021, 58.92616444081068, -22.58392135798931, 41.320816308259964, -26.547916397452354, -25.959701716899872, -67.98639269173145, 5.154650084674358, -62.78442554175854, -28.265241652727127, -5.987719252705574, -66.7631229609251, -70.48014402389526, 19.497979629784822, -24.721291460096836, -89.92554870247841, -38.822927854955196, 61.62837319076061, -13.761134626343846, 6.175794489681721, -19.762852298095822, 10.045196920633316, 17.771882221102715, 32.064528569579124, 21.65485306084156, -26.666154988110065, -2.6509159952402115, -56.39430417120457, -51.311127942055464, -13.610833190381527, -157.28748663887382, -81.37203443050385, -24.685252752155066, 11.831749841570854, -91.75121384300292, -6.303367733955383, -30.126914098858833, 53.46142176911235, -33.68457728624344, 32.93063898384571, -22.103371143341064, -62.657744862139225, 46.714147198945284, 8.740889951586723, 9.406330041587353, -60.71320669353008, -85.15958833508193, 18.264303848147392, 27.301846342161298, 4.831582896411419, 7.383842762559652, 25.926298312842846, -8.1832375228405, -55.648787654936314, -67.25999113544822, -17.950927823781967, -82.46182768978179, -84.73318713903427, -13.998236522078514, 41.237258199602365, -23.998384080827236, 23.72593229264021, -33.14888509362936, 51.84520324319601, 47.42889989167452, -70.22416726499796, -9.541741825640202, 0.5652448385953903, -70.09339793026447, -24.322290662676096, -63.227409198880196, 13.049629732966423, 17.08566466718912, -2.6082392930984497, -51.08501137048006, 36.15927942842245, 13.20456974208355, 0.49376489967107773, -69.50260574370623, 38.52957080304623, 1.6908533424139023, -72.74941532313824, -131.11038198322058, 29.69889272749424, -47.90423955023289, -16.06122189760208, -16.366870619356632, -8.061057478189468, -28.532342940568924, 11.561441421508789, 35.34852012246847, -12.02099173516035, 37.32228544354439, -17.758727945387363, -69.92462565004826, 11.03485532104969, -4.20652773976326, -47.52904975414276, -99.38165113329887, -16.88828471302986, -62.87770599126816, 32.90375437960029, -19.5910866856575, 21.436629489064217, -88.09909382089972, -2.9662412144243717, 9.735698394477367, -30.83979231864214, 13.733748018741608], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425773983377006, "mean_inference_ms": 4.561434034804624, "mean_action_processing_ms": 4.211702910781075, "mean_env_wait_ms": 3.2356850443893777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13104000, "timesteps_this_iter": 131040, "agent_timesteps_total": 13104000, "timers": {"sample_time_ms": 36395.519, "sample_throughput": 3600.443, "load_time_ms": 25.02, "load_throughput": 5237469.267, "learn_time_ms": 14991.285, "learn_throughput": 8741.079, "update_time_ms": 2.209}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.1554436208840465e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 126.21711173516418, "policy_loss": -0.003597975723256091, "vf_loss": 25.246425191134108, "vf_explained_var": 0.43573995954674205, "kl": 0.002623502528185749, "entropy": -0.5954943798135258, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13104000, "num_agent_steps_sampled": 13104000, "num_steps_trained": 13104000, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13104000}, "done": false, "episodes_total": 26400, "training_iteration": 100, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-33-14", "timestamp": 1691022794, "time_this_iter_s": 39.02945899963379, "time_total_s": 3116.841792345047, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3116.841792345047, "timesteps_since_restore": 13104000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 44.90545454545454, "ram_util_percent": 51.58727272727273}}
{"episode_reward_max": 61.62837319076061, "episode_reward_min": -157.28748663887382, "episode_reward_mean": -18.02402356952429, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.265241652727127, -5.987719252705574, -66.7631229609251, -70.48014402389526, 19.497979629784822, -24.721291460096836, -89.92554870247841, -38.822927854955196, 61.62837319076061, -13.761134626343846, 6.175794489681721, -19.762852298095822, 10.045196920633316, 17.771882221102715, 32.064528569579124, 21.65485306084156, -26.666154988110065, -2.6509159952402115, -56.39430417120457, -51.311127942055464, -13.610833190381527, -157.28748663887382, -81.37203443050385, -24.685252752155066, 11.831749841570854, -91.75121384300292, -6.303367733955383, -30.126914098858833, 53.46142176911235, -33.68457728624344, 32.93063898384571, -22.103371143341064, -62.657744862139225, 46.714147198945284, 8.740889951586723, 9.406330041587353, -60.71320669353008, -85.15958833508193, 18.264303848147392, 27.301846342161298, 4.831582896411419, 7.383842762559652, 25.926298312842846, -8.1832375228405, -55.648787654936314, -67.25999113544822, -17.950927823781967, -82.46182768978179, -84.73318713903427, -13.998236522078514, 41.237258199602365, -23.998384080827236, 23.72593229264021, -33.14888509362936, 51.84520324319601, 47.42889989167452, -70.22416726499796, -9.541741825640202, 0.5652448385953903, -70.09339793026447, -24.322290662676096, -63.227409198880196, 13.049629732966423, 17.08566466718912, -2.6082392930984497, -51.08501137048006, 36.15927942842245, 13.20456974208355, 0.49376489967107773, -69.50260574370623, 38.52957080304623, 1.6908533424139023, -72.74941532313824, -131.11038198322058, 29.69889272749424, -47.90423955023289, -16.06122189760208, -16.366870619356632, -8.061057478189468, -28.532342940568924, 11.561441421508789, 35.34852012246847, -12.02099173516035, 37.32228544354439, -17.758727945387363, -69.92462565004826, 11.03485532104969, -4.20652773976326, -47.52904975414276, -99.38165113329887, -16.88828471302986, -62.87770599126816, 32.90375437960029, -19.5910866856575, 21.436629489064217, -88.09909382089972, -2.9662412144243717, 9.735698394477367, -30.83979231864214, 13.733748018741608], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437397712813331, "mean_inference_ms": 4.551782042214345, "mean_action_processing_ms": 4.179896216013141, "mean_env_wait_ms": 3.217755595621318, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13235040, "timesteps_this_iter": 131040, "agent_timesteps_total": 13235040, "timers": {"sample_time_ms": 33997.2, "sample_throughput": 3854.435, "load_time_ms": 23.599, "load_throughput": 5552720.445, "learn_time_ms": 14990.373, "learn_throughput": 8741.611, "update_time_ms": 2.182}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5777218104420233e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 128.049046125099, "policy_loss": -0.0005944170230677203, "vf_loss": 25.60980689141058, "vf_explained_var": 0.4232422765010574, "kl": 0.0024158754600896283, "entropy": -0.5971530655592573, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13235040, "num_agent_steps_sampled": 13235040, "num_steps_trained": 13235040, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13235040}, "done": false, "episodes_total": 26400, "training_iteration": 101, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-33-29", "timestamp": 1691022809, "time_this_iter_s": 15.21955394744873, "time_total_s": 3132.0613462924957, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3132.0613462924957, "timesteps_since_restore": 13235040, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 13.722727272727274, "ram_util_percent": 51.1909090909091}}
{"episode_reward_max": 73.21661357581615, "episode_reward_min": -500.6577136963606, "episode_reward_mean": -27.452830464573346, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.117120385169983, 33.86434879153967, -25.061799474060535, -54.77758076041937, -111.62864450365305, 51.20106905326247, -16.74282042309642, -73.07474169135094, 12.030746459960938, 15.749981418251991, -26.142620220780373, -46.269238859415054, 29.710965558886528, 1.1090616956353188, -40.84874587878585, -46.54673431068659, -33.364390041679144, 6.80794595181942, -42.48473567515612, -20.89918738603592, -52.326636388897896, -34.36949859559536, 27.163915656507015, -4.005594484508038, -49.21186286211014, -15.134763929992914, -16.944982605054975, -30.191787600517273, -26.797149889171124, 0.9578277170658112, -41.69078125804663, -63.285092920064926, 6.256941054016352, -40.085894875228405, 5.057923451066017, 16.391298681497574, -170.29321613162756, -51.285647731274366, 34.50503125041723, 2.0263755843043327, 14.237570948898792, -30.034721352159977, 19.53904891014099, -19.295227847993374, 19.59230912104249, 42.87854792177677, 20.01815753430128, 31.402444902807474, -109.48364105075598, 38.74682608805597, 23.422412805259228, 22.248139906674623, -51.970780447125435, -88.21264802664518, -3.2026734203100204, -2.5098572373390198, -94.9354631267488, -114.41173147410154, 42.212087243795395, -50.080872632563114, 12.125545233488083, -3.1500019282102585, -94.92388830333948, -42.26217304170132, -38.986819095909595, -30.476277891546488, 47.760810270905495, 46.59450777992606, -10.216291800141335, -47.63212192803621, -182.10253947228193, -32.0455020442605, 28.853510269895196, -83.12824200838804, 21.815478172153234, 10.379340913146734, 57.8007377833128, 22.52339766174555, 10.874354131519794, -0.3153594508767128, 8.070236682891846, -42.55382327735424, -50.62531791999936, 31.28134571388364, -9.56829397380352, -14.79030166566372, 10.241790045052767, -11.297742165625095, -32.44184472411871, 64.88241571933031, 21.264868173748255, -26.637619845569134, 12.219621803611517, -89.82707479596138, 8.974899336695671, -31.20092064142227, 8.365368604660034, -63.919975250959396, 24.258945301175117, -20.087289713323116, -68.36210086941719, 72.87439695000648, 41.44134034216404, -91.25424627959728, -16.54746212810278, -11.022934019565582, -19.577047027647495, 58.62356426566839, -101.02550780773163, -68.77025008201599, 34.69331889599562, 67.42026017606258, -59.63484302163124, -113.1972326785326, 25.216007312759757, -1.5401732623577118, -87.83607240021229, -39.9506406635046, 37.31100411713123, -45.01266600191593, -86.75676719844341, 11.341465685516596, 12.073299586772919, -93.30334477126598, -55.100597500801086, -18.875957265496254, 8.569859459996223, -32.96136451140046, 12.499596819281578, -43.77592918276787, -33.90593056380749, -28.833724454045296, 17.889555975794792, -61.686395421624184, -153.2441006153822, -26.640997484326363, -79.04064738750458, 10.88044859468937, -3.9991194792091846, -18.413363195955753, -42.7721433788538, 15.697352610528469, 2.168883517384529, -87.73007110506296, -55.69044119119644, -5.824690252542496, -10.322706013917923, -30.621883556246758, 23.789852663874626, -32.3506895005703, -47.872521318495274, 13.688749119639397, 11.396702706813812, -35.30683571845293, -95.98376643285155, -142.4461032450199, 20.461941845715046, 25.686594165861607, -25.261473774909973, 34.542220786213875, -2.8756752386689186, 40.73525746166706, -60.21197583526373, 31.299807652831078, 14.737035900354385, -25.023320458829403, -11.771239399909973, -88.88286863267422, -123.96735833771527, 0.6448718905448914, -158.8761869519949, -40.35385067015886, -49.666500464081764, -22.485416248440742, 26.400321699678898, -123.08255061507225, -67.37955243885517, -34.82391803711653, -163.80434300005436, -42.005877777934074, -2.764381393790245, -75.52876348793507, -63.2152828425169, 35.28240644559264, 37.66337741166353, -59.34986775368452, -14.487557746469975, -35.44382219016552, 20.023654349148273, 12.103336781263351, -6.030965320765972, -27.856894988566637, -13.45996468514204, 9.91683066636324, 22.491639129817486, -56.4328630566597, 44.62389549612999, -28.56039110571146, -59.6838965639472, -104.86831140518188, 21.103624150156975, -45.06111214309931, 73.21661357581615, -19.83469221740961, -10.063415952026844, -36.62870831787586, 23.868101816624403, -28.16276751458645, -69.53563004732132, -36.628216575831175, 50.485850639641285, -4.624366298317909, 29.771952286362648, 11.892012983560562, -72.17484935373068, -10.665761202573776, -148.8780183494091, -24.65977704524994, 48.22155548259616, -3.7978482097387314, -96.93849062919617, -26.15578692406416, -58.24245373904705, -66.55015330761671, -36.26991802453995, 58.459000900387764, -118.45949983596802, 4.7120376992970705, 22.275442376732826, 4.225817896425724, -17.993798151612282, -90.26313307136297, -4.421577364206314, -82.25925521552563, -188.79157119989395, -81.85320842266083, -9.663093723356724, -105.25336258113384, -82.61020065844059, -51.76676404848695, -71.78270914126188, -14.813261419534683, -99.6958521604538, -115.32144818454981, -70.8745179772377, 24.416549742221832, 1.373131014406681, -3.4346976801753044, -33.74211449176073, -2.6692564338445663, -11.165551230311394, -294.5238920673728, 20.561349898576736, 31.09224696084857, -62.590716540813446, -34.72643469274044, -86.46080910414457, 31.59863915666938, -75.49150959402323, -88.22803948819637, -95.83679610490799, -63.39779348671436, -24.811839029192924, -15.64415168389678, 12.926700755953789, -3.86169758066535, -34.23492878675461, -30.988996222615242, -99.59613147377968, 30.527152355760336, -36.81663301214576, 1.0871133878827095, 16.55654752254486, 39.33963892236352, -43.352883249521255, -63.98406629264355, 49.21557205542922, -113.65809632092714, -5.810322500765324, -25.3508543074131, 13.715654756873846, -48.77507966756821, -112.63126984238625, 8.026756808161736, -58.594208791852, 35.42994838953018, 5.515622824430466, -20.93004661798477, -7.421969175338745, -317.8040655106306, -22.929787009954453, -2.6314855441451073, -44.954534724354744, 4.409457836300135, -12.52777636423707, 14.145465329289436, 52.39519191533327, 4.628980666399002, 29.229147732257843, -37.076256819069386, -3.5313444333150983, 9.23798293247819, 10.263910949230194, -35.564906030893326, 3.6792851388454437, -23.016648314893246, -17.01217120885849, -86.28550527617335, -6.570819914340973, -40.550814151763916, 21.13502738624811, -8.334927693009377, -19.230282612144947, -9.93180152028799, -71.52823787927628, -35.39217732101679, -60.60348977148533, -85.31332276761532, -19.737501051276922, 0.2435987964272499, 17.128857050091028, 24.744417637586594, -27.241757810115814, -155.55125195533037, -35.41269934177399, 25.285091161727905, -22.089374899864197, -97.27497302740812, -16.210599400103092, 28.498694695532322, 5.963971763849258, 13.84802109748125, -59.983381412923336, 15.5571269094944, 1.8397856652736664, -12.198196031153202, -74.80407372117043, 4.8537279814481735, -18.97168130427599, -6.576037615537643, -120.06524537876248, -22.25856350362301, -23.954404279589653, 31.94486143067479, -59.36910466104746, 4.308534026145935, -50.948638558387756, -31.282785713672638, -41.9565122500062, -38.90645334124565, -66.69884541630745, -12.298767127096653, -89.73458040505648, -12.881992194801569, -92.17046972364187, -68.31605277210474, 30.962654443457723, -58.675832971930504, -143.79547730088234, 17.18326148018241, -54.891575038433075, -50.50707624107599, 10.517959848046303, -45.04825305938721, -160.30750557780266, -83.22177127748728, -87.6632563509047, -28.890341341495514, 39.299011275172234, 19.878486834466457, -48.215911488980055, 40.1655954644084, -13.367743026465178, -39.98186771571636, -54.97034288570285, 30.043201327323914, 6.501573480665684, -98.35650042071939, -53.36924223601818, 24.735585317015648, -90.64021020755172, 12.477266490459442, -53.67531290650368, -73.59304700046778, -18.52240741252899, 36.01134988665581, -53.82199376821518, 29.344447523355484, -22.902268044650555, -72.70498616993427, -4.929751753807068, -41.35118444263935, 8.7508105635643, -17.996086537837982, -3.3961189724504948, -97.58320093154907, -14.528060749173164, 8.02682514488697, 3.5135416239500046, -178.7684773951769, 21.70931015908718, 27.705261819064617, 15.117044366896152, -40.73294196277857, 42.14185956120491, 27.652853034436703, -132.3969079181552, 54.807725217193365, -36.523462638258934, -11.217198453843594, -41.525813564658165, -26.505220137536526, -91.39039593935013, -24.996523559093475, -36.22459003329277, 43.93839939683676, 20.795559626072645, -12.66601648926735, 12.66717530041933, -56.22029913216829, -146.77269080281258, -5.25810594856739, -39.795369014143944, 1.7718220353126526, -10.055953741073608, 0.5816535204648972, -75.75246273726225, -18.518458113074303, 36.71716845035553, 50.20702079311013, -65.41814360022545, 7.698150128126144, -20.3677599420771, -36.39293316565454, 37.947343956679106, -78.58974623680115, 0.8060286939144135, 39.83956794068217, -22.56658510118723, -30.14520152658224, 10.205449517816305, 28.986652351915836, -500.6577136963606, -44.58695852011442, -11.401821285486221, 13.719374492764473, -26.48909080028534, 18.717022076249123, -35.485841542482376, -19.03224067389965, 10.872642561793327, -74.41649268567562, 18.16962786950171, -86.23139729350805, -154.40587627887726, -5.419079042971134, -109.72791203856468, -14.877557702362537, -130.59241190552711, -28.045003002509475, -28.352179307490587, -43.04461357742548, 26.913851343095303, 15.63964319229126, -86.02439427375793, -34.60532836616039, -24.057561215013266, -14.917821764945984, -85.53417835384607, -51.15528208017349, -26.78558085858822, -64.48447580635548, 23.65168011933565, -6.248810671269894, -43.53904177248478, 33.38118852674961, -67.406812928617, -10.930124901235104, -58.66574051976204, -100.49917206168175], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426304479169259, "mean_inference_ms": 4.561095243999494, "mean_action_processing_ms": 4.211658623958533, "mean_env_wait_ms": 3.2357139146075715, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13366080, "timesteps_this_iter": 131040, "agent_timesteps_total": 13366080, "timers": {"sample_time_ms": 36419.073, "sample_throughput": 3598.115, "load_time_ms": 25.489, "load_throughput": 5141056.365, "learn_time_ms": 14985.197, "learn_throughput": 8744.63, "update_time_ms": 2.216}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.888609052210116e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 124.28504946797976, "policy_loss": 0.0017797928623335482, "vf_loss": 24.854627428088993, "vf_explained_var": 0.44992166736219946, "kl": 0.0023464933231968875, "entropy": -0.6029827938712199, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13366080, "num_agent_steps_sampled": 13366080, "num_steps_trained": 13366080, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13366080}, "done": false, "episodes_total": 26880, "training_iteration": 102, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-34-09", "timestamp": 1691022849, "time_this_iter_s": 39.41744136810303, "time_total_s": 3171.4787876605988, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3171.4787876605988, "timesteps_since_restore": 13366080, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 44.371428571428574, "ram_util_percent": 51.351785714285725}}
{"episode_reward_max": 54.807725217193365, "episode_reward_min": -500.6577136963606, "episode_reward_mean": -30.515810836935415, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.64021020755172, 12.477266490459442, -53.67531290650368, -73.59304700046778, -18.52240741252899, 36.01134988665581, -53.82199376821518, 29.344447523355484, -22.902268044650555, -72.70498616993427, -4.929751753807068, -41.35118444263935, 8.7508105635643, -17.996086537837982, -3.3961189724504948, -97.58320093154907, -14.528060749173164, 8.02682514488697, 3.5135416239500046, -178.7684773951769, 21.70931015908718, 27.705261819064617, 15.117044366896152, -40.73294196277857, 42.14185956120491, 27.652853034436703, -132.3969079181552, 54.807725217193365, -36.523462638258934, -11.217198453843594, -41.525813564658165, -26.505220137536526, -91.39039593935013, -24.996523559093475, -36.22459003329277, 43.93839939683676, 20.795559626072645, -12.66601648926735, 12.66717530041933, -56.22029913216829, -146.77269080281258, -5.25810594856739, -39.795369014143944, 1.7718220353126526, -10.055953741073608, 0.5816535204648972, -75.75246273726225, -18.518458113074303, 36.71716845035553, 50.20702079311013, -65.41814360022545, 7.698150128126144, -20.3677599420771, -36.39293316565454, 37.947343956679106, -78.58974623680115, 0.8060286939144135, 39.83956794068217, -22.56658510118723, -30.14520152658224, 10.205449517816305, 28.986652351915836, -500.6577136963606, -44.58695852011442, -11.401821285486221, 13.719374492764473, -26.48909080028534, 18.717022076249123, -35.485841542482376, -19.03224067389965, 10.872642561793327, -74.41649268567562, 18.16962786950171, -86.23139729350805, -154.40587627887726, -5.419079042971134, -109.72791203856468, -14.877557702362537, -130.59241190552711, -28.045003002509475, -28.352179307490587, -43.04461357742548, 26.913851343095303, 15.63964319229126, -86.02439427375793, -34.60532836616039, -24.057561215013266, -14.917821764945984, -85.53417835384607, -51.15528208017349, -26.78558085858822, -64.48447580635548, 23.65168011933565, -6.248810671269894, -43.53904177248478, 33.38118852674961, -67.406812928617, -10.930124901235104, -58.66574051976204, -100.49917206168175], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411391622198698, "mean_inference_ms": 4.549800949278271, "mean_action_processing_ms": 4.154520582834595, "mean_env_wait_ms": 3.20310604012027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13497120, "timesteps_this_iter": 131040, "agent_timesteps_total": 13497120, "timers": {"sample_time_ms": 33981.863, "sample_throughput": 3856.175, "load_time_ms": 23.322, "load_throughput": 5618680.727, "learn_time_ms": 14983.226, "learn_throughput": 8745.78, "update_time_ms": 2.221}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.944304526105058e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 125.87828584970455, "policy_loss": 0.002512057161749688, "vf_loss": 25.172537687431525, "vf_explained_var": 0.42374246062770965, "kl": 0.002335407182208753, "entropy": -0.6078040436390908, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13497120, "num_agent_steps_sampled": 13497120, "num_steps_trained": 13497120, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13497120}, "done": false, "episodes_total": 26880, "training_iteration": 103, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-34-24", "timestamp": 1691022864, "time_this_iter_s": 15.16781210899353, "time_total_s": 3186.6465997695923, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3186.6465997695923, "timesteps_since_restore": 13497120, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 13.663636363636362, "ram_util_percent": 51.599999999999994}}
{"episode_reward_max": 79.78597424179316, "episode_reward_min": -485.4974030405283, "episode_reward_mean": -18.825688401555333, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.187385592609644, -100.4550317376852, -43.9202776402235, 2.8892698362469673, -41.767458863556385, -7.956674247980118, 50.40101759880781, 3.2678159289062023, 12.53063640743494, 7.47519750893116, 60.23304522037506, -48.295267060399055, -56.87611739337444, -128.39606007933617, -1.7918568029999733, -35.607881143689156, -5.961842872202396, -58.41034235060215, -49.68097399175167, -10.937550202012062, 2.9287639036774635, 26.940314754843712, 18.152346029877663, -61.525857865810394, -58.56152227520943, -17.812621876597404, -44.4278384745121, -32.1197040528059, -15.125785388052464, -1.3766310065984726, 18.919115982949734, -51.28902889043093, -23.887384295463562, 27.686554178595543, -24.575172528624535, -4.992135647684336, 11.916501373052597, 21.375973254442215, -65.60912779532373, 37.02577454596758, 13.940441191196442, 27.386770147830248, -32.836096212267876, 33.775526594370604, -286.49328434467316, 46.03190100193024, 23.34705178439617, -20.76423764973879, 28.453071672469378, 5.241774320602417, -50.24288007616997, -19.308544158935547, -84.99358230829239, -10.041758768260479, -41.28660997748375, -32.19868112728, -97.54567936062813, -13.383377991616726, -4.980322245508432, -9.296334967017174, -45.131930470466614, 14.030149169266224, 24.117039743810892, -28.322880998253822, -21.73973024636507, 12.267486341297626, 37.52749698981643, -22.056954868137836, -22.403438463807106, -17.114732302725315, -110.47093454003334, -18.63401037454605, -15.989586845040321, -24.448263235390186, -14.033354081213474, -63.405000776052475, -10.01214712113142, 14.158464550971985, 16.560682341456413, 25.813345722854137, 34.003890220075846, -208.2055486291647, 23.06469276547432, -14.218875728547573, 3.7759825959801674, -0.7256386876106262, -96.0291380211711, -183.62175803631544, -73.4095449745655, -37.012819811701775, -54.49466620385647, 41.02667414397001, -2.7692851424217224, -18.399258017539978, -14.159459345042706, -46.35377397015691, 15.837078031152487, -59.13203038275242, -1.7711269706487656, -174.5659739561379, -26.549791648983955, -21.77632611989975, 55.63998857885599, -128.013154104352, -41.05220379680395, -79.88552125543356, -123.53716807439923, -29.068793445825577, -12.073041819036007, 16.22253105789423, 30.93702968582511, -12.67547694593668, 12.611466094851494, 14.117500007152557, -70.53552881628275, -48.36582552269101, 15.027312267571688, -38.397973373532295, -85.38165012001991, -42.822007063776255, -131.18233880400658, 12.7253949791193, -14.079065442085266, 19.363156236708164, 6.8512826934456825, -2.4072987399995327, 21.583015009760857, -24.360895454883575, 34.03544993698597, -31.460806474089622, -62.39840729534626, 37.744172217324376, -44.90250736474991, -10.243483059108257, 11.741601943969727, 42.76546369493008, -40.25382145866752, 20.96911583468318, -13.38652178645134, -75.08222553133965, 8.459634080529213, -5.742162857204676, 6.479954898357391, 39.433307480067015, -123.92518542706966, -109.21477794647217, -26.861289858818054, 38.09314940311015, -58.95806761085987, -138.0831168293953, -19.079794824123383, -34.311372455209494, -96.54220110177994, -100.07396878302097, -114.6631041392684, -22.959969639778137, -12.104368718340993, -28.67238587886095, -9.166458271443844, -21.181927502155304, 24.28785205259919, 2.0099085569381714, 20.96677080914378, -122.4855340346694, -28.148114681243896, -19.41020679473877, -107.28299029171467, 47.02985444664955, -6.284307684749365, 26.19645046442747, 50.55503221601248, -29.868054501712322, -6.6551243513822556, 32.22740328684449, -26.598901364952326, 29.36980140954256, 2.6877469196915627, 7.0752782709896564, -73.29157489538193, -9.504118084907532, -14.26605797931552, -117.15449909865856, -28.31329893320799, -29.708520002663136, -119.72637897729874, 9.740933433175087, 44.650923892855644, 43.34811421483755, -106.84268330037594, -5.463818967342377, -84.25472016632557, -102.53469126671553, 43.21458641439676, -34.39694160968065, 23.97840266674757, -32.97879874706268, -23.939340010285378, -7.341274596750736, 64.34593300893903, -9.459665417671204, -83.24112732708454, -48.99336402863264, 25.377054184675217, -21.425974316895008, -7.984882578253746, 22.475938577204943, -39.09685903787613, -2.5586885884404182, 33.54499763250351, -28.879374280571938, -22.646635971963406, -88.71817637979984, 18.340988621115685, 28.52265263348818, 3.521463345736265, -38.58369019627571, 51.5852891728282, 41.69849482178688, -31.188389509916306, 30.405323296785355, 28.10411897301674, -13.810523822903633, -24.784724049270153, -30.132699843496084, 27.338221471756697, -92.38462742418051, 25.504815563559532, -37.28714123368263, 47.59605505503714, -13.348607920110226, 27.438058994710445, 27.283212766051292, -103.63886550813913, -26.215805128216743, -64.47490984201431, -114.46475598961115, 15.005260091274977, 11.698093131184578, -16.3692356236279, -56.420149743556976, -18.19336723536253, 10.237144134938717, 55.59682720899582, 41.65961201488972, 8.016126036643982, -44.916230449452996, -17.91504268348217, -61.63960403203964, 42.807084165513515, 59.827790196985006, 6.13460847735405, 15.466430336236954, -90.21209652721882, 20.6923266351223, 25.498144682496786, -45.93007202446461, 47.26316935941577, -13.985490337014198, -5.146638438105583, 7.506064251065254, 54.87650924921036, 20.34972381964326, -25.33220925554633, 26.23076519370079, 57.40248688496649, 10.474820427596569, -23.808466151356697, 9.75653025507927, 6.526373788714409, 23.568055517971516, -77.54865865409374, 16.142252288758755, -101.14382579922676, -25.575877845287323, -84.73998640477657, 29.61016044765711, -15.69038461893797, -4.145371526479721, -16.005843583494425, -8.024909924715757, -29.31643173098564, -8.955745704472065, -138.65403655171394, -49.44056993722916, -20.62766869366169, -2.543848991394043, -18.036380141973495, -34.5322330892086, 37.410213615745306, 10.293824598193169, 7.813283048570156, -37.24287971109152, -8.757798787206411, 10.318212732672691, -42.20103622227907, -35.76603052020073, 14.135227777063847, -90.33923514932394, 30.042058054357767, -9.150840759277344, -54.82167449966073, 56.48007172346115, 57.48336298763752, 36.200641084462404, -10.740000292658806, -39.25131319463253, -6.401822544634342, -32.87607850134373, 0.41191527247428894, 54.79249315522611, -8.660960983484983, -33.212603732943535, -46.643121004104614, 25.314955845475197, -42.453373562544584, -71.96837440133095, 20.277671165764332, -24.271695900708437, -73.2333669140935, -2.651186052709818, -55.53374243527651, 71.32740757614374, 66.65729235112667, 21.50941391289234, -15.42260630428791, -34.44132041931152, -1.740380123257637, -78.60844179987907, -36.4388267993927, -128.78845989704132, -19.67429192364216, -5.319188125431538, 5.771004904061556, 2.204870752990246, 79.78597424179316, 44.602092357352376, 35.64281223714352, 7.597719892859459, -0.39235565811395645, -31.986302331089973, -45.41088155657053, -134.48103213310242, 19.62858145684004, 20.67869614250958, -52.932524770498276, -36.276417177170515, -22.55088770389557, -14.501938242465258, -95.64200453460217, 0.5308083482086658, -9.74750903248787, -126.38411493599415, 50.061079911887646, -37.014027170836926, 29.89108307659626, 54.9909670650959, -35.600693844258785, 20.921493478119373, 46.19278954714537, -75.62669086456299, -26.515761233866215, -27.302718445658684, 16.778296686708927, -66.26102305948734, -30.503136172890663, -14.485402144491673, -159.34983387589455, -9.260007083415985, -17.20457512885332, 14.655267529189587, 63.221061795949936, 32.782029680907726, -21.58316007256508, 15.313421916216612, -11.327192679047585, -14.042716294527054, 29.43532707542181, 35.825992822647095, -8.834031999111176, -50.79710844904184, -72.97474220395088, -10.657329328358173, -29.63471917808056, -4.369256906211376, -65.20451479032636, 26.21555196493864, -61.05249573290348, 76.6306674182415, 19.397581949830055, 0.07575216889381409, -4.273554593324661, -20.535582050681114, 54.972648445516825, -23.996493443846703, 5.628108635544777, 15.17892673611641, -51.0456805229187, -485.4974030405283, -75.04902055859566, -35.93655251711607, -90.38217911869287, 19.99031776189804, -21.43962010741234, -64.16078199446201, 12.608444884419441, -88.53893555700779, 54.84793999046087, -74.09391801059246, -92.54052491486073, -42.06480388343334, 13.555578619241714, 34.71338325738907, -49.00364799052477, -5.916988052427769, -191.9795743227005, 32.49961218982935, 32.74711570888758, -44.44653704762459, -52.008657574653625, -104.86394856870174, -43.47831016406417, -96.79558538645506, -6.069703109562397, 16.014092423021793, -27.122056856751442, -20.36237244307995, -117.37165251374245, -36.760640382766724, 0.8018077164888382, 39.324531976133585, 19.19587752223015, 43.51122387312353, -50.91817833483219, -32.358232259750366, -66.48563222587109, -1.3335788771510124, -71.65294034779072, -22.57600797712803, 0.7070226967334747, -110.48827691376209, 1.7639903388917446, -34.56555879116058, 13.036247923970222, 36.648868545889854, -13.047325879335403, 55.093423031270504, -58.45193959772587, 1.9519467875361443, -39.125384010374546, -6.69119893014431, -95.36967931687832, 23.48049846291542, -43.63838282972574, 5.765426740050316, -11.048081621527672, -22.545538656413555, 7.059458523988724, -36.95519921556115, -39.18161977082491, -13.502659551799297, -71.65874050557613, 6.938428357243538, -16.27983632683754, 10.040127657353878, 11.52144966647029, 11.241251319646835, -95.01777560263872, -56.43102551996708, 29.629234429448843, 30.191962629556656, 45.35825690627098, 30.176255486905575, 24.62536522001028, 14.200655015185475, -38.72177964448929, 33.15945985913277, -3.9706951677799225, -10.338323567062616, 16.390321895480156, 13.964810512959957], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426310827162995, "mean_inference_ms": 4.5610717716597815, "mean_action_processing_ms": 4.211739709453473, "mean_env_wait_ms": 3.23534947364185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13628160, "timesteps_this_iter": 131040, "agent_timesteps_total": 13628160, "timers": {"sample_time_ms": 36401.269, "sample_throughput": 3599.875, "load_time_ms": 24.915, "load_throughput": 5259400.917, "learn_time_ms": 14980.809, "learn_throughput": 8747.191, "update_time_ms": 2.259}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.972152263052529e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 121.90470937844991, "policy_loss": 0.002857528481555715, "vf_loss": 24.37747237161069, "vf_explained_var": 0.441979823253488, "kl": 0.0026269579283418757, "entropy": -0.6122549847035426, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13628160, "num_agent_steps_sampled": 13628160, "num_steps_trained": 13628160, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13628160}, "done": false, "episodes_total": 27360, "training_iteration": 104, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-35-03", "timestamp": 1691022903, "time_this_iter_s": 39.423633098602295, "time_total_s": 3226.0702328681946, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3226.0702328681946, "timesteps_since_restore": 13628160, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 44.22500000000001, "ram_util_percent": 51.39642857142859}}
{"evaluation": {"episode_reward_max": -1.804144248366356, "episode_reward_min": -1.804144248366356, "episode_reward_mean": -1.804144248366356, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.804144248366356], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902825731027134, "mean_inference_ms": 3.865901030833367, "mean_action_processing_ms": 1.2385071634372657, "mean_env_wait_ms": 199.33005399024145, "mean_env_render_ms": 3.091726201443097}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 70.83398235961795, "episode_reward_min": -1160.3484469354153, "episode_reward_mean": -32.178628248032574, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.37444496154785, -19.408812448382378, -25.56098923366517, 34.69213566184044, 31.037639923393726, -29.935023464262486, 2.1178450509905815, 26.955630782991648, -26.53385265916586, 28.90379884839058, 13.959552936255932, 11.150064542889595, 16.182446859776974, -102.89772555977106, 38.53450804203749, -29.409674391150475, -20.027242556214333, 46.539160281419754, -54.23066331446171, 37.53013049811125, 30.442469500005245, 52.0635536685586, -19.72713897190988, 24.23126519843936, 23.26262627542019, 43.59007205069065, -11.336709931492805, 2.6000026911497116, 33.53547430410981, -42.05588914453983, 12.233909390866756, 33.80246997624636, -0.17357300966978073, -23.5740297883749, -84.03893126547337, 23.176144883036613, -79.90608688443899, -38.98412711918354, 39.50177415460348, 34.01401258260012, 32.78458259254694, -97.96939292550087, -19.971579022705555, -185.78006156533957, 23.68674897775054, -10.862844042479992, 19.991315949708223, 42.89032553881407, 55.45616106688976, -27.699077233672142, 14.747679777443409, 3.8251821286976337, -48.17396727204323, -204.9881984256208, -69.17387835681438, -5.679120019078255, -19.038060948252678, -100.92004162073135, -41.8593824505806, -22.16422414779663, 23.62310814857483, -10.991441363468766, -58.74250643700361, -56.084821395576, -82.6277784705162, -28.073797218501568, 26.154002107679844, -31.076233461499214, 30.135163322091103, 37.00610225275159, -35.20752611756325, 15.1081926189363, -2.6692719161510468, -146.70163927972317, 7.4622781202197075, 32.85350139439106, -60.10457644611597, -88.99879402294755, -1160.3484469354153, -11.940840274095535, -81.09925651550293, -183.86930994689465, -34.60407280921936, 58.05364830046892, -16.28396299481392, 8.97779032215476, 14.927838973701, 25.60168333724141, -50.56379513442516, -105.13539806008339, 12.64103738963604, -76.1344213783741, -86.33251990377903, -150.58063372969627, 32.342812694609165, 16.23447558283806, -25.301377810537815, 5.933390103280544, -60.08876846730709, -44.871297016739845, 23.238377019762993, -25.13493549823761, 2.227817304432392, -33.14638861268759, 15.998568050563335, 7.97134842723608, 48.05048693716526, 49.5008339099586, 4.963708437979221, 20.801648646593094, -24.228545479476452, -98.63551153987646, -55.66705064475536, 36.00283206999302, -65.53385132551193, 48.57249581813812, -13.567988157272339, 2.3761671409010887, 47.99278444238007, -45.29451197385788, 2.937947690486908, -28.198567375540733, -16.887765154242516, -65.04829815030098, 23.00999817252159, -110.32440054416656, -28.407148972153664, 25.912635691463947, -55.415678679943085, -39.02000433206558, -57.72237940132618, -32.03764443099499, -48.375159688293934, -145.47401094436646, -52.35264725983143, 21.69176446646452, -32.01198287308216, -90.87774892151356, -63.147044099867344, -65.1007407605648, -21.146302487701178, -26.150753101333976, 4.307242088019848, -31.860297366976738, 64.59550870582461, 10.77439957484603, -3.1310293450951576, 12.374945662915707, 30.526030980050564, 29.28962918370962, -12.54419493675232, 17.410162061452866, -4.620272725820541, 60.60768041014671, 21.889669820666313, 19.7774144038558, -39.018826730549335, -7.2772917822003365, -6.634003207087517, 13.279493123292923, -6.516330100595951, -94.71285055577755, -110.24496106803417, 42.28276200965047, -64.22644750028849, 45.085808016359806, -81.9545561671257, -29.069345511496067, -50.334288999438286, -87.49547538161278, 46.67333139665425, 2.8879934772849083, -213.09306314587593, 17.14038749039173, 7.062685906887054, 10.005648585036397, -157.19831846654415, 0.20830494537949562, -20.22305988520384, 30.51276247948408, -12.149864472448826, 46.4373644515872, 27.082141675055027, -76.95678813755512, 39.358693443238735, 47.00007101148367, -20.690541453659534, -14.329980283975601, -4.994712978601456, -40.26635441184044, -23.762498296797276, 2.6247291937470436, -42.34721790254116, -98.63967256993055, 12.263131454586983, -146.14831811189651, 10.122571855783463, -1.535032443702221, -56.02192600816488, -45.42701891809702, 19.62550015002489, -64.61709778010845, 8.137307718396187, -3.696010909974575, 6.735648721456528, 33.60618933662772, -4.292354695498943, -129.8016612827778, 8.322943106293678, -2.4539579525589943, 3.4252212420105934, 31.662990301847458, 15.722138937562704, -97.779450930655, -60.797243379056454, -33.99748855829239, -19.86569607630372, -108.87526738643646, -9.864642925560474, 18.142836898565292, 26.652693316340446, -654.1005921065807, 2.345084272325039, -0.8937911242246628, 13.912790656089783, -66.59790174663067, -74.04919950291514, -98.10747419297695, 16.51443909853697, 52.55783411115408, 68.65547363087535, 21.582304373383522, 2.176174834370613, -9.63069362938404, -59.82524885237217, 44.43430808931589, 12.66447401791811, -7.774809941649437, -40.79776168614626, -16.265811011195183, -67.86623809114099, -14.414156422019005, -11.215070590376854, 23.430769331753254, 22.401497915387154, -50.335757091641426, -65.64432792365551, 4.840918578207493, -29.55235169827938, -52.808635756373405, 26.229430451989174, -4.194442987442017, -19.308820761740208, -44.95236510038376, 36.30152977257967, -381.53667552769184, -42.98695880174637, -110.57268661260605, 11.074090294539928, -47.309102460742, -74.47105640172958, -30.397579669952393, -14.651535131037235, -98.58113961666822, 17.72187329083681, -2.6344545036554337, -69.8092540949583, 1.4876021966338158, -12.526942282915115, -23.072099938988686, 35.40073838457465, 22.256196975708008, 15.993204284459352, -0.24346528202295303, -63.06923004984856, -97.24023851007223, 34.72046871855855, 33.654615581035614, -147.94856809452176, -37.35853347182274, -410.6226143836975, -66.03801029920578, -4.7796536013484, 22.489672787487507, 10.284308388829231, -16.96774021536112, 52.84032007679343, -47.42433051019907, 14.384939506649971, -27.231175169348717, -42.92381916940212, -51.77568216621876, 33.0502043813467, 29.623560339212418, -92.10388518869877, 20.048910170793533, 12.405469380319118, -74.87469263374805, -55.10741160809994, -22.602986440062523, 19.09901775419712, -103.79849849827588, 34.62343617528677, -11.649398282170296, 49.88717938400805, -80.53861118108034, -2.2264690957963467, -80.67290350049734, -3.5078966170549393, -6.625250279903412, -143.61313466727734, 20.888648226857185, 22.544309057295322, -104.20179145783186, 57.83327793329954, -30.159966461360455, -86.50580383092165, -6.393719770014286, 31.832180704921484, -34.258796628564596, 29.82561717927456, -393.5763404816389, -17.438134394586086, -6.515276730060577, -85.20335431396961, -53.65973089635372, 52.56858068704605, -125.4078221693635, 3.1198974698781967, -33.36455262452364, -38.489202693104744, -156.04087134450674, -104.00160009786487, -5.925945565104485, -10.357867799699306, 26.884880900382996, -29.43644057959318, 22.60783537477255, 36.80694383755326, -102.87986604869366, -44.48280918598175, -76.2362284436822, -3.011332482099533, -32.34206185489893, 1.5412240698933601, -22.903767563402653, -27.391043305397034, -5.6947517320513725, -48.526146963238716, 26.34241273254156, -53.09236894547939, -43.25388613715768, -78.6881533190608, -19.094888120889664, -4.879311308264732, 4.977054066956043, 10.764072384685278, -115.79612818360329, 30.00634691864252, -81.3910561054945, -554.8960327208042, -4.098010838031769, -8.69077356159687, -23.450593173503876, -82.88152035325766, -32.457844853401184, 30.56207910180092, -84.08762879669666, -30.869837038218975, 35.572443049401045, -151.8690061569214, -8.144028753042221, -193.13757310807705, 36.78227271139622, 22.239967063069344, -52.59167319536209, -78.7880433909595, -89.59744170308113, -88.3271507024765, -68.856784299016, -13.209791630506516, -169.7922675833106, -67.65195047110319, 38.193136774003506, -88.11011509597301, -89.17579539865255, -46.02980254590511, -23.19122441112995, 27.931641794741154, 34.42233794927597, -62.559393264353275, -25.46986173093319, 19.553829945623875, 30.471327487379313, 5.613932684063911, 4.628384046256542, 10.232884995639324, 6.621539369225502, -48.451629757881165, 16.645119458436966, -6.005477733910084, 10.196279920637608, -126.52271877229214, 25.347711823880672, -56.70752212405205, 2.6534491181373596, -60.25074115395546, 45.94162819907069, 70.83398235961795, 13.308007042855024, -49.338603772222996, -3.3907648511230946, 13.205207288265228, -1.8221514150500298, 24.982724606990814, 26.30331712216139, -4.435462228953838, -49.359780214726925, -20.413386523723602, -38.478289283812046, -116.73803663253784, -23.410484358668327, 21.81815854460001, -28.33509485423565, -62.69207485020161, -25.382635809481144, 12.6845191270113, -269.93727272748947, 34.931142903864384, -30.940106496214867, 34.87572007626295, 40.19039849564433, 0.10515932738780975, -766.2241131141782, 19.298052348196507, -38.46120850741863, -89.98867177963257, -12.776333943009377, -13.014712169766426, -72.41175027936697, 6.678664535284042, -99.32846429944038, 37.01712033897638, -2.0956154465675354, -109.65232947468758, 25.930745370686054, -6.83039665222168, 18.881626546382904, -30.257381096482277, -20.85557758063078, -0.023697569966316223, -22.85055104829371, -49.11434091813862, -104.29605327546597, -92.8566807731986, 29.08315759897232, 18.588746421039104, -68.1804279088974, -771.2440985105932, -0.08124909922480583, -114.66665025055408, -40.74579789489508, -179.60996860265732, -75.05427627265453, 20.331571366637945, -3.1488587707281113, 16.299045329913497, -24.753534007817507, 1.4870315194129944, 15.352560117840767, -44.09009112790227, 4.060071051120758, -64.88249851763248, -90.23571093380451, 41.9291193112731, 23.167685471475124, -67.53679552674294, -43.00941102206707, -1.4812551513314247, 4.306398883461952], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425599176836946, "mean_inference_ms": 4.561078010385554, "mean_action_processing_ms": 4.211674883238973, "mean_env_wait_ms": 3.235702217938602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13759200, "timesteps_this_iter": 131040, "agent_timesteps_total": 13759200, "timers": {"sample_time_ms": 36243.487, "sample_throughput": 3615.546, "load_time_ms": 24.606, "load_throughput": 5325481.039, "learn_time_ms": 14918.092, "learn_throughput": 8783.965, "update_time_ms": 2.259}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.860761315262645e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 128.2192420263651, "policy_loss": -0.0011180904084062172, "vf_loss": 25.644350335589447, "vf_explained_var": 0.417462217337769, "kl": 0.0024229710387344734, "entropy": -0.6165777161770825, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13759200, "num_agent_steps_sampled": 13759200, "num_steps_trained": 13759200, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13759200}, "done": false, "episodes_total": 27840, "training_iteration": 105, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-35-43", "timestamp": 1691022943, "time_this_iter_s": 39.45142483711243, "time_total_s": 3265.521657705307, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3265.521657705307, "timesteps_since_restore": 13759200, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 44.28035714285714, "ram_util_percent": 51.539285714285725}}
{"episode_reward_max": 70.83398235961795, "episode_reward_min": -771.2440985105932, "episode_reward_mean": -38.73457800546661, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.209791630506516, -169.7922675833106, -67.65195047110319, 38.193136774003506, -88.11011509597301, -89.17579539865255, -46.02980254590511, -23.19122441112995, 27.931641794741154, 34.42233794927597, -62.559393264353275, -25.46986173093319, 19.553829945623875, 30.471327487379313, 5.613932684063911, 4.628384046256542, 10.232884995639324, 6.621539369225502, -48.451629757881165, 16.645119458436966, -6.005477733910084, 10.196279920637608, -126.52271877229214, 25.347711823880672, -56.70752212405205, 2.6534491181373596, -60.25074115395546, 45.94162819907069, 70.83398235961795, 13.308007042855024, -49.338603772222996, -3.3907648511230946, 13.205207288265228, -1.8221514150500298, 24.982724606990814, 26.30331712216139, -4.435462228953838, -49.359780214726925, -20.413386523723602, -38.478289283812046, -116.73803663253784, -23.410484358668327, 21.81815854460001, -28.33509485423565, -62.69207485020161, -25.382635809481144, 12.6845191270113, -269.93727272748947, 34.931142903864384, -30.940106496214867, 34.87572007626295, 40.19039849564433, 0.10515932738780975, -766.2241131141782, 19.298052348196507, -38.46120850741863, -89.98867177963257, -12.776333943009377, -13.014712169766426, -72.41175027936697, 6.678664535284042, -99.32846429944038, 37.01712033897638, -2.0956154465675354, -109.65232947468758, 25.930745370686054, -6.83039665222168, 18.881626546382904, -30.257381096482277, -20.85557758063078, -0.023697569966316223, -22.85055104829371, -49.11434091813862, -104.29605327546597, -92.8566807731986, 29.08315759897232, 18.588746421039104, -68.1804279088974, -771.2440985105932, -0.08124909922480583, -114.66665025055408, -40.74579789489508, -179.60996860265732, -75.05427627265453, 20.331571366637945, -3.1488587707281113, 16.299045329913497, -24.753534007817507, 1.4870315194129944, 15.352560117840767, -44.09009112790227, 4.060071051120758, -64.88249851763248, -90.23571093380451, 41.9291193112731, 23.167685471475124, -67.53679552674294, -43.00941102206707, -1.4812551513314247, 4.306398883461952], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411104361891231, "mean_inference_ms": 4.549967176023622, "mean_action_processing_ms": 4.154894433368853, "mean_env_wait_ms": 3.2032134959462493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 13890240, "timesteps_this_iter": 131040, "agent_timesteps_total": 13890240, "timers": {"sample_time_ms": 29750.738, "sample_throughput": 4404.597, "load_time_ms": 22.897, "load_throughput": 5723054.968, "learn_time_ms": 14928.727, "learn_throughput": 8777.708, "update_time_ms": 2.257}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.930380657631323e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 145.18596792845932, "policy_loss": -0.0077016142425739694, "vf_loss": 29.044280096621495, "vf_explained_var": 0.3871563184859505, "kl": 0.002284334954767284, "entropy": -0.6155521820522978, "entropy_coeff": 0.001}}}, "num_steps_sampled": 13890240, "num_agent_steps_sampled": 13890240, "num_steps_trained": 13890240, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 13890240}, "done": false, "episodes_total": 27840, "training_iteration": 106, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-35-58", "timestamp": 1691022958, "time_this_iter_s": 15.30201244354248, "time_total_s": 3280.8236701488495, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3280.8236701488495, "timesteps_since_restore": 13890240, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 13.727272727272727, "ram_util_percent": 51.281818181818174}}
{"episode_reward_max": 72.83817196637392, "episode_reward_min": -1442.5570371001959, "episode_reward_mean": -58.791414740953286, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1284.6999583765864, -199.58953896164894, 16.80262292176485, -7.622280567884445, -41.77508991956711, -23.663647897541523, 55.792257295921445, 41.40377204120159, -40.24836043827236, 72.83817196637392, -29.62200251966715, -131.66367820836604, 17.70098225772381, 0.3476265072822571, -9.660318274050951, -191.51680140197277, 32.720172327011824, -15.488318108022213, -67.64193017780781, 50.922910714522004, -28.158081136643887, -79.8231021463871, -40.90198731422424, -13.013318628072739, 4.950969483703375, 55.15639637410641, -50.36399234831333, -39.597238617017865, 11.277697399258614, 53.27270819246769, -39.76617323607206, -66.35883087664843, -278.6201969832182, -63.46770441532135, -71.41601796448231, -927.546389117837, -38.61964600533247, -28.4586523771286, 27.57353586703539, 17.786637846380472, -123.01045282930136, -807.9730132967234, -48.43848894536495, -43.32044471800327, -2.092074729502201, 56.8792767226696, -179.1750123053789, -56.35163763165474, 22.68267720937729, 9.991614863276482, -143.5966068804264, 17.902311138808727, 40.31304665654898, 18.30167653784156, 36.95003545284271, -31.668148711323738, 31.470488376915455, -267.917634755373, 17.305865205824375, -45.01248396188021, 43.15628629177809, -50.94174470752478, -10.12323197722435, -19.223761070519686, 11.401427209377289, 25.047836236655712, -22.630128052085638, 12.104624517261982, 2.973703294992447, 10.689042255282402, -98.99421782791615, -201.18580911308527, -13.582352869212627, -137.94395231455564, -17.43307200819254, -46.38078945875168, -20.419296264648438, -32.11693033576012, -17.996481843292713, -175.86024944484234, -24.84515632688999, 3.400193013250828, -78.30901354551315, -304.78993025422096, 12.224263094365597, -48.106855273246765, 42.2116273380816, -425.43679817020893, -66.19428285956383, 8.313717745244503, 3.8566731959581375, -22.94990849494934, -41.56160420179367, -163.98653404414654, -27.23660969734192, -82.12922595441341, -57.52430535852909, -88.12413942813873, -24.946785107254982, -40.100430734455585, -18.18222703039646, -1.6617714241147041, -22.544127613306046, 33.6997754573822, 32.14812025986612, -114.83865462243557, -92.14001131057739, -257.51374150440097, -174.4935047775507, -60.38848876953125, -17.702133633196354, 45.543393827974796, -229.86477423459291, 4.771911643445492, -80.16164772957563, 45.67199057713151, 34.729021925479174, 34.89817229658365, -5.594982519745827, -24.46652497164905, 25.35320458561182, 19.888981878757477, 46.49027470499277, -36.51825389266014, -21.623896449804306, 2.280053496360779, -139.9289419800043, 19.574334865435958, -112.79901372268796, 50.4087043851614, 46.75909781455994, -9.861470565199852, -34.20264230668545, -26.19690528512001, -199.30578238517046, -12.86531038209796, -1190.4798327833414, -49.831888273358345, 22.273080550134182, 18.32970404997468, -42.173368982970715, 25.790104441344738, 62.23369336128235, -48.907454773783684, 9.86320442520082, 13.494330793619156, 16.75628401339054, -36.4042209610343, 32.34204585105181, -14.097212947905064, -582.397067181766, -34.60845622420311, -10.519826155155897, -90.68921798467636, 46.06079088523984, -114.62282689660788, -658.2328293323517, 1.4886634945869446, 4.651320427656174, 5.82971154153347, -0.690587043762207, -34.03923434019089, 23.72160029411316, 12.70971405506134, -345.8050244450569, -19.18220752850175, -50.008136823773384, -68.34659586846828, -57.05219987779856, -28.483846170827746, 11.330811334773898, -71.69845185056329, -73.26128820516169, 42.75402508303523, 15.706735253334045, 16.037677846848965, -71.8573001101613, -25.966137558221817, -26.6615252494812, -213.1232856363058, -56.76565584540367, -26.45698958262801, -326.2514447122812, -133.38552234321833, -27.595311537384987, 17.117789931595325, -43.24143986403942, -150.85539757460356, 5.641116037964821, -132.86440996080637, 20.615704495459795, 15.073393926024437, 63.378656554967165, 3.0219185948371887, 2.9566110596060753, 51.12237174063921, 49.568647645413876, -54.508647706359625, 34.9142907038331, -107.47286377847195, -5.091958187520504, -68.3870115429163, -2.690475322306156, -60.70598545670509, 34.603398367762566, 57.18133896589279, 55.86568681150675, -39.10452878475189, -27.69192397594452, 22.850037273019552, 54.53912850096822, -33.409254770725965, 30.773239441215992, 39.490488186478615, 31.76844323053956, -36.748644426465034, -109.0194775313139, -86.56663632392883, -200.9274373948574, -20.860493751242757, -1.9294729679822922, -17.89016342163086, -81.02898650616407, -37.40024497359991, -66.31869207322598, -15.69946400821209, -71.69878177344799, -16.770608015358448, -22.87411431968212, -66.11778425425291, -174.4103792756796, -14.205908839590847, 7.755013708025217, -66.15335436165333, 58.24526349827647, 38.21633791178465, 4.027196645736694, -63.51475493609905, 49.72675809636712, -41.53849743306637, -18.224924996495247, 27.427249930799007, -91.9205027371645, 12.19697892293334, -40.81345134228468, 18.634066551923752, 37.55067668110132, 7.411662764847279, 48.39844425022602, -23.844720020890236, -10.141798824071884, 23.26943015307188, -38.27162680774927, 44.717620588839054, -198.5861544907093, -77.7678291797638, -34.37384545430541, -18.183391451835632, -18.146875109523535, 16.50912817567587, -193.4268543422222, -61.859107941389084, 1.3241579979658127, -527.3877544403076, -208.00351507216692, -1192.9954221248627, -143.41998213529587, -33.947192437946796, -17.843809187412262, -277.0663942024112, -51.73099463805556, -60.42464937269688, 13.410041876137257, 32.06427511572838, 51.91070914268494, -51.09734520316124, 5.55558605492115, -382.7842863276601, -81.96846032142639, 36.70976097881794, 66.01419049501419, -42.58872001618147, 25.27740414813161, -49.59329041838646, 38.722359500825405, -6.253309480845928, 19.711540959775448, 29.30600891262293, -17.940071975812316, -16.43843485414982, 2.3891830444335938, -48.322923973202705, -1.9675244614481926, -11.368483401834965, 15.281187511980534, 70.09328962862492, -89.05892552435398, 19.007354997098446, -173.9467944353819, 43.593282017856836, 9.531904928386211, 55.07427854835987, 24.364171732217073, -67.221375182271, -407.8582102507353, -5.889236778020859, -4.914702117443085, -19.375512801110744, 39.17122685536742, 17.23365668952465, -30.947827134281397, -13.56066881865263, -78.04159393906593, -25.369254633784294, 45.2240486741066, 22.82675004005432, -89.34709583222866, 13.385092832148075, -52.517043210566044, 41.656534075737, -35.965721756219864, 20.572495609521866, -7.802138023078442, -45.34338949620724, -44.41577038168907, -47.958115726709366, -45.583486910909414, -145.87569146603346, -63.63849615305662, -62.646785544231534, -77.51191737502813, -100.8678837120533, -75.66496348381042, -159.21143586933613, 53.2070930711925, 4.8292204439640045, 24.258673034608364, 42.887676786631346, 24.205046515911818, -104.97322111204267, -214.20835180580616, -52.777396127581596, -72.88304361701012, -60.83348189294338, -165.85329088568687, -42.55181445926428, -46.96400207281113, -71.88752821832895, 5.549319550395012, 28.68282948806882, -57.83676169812679, 17.93815267831087, 19.014166682958603, -32.24741326458752, -22.166265606880188, -33.86031997203827, -120.65919257700443, 28.399310804903507, 43.21204052120447, 3.0855416357517242, 49.69950620830059, -83.51961150765419, -27.16755047440529, -4.359089709818363, -39.56843721866608, 43.67103350907564, -7.835750833153725, -71.85868582874537, 31.988370716571808, -152.2653443366289, -51.11941157281399, 7.849921867251396, -74.92389865964651, 2.9254145473241806, 4.213546857237816, -71.89314252138138, -123.52963198721409, 40.92626631259918, -108.68518267571926, -67.21064408868551, 65.59673075191677, -34.29728102684021, -11.881595365703106, -3.5208059549331665, -31.744309455156326, 51.52262447029352, -15.968792658299208, 66.79307904094458, -70.74387890100479, 2.801888920366764, -54.19575680792332, -8.62864624708891, 41.19502104818821, -136.50014673173428, -0.7080584093928337, 44.81572698801756, -79.26394672691822, -661.790641233325, 28.177735432982445, -19.239692248404026, 10.84119527041912, -48.77178354561329, -102.48105995357037, 11.248812884092331, -4.038678087294102, -45.98047599196434, -252.51389844715595, 14.675635397434235, 49.407453721389174, -36.85052516311407, 67.17029086500406, -11.99507474899292, -8.790475338697433, 14.640326999127865, -0.33848948776721954, -29.67580788768828, -254.3605738831684, -20.357036843895912, 29.686031833291054, 35.82619358599186, 9.256678719073534, -167.83898230455816, -34.121766731143, 37.12964653223753, 24.980859633535147, -19.28506288677454, -165.50643709301949, -180.06375715136528, -34.66551564633846, -72.8822944238782, -22.609431862831116, -56.483602521941066, -27.971512608230114, -35.65838839113712, -892.8464345633984, -11.952821809798479, 33.273289903998375, -77.87994310259819, 10.549782827496529, 15.185498178005219, -1442.5570371001959, 48.78360312059522, -473.36086627840996, -29.9998140335083, -22.117400461807847, -753.5344501137733, -22.024589464068413, -94.72607727721334, -47.34663684666157, -18.421370543539524, -7.123230263590813, 13.432083800435066, -8.162121061235666, -9.916476503014565, -76.60103552043438, -629.6427983790636, -62.23917296528816, -958.0299655348063, -16.402639001607895, 17.44812213629484, 15.550494357943535, -37.18471100926399, -12.720664858818054, 3.634447082877159, 46.512039467692375, 14.203824944794178, 15.317061074078083, -69.30379347503185, 35.4649810642004, -94.92604525387287, -48.238303162157536, 18.242070734500885, -152.04831224679947, -20.86964711174369, 23.031998872756958, -39.047460466623306, -49.27700408175588, 27.308311477303505, -17.64971338957548, -53.586446672677994], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424972652399784, "mean_inference_ms": 4.560893547001155, "mean_action_processing_ms": 4.211668184522784, "mean_env_wait_ms": 3.2355934020100325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14021280, "timesteps_this_iter": 131040, "agent_timesteps_total": 14021280, "timers": {"sample_time_ms": 29734.827, "sample_throughput": 4406.954, "load_time_ms": 22.968, "load_throughput": 5705303.94, "learn_time_ms": 14916.222, "learn_throughput": 8785.066, "update_time_ms": 2.257}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4651903288156613e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 149.70189324746667, "policy_loss": 0.00193882468945234, "vf_loss": 29.93782020213356, "vf_explained_var": 0.35168334008545005, "kl": 0.0030362729656509377, "entropy": -0.6200371094074728, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14021280, "num_agent_steps_sampled": 14021280, "num_steps_trained": 14021280, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14021280}, "done": false, "episodes_total": 28320, "training_iteration": 107, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-36-37", "timestamp": 1691022997, "time_this_iter_s": 39.20269799232483, "time_total_s": 3320.0263681411743, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3320.0263681411743, "timesteps_since_restore": 14021280, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 44.24821428571429, "ram_util_percent": 51.41250000000001}}
{"episode_reward_max": 67.17029086500406, "episode_reward_min": -1442.5570371001959, "episode_reward_mean": -80.67757624181918, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.59673075191677, -34.29728102684021, -11.881595365703106, -3.5208059549331665, -31.744309455156326, 51.52262447029352, -15.968792658299208, 66.79307904094458, -70.74387890100479, 2.801888920366764, -54.19575680792332, -8.62864624708891, 41.19502104818821, -136.50014673173428, -0.7080584093928337, 44.81572698801756, -79.26394672691822, -661.790641233325, 28.177735432982445, -19.239692248404026, 10.84119527041912, -48.77178354561329, -102.48105995357037, 11.248812884092331, -4.038678087294102, -45.98047599196434, -252.51389844715595, 14.675635397434235, 49.407453721389174, -36.85052516311407, 67.17029086500406, -11.99507474899292, -8.790475338697433, 14.640326999127865, -0.33848948776721954, -29.67580788768828, -254.3605738831684, -20.357036843895912, 29.686031833291054, 35.82619358599186, 9.256678719073534, -167.83898230455816, -34.121766731143, 37.12964653223753, 24.980859633535147, -19.28506288677454, -165.50643709301949, -180.06375715136528, -34.66551564633846, -72.8822944238782, -22.609431862831116, -56.483602521941066, -27.971512608230114, -35.65838839113712, -892.8464345633984, -11.952821809798479, 33.273289903998375, -77.87994310259819, 10.549782827496529, 15.185498178005219, -1442.5570371001959, 48.78360312059522, -473.36086627840996, -29.9998140335083, -22.117400461807847, -753.5344501137733, -22.024589464068413, -94.72607727721334, -47.34663684666157, -18.421370543539524, -7.123230263590813, 13.432083800435066, -8.162121061235666, -9.916476503014565, -76.60103552043438, -629.6427983790636, -62.23917296528816, -958.0299655348063, -16.402639001607895, 17.44812213629484, 15.550494357943535, -37.18471100926399, -12.720664858818054, 3.634447082877159, 46.512039467692375, 14.203824944794178, 15.317061074078083, -69.30379347503185, 35.4649810642004, -94.92604525387287, -48.238303162157536, 18.242070734500885, -152.04831224679947, -20.86964711174369, 23.031998872756958, -39.047460466623306, -49.27700408175588, 27.308311477303505, -17.64971338957548, -53.586446672677994], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410406562658888, "mean_inference_ms": 4.549579084022204, "mean_action_processing_ms": 4.154608215492149, "mean_env_wait_ms": 3.203446224400812, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14152320, "timesteps_this_iter": 131040, "agent_timesteps_total": 14152320, "timers": {"sample_time_ms": 27290.928, "sample_throughput": 4801.596, "load_time_ms": 21.426, "load_throughput": 6115828.939, "learn_time_ms": 14905.817, "learn_throughput": 8791.199, "update_time_ms": 2.293}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2325951644078307e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 179.93584028711933, "policy_loss": 0.003184933491609792, "vf_loss": 35.9833596991809, "vf_explained_var": 0.15606750360953764, "kl": 0.0024241197165385505, "entropy": -0.6240490474154018, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14152320, "num_agent_steps_sampled": 14152320, "num_steps_trained": 14152320, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14152320}, "done": false, "episodes_total": 28320, "training_iteration": 108, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-36-52", "timestamp": 1691023012, "time_this_iter_s": 15.073373079299927, "time_total_s": 3335.0997412204742, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3335.0997412204742, "timesteps_since_restore": 14152320, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 13.804545454545451, "ram_util_percent": 51.5}}
{"episode_reward_max": 75.05561789125204, "episode_reward_min": -2022.7682911083102, "episode_reward_mean": -164.22713021489713, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.152653694152832, -37.61145777255297, -90.2075852304697, -55.26778084039688, -34.90872721374035, 0.6304929256439209, -246.7933865711093, 7.372216660529375, 27.570664435625076, -471.8298752307892, 6.539262965321541, -22.189590595662594, -40.62823697179556, -53.88262274861336, -1176.6425446420908, -254.3249824270606, -385.1802149042487, -208.51798153668642, -16.864981673657894, -66.61275667697191, -46.146426290273666, 13.730174623429775, -244.32938097417355, -75.26452291756868, 43.87718161940575, -63.98285347223282, -5.312395513057709, -38.99954294040799, -762.5536768957973, -15.507577907294035, -22.706413008272648, 0.9260919168591499, -1410.5436080545187, 54.74065064638853, -14.372859731316566, -58.48714795708656, -482.862321048975, -44.24200755357742, -1460.424147579819, -40.51636282354593, -61.88320904970169, 6.445906937122345, -85.5875418111682, -43.43480207026005, -1277.0276190042496, 2.2375370785593987, -204.88422798365355, 5.053563915193081, 38.10918888449669, -844.6490215808153, -29.03701864928007, -0.25295424461364746, -380.3667914941907, -25.10866093635559, -94.1254305690527, -39.3314496204257, -37.161348819732666, -911.4619839638472, -423.23155296593904, -1422.0896355062723, -76.21831775829196, -7.673412412405014, -580.3997652083635, -420.35261971503496, 16.40262807905674, 29.616874858736992, -402.1309142559767, -20.48214742541313, -15.595603160560131, -77.99815925210714, -53.22718098014593, -113.97261834144592, 11.176641471683979, -1286.6385248750448, -1.2235456854104996, 19.37149965763092, -2.973517522215843, -24.57510680705309, -517.1586723029613, 0.9864850267767906, -849.2468281388283, 22.647228248417377, -163.61830031499267, -53.646633706986904, -11.890099927783012, -46.906353525817394, -88.99207411706448, -3.0350677222013474, -131.1406360566616, 28.394981183111668, -135.93241729587317, -88.20406035333872, 1.0162951350212097, -24.5452391654253, -239.22083012759686, -99.56454746425152, -30.14404857158661, -52.964712522923946, 12.307042326778173, -25.887524612247944, -26.661245808005333, -31.618807464838028, -22.10380059480667, -161.75931341014802, -4.175161741673946, -61.774241015315056, -76.12105758488178, -0.0005439035594463348, 6.222610205411911, -40.6006680354476, -30.920837119221687, -56.9550890699029, 30.41591322608292, -266.3171130120754, -1049.5832727327943, -1723.6457798182964, -16.633686929941177, -9.920446492731571, 50.917826015502214, -94.73652175068855, -24.159296959638596, -20.575625516474247, -115.32715737819672, 23.880299426615238, -87.92408791743219, -11.902102060616016, 43.01025427132845, -34.387483566999435, 8.709481678903103, -106.08875447511673, -2022.7682911083102, -460.83004270493984, 1.7070574425160885, -16.700341694056988, -40.11674525588751, 57.620457235723734, -98.47099955379963, 2.346103969961405, -929.6504377126694, 19.816166378557682, -25.55241386592388, -113.23914189636707, 35.71607246249914, -130.4793435782194, -48.35903297737241, -29.82103792577982, -78.75004380941391, -102.03301417082548, -17.975379668176174, -60.12103995680809, -324.01485423743725, 33.46835722029209, -890.8625700175762, 3.2889089062809944, -44.67330816946924, -45.65164636820555, -24.463324226439, -295.8474648334086, -35.874376744031906, -72.77818322181702, 52.1911284327507, 0.31327735632658005, -1463.8190137147903, -40.89566293358803, 13.93295880407095, -11.536361828446388, -840.9566724672914, -2.2161726132035255, 32.65004047751427, -24.284758396446705, -35.00476108491421, 30.777628012001514, -44.260472632944584, 48.53211589157581, -1.9065142124891281, 32.59850434958935, -101.63157802820206, -177.31824727356434, 21.807576417922974, -1731.9313280135393, -648.6132552847266, 6.916836462914944, -49.571496330201626, 33.36568356305361, 9.655629828572273, -5.722347840666771, -297.312435567379, 40.59016764163971, -1777.3751706779003, -14.17012120783329, -1.8900937736034393, -68.77974399924278, 28.504455640912056, -114.22575338184834, -81.3805780261755, -638.4381236732006, 11.005579397082329, -698.0998839735985, -56.50417545437813, -194.02083979547024, -36.8253633081913, -43.217285469174385, 12.07616314291954, -47.629752799868584, -417.918358489871, 21.911103431135416, -0.06821606308221817, -109.52332570403814, -30.603933095932007, -33.29731862992048, 2.077562414109707, -58.92529286444187, -827.0772804766893, -892.3703492283821, 24.227958211675286, -324.58049461245537, -110.25915536284447, -24.673346653580666, -277.32838352397084, -92.48391059786081, -2.846299484372139, -31.506002597510815, -18.724098809063435, -90.48052029311657, 14.233177296817303, -341.16533775627613, -62.48077965527773, -66.6107962243259, 47.94397322833538, -32.362568490207195, -44.54131632298231, -59.23086281120777, -772.1200461685658, -91.27505020424724, -113.43103927373886, 21.788442336022854, 10.600437879562378, 56.877933245152235, 29.401777274906635, -8.065310686826706, -14.940997630357742, -109.20370091497898, 32.19869448244572, -105.78907467797399, -1152.2667697966099, -416.387482970953, -0.4191082864999771, 16.6218391507864, -240.7982536405325, -47.8716996088624, -45.982044130563736, -70.88761091977358, 18.422610104084015, -73.2783292233944, -161.08017186820507, -522.978412464261, -78.07013742253184, 23.48686708509922, -851.2254936099052, -47.89620552212, 5.064526651054621, -677.1244788616896, -18.4220187664032, -747.4198838323355, -29.161949906498194, 18.654412619769573, -4.9224932342767715, -10.601355485618114, 11.692400716245174, -13.131125003099442, -1197.3273432403803, -1718.2916908413172, -22.15060692280531, -116.54643791168928, -675.3225508183241, 12.01436349004507, -2.161731943488121, -97.83329410851002, -47.26789519935846, -15.640880949795246, -12.773411802947521, -61.85427641868591, -81.92591539025307, 66.33034955337644, -25.24212047457695, 41.28195346146822, -823.563588783145, -1018.0354541838169, -14.740257680416107, 11.891823284327984, -664.9885022863746, 4.405070096254349, 28.818392608314753, -3.5590776205062866, -9.052124857902527, 14.405168294906616, -287.9618639200926, -35.79964315891266, 36.992093071341515, 28.1187936514616, 43.21296950429678, -60.308527171611786, 54.41633448749781, -32.61812066286802, 28.42781463265419, -1270.470598950982, -206.10778157413006, -16.73545628786087, -141.51651104167104, -121.87643894553185, -1479.6627498716116, -40.31091419048607, -82.06691733002663, -901.5353039950132, 18.023980163037777, -0.27175670862197876, -47.63807816803455, -29.184661880135536, -9.701804235577583, -14.04402956366539, -530.5028761662543, -108.8179395571351, -56.59204648435116, -783.4837986752391, -81.53155690431595, 40.68336195871234, -66.80968634784222, -43.85029377043247, 0.7505118735134602, -13.448057014495134, 21.709734462201595, -13.046392545104027, 5.379636004567146, 43.30401308462024, 33.99121068790555, -3.795505076646805, 0.014146149158477783, 10.266976326704025, -5.739360056817532, 46.617907740175724, 19.406460627913475, -7.963258668780327, -33.133493434637785, 62.34266109764576, 2.930994726717472, -6.975093483924866, 55.92895119637251, -160.53336437046528, -82.5576237142086, -23.518211409449577, -18.308738209307194, -91.78043977171183, -70.98983900249004, -7.161310195922852, -54.71460397541523, -42.10616301000118, -10.07614853978157, -34.611490450799465, -1439.5175242125988, -31.637485943734646, -8.550942987203598, 25.790665328502655, -832.8591871149838, 8.617809571325779, 17.495995208621025, -26.150988213717937, -57.65443204343319, -5.150423623621464, -635.2760172337294, -546.2938470002264, -46.89088563621044, -96.53397916257381, 23.035502925515175, -69.18183000385761, -64.57528705894947, -15.118227921426296, -99.75905807316303, -56.830115877091885, 15.326783366501331, -128.4049104899168, -335.81259052455425, -135.45796957612038, 36.14849504083395, 31.466470688581467, -5.402203932404518, -9.0629263818264, -12.096151687204838, 24.89398094266653, -2.378903890028596, -29.368474900722504, -61.758694261312485, 44.166204273700714, -255.4888480901718, 1.6847279146313667, -44.132715448737144, -307.34138345718384, -98.85786404460669, -229.45942537486553, -13.884693071246147, 29.87480089813471, 20.15265876427293, -31.84847365319729, -116.60788886994123, -78.0262089073658, 3.1149245500564575, 46.80717393755913, 51.70611079595983, -55.844722747802734, -46.72141569852829, -915.1851864904165, -76.11265025287867, 25.220914907753468, -257.4287851974368, -64.22574609518051, -23.51875400543213, -22.412823393940926, -47.26097583025694, -505.54391990602016, 1.0954400599002838, 11.664006941020489, -68.03449633717537, 5.835160173475742, -1142.821035400033, -32.11120219528675, -378.42343823611736, -19.75404989719391, -1542.4038254022598, 28.931468278169632, -44.06155255436897, -52.4321653097868, -551.4499167203903, -144.9851165600121, -8.134208597242832, -20.566587187349796, -2.9827431440353394, -16.185910657048225, 14.805174257606268, 36.595766419544816, 22.425646767020226, -946.2820633947849, -74.32754299044609, -33.55294342339039, -94.50505538284779, -7.780299618840218, -64.37176861613989, -143.75696404278278, -90.64523544162512, -371.8899181187153, -12.746581137180328, -1035.171670794487, -6.3878816813230515, -18.835190132260323, -18.586178600788116, -22.31673462688923, -73.25908902287483, -52.51650360226631, 29.010334834456444, -1223.942379951477, 17.907751709222794, -1913.7532844245434, 6.141337938606739, -151.40041150152683, -33.44208278506994, -38.634966507554054, -101.02089042961597, -19.651355743408203, 13.107098385691643, 7.880464717745781, -72.29789335466921, 31.643699176609516, 50.69935107976198, -232.56007646024227, 75.05561789125204, 21.73910467326641, -30.06158221513033, 19.598520308732986, -54.39908079057932, -27.98489038646221, -30.29760381579399, 28.095233380794525], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424384013923466, "mean_inference_ms": 4.560684230491274, "mean_action_processing_ms": 4.211703905886486, "mean_env_wait_ms": 3.235786844039105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14283360, "timesteps_this_iter": 131040, "agent_timesteps_total": 14283360, "timers": {"sample_time_ms": 29704.112, "sample_throughput": 4411.51, "load_time_ms": 23.375, "load_throughput": 5605906.739, "learn_time_ms": 14900.475, "learn_throughput": 8794.351, "update_time_ms": 2.287}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.162975822039153e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 181.06614228187854, "policy_loss": -0.006958886489157642, "vf_loss": 36.21955896192981, "vf_explained_var": 0.11558940547341515, "kl": 0.0026691239708640704, "entropy": -0.6289840875774302, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14283360, "num_agent_steps_sampled": 14283360, "num_steps_trained": 14283360, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14283360}, "done": false, "episodes_total": 28800, "training_iteration": 109, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-37-32", "timestamp": 1691023052, "time_this_iter_s": 39.53454923629761, "time_total_s": 3374.634290456772, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3374.634290456772, "timesteps_since_restore": 14283360, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 44.223214285714285, "ram_util_percent": 51.414285714285725}}
{"evaluation": {"episode_reward_max": 17.725802525877953, "episode_reward_min": 17.725802525877953, "episode_reward_mean": 17.725802525877953, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.725802525877953], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902825731027134, "mean_inference_ms": 3.865901030833367, "mean_action_processing_ms": 1.2385071634372657, "mean_env_wait_ms": 199.33005399024145, "mean_env_render_ms": 3.091726201443097}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 75.05561789125204, "episode_reward_min": -1913.7532844245434, "episode_reward_mean": -140.64497123174368, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.81259052455425, -135.45796957612038, 36.14849504083395, 31.466470688581467, -5.402203932404518, -9.0629263818264, -12.096151687204838, 24.89398094266653, -2.378903890028596, -29.368474900722504, -61.758694261312485, 44.166204273700714, -255.4888480901718, 1.6847279146313667, -44.132715448737144, -307.34138345718384, -98.85786404460669, -229.45942537486553, -13.884693071246147, 29.87480089813471, 20.15265876427293, -31.84847365319729, -116.60788886994123, -78.0262089073658, 3.1149245500564575, 46.80717393755913, 51.70611079595983, -55.844722747802734, -46.72141569852829, -915.1851864904165, -76.11265025287867, 25.220914907753468, -257.4287851974368, -64.22574609518051, -23.51875400543213, -22.412823393940926, -47.26097583025694, -505.54391990602016, 1.0954400599002838, 11.664006941020489, -68.03449633717537, 5.835160173475742, -1142.821035400033, -32.11120219528675, -378.42343823611736, -19.75404989719391, -1542.4038254022598, 28.931468278169632, -44.06155255436897, -52.4321653097868, -551.4499167203903, -144.9851165600121, -8.134208597242832, -20.566587187349796, -2.9827431440353394, -16.185910657048225, 14.805174257606268, 36.595766419544816, 22.425646767020226, -946.2820633947849, -74.32754299044609, -33.55294342339039, -94.50505538284779, -7.780299618840218, -64.37176861613989, -143.75696404278278, -90.64523544162512, -371.8899181187153, -12.746581137180328, -1035.171670794487, -6.3878816813230515, -18.835190132260323, -18.586178600788116, -22.31673462688923, -73.25908902287483, -52.51650360226631, 29.010334834456444, -1223.942379951477, 17.907751709222794, -1913.7532844245434, 6.141337938606739, -151.40041150152683, -33.44208278506994, -38.634966507554054, -101.02089042961597, -19.651355743408203, 13.107098385691643, 7.880464717745781, -72.29789335466921, 31.643699176609516, 50.69935107976198, -232.56007646024227, 75.05561789125204, 21.73910467326641, -30.06158221513033, 19.598520308732986, -54.39908079057932, -27.98489038646221, -30.29760381579399, 28.095233380794525], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410074350279873, "mean_inference_ms": 4.549368796250799, "mean_action_processing_ms": 4.154504877186187, "mean_env_wait_ms": 3.203524618939123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14414400, "timesteps_this_iter": 131040, "agent_timesteps_total": 14414400, "timers": {"sample_time_ms": 27300.467, "sample_throughput": 4799.918, "load_time_ms": 21.839, "load_throughput": 6000288.17, "learn_time_ms": 14892.023, "learn_throughput": 8799.342, "update_time_ms": 2.273}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0814879110195767e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 187.18695203372644, "policy_loss": 0.004370517302492325, "vf_loss": 37.43239460196546, "vf_explained_var": 0.057725263218725884, "kl": 0.0020843057355578107, "entropy": -0.6258496599385388, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14414400, "num_agent_steps_sampled": 14414400, "num_steps_trained": 14414400, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14414400}, "done": false, "episodes_total": 28800, "training_iteration": 110, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-37-47", "timestamp": 1691023067, "time_this_iter_s": 14.92093014717102, "time_total_s": 3389.555220603943, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3389.555220603943, "timesteps_since_restore": 14414400, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 13.863636363636363, "ram_util_percent": 51.563636363636355}}
{"episode_reward_max": 68.36342598870397, "episode_reward_min": -2154.241668701172, "episode_reward_mean": -287.6902683568129, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.36181520670652, -107.75386077165604, -306.103513866663, -113.32278015464544, -75.4460516422987, -44.86133451759815, -1663.8120375424623, 26.143740691244602, -193.34413348138332, -29.953400686383247, -279.9891814291477, -65.91112712025642, -19.892800197005272, -350.57462452352047, -60.92088904231787, -23.225236669182777, -414.4310264699161, -380.46045008301735, -1393.3714373856783, -934.5312391221523, 27.89722916483879, -89.23240708559752, -18.729433797299862, -78.6877925992012, -758.3143548220396, -38.212506890296936, 20.032114133238792, -2154.241668701172, 15.784877751022577, -26.063674315810204, -44.86642738059163, 6.690154492855072, -628.1819397807121, -98.95356491208076, -28.261454597115517, -318.8091334849596, -1231.1157034635544, -13.025659069418907, -77.57243719696999, -260.57041550055146, -12.919235445559025, -61.26936590671539, -10.96395418792963, -31.276095762848854, 37.51826627552509, -139.8411664366722, -86.6718206256628, -42.75981543213129, 24.179939821362495, -1068.1915351599455, -874.7075980901718, -284.0175254791975, -73.76066350191832, -941.3139434605837, -653.8019704073668, 17.022492364048958, -890.946666687727, -26.596909418702126, 26.977930393069983, -702.49737611413, -215.89078396558762, 27.943161249160767, -102.75933592021465, -953.2259257808328, 20.622345983982086, 6.527580879628658, -16.038977220654488, -27.073590204119682, 52.84127299487591, 11.055148515850306, -11.510350439697504, -72.16357241943479, 2.9039399325847626, -1094.4876195341349, -997.7238702699542, -70.15355391800404, -1400.3369431346655, -797.5546746402979, -33.40261835604906, -944.2204794213176, -267.59149584174156, -1608.9889726750553, -215.182892665267, -70.85409058630466, -74.4356780461967, -12.274941220879555, -760.1813006997108, -154.20157046616077, 39.976050052791834, -23.884396463632584, 16.321164280176163, -672.7970849573612, -29.99041609466076, -48.025605380535126, -25.33385156095028, -355.11156265437603, -30.117991529405117, -304.9839704334736, -202.1588558740914, -486.5679882392287, -1029.5858618468046, 41.546342581510544, -46.420990504324436, -44.137268610298634, 8.198251660913229, 11.478488743305206, -14.595490224659443, -254.38202591985464, -23.26982381939888, -62.86416371166706, -270.3833163678646, -0.9553192108869553, -493.9144713617861, -17.782369658350945, -330.9136908277869, 20.111311875283718, -11.969691444188356, -11.12044806778431, 32.613921157084405, 1.3459314554929733, 19.753443971276283, -24.404135406017303, 58.84626552835107, -541.6364820897579, 10.240033991634846, -550.477065436542, -87.88999969512224, -448.19502970576286, -54.97908993065357, -943.3772510290146, -692.5695438589901, -47.33605745434761, -30.750857658684254, -73.95358929783106, 12.888072557747364, -1508.7473860755563, -8.622445303946733, 9.201928660273552, 25.008913204073906, -57.70665588416159, -13.802461283281446, -45.702752240002155, -493.4405544027686, -1109.0927340686321, -23.572623789310455, -350.01307218521833, -1461.4066806547344, -110.4521133042872, -525.8730223327875, -113.29641225934029, 4.681879177689552, -9.540021225810051, -385.6865873336792, 40.80403196811676, -46.27708222717047, -55.60308253765106, -1380.7565204948187, 12.086130820214748, -1528.5520850718021, -11.554246470332146, 3.3382323384284973, -1110.3852076381445, -1216.2218980193138, -83.48281542956829, -1022.4521077573299, -1463.9069988280535, -71.51211504638195, -79.17149664461613, 36.05757053941488, -58.690083011984825, -1.3753612414002419, -35.72113184630871, -130.59149837493896, -107.41764611750841, -5.066616430878639, -253.34236854314804, -1282.4120732694864, -672.5755225867033, -23.362510822713375, -36.567937195301056, -107.86512141115963, -52.21492451429367, -89.97770716249943, -30.58469730615616, -54.36607554554939, -399.5670849364251, -1239.8338164687157, -38.929828479886055, 37.17674296349287, -1018.8324512019753, -34.80236381292343, 1.1584691852331161, 20.259396202862263, -41.08037193864584, 50.36577530950308, -54.93921810388565, -66.6189212501049, -774.4060451090336, -702.0121994391084, -222.53589709848166, -40.2848042845726, -25.20397151261568, -166.1378392279148, -32.56579238176346, -101.27038951590657, -84.8097591996193, -31.296341471374035, -123.44642939418554, -63.29098406434059, 6.4560224413871765, -817.5433864705265, -1560.0860205590725, -66.84473724663258, 43.539067555218935, -528.6095272749662, 22.246135536581278, -9.444271080195904, -9.679963074624538, 1.4118656888604164, -74.17291305959225, -1445.7507996931672, -39.447762839496136, -10.00270477309823, -1218.450356386602, -1698.0839879512787, 25.128884822130203, -1389.8999142199755, -1622.0029444098473, -1236.1041364446282, 9.631933599710464, -275.97602312266827, -730.1717000752687, 10.118241928517818, -27.443289816379547, -471.0839192569256, -128.6488306298852, -61.67800811678171, -45.413164377212524, -78.09253664314747, -29.713283389806747, 0.7459144536405802, 24.327833890914917, -238.1408315896988, 26.091706417500973, 15.613316766917706, -4.929180838167667, -393.411194562912, -37.02860364317894, -112.48560327291489, -600.6877287626266, -436.62815138697624, -232.30920958518982, -92.59294767677784, -1623.7556056156754, -1256.362365949899, -1234.812487438321, -942.2964727990329, -127.98839382827282, 13.047063276171684, -771.7833614200354, -52.24441085755825, -29.25254050642252, 2.8574262261390686, -232.07189092040062, 34.07168297469616, -1835.6014848798513, -53.53268299996853, -30.131045326590538, -1339.0720817744732, -35.163138166069984, -27.64303410053253, -200.1174377799034, 12.983946859836578, -551.0214940309525, -49.26152857393026, -13.476544082164764, -35.321556374430656, -67.33596684038639, -95.92030923813581, -30.141413033008575, -21.56316827237606, -93.77099897712469, -57.41472290456295, -283.64048817008734, 23.53325255215168, -4.0954776257276535, 52.780210219323635, 31.89613203704357, -72.78087825328112, 21.358648093417287, 40.73028352856636, -45.10978123545647, -52.339266046881676, -34.27338956296444, 32.78069067001343, -93.3283929079771, -61.14577104151249, -660.4168817847967, -66.342555180192, -187.05852103233337, -1.0904705747961998, -53.404896050691605, -1626.5110078994185, 25.177146341651678, -1025.9137812778354, -43.14274889230728, 6.812939517199993, 42.456777308136225, -87.14708805829287, -70.2865968644619, -29.673134706914425, -19.08886207640171, -52.460574597120285, -3.027320109307766, -88.33709445595741, -107.55050911009312, -889.3901386409998, 45.89956182986498, -21.384968668222427, -41.83020672947168, -115.5783149600029, -1264.4521310925484, 43.366097040474415, -1.0332386828958988, -224.4957763105631, 35.49345054477453, 16.45920878648758, -85.81762892007828, -1710.8221351653337, -65.5336037799716, -82.41372702270746, -72.95842314511538, -24.607432313263416, -246.22587148100138, -1303.9848704487085, -48.905620247125626, -1541.7872332185507, 36.85813666135073, -23.34644465893507, 22.45389226078987, 9.79005590826273, -151.11711266636848, -266.6194830238819, -937.7917973212898, -31.764357574284077, -101.87377236783504, -866.7668113410473, 2.1709850504994392, -36.94703024066985, -509.4478195607662, 51.792543198913336, -6.405265793204308, -66.26853206753731, -6.307391874492168, -1233.7843952402472, -98.65570802986622, -19.00799523293972, -990.2975535430014, -2.289727531373501, -33.6043394356966, -66.3710515499115, -33.37987592071295, -43.22683184593916, -37.63380033522844, -65.27613765746355, -35.40347936749458, -131.8224120736122, -1141.673290874809, -1035.9408229887486, -109.31000532209873, -180.40525715053082, -70.62317743897438, -405.8102526664734, -67.60158451646566, -99.4360776245594, -233.05038671195507, -5.8883876614272594, -178.90779918804765, -137.97745797783136, -365.5576764792204, -97.08696188777685, 24.158426761627197, -112.5360090136528, -64.7975517436862, -101.13518288731575, -29.457708686590195, 1.9082725122570992, 17.560574769973755, 26.651113882660866, -771.7202375158668, -1116.4390790611506, 4.395779676735401, -502.8722828179598, -807.5516198426485, -632.6251213252544, -1216.0223378241062, -0.3724081814289093, 42.80404057353735, -8.513628676533699, -5.768208622932434, 33.0075188241899, -5.392214417457581, -74.4906599521637, -16.231445655226707, -65.45855573564768, -746.6840253472328, -1.402766577899456, 68.36342598870397, 11.162425100803375, -282.66753183305264, -977.1502691805363, -141.4445786178112, 29.111889719963074, -235.0709692388773, -770.0490088015795, -6.599714525043964, -14.294906303286552, -1288.8687766641378, -48.076415084302425, -54.126826701685786, 2.3531571850180626, -50.790740452706814, 64.25353002175689, -1864.9901467859745, 2.0595629811286926, -794.5317376106977, -81.1182828322053, -48.83839599788189, -147.28353305161, -1315.7074939981103, -26.11359417438507, -476.50134098529816, -293.07106141746044, -13.523442320525646, -69.82242302596569, 26.376676097512245, -62.24787236750126, -76.06148484349251, -299.76868817955256, -27.455801837146282, 25.415387958288193, -21.504741936922073, -719.6897833049297, -281.3047105669975, -933.0432156473398, -152.65467481315136, -64.34687053412199, 3.884804382920265, -7.952280193567276, 44.41994642466307, -24.664742797613144, -7.825952619314194, -363.04118947312236, -60.58417594432831, -60.38240455836058, -1446.44915561378, -129.68652811646461, -2.259274397045374, -82.49925688654184, -40.142096638679504, -1842.4574873149395, -367.53175639361143, -948.243039496243, -1187.4528224915266, -28.8700353205204, 28.864435344934464, -1879.01393699646, -1310.8189607709646, -68.69366480410099, -63.84487397968769, -1442.6175423115492, -984.7361622042954, -109.10569164156914, -40.34454520046711, 12.408666446805, -1642.9602649956942, -81.32003420591354, -52.469540648162365, 13.538828358054161, -75.31342343986034], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429515794582836, "mean_inference_ms": 4.566078239369971, "mean_action_processing_ms": 4.214953450399014, "mean_env_wait_ms": 3.240110295888355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14545440, "timesteps_this_iter": 131040, "agent_timesteps_total": 14545440, "timers": {"sample_time_ms": 29884.211, "sample_throughput": 4384.924, "load_time_ms": 23.499, "load_throughput": 5576325.453, "learn_time_ms": 15007.155, "learn_throughput": 8731.835, "update_time_ms": 2.45}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5407439555097883e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 217.409704118358, "policy_loss": -0.00927220128746821, "vf_loss": 43.49058437347412, "vf_explained_var": 0.010236353536660525, "kl": 0.0021366426852642943, "entropy": -0.629421877925114, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14545440, "num_agent_steps_sampled": 14545440, "num_steps_trained": 14545440, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14545440}, "done": false, "episodes_total": 29280, "training_iteration": 111, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-38-29", "timestamp": 1691023109, "time_this_iter_s": 42.34023952484131, "time_total_s": 3431.895460128784, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3431.895460128784, "timesteps_since_restore": 14545440, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 55.368333333333325, "ram_util_percent": 51.263333333333335}}
{"episode_reward_max": 68.36342598870397, "episode_reward_min": -1879.01393699646, "episode_reward_mean": -318.83859415849673, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.08696188777685, 24.158426761627197, -112.5360090136528, -64.7975517436862, -101.13518288731575, -29.457708686590195, 1.9082725122570992, 17.560574769973755, 26.651113882660866, -771.7202375158668, -1116.4390790611506, 4.395779676735401, -502.8722828179598, -807.5516198426485, -632.6251213252544, -1216.0223378241062, -0.3724081814289093, 42.80404057353735, -8.513628676533699, -5.768208622932434, 33.0075188241899, -5.392214417457581, -74.4906599521637, -16.231445655226707, -65.45855573564768, -746.6840253472328, -1.402766577899456, 68.36342598870397, 11.162425100803375, -282.66753183305264, -977.1502691805363, -141.4445786178112, 29.111889719963074, -235.0709692388773, -770.0490088015795, -6.599714525043964, -14.294906303286552, -1288.8687766641378, -48.076415084302425, -54.126826701685786, 2.3531571850180626, -50.790740452706814, 64.25353002175689, -1864.9901467859745, 2.0595629811286926, -794.5317376106977, -81.1182828322053, -48.83839599788189, -147.28353305161, -1315.7074939981103, -26.11359417438507, -476.50134098529816, -293.07106141746044, -13.523442320525646, -69.82242302596569, 26.376676097512245, -62.24787236750126, -76.06148484349251, -299.76868817955256, -27.455801837146282, 25.415387958288193, -21.504741936922073, -719.6897833049297, -281.3047105669975, -933.0432156473398, -152.65467481315136, -64.34687053412199, 3.884804382920265, -7.952280193567276, 44.41994642466307, -24.664742797613144, -7.825952619314194, -363.04118947312236, -60.58417594432831, -60.38240455836058, -1446.44915561378, -129.68652811646461, -2.259274397045374, -82.49925688654184, -40.142096638679504, -1842.4574873149395, -367.53175639361143, -948.243039496243, -1187.4528224915266, -28.8700353205204, 28.864435344934464, -1879.01393699646, -1310.8189607709646, -68.69366480410099, -63.84487397968769, -1442.6175423115492, -984.7361622042954, -109.10569164156914, -40.34454520046711, 12.408666446805, -1642.9602649956942, -81.32003420591354, -52.469540648162365, 13.538828358054161, -75.31342343986034], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415417799404705, "mean_inference_ms": 4.555855174033914, "mean_action_processing_ms": 4.158218986254144, "mean_env_wait_ms": 3.2091076037280466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14676480, "timesteps_this_iter": 131040, "agent_timesteps_total": 14676480, "timers": {"sample_time_ms": 27592.721, "sample_throughput": 4749.079, "load_time_ms": 21.79, "load_throughput": 6013753.581, "learn_time_ms": 15080.311, "learn_throughput": 8689.476, "update_time_ms": 2.439}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.703719777548942e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 230.6636816950425, "policy_loss": 0.005684641429131493, "vf_loss": 46.126423066662205, "vf_explained_var": 0.012622639910721864, "kl": 0.0019255228082759566, "entropy": -0.6292948811498594, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14676480, "num_agent_steps_sampled": 14676480, "num_steps_trained": 14676480, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14676480}, "done": false, "episodes_total": 29280, "training_iteration": 112, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-38-45", "timestamp": 1691023125, "time_this_iter_s": 16.03495502471924, "time_total_s": 3447.9304151535034, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3447.9304151535034, "timesteps_since_restore": 14676480, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 20.343478260869567, "ram_util_percent": 51.89130434782608}}
{"episode_reward_max": 54.29326881468296, "episode_reward_min": -3418.901359811425, "episode_reward_mean": -380.3072233535524, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.12771438062191, -190.0605760961771, -1190.2252420037985, -88.31572790443897, -1251.012550495565, -2782.7326921522617, -292.11112873256207, -1204.7260414659977, -39.68112929165363, -108.33769242465496, -49.25881424173713, -446.44115929305553, 19.940965607762337, -47.8960697054863, -180.50290059298277, -512.1863994076848, 21.6486034989357, -87.44487373530865, -84.0562676936388, -978.4818100482225, -120.55746408551931, -59.219355300068855, -130.1375522017479, -74.16420638561249, -19.569138079881668, -48.29278799891472, -26.916757822036743, -33.289811193943024, -2.7627290189266205, -1949.5222268551588, -795.9791293516755, -1488.8410159647465, -1.0621182844042778, -1037.39266654104, -215.32240258157253, -15.939001321792603, -21.865152336657047, -773.7026632130146, -58.39960494637489, -147.30140690505505, -23.56371859461069, -525.7353710979223, -826.8682100474834, -830.8690126165748, -275.46817971765995, -35.37412351369858, 2.2020026817917824, -95.46664552390575, -215.92394119501114, 22.022418059408665, -952.2356630563736, -896.4313960634172, -7.47773353010416, 42.07749901339412, -64.614241912961, -336.66011340916157, -84.9452947974205, -139.72740814834833, -24.287779059261084, -24.626049235463142, -1020.3653847575188, -105.24583055078983, -43.785944417119026, -1242.1296153962612, -63.014213383197784, -0.5131190270185471, -105.08483654074371, -79.83836664259434, -107.91954281926155, -19.97934640198946, -637.8860004656017, 11.816749382764101, -36.84506306797266, -11.865160889923573, -41.51174306869507, -42.62574606388807, -105.71232734620571, -18.476632796227932, -104.84299820661545, 3.45404551923275, -1587.7808561846614, -46.5895322766155, -100.89329542219639, -58.038825288414955, -1760.7086852416396, -58.17384745180607, 0.5350426733493805, -1648.5063811838627, -93.1382445693016, -896.1170758157969, -590.706062503159, -92.6903765797615, -209.59719962626696, -414.0418285764754, -375.1995456814766, -68.65150378644466, -137.6781760826707, -446.2925505489111, -9.130848810076714, -15.162908136844635, -67.89366764575243, -17.737106040120125, -410.83209981024265, -41.41060679405928, -11.315123196691275, 6.639325901865959, -1564.7798193842173, -89.51795498281717, -15.849647596478462, -96.51824747025967, -161.93414270877838, -74.03326708823442, 19.066740304231644, -12.779110133647919, -1.151319645345211, -917.8924182355404, -538.9026642590761, -1411.5041459053755, -87.70828758180141, -737.4863273054361, 6.247618660330772, -53.21788717806339, -33.85115812718868, -1194.1902220398188, -1767.1554197594523, -1101.762853242457, 3.9713187143206596, -53.16400846838951, -182.95199942588806, -10.395310766994953, -168.773875400424, -448.2486345767975, -1085.263687312603, -67.6373883523047, -1296.7927662730217, -1777.9707619547844, -105.73153616674244, -1208.308210477233, -55.97646543011069, -84.95582287013531, 54.29326881468296, -494.4158008135855, -55.71428234875202, -77.7788989469409, -91.72649221867323, -371.4466004371643, -861.0169241726398, 17.749864879995584, -1133.5050663799047, 6.484431803226471, -83.94560964405537, -1557.771652340889, -71.89299257099628, -74.11947504989803, -86.59893473982811, -762.7140707075596, -0.026502251625061035, -1226.1963714957237, -1052.4534751437604, -14.002435356378555, -50.79376223683357, -1200.7661107797176, -34.30393008515239, -59.10612127184868, -4.434812389314175, -1384.8412377238274, -463.44696149230003, -322.66288654506207, -962.1300772642717, -1746.1099460721016, -1376.3927713483572, -5.2292952463030815, -911.7019707113504, -28.455743461847305, -2289.307202115655, -912.3662572652102, -415.84296590834856, -90.52823759615421, -138.79103057086468, -92.5641627125442, -1193.3075142800808, -333.86737306416035, -73.22932466864586, -795.6118945628405, -63.906218111515045, -20.772562980651855, -381.73904624581337, -1090.1113966703415, -55.74294598400593, -1590.1752769351006, -1345.6291414797306, -54.039150804281235, -350.61050621420145, -75.52708538621664, -12.886928871273994, -835.5451864898205, -47.62921096384525, -287.94266476109624, -23.06777961552143, -419.86817556619644, -144.87719652801752, -38.81418773531914, -66.58313177525997, -36.38155944645405, -14.616904743015766, -137.35187136381865, -553.9907932430506, -132.7520591467619, -29.746563471853733, 0.5980694741010666, -96.14768372476101, -8.299319073557854, -16.554390609264374, -71.09584724903107, -639.5369631871581, -32.50919657945633, -433.0203891992569, -183.26712096109986, 25.395655065774918, -81.4178919494152, -955.782804697752, -1370.0892208963633, -64.08556997776031, -1051.8984798043966, -1274.890190422535, -1293.9425303936005, -437.6065174937248, -118.51905596256256, 11.29107803106308, -90.08678482472897, -478.586532369256, -129.34853349626064, -511.9708382487297, -784.5508540421724, -277.77340438216925, -22.87518075108528, -477.28043618798256, -101.97942167520523, -107.2215473651886, -30.867645159363747, -20.851100474596024, 1.1719405017793179, -30.211063012480736, -1599.876073293388, 3.941759705543518, -29.923622611910105, -1262.4102534800768, -70.25927601754665, -1464.1049603000283, -86.2489315494895, -43.42296585440636, -95.02596826851368, -913.5414921939373, -59.693433567881584, -1348.4062861949205, 14.238150835037231, -75.39153550565243, -490.9508310109377, -113.6768808066845, -608.3695590645075, -794.8111584559083, -23.820364711806178, -665.5022324472666, -859.8463656455278, -404.6829728037119, -1478.7950587570667, -1218.7470733597875, -1503.3877363428473, -781.3753937631845, -566.942402869463, -3418.901359811425, -118.2615297883749, -1128.214876420796, -1235.2280161082745, -1939.875882923603, -835.6991074234247, -665.8352928906679, -77.65981869399548, -37.51605685800314, -11.852211251854897, -1447.5079609304667, -524.0698395818472, 8.158431813120842, 13.779690735042095, -221.81923887133598, -695.1779708191752, -62.841306909918785, -864.3291662782431, -8.181893058121204, 12.303293220698833, -76.26712329685688, -253.40267887711525, -324.86322048678994, -711.4074435979128, -0.3007060717791319, -1.792377881705761, -65.8300811201334, -21.332771852612495, -1680.5225366801023, -614.7735771909356, -106.33114682137966, -50.43629644066095, -0.3913280814886093, -468.06565630435944, -167.44811285287142, -457.5177409723401, -141.5137960575521, -547.8147463351488, -174.31279927492142, -52.74782292172313, -23.67931903898716, -70.78135181963444, -688.2638995051384, -16.965739525854588, -118.7767693400383, -123.73492461442947, -39.51859971880913, -795.5559510886669, 10.450932160019875, -8.562818996608257, -27.52784350514412, -103.75909370929003, -1512.0074426084757, -130.0571400821209, -43.247187063097954, -277.9661229774356, -20.125810250639915, -1124.6659132093191, -1383.3487834185362, -85.9898215457797, -803.3905044645071, -72.42504744231701, -122.24264904856682, -235.94423912465572, 0.3052637428045273, -16.528193593025208, -181.56291637942195, -44.640824154019356, -1334.153085924685, -543.4331886097789, -819.2908509373665, -612.7893604934216, -162.2694562152028, -631.1532379984856, -1394.4256842583418, -80.85478703677654, -163.18629187345505, -386.1825985312462, -811.0992189496756, -20.484945371747017, -61.795488238334656, -1646.9967495650053, 6.499970048666, -86.83640037477016, -322.3129937238991, -1604.3371758833528, -383.3204955011606, 31.15757019072771, -240.30881033837795, -1198.6117197424173, -78.53437693417072, -1211.165805362165, -178.1811481565237, 12.354764334857464, -1324.3105079680681, -51.01396796107292, -214.08110529184341, -290.3889351375401, -622.0118320286274, -829.0990468226373, -499.39414956606925, -83.24417300522327, -1303.6722045391798, 16.570614375174046, -431.26733257621527, -23.6724361628294, -61.378240287303925, -71.30102533102036, -81.14336441457272, -1594.752085328102, -46.10147684067488, -49.64827783405781, -36.34382405877113, -100.2057227268815, -104.69353561848402, -88.54844780266285, -831.0447307229042, -67.56932427734137, -86.26272863149643, -1641.124235600233, 18.623826697468758, -6.101894460618496, -66.45028713345528, 0.9281159192323685, -685.6039930209517, -46.657071851193905, 4.454146411269903, -32.01167134940624, -46.17101787030697, -232.5960379615426, -73.3485090136528, -103.90919436514378, -57.061977222561836, 2.0468508452177048, -250.8491624891758, -114.55195413529873, -95.25525476038456, 2.2715514078736305, -156.396415296942, -168.54513492807746, -1035.5133770406246, -121.61687110364437, -128.41560054570436, -149.33301408216357, -5.679645448923111, -167.89941942691803, -16.137693256139755, -229.50436207652092, -123.30231764912605, -38.73717652261257, -8.154026612639427, -501.803837582469, -51.661136232316494, -2274.0598053485155, -88.37410509586334, -171.39027689397335, -65.21419185400009, -116.28017181158066, -818.2601963430643, -1.0942180454730988, -32.26044538617134, -114.96339625865221, -63.331738874316216, -70.38155403733253, -44.396460115909576, -850.1791102513671, -54.05404590070248, -949.0172280669212, -246.9178281277418, -164.5933835208416, -6.945920050144196, -17.82485108077526, -103.93382236361504, -47.735531874001026, -195.66723842918873, -459.9584154598415, -58.97859366238117, -369.968697110191, -4.7861764542758465, -60.74719812721014, -984.7760793268681, -85.15198013931513, -67.05273853242397, -16.920125395059586, -168.5591086000204, 29.768141210079193, -39.43612948060036, -121.0051652342081, -19.50452271848917, -88.59354469180107, -7.780682243406773, -1050.8624332863837, 39.917607709765434, -70.97548927366734, -82.76208775490522, -53.141616359353065, -132.16028402745724, -441.49498376250267, -815.3443165719509, -41.461436837911606, -87.82489804923534, -311.82252721488476, -1552.5123238041997, -96.13526223413646, -3.8054917380213737, -1662.1590396165848, -68.1706292629242, -1045.2202816605568, -35.808686170727015, -234.4179595708847], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429163624494891, "mean_inference_ms": 4.565603146514918, "mean_action_processing_ms": 4.214809589352213, "mean_env_wait_ms": 3.239642053342028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14807520, "timesteps_this_iter": 131040, "agent_timesteps_total": 14807520, "timers": {"sample_time_ms": 30064.153, "sample_throughput": 4358.679, "load_time_ms": 23.397, "load_throughput": 5600799.694, "learn_time_ms": 15082.779, "learn_throughput": 8688.054, "update_time_ms": 2.456}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.851859888774471e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 240.66186054298643, "policy_loss": 0.008880555095837843, "vf_loss": 48.12286270989312, "vf_explained_var": -0.02901986380204505, "kl": 0.0018452147643314445, "entropy": -0.6296047902662695, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14807520, "num_agent_steps_sampled": 14807520, "num_steps_trained": 14807520, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14807520}, "done": false, "episodes_total": 29760, "training_iteration": 113, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-39-25", "timestamp": 1691023165, "time_this_iter_s": 39.21177268028259, "time_total_s": 3487.142187833786, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3487.142187833786, "timesteps_since_restore": 14807520, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 44.40535714285715, "ram_util_percent": 51.50000000000001}}
{"episode_reward_max": 70.97501842305064, "episode_reward_min": -2807.272602021694, "episode_reward_mean": -283.66689108605107, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.153440162539482, -97.81673321127892, -48.80333663523197, -65.1943943053484, -142.79886896908283, -204.12884764187038, -291.94641234353185, -78.18662964552641, -8.3684933334589, -711.9142519831657, 20.42223297059536, -37.253578739240766, 8.247348815202713, -521.1956911981106, -1360.7391892522573, -77.63455173373222, -91.89930043369532, 28.87520619481802, -77.00128638744354, -169.09354948997498, -297.1625673621893, 33.14065057039261, -22.03954255580902, -1073.0874575413764, 21.252967182546854, -55.9674731194973, -64.69425530731678, -112.27074065059423, -33.17795117199421, -84.19715262204409, -97.41065163165331, -37.57562682032585, -8.21826446801424, -24.52758090943098, 14.522419191896915, -67.79665942490101, -1241.4499451220036, -349.49777388200164, -412.1049535572529, -378.58486565202475, -1359.843884125352, -804.4110548868775, -60.44380680471659, -61.03586766123772, 28.141337268054485, -277.89459900557995, -40.90388081967831, -16.5571496412158, -87.16324132680893, -564.6766690611839, -2160.095955260098, -262.2779060602188, 37.2954996265471, -55.67812615633011, -19.54002419859171, -481.1598519459367, -1695.45418587327, 4.237626284360886, -55.77943468093872, -18.032028134912252, -28.1875067204237, -0.2912910580635071, -162.57679572701454, -96.03232138603926, -121.43171544373035, -7.6319807935506105, -1264.710115648806, -11.282005190849304, -28.22451490908861, -39.75956302881241, -77.90647922456264, -897.5919902324677, -58.40087679028511, 9.826191619038582, -66.94330798089504, 7.933249857276678, -443.3298340663314, 5.184172719717026, -82.1926114782691, -40.39146292209625, -138.939255297184, -452.48552663624287, -17.00114419311285, -723.0730084329844, 9.046622291207314, -18.613663464784622, -1211.825835276395, -86.4640991576016, -1237.328087374568, -142.4761269837618, -695.9586951956153, -297.6342687914148, -419.02652725577354, -289.7230407111347, -210.8289835676551, 6.510397553443909, -746.3153695613146, -66.49436216056347, -21.084631100296974, -14.721423044800758, -1254.1520721018314, -30.495396271348, -1463.0102178305387, -43.89614376798272, -16.354353949427605, -98.51885034888983, -10.187888912856579, -276.2112767547369, -24.816744346171618, -182.61044804006815, -239.73458825051785, -714.8427619189024, -199.2734299749136, 9.728609323501587, -64.51436199247837, -1552.22297000885, 16.62107763439417, 26.71854667365551, -51.831331834197044, -21.25499626994133, -117.63268259167671, -83.71441596746445, -45.732088550925255, -519.1729288995266, -76.75472323596478, -66.24257083237171, -337.36538352817297, -16.75375173985958, -51.06629544496536, -58.704057931900024, -119.65803220123053, -644.0989298820496, -109.13986306637526, -59.93338055163622, 18.364273749291897, -49.170127402991056, -27.499064199626446, -82.06568117439747, -5.353598635643721, -143.07418001443148, -31.3543940782547, -10.441434413194656, -41.861873991787434, -88.13601581007242, -466.7207757383585, -68.73069886863232, -112.49794086813927, -41.21630197018385, -32.14577794075012, -153.79377645254135, -330.97632575035095, -43.36414725333452, -389.13565254956484, -1372.1019729971886, -65.23933507502079, 0.7645566314458847, 12.305583640933037, -305.1297264099121, -205.0224783718586, -86.20504090189934, -20.628821417689323, -19.620195999741554, -66.1973077505827, -1007.3318881765008, 32.32881809026003, -55.058548636734486, -71.51789417862892, -96.9260783046484, -113.92036014795303, -12.272064581513405, -10.500758349895477, -7.726027153432369, -880.9415715783834, -926.85552380234, 3.4645126461982727, -1267.8728702962399, -121.76295188069344, -35.11449486389756, 38.21715699881315, -99.79812567681074, -57.93133018910885, -55.447124399244785, -163.2903645336628, 19.979121301323175, -19.47534403949976, -1020.4515041559935, -28.149728566408157, -1410.7388387471437, -767.3735050857067, -7.890983745455742, -32.6395096629858, 1.0313556790351868, -2807.272602021694, -18.642022773623466, -0.7188046313822269, -29.207068778574467, -50.46136175096035, -220.5900241136551, -28.233965910971165, -1928.111813314259, 1.7721322923898697, -21.024280227720737, -86.87596257030964, -63.46672223508358, -0.834933441132307, -740.5450342148542, -106.5353392586112, -85.33399805426598, -112.236118465662, -219.63140739500523, -113.18280366063118, -158.17798317223787, -16.257398549467325, -46.533162981271744, -11.945570934563875, -4.5155652686953545, -1011.7844539918005, -22.38466015458107, -427.3047941252589, -1489.114469356835, -56.50222985446453, -87.12817269563675, -33.12313383817673, -1078.3636874556541, 37.95608967542648, -1130.7526220083237, -110.06952764093876, -74.94371047616005, -11.616134271025658, -315.01281145215034, -73.03079663217068, -1096.4788059145212, -34.51735211536288, -1100.064390450716, -23.69759038835764, -165.42764618992805, -454.11377760767937, -513.5822190083563, -13.142306189984083, -22.600488401949406, -71.53466575592756, 21.42801370471716, -133.40924714505672, 1.7612288445234299, -1.5205912292003632, -1813.6028539538383, -694.4634035639465, -26.461517840623856, -962.5754478722811, 3.5179628133773804, -148.43519523739815, 11.213432483375072, -1263.7123705893755, -711.0362889021635, -70.42971854284406, -629.9655485451221, -682.4303162693977, -62.13560029864311, -784.900177910924, -18.4877892434597, -111.51120071858168, -787.1317347288132, -793.0617297589779, -28.74377278983593, -845.3247582875192, -5.1481983214616776, -447.73121751099825, 12.354754202067852, -116.60482040792704, -48.169796139001846, -52.629947654902935, -69.14182198047638, -105.25857472419739, 43.88355388492346, 10.623323485255241, -21.294929906725883, 21.064181976020336, -57.79530267044902, -1115.797079846263, -52.27547024190426, -582.8739240765572, -18.900993935763836, -36.39890652894974, -50.21082916110754, -420.8160619037226, -35.95549764484167, -450.876153498888, -103.04117584228516, -265.30275888741016, -250.6982893794775, -162.680112965405, -46.4545928388834, -1602.0259368121624, -156.32745185494423, -67.67263212800026, -52.28755134344101, -20.150670871138573, -25.64931830763817, -125.59853857010603, -706.3260124512017, -680.7541548162699, -85.45970565453172, -35.33750921487808, -1043.239208638668, 70.97501842305064, -520.485719896853, -10.89634745195508, -60.39555601775646, -914.3220180440694, -855.0314565226436, -495.9415177702904, -122.49730642139912, -16.171260103583336, -1356.1814677864313, -208.17733497917652, -1.2876972258090973, -107.30251035094261, -99.54270415008068, -57.76828934252262, -83.7767334356904, -934.8949406892061, -505.3226689044386, -879.6317335516214, -497.2960517704487, -67.08513359725475, -12.771768847480416, -60.354684203863144, 24.129879139363766, -1459.8052921388298, -999.0744273066521, -55.2988344617188, -92.77335639297962, -420.6657513976097, -280.03213135153055, 14.23322781175375, 26.036001347005367, -26.278155595064163, -2538.8873503189534, -85.0642154365778, -58.78613372147083, -1293.6826191842556, -97.72107135504484, -22.695125944912434, -95.68170309066772, -1720.4745991379023, -10.808348700404167, -1200.71327213943, -930.5814358592033, 24.833013774827123, -46.516478940844536, 27.902774050831795, -2.9935147389769554, -596.5004299134016, -17.838941648602486, -1395.3430899642408, -14.474479377269745, -477.2996031790972, -1280.7519017159939, -318.1434016376734, -139.97848369926214, -175.6182423233986, -816.887642338872, -322.20847196877, -116.0603040009737, 2.630391262471676, -82.71934002637863, 38.60707451403141, -741.1911256611347, -54.9371762573719, -117.9438110999763, -55.4986038915813, -394.6443090736866, 16.366039238870144, -30.06810550391674, -5.9219825230538845, -38.5985539406538, -111.4300449192524, -30.317119359970093, -1307.5086194127798, 28.906580075621605, -28.712525941431522, -666.3629007935524, 31.948992773890495, -43.16165255010128, -1566.915052331984, -34.35608810186386, -1532.9462504833937, -68.50689301639795, -30.971122458577156, -76.08151869475842, -51.07428780198097, -165.6674277856946, -3.3184279203414917, -328.17285946011543, -539.5367572456598, -2.3439605310559273, -152.6035630106926, -959.9572733808309, -42.90839049220085, -29.01702728867531, -729.8924788981676, -1419.7810766249895, 23.58701267838478, -315.34705927222967, -31.7507296949625, 7.357447899878025, -135.46957796812057, -1890.760492682457, -29.825446762144566, -91.071847230196, -8.110198587179184, -4.372608615085483, -56.47077634930611, -68.36454543471336, -106.07170654833317, -1669.2240118831396, -9.79656708240509, -1068.9489297159016, -24.52153565734625, -122.720966309309, -48.39837725460529, -206.74230648577213, 18.52793537825346, 13.831128135323524, -43.513077825307846, -105.22458308935165, -531.9261010140181, -227.32775655388832, -79.3846334964037, -86.07503283023834, -561.4758630394936, -53.43181551247835, -25.58806674182415, -445.7503325268626, -29.052449002861977, -973.337512537837, -40.45532001182437, -34.43345396220684, -1067.9705680459738, -729.1858754754066, -6.890376165509224, -69.17671414464712, 46.73075648397207, -1545.5199549347162, -38.93216013908386, -15.081907644867897, -62.647973984479904, -5.021151974797249, -63.5513199865818, -61.98592796549201, -1419.9749293774366, -7.351629175245762, -199.12650045752525, 3.3447896242141724, 35.18846242129803, -68.02839820086956, 10.674126908183098, -20.31938123703003, -80.71982288360596, -36.352062188088894, -37.71290175616741, -15.84538260102272, -2.174180254340172, -89.97079456597567, -8.5228486135602, -84.76767189800739, -910.0667707100511, -416.5662966966629, -28.572891905903816, -28.293127790093422, 0.5743251144886017, -90.36100649833679, -11.966896882280707, -20.077932968735695, -108.25736735761166, -401.9672512598336, 4.134242802858353, -11.35539135336876, -102.65255146473646, -169.7825152426958], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.428654386339186, "mean_inference_ms": 4.565205483193684, "mean_action_processing_ms": 4.214599607379801, "mean_env_wait_ms": 3.2393050958864364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14938560, "timesteps_this_iter": 131040, "agent_timesteps_total": 14938560, "timers": {"sample_time_ms": 30047.479, "sample_throughput": 4361.098, "load_time_ms": 23.393, "load_throughput": 5601730.151, "learn_time_ms": 15072.532, "learn_throughput": 8693.961, "update_time_ms": 2.447}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9259299443872354e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 246.07899331994466, "policy_loss": -0.0035952918445618883, "vf_loss": 49.21876428118743, "vf_explained_var": -0.018242378709136798, "kl": 0.0022126358455359122, "entropy": -0.6304175862274717, "entropy_coeff": 0.001}}}, "num_steps_sampled": 14938560, "num_agent_steps_sampled": 14938560, "num_steps_trained": 14938560, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 14938560}, "done": false, "episodes_total": 30240, "training_iteration": 114, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-40-04", "timestamp": 1691023204, "time_this_iter_s": 39.1098210811615, "time_total_s": 3526.2520089149475, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3526.2520089149475, "timesteps_since_restore": 14938560, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 44.38392857142857, "ram_util_percent": 51.54285714285715}}
{"evaluation": {"episode_reward_max": 10.497864067554474, "episode_reward_min": 10.497864067554474, "episode_reward_mean": 10.497864067554474, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.497864067554474], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902825731027134, "mean_inference_ms": 3.865901030833367, "mean_action_processing_ms": 1.2385071634372657, "mean_env_wait_ms": 199.33005399024145, "mean_env_render_ms": 3.091726201443097}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 46.73075648397207, "episode_reward_min": -1890.760492682457, "episode_reward_mean": -254.38082430070267, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.712525941431522, -666.3629007935524, 31.948992773890495, -43.16165255010128, -1566.915052331984, -34.35608810186386, -1532.9462504833937, -68.50689301639795, -30.971122458577156, -76.08151869475842, -51.07428780198097, -165.6674277856946, -3.3184279203414917, -328.17285946011543, -539.5367572456598, -2.3439605310559273, -152.6035630106926, -959.9572733808309, -42.90839049220085, -29.01702728867531, -729.8924788981676, -1419.7810766249895, 23.58701267838478, -315.34705927222967, -31.7507296949625, 7.357447899878025, -135.46957796812057, -1890.760492682457, -29.825446762144566, -91.071847230196, -8.110198587179184, -4.372608615085483, -56.47077634930611, -68.36454543471336, -106.07170654833317, -1669.2240118831396, -9.79656708240509, -1068.9489297159016, -24.52153565734625, -122.720966309309, -48.39837725460529, -206.74230648577213, 18.52793537825346, 13.831128135323524, -43.513077825307846, -105.22458308935165, -531.9261010140181, -227.32775655388832, -79.3846334964037, -86.07503283023834, -561.4758630394936, -53.43181551247835, -25.58806674182415, -445.7503325268626, -29.052449002861977, -973.337512537837, -40.45532001182437, -34.43345396220684, -1067.9705680459738, -729.1858754754066, -6.890376165509224, -69.17671414464712, 46.73075648397207, -1545.5199549347162, -38.93216013908386, -15.081907644867897, -62.647973984479904, -5.021151974797249, -63.5513199865818, -61.98592796549201, -1419.9749293774366, -7.351629175245762, -199.12650045752525, 3.3447896242141724, 35.18846242129803, -68.02839820086956, 10.674126908183098, -20.31938123703003, -80.71982288360596, -36.352062188088894, -37.71290175616741, -15.84538260102272, -2.174180254340172, -89.97079456597567, -8.5228486135602, -84.76767189800739, -910.0667707100511, -416.5662966966629, -28.572891905903816, -28.293127790093422, 0.5743251144886017, -90.36100649833679, -11.966896882280707, -20.077932968735695, -108.25736735761166, -401.9672512598336, 4.134242802858353, -11.35539135336876, -102.65255146473646, -169.7825152426958], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4141732384153105, "mean_inference_ms": 4.5561892046060635, "mean_action_processing_ms": 4.158580599473972, "mean_env_wait_ms": 3.2091198472777878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 15069600, "timesteps_this_iter": 131040, "agent_timesteps_total": 15069600, "timers": {"sample_time_ms": 27599.139, "sample_throughput": 4747.974, "load_time_ms": 21.6, "load_throughput": 6066684.506, "learn_time_ms": 15056.724, "learn_throughput": 8703.089, "update_time_ms": 2.446}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.629649721936177e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 215.58770649881006, "policy_loss": 0.0009650629905626091, "vf_loss": 43.11594402490978, "vf_explained_var": 4.533157553724063e-05, "kl": 0.0020814733047749326, "entropy": -0.6330522338335659, "entropy_coeff": 0.001}}}, "num_steps_sampled": 15069600, "num_agent_steps_sampled": 15069600, "num_steps_trained": 15069600, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 15069600}, "done": false, "episodes_total": 30240, "training_iteration": 115, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-40-19", "timestamp": 1691023219, "time_this_iter_s": 14.891807794570923, "time_total_s": 3541.1438167095184, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3541.1438167095184, "timesteps_since_restore": 15069600, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 13.952380952380953, "ram_util_percent": 51.599999999999994}}
{"episode_reward_max": 52.544512651860714, "episode_reward_min": -2272.1136004924774, "episode_reward_mean": -235.1188707767423, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.48418332636356, 20.14495049417019, -45.82381674647331, -147.91971464455128, -155.12693975493312, -176.62872172519565, -23.071365632116795, -181.8704663515091, -16.803074046969414, -1013.7745784521103, 45.55464372038841, -106.3277516067028, -127.45585314929485, -59.13201054930687, -13.709838330745697, -740.2104029506445, -35.233387507498264, -4.789526984095573, -340.3375872373581, -21.41199549101293, 45.44799046218395, -377.99118971824646, -143.48015728592873, -87.23142184317112, -462.2981977388263, -75.17732934653759, -890.7103936523199, -84.21866124868393, -80.77476461231709, -52.686994448304176, -1793.9910149127245, -910.4692349508405, -160.06705528497696, -79.60721883177757, -24.66517372429371, -22.44104339182377, -1246.4932981431484, -84.51782636344433, 14.73721400462091, -1245.3849404901266, -487.3308123089373, -121.5310547798872, -27.312069475650787, -83.47099301964045, -124.60573352128267, -33.432380974292755, -56.3242833763361, -1034.4381796643138, -77.99266143143177, -57.20839883387089, -200.70166463032365, -584.068486571312, -47.14248909801245, -53.623436495661736, -432.6893235743046, -55.53333283029497, -68.66582518815994, -28.872097238898277, -5.113372020423412, -65.02058327198029, -21.270599491894245, -1082.4956406205893, -19.81305705010891, -1193.1646047830582, -831.059792034328, -103.38472074270248, -34.164936788380146, -43.90529029816389, -108.668411873281, -113.74661024659872, -77.59957447648048, -15.233930226415396, -452.77648866176605, -37.9981242492795, 34.915577098727226, -31.017161909490824, -18.223627254366875, -67.69955709576607, -12.631383404135704, -853.3703362047672, -27.856747314333916, -37.31445001810789, -10.645264200866222, -68.34498730301857, -4.305766761302948, -70.66808203607798, -69.62623062729836, -5.644685044884682, -57.232070073485374, -1289.2364944852889, -76.36810576915741, -37.98417477309704, -168.31194569170475, -8.713841829448938, -29.808258526027203, 23.321504168212414, -1012.1565677151084, -989.5258845165372, -71.33770403265953, -610.034295976162, -158.26692721247673, 14.566457979381084, -95.46617569774389, -7.785427674651146, -31.338030692189932, -115.77067975699902, -317.33733609318733, -240.7245015501976, -95.94688107818365, -668.4532840996981, -63.619668424129486, -595.8807514309883, -13.72880107164383, -211.27123415470123, -187.43601832538843, -147.43964564800262, 35.4502984136343, -614.5365056693554, -310.51090398430824, -622.199990555644, -112.68577375076711, -1423.9669197052717, -336.03953847661614, -64.06955142319202, -616.9460864439607, -65.78695826232433, -93.69551188498735, -103.09835386276245, -83.25119300186634, 42.17038552835584, -196.67204542458057, 34.36225900799036, -37.84546023607254, -1268.3986826241016, -25.30530673265457, -108.19405368715525, -125.9038553237915, -52.40694607049227, -1077.182562738657, -56.38708084821701, 5.990723341703415, -47.64020171016455, -50.92256369441748, 5.1721354722976685, -48.98852148652077, -55.89615240693092, -105.77206888794899, -33.51541732251644, 4.737157359719276, -54.806734666228294, 16.69052429497242, -80.98701275885105, -1248.312473744154, -33.276850592345, -499.1660662740469, -95.60922238230705, -49.27544895559549, -47.54434176534414, -38.950301110744476, -25.605944983661175, -781.3945975154638, -305.37629763036966, 31.69848996400833, 30.42201766371727, -1147.149886265397, 13.540003158152103, -180.99875013530254, -8.80071845650673, -53.4376265257597, -21.685467435978353, -82.41019710153341, -52.528778195381165, -141.10015923529863, -46.08325178921223, 8.683446027338505, -78.46192203462124, 36.01485062390566, 4.762702740728855, -277.5215091481805, -322.9437980055809, -125.99802334606647, -58.72935000061989, 35.7636555545032, -117.16462713479996, -19.43603579699993, -20.48344373703003, -36.788940623402596, -1169.3095520064235, -37.604047022759914, -90.26330726593733, -52.42246602475643, -38.84222936630249, -1047.952163234353, -18.715127617120743, -40.1804837025702, -2272.1136004924774, -82.12527885288, 4.52835051715374, -74.76674496382475, -78.78011848032475, -22.458432964980602, -2.1394215673208237, -82.76643853634596, -724.4874554127455, -1222.3149633258581, -90.077652618289, -34.104644156992435, 20.703561916947365, -93.68582151830196, -531.2531392127275, -41.8733167052269, -19.17916315793991, -24.762299723923206, -82.53629801422358, -867.8235703408718, 34.033689776435494, -0.13600356876850128, -1161.503578901291, 52.544512651860714, -42.09109650552273, -2.831887762993574, -1179.4993322491646, -90.5989228785038, -19.419941164553165, -26.379530012607574, -101.80570548772812, -49.43034974858165, -12.333252362906933, -1280.863841459155, -49.00247969478369, -28.577902272343636, -295.844675809145, -88.60667960345745, 39.57532741129398, -1603.3709661960602, -38.75279480218887, -105.92512525618076, 16.9934895709157, -169.11619409918785, -406.8446905761957, -14.918555274605751, -155.9965826496482, -23.04400278441608, -19.988531544804573, -22.1859645023942, -879.4782678633928, -84.16767680644989, -259.84401032701135, -31.725879907608032, 20.74536394327879, -60.07218810915947, 7.326364737004042, -10.830176211893559, 6.022199749946594, -6.713371478021145, 0.9235376045107841, -110.66346940398216, 0.14092419855296612, -7.800686523318291, -4.210437074303627, -11.555347621440887, -422.5650531426072, -15.808134362101555, -243.39415752887726, 6.9318710416555405, 10.58990177884698, -581.584451302886, -855.8825851678848, -36.78354352712631, -40.275460317730904, -864.7350412756205, -348.95734894648194, 39.075971841812134, -507.4122158661485, -351.1305421292782, -61.434517949819565, -71.19748770445585, -14.458963349461555, -72.3038834258914, -335.69989085942507, -23.19491944462061, -4.356981262564659, -483.15842048078775, -52.38477232307196, -49.2112828604877, -1536.8105603605509, -84.73315630853176, -30.475594371557236, -58.3742348998785, -128.44009947031736, -811.4940434284508, 46.11268971115351, -1891.4581705927849, -1029.6007872074842, -395.4341818243265, -88.45528803020716, -84.9501700848341, -207.74342834949493, -51.632811203598976, -9.087894573807716, -1096.5073308050632, -891.65911655128, -35.15244796127081, -77.14881191402674, 35.32575023174286, 34.010593473911285, -246.02239522337914, -464.47473169490695, -35.632379189133644, -48.892767399549484, -1022.4807202890515, 14.000923171639442, 1.5960747599601746, -17.62167003750801, -39.379916002973914, -71.42787591554224, -143.36447301506996, -32.856338411569595, -150.22326624393463, -32.45689141377807, -173.48152704536915, -281.3787090331316, -36.225685462355614, -9.201840415596962, -132.45938497036695, -472.1547399908304, -114.56949589401484, -235.55004140734673, -410.21315882354975, -47.29370857030153, -444.40478184074163, -80.99812381714582, -44.85961057245731, -19.457445070147514, -61.194084748625755, -35.25437320023775, -40.22457481175661, -43.524043664336205, -40.42895036935806, -820.6093237549067, -103.54408638179302, -194.52398674190044, -64.09193220734596, -37.96497260034084, -37.52526231855154, -11.422964150086045, -32.339332178235054, -27.08290059491992, -664.6866762414575, -1611.2357518151402, -1077.336884021759, -1192.8611232489347, -800.5630622655153, -12.782960459589958, -828.5285232141614, 0.9288807287812233, 1.9362679198384285, -10.680030174553394, -46.79734741151333, -64.49558274447918, 24.297043353319168, 17.63631097972393, -24.154731586575508, -44.992019053548574, -44.243353858590126, -1024.1070002652705, 43.26256042718887, 46.5942719578743, -85.72680780291557, -53.530890703201294, -15.597203515470028, -52.368066146969795, -105.2878827303648, -44.90538563579321, -27.011654086411, -1178.661080673337, -60.68953695893288, -61.039332166314125, -63.38932201266289, -1371.3683116137981, -1628.222575508058, -207.38077384978533, -146.66693744808435, -6.220104351639748, -126.99750682711601, -1163.2697919160128, -62.97795990854502, 49.433474987745285, -1071.3140291422606, -55.043157525360584, -1009.931057266891, 9.266490191221237, -105.69809647649527, -128.62201242893934, -43.557298596948385, -60.26718307286501, -50.32047405093908, -31.63908913731575, -155.90038713812828, 12.906073488295078, -21.030853912234306, -338.6893261000514, -54.77373962942511, 0.4630279317498207, -95.51258572936058, -67.00226518511772, -49.97247335314751, -208.45853012800217, -121.3293389827013, 2.6289427541196346, -78.12503980100155, 0.05042227357625961, -0.2278897911310196, -1027.1202208846807, -22.703694984316826, -98.64961122721434, 26.755566097795963, -36.415363132953644, -178.25963796675205, -42.50601816177368, -26.710259579122066, 8.447737395763397, 19.807016134262085, -1305.339383944869, 1.334059089422226, -642.2444190680981, 8.360080696642399, -284.9838961958885, -51.597675904631615, -57.70071171224117, -48.268157325685024, -168.52315311133862, -254.65510138869286, -276.8083386272192, -744.0748252421618, -1699.2694684490561, -88.71826161444187, -25.177267782390118, -71.42094695568085, -25.90227695554495, -47.21614572405815, -119.24364124238491, 10.257236044853926, 1.8450427502393723, -45.48734062165022, -48.36236102133989, -1566.5343665257096, -83.09530608355999, -400.0186259150505, -1672.0827549919486, -39.66056928783655, -109.41469894349575, -220.798400612548, -87.97914247959852, -328.5037285685539, -1152.500199407339, -194.53468627855182, -1029.376835823059, -110.1560388058424, -93.15330712497234, -51.270337626338005, -38.836632803082466, -16.623339921236038, -107.29826632142067, 2.4484191983938217, -70.35159900039434, 0.45149457454681396, -44.435224652290344, -616.050718024373, -110.41606059204787, -1255.6858710348606, -153.00015538185835, -129.2732258439064, -42.32878144085407, -75.50956286489964, -35.23570614308119, -94.60795097611845, 10.623398192226887, 32.37917883694172, -169.60464327037334], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427768323769243, "mean_inference_ms": 4.565002631511927, "mean_action_processing_ms": 4.21448587082387, "mean_env_wait_ms": 3.239356242244704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 15200640, "timesteps_this_iter": 131040, "agent_timesteps_total": 15200640, "timers": {"sample_time_ms": 30001.486, "sample_throughput": 4367.784, "load_time_ms": 23.348, "load_throughput": 5612466.99, "learn_time_ms": 15057.217, "learn_throughput": 8702.803, "update_time_ms": 2.453}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.8148248609680886e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 226.11173315966047, "policy_loss": -0.006621122346806871, "vf_loss": 45.22833148040225, "vf_explained_var": -0.009571338426254983, "kl": 0.0023629188100101365, "entropy": -0.6371268968641972, "entropy_coeff": 0.001}}}, "num_steps_sampled": 15200640, "num_agent_steps_sampled": 15200640, "num_steps_trained": 15200640, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 15200640}, "done": false, "episodes_total": 30720, "training_iteration": 116, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-40-58", "timestamp": 1691023258, "time_this_iter_s": 39.53002452850342, "time_total_s": 3580.673841238022, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3580.673841238022, "timesteps_since_restore": 15200640, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 44.442857142857136, "ram_util_percent": 51.098214285714285}}
{"episode_reward_max": 49.433474987745285, "episode_reward_min": -1699.2694684490561, "episode_reward_mean": -244.2738773218915, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1628.222575508058, -207.38077384978533, -146.66693744808435, -6.220104351639748, -126.99750682711601, -1163.2697919160128, -62.97795990854502, 49.433474987745285, -1071.3140291422606, -55.043157525360584, -1009.931057266891, 9.266490191221237, -105.69809647649527, -128.62201242893934, -43.557298596948385, -60.26718307286501, -50.32047405093908, -31.63908913731575, -155.90038713812828, 12.906073488295078, -21.030853912234306, -338.6893261000514, -54.77373962942511, 0.4630279317498207, -95.51258572936058, -67.00226518511772, -49.97247335314751, -208.45853012800217, -121.3293389827013, 2.6289427541196346, -78.12503980100155, 0.05042227357625961, -0.2278897911310196, -1027.1202208846807, -22.703694984316826, -98.64961122721434, 26.755566097795963, -36.415363132953644, -178.25963796675205, -42.50601816177368, -26.710259579122066, 8.447737395763397, 19.807016134262085, -1305.339383944869, 1.334059089422226, -642.2444190680981, 8.360080696642399, -284.9838961958885, -51.597675904631615, -57.70071171224117, -48.268157325685024, -168.52315311133862, -254.65510138869286, -276.8083386272192, -744.0748252421618, -1699.2694684490561, -88.71826161444187, -25.177267782390118, -71.42094695568085, -25.90227695554495, -47.21614572405815, -119.24364124238491, 10.257236044853926, 1.8450427502393723, -45.48734062165022, -48.36236102133989, -1566.5343665257096, -83.09530608355999, -400.0186259150505, -1672.0827549919486, -39.66056928783655, -109.41469894349575, -220.798400612548, -87.97914247959852, -328.5037285685539, -1152.500199407339, -194.53468627855182, -1029.376835823059, -110.1560388058424, -93.15330712497234, -51.270337626338005, -38.836632803082466, -16.623339921236038, -107.29826632142067, 2.4484191983938217, -70.35159900039434, 0.45149457454681396, -44.435224652290344, -616.050718024373, -110.41606059204787, -1255.6858710348606, -153.00015538185835, -129.2732258439064, -42.32878144085407, -75.50956286489964, -35.23570614308119, -94.60795097611845, 10.623398192226887, 32.37917883694172, -169.60464327037334], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414304055183828, "mean_inference_ms": 4.556460555466109, "mean_action_processing_ms": 4.158849323986882, "mean_env_wait_ms": 3.2091393396283934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 15331680, "timesteps_this_iter": 131040, "agent_timesteps_total": 15331680, "timers": {"sample_time_ms": 27602.466, "sample_throughput": 4747.402, "load_time_ms": 21.694, "load_throughput": 6040355.331, "learn_time_ms": 15083.045, "learn_throughput": 8687.901, "update_time_ms": 2.429}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4074124304840443e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 209.36502390414728, "policy_loss": 0.004881561557537304, "vf_loss": 41.86748663584391, "vf_explained_var": 0.0005335479867928344, "kl": 0.001932100864902546, "entropy": -0.6372688555802923, "entropy_coeff": 0.001}}}, "num_steps_sampled": 15331680, "num_agent_steps_sampled": 15331680, "num_steps_trained": 15331680, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 15331680}, "done": false, "episodes_total": 30720, "training_iteration": 117, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-41-14", "timestamp": 1691023274, "time_this_iter_s": 15.42490291595459, "time_total_s": 3596.0987441539764, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3596.0987441539764, "timesteps_since_restore": 15331680, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 14.840909090909093, "ram_util_percent": 51.58636363636363}}
{"episode_reward_max": 56.386537700891495, "episode_reward_min": -2473.585999324918, "episode_reward_mean": -239.99841376927603, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.23123857751488686, -37.846147641539574, -429.9037443101406, -59.29089270532131, -67.8079914599657, 40.90930138528347, -535.969814196229, -71.29854889214039, -22.307012781500816, -23.19339213706553, -200.89410535246134, -66.70220150053501, -7.441407658159733, -117.28223054111004, 56.386537700891495, -11.572032801806927, 7.800932452082634, -403.5668278634548, 16.106656707823277, 5.821130581200123, -19.427136205136776, -58.68415167182684, -47.52745596691966, 9.852543357759714, -880.4759397655725, -185.1854114085436, -33.072375144809484, -78.41126507520676, 43.17279568314552, -25.12816595286131, 54.668402656912804, -42.71453282237053, -208.96980847418308, -123.7583853751421, -410.3546318113804, -1396.7866920232773, -57.18141159415245, -3.887769415974617, -232.05778393149376, -51.75754576176405, 2.768109954893589, -109.76339720189571, 17.237201891839504, -6.333556264638901, -784.885974407196, -25.433382771909237, -122.81616070866585, -87.48888481408358, -100.71654616296291, 29.972232323139906, -107.44963990151882, -122.93305687792599, -278.87435360997915, -96.68347992002964, 11.576896868646145, -37.51547780632973, 27.53478779643774, -72.87056900560856, -315.31603218615055, -42.75472651235759, 15.160784751176834, -206.19806150346994, -6.607703521847725, -989.6142875701189, -96.42847846448421, -6.28436653316021, -149.610395103693, 29.47342725098133, -1226.5374560058117, -911.6655951365829, 16.67359870672226, -54.30819056928158, -177.7844192571938, -72.92136920243502, 23.706197207793593, -156.80934944748878, -160.4489327929914, -148.8527501821518, -35.872850466519594, -35.65802721679211, -11.623676180839539, -788.8095333911479, -77.0780485868454, -89.11817395873368, -172.05576720833778, -12.617180675268173, -1012.660337164998, -11.889076679944992, -1166.1307743042707, -31.111062563955784, -146.40592020750046, -24.84235069900751, 4.230396881699562, -780.5611492097378, -198.60590372234583, -173.4591237604618, -21.333747878670692, -148.27978859841824, -755.1403204128146, -73.40391778945923, -59.556140415370464, -1376.7717827577144, -15.144453004002571, -0.6630616299808025, -446.234011515975, -650.5160630494356, -7.767872802913189, -12.848426714539528, -446.38681741803885, -32.602552853524685, 34.258558847010136, -3.708502234891057, -395.0471580773592, -3.3741633892059326, -521.0085899829865, -131.9706942588091, 1.4108379408717155, -1131.0357543639839, 21.867046158760786, 0.9242020770907402, -94.09824027121067, -45.03685586154461, -69.4993156939745, -121.21904473006725, -31.899119090288877, -110.05717812478542, -649.9377034455538, -15.164606720209122, 30.988647669553757, -27.015920132398605, -73.70779740065336, -209.84167824685574, -6.64252533018589, -36.744440861046314, -68.62330144643784, -570.5202489942312, -65.19943825155497, -50.96695803105831, -44.15987750887871, 41.538438871502876, -340.7109636813402, -40.30131197441369, -54.480772495269775, -25.090350173413754, -85.22981655597687, -646.4515710473061, -64.22780723124743, 16.39159618318081, -13.648429311811924, -0.8436527922749519, -69.47108145430684, -1456.9087956547737, -80.46270213648677, -73.62248332053423, 48.82178106158972, -389.0544498451054, -334.4122224599123, -87.29920640587807, -1190.7214159220457, 5.534805931150913, -13.397828370332718, -28.55907168239355, -2473.585999324918, -48.474265202879906, 14.786992534995079, -98.99406544864178, -651.9876775443554, -745.8011661022902, -219.5133237540722, 4.758810173720121, -100.2656184360385, -107.53408647328615, -30.987120136618614, -159.1493579223752, -108.58356124162674, -4.633314684033394, 35.18285962194204, -147.7931020706892, 38.37537285685539, -65.10163640975952, 0.8637202382087708, -450.41606029868126, -496.304079644382, -55.98296804726124, -484.214068159461, -333.67792920023203, 24.91736338287592, -1393.1234037280083, -1099.12471421808, -62.79997153580189, -120.42365239188075, 19.797665670514107, -22.355969980359077, -38.35122265666723, -119.75136253237724, -269.4039743989706, -399.1464291661978, -10.576027914881706, -32.315940245985985, -59.870399583131075, -178.3569097071886, -42.21410019695759, -628.5984921008348, -306.7403563335538, -1160.9253698289394, -58.51167411915958, 40.92990990355611, -176.8000464439392, -104.58129251003265, -532.8912532255054, -79.63548167049885, -0.9289248809218407, -795.9153155237436, -61.78756767511368, 8.804770521819592, -121.88430931791663, -25.357776403427124, -175.0362283885479, -116.094363540411, -128.5252407938242, -62.64822107553482, -28.89940372109413, -113.09926125407219, -561.7214375734329, -16.658214509487152, -46.9477668851614, -370.5174558162689, -1238.718226954341, -87.75802664458752, -1028.3172879498452, -1644.3660866618156, -67.50069654732943, -789.7700965180993, -155.18406830728054, -72.82228975743055, -48.406497091054916, -44.765882670879364, -31.79391422122717, -48.44896860420704, -75.42729163914919, -14.002831064164639, -121.16147351264954, 5.7404602244496346, -70.3470811098814, -60.86401769518852, -802.2947427928448, -1152.6948215961456, -1065.0108216255903, -568.5517407488078, -47.87875625491142, -931.9965560883284, -64.38289663568139, -39.8464727178216, -1459.6934804469347, -119.94788920879364, -64.14335185289383, -2028.777708761394, -43.76529523730278, -23.658484645187855, -33.34409756958485, -115.11393634974957, -455.42901031672955, -0.47379907965660095, -28.34518553316593, -1411.6038160324097, 32.52710671722889, 7.091878917068243, -27.609090074896812, -150.31708861887455, -171.72625789791346, -869.6787965670228, -21.956977374851704, -1475.8118984550238, -525.9928540587425, 24.959359131753445, -4.396140303462744, -19.363133549690247, -110.91461718082428, -42.1236003190279, -60.38518879562616, -109.00054350495338, -10.329872570931911, -91.41107630729675, -450.36260472238064, -53.7450819760561, -460.236326739192, -81.40016293525696, -62.222209081053734, -645.5323384702206, 29.208768777549267, -307.8305005133152, -68.7660425901413, -72.81733473390341, -8.71135751530528, -66.03705675899982, -32.25606061518192, -44.75572398304939, 16.971040941774845, -13.868657074868679, -2.5569935142993927, -60.197142004966736, -7.043128825724125, 28.138737708330154, -1338.3207533881068, -21.364060804247856, 28.724982768297195, -63.297374442219734, -457.81425689160824, 5.255002602934837, -96.59628660231829, -153.43703676760197, -389.2519931420684, -729.1871705949306, -150.58459151536226, 8.95839823782444, -22.777866825461388, -12.097146719694138, -71.83454030752182, -26.95061295852065, -195.19995023310184, -408.74007591605186, 6.287111163139343, -38.013412952423096, -644.2118263840675, -738.6989149153233, -162.67096841335297, -27.320990219712257, -1534.9844843409956, -5.239247515797615, -1715.3825232349336, -71.16939355432987, -96.40688648819923, -1088.160844117403, -63.78305387496948, -222.69796166568995, -85.97262933850288, -25.5519556440413, 2.641179323196411, -125.98562047630548, -16.505663201212883, -13.342042066156864, 0.7683056499809027, -28.626369044184685, -16.87258742749691, -27.357652619481087, -458.60170274972916, -71.39621640741825, -574.3505030870438, -686.2876736670732, -162.32279800996184, -877.3854000717402, -255.60179860889912, 1.9593458324670792, -188.5858609378338, 25.87442274391651, -50.378354124724865, 34.195872535929084, -89.67366161756217, -231.63998386263847, -1097.3173049986362, 10.717799633741379, -48.06383137404919, 25.93324840441346, -177.2508945837617, 1.9880785197019577, -992.2742559313774, 41.333354875445366, -22.00709570199251, 1.3025590106844902, -35.94229916483164, -35.6892269551754, -89.63808792829514, -27.669712983071804, -98.6200207695365, -139.6927232593298, -23.362313218414783, -411.3907433450222, -20.799187690019608, -22.05930170416832, -365.20238530635834, 39.53400453552604, -712.88341550529, -29.69655293226242, -396.8112144768238, -3.908710826188326, -1342.0348124727607, -62.66791720688343, -112.93435303866863, -14.643251061439514, 14.909444443881512, -41.46683822572231, -1921.5551667064428, -33.84475167095661, -89.15403437614441, -885.0732003450394, -1198.772810805589, -224.58181649446487, -94.57548074424267, -53.47966955602169, -23.51713030040264, -1.1765928715467453, 0.5467747151851654, -90.61504058539867, -19.668828889727592, -226.05702796578407, -109.58384758979082, -941.7738511040807, -60.8299867734313, 5.580476086586714, -779.8571021407843, -63.84480434656143, -40.81111501902342, 2.995437666773796, 6.0520878210663795, -1147.4996328391135, -74.942208327353, -1.756191372871399, -13.813381925225258, -12.619590444490314, -20.202284179627895, 2.9707829654216766, -175.6538286432624, -43.70347514003515, -50.50540956109762, -637.7116160467267, 29.200989976525307, -140.3083173185587, 39.64723119139671, -138.79580192640424, -78.98317028582096, -48.67305709421635, -101.44368302822113, 19.89921221882105, -14.564713701605797, -1960.16374925524, 12.86533529497683, -109.65160859376192, -51.51410461589694, -553.0582151710987, -92.36036827135831, -4.634725999087095, -26.189225535839796, -1100.140312705189, -115.78465416282415, -568.8621579706669, 11.119612902402878, -134.23474553972483, -1138.5145305991173, -1740.8622250258923, -0.5556245669722557, -55.27230801433325, -52.18957630544901, -52.16275514662266, -1084.5730495154858, -15.381099566817284, -345.8229636531323, -38.22304944694042, -3.4379284605383873, -5.682899691164494, -72.27025034278631, -480.6627272218466, -48.42040328681469, -888.7281128019094, -85.3238447457552, -1523.3364611566067, -1009.6383788436651, -58.833665899932384, 26.97856328636408, -15.93912461400032, 13.98372895270586, -323.27881172299385, 44.739127062261105, -10.69959757477045, -71.3891543187201, -86.17466215789318, -60.72085488960147, -1057.6475085169077, -579.0248502343893, -1181.5401193350554, -30.400056958198547], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427924407480041, "mean_inference_ms": 4.564623078340613, "mean_action_processing_ms": 4.214396381478866, "mean_env_wait_ms": 3.239329078531745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 15462720, "timesteps_this_iter": 131040, "agent_timesteps_total": 15462720, "timers": {"sample_time_ms": 30042.136, "sample_throughput": 4361.874, "load_time_ms": 23.322, "load_throughput": 5618652.007, "learn_time_ms": 15092.249, "learn_throughput": 8682.603, "update_time_ms": 2.421}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2037062152420221e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 221.33840762093777, "policy_loss": -3.9074764735996505e-05, "vf_loss": 44.26708671269024, "vf_explained_var": 0.009026544922996165, "kl": 0.002152561758737784, "entropy": -0.6344316682935188, "entropy_coeff": 0.001}}}, "num_steps_sampled": 15462720, "num_agent_steps_sampled": 15462720, "num_steps_trained": 15462720, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 15462720}, "done": false, "episodes_total": 31200, "training_iteration": 118, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-41-53", "timestamp": 1691023313, "time_this_iter_s": 39.34017872810364, "time_total_s": 3635.43892288208, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3635.43892288208, "timesteps_since_restore": 15462720, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 44.43571428571429, "ram_util_percent": 51.66428571428571}}
{"episode_reward_max": 44.739127062261105, "episode_reward_min": -1960.16374925524, "episode_reward_mean": -288.39273339181204, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.53400453552604, -712.88341550529, -29.69655293226242, -396.8112144768238, -3.908710826188326, -1342.0348124727607, -62.66791720688343, -112.93435303866863, -14.643251061439514, 14.909444443881512, -41.46683822572231, -1921.5551667064428, -33.84475167095661, -89.15403437614441, -885.0732003450394, -1198.772810805589, -224.58181649446487, -94.57548074424267, -53.47966955602169, -23.51713030040264, -1.1765928715467453, 0.5467747151851654, -90.61504058539867, -19.668828889727592, -226.05702796578407, -109.58384758979082, -941.7738511040807, -60.8299867734313, 5.580476086586714, -779.8571021407843, -63.84480434656143, -40.81111501902342, 2.995437666773796, 6.0520878210663795, -1147.4996328391135, -74.942208327353, -1.756191372871399, -13.813381925225258, -12.619590444490314, -20.202284179627895, 2.9707829654216766, -175.6538286432624, -43.70347514003515, -50.50540956109762, -637.7116160467267, 29.200989976525307, -140.3083173185587, 39.64723119139671, -138.79580192640424, -78.98317028582096, -48.67305709421635, -101.44368302822113, 19.89921221882105, -14.564713701605797, -1960.16374925524, 12.86533529497683, -109.65160859376192, -51.51410461589694, -553.0582151710987, -92.36036827135831, -4.634725999087095, -26.189225535839796, -1100.140312705189, -115.78465416282415, -568.8621579706669, 11.119612902402878, -134.23474553972483, -1138.5145305991173, -1740.8622250258923, -0.5556245669722557, -55.27230801433325, -52.18957630544901, -52.16275514662266, -1084.5730495154858, -15.381099566817284, -345.8229636531323, -38.22304944694042, -3.4379284605383873, -5.682899691164494, -72.27025034278631, -480.6627272218466, -48.42040328681469, -888.7281128019094, -85.3238447457552, -1523.3364611566067, -1009.6383788436651, -58.833665899932384, 26.97856328636408, -15.93912461400032, 13.98372895270586, -323.27881172299385, 44.739127062261105, -10.69959757477045, -71.3891543187201, -86.17466215789318, -60.72085488960147, -1057.6475085169077, -579.0248502343893, -1181.5401193350554, -30.400056958198547], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414593883305318, "mean_inference_ms": 4.556173466512364, "mean_action_processing_ms": 4.159103751569928, "mean_env_wait_ms": 3.2093046742710136, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 15593760, "timesteps_this_iter": 131040, "agent_timesteps_total": 15593760, "timers": {"sample_time_ms": 27622.009, "sample_throughput": 4744.043, "load_time_ms": 21.37, "load_throughput": 6131849.626, "learn_time_ms": 15086.082, "learn_throughput": 8686.152, "update_time_ms": 2.42}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.018531076210111e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 220.66517594484725, "policy_loss": -0.003517758962757771, "vf_loss": 44.13591757811953, "vf_explained_var": 0.0030916939926831097, "kl": 0.002063142775397708, "entropy": -0.6361890300627677, "entropy_coeff": 0.001}}}, "num_steps_sampled": 15593760, "num_agent_steps_sampled": 15593760, "num_steps_trained": 15593760, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 15593760}, "done": false, "episodes_total": 31200, "training_iteration": 119, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-42-08", "timestamp": 1691023328, "time_this_iter_s": 15.142712593078613, "time_total_s": 3650.5816354751587, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3650.5816354751587, "timesteps_since_restore": 15593760, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 13.91818181818182, "ram_util_percent": 51.66363636363636}}
{"evaluation": {"episode_reward_max": -151.34466093033552, "episode_reward_min": -151.34466093033552, "episode_reward_mean": -151.34466093033552, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.34466093033552], "episode_lengths": [500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902825731027134, "mean_inference_ms": 3.865901030833367, "mean_action_processing_ms": 1.2385071634372657, "mean_env_wait_ms": 199.33005399024145, "mean_env_render_ms": 3.091726201443097}, "off_policy_estimator": {}, "timesteps_this_iter": 0}, "episode_reward_max": 57.18731891363859, "episode_reward_min": -2470.701230827719, "episode_reward_mean": -243.7030495442741, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1476.232443958521, -46.63147276267409, -208.6179265230894, -0.7603009901940823, 9.546298757195473, 4.653490409255028, -1545.3811678215861, 5.8070986568927765, 9.671355355530977, -132.0873880982399, -7.672210708260536, -57.879635602235794, -76.49120670557022, -1422.451845139265, -159.2112706899643, -579.0669822096825, -13.302622089162469, -15.568247362971306, -749.3155086822808, -32.65788023173809, -717.868380561471, -762.8806331157684, -235.3380002528429, -135.393780015409, -95.7908471673727, -15.33153573423624, -244.9550890251994, -19.63514520972967, -132.18183936178684, -91.18371142446995, -107.57165595144033, -233.36386127769947, -52.272439032793045, -116.71499858796597, -10.338851269334555, -146.6932720914483, 14.653777241706848, -5.509523168206215, 30.037312656641006, -64.44579817354679, -33.089607536792755, -1284.0447085052729, -842.2572192400694, -6.57959583774209, -62.554115027189255, -179.3229811899364, -144.93046187609434, -132.51231428980827, -197.27533316239715, -446.2507730573416, -57.548459738492966, -71.06344602257013, -2.4777407199144363, -1115.4986146669835, -99.06852078437805, -183.64739294350147, 3.903943821787834, -92.2770370580256, -1.635171003639698, 38.224489726126194, -96.03904521465302, -232.3947007060051, -18.832877695560455, -26.812485091388226, 18.10614202916622, 27.88388430327177, -28.21756136417389, -2116.696856915951, -57.70892820134759, -225.035313796252, -47.88364714384079, 0.8433019369840622, -237.33348156511784, -16.50181156396866, -607.4515205584466, -161.07714009284973, -657.815822025761, -51.244163528084755, -78.93174281716347, 37.50169779360294, -720.5214190036058, -54.09654322266579, -98.96692493185401, 17.24154813028872, -11.507385671138763, -611.5074474662542, -611.4698534458876, -30.89553626999259, -72.09822072088718, -44.02692485973239, -139.35676535218954, -13.534560516476631, -11.555310018360615, -82.06898023188114, -88.60295683890581, -38.829616248607635, -9.12164930999279, -130.8705589622259, -374.3219118863344, -109.35360623896122, -1165.1029594317079, -179.00693179666996, 0.3552762418985367, -592.3050637021661, -0.0608329251408577, -1012.8892144113779, -1021.4691184461117, 39.0380766838789, -1064.6605718284845, -49.44482161849737, 16.868772514164448, -0.34257613122463226, -101.5580953527242, -32.967156782746315, 34.82448163628578, -78.25979349017143, -519.8058988153934, -564.3109203204513, -1809.4270507842302, -23.773911769501865, -1451.0788663476706, -855.3842057287693, -88.31889875978231, -6.500640239566565, -54.804440557956696, -1308.5129719525576, -170.8198183476925, -90.55314241349697, 10.068088099360466, -25.222389386966825, -27.326205357909203, -15.230417266488075, -35.51895344257355, -22.733852790668607, -59.08151027560234, -79.65548411011696, 30.860668927431107, -1496.263729736209, -44.713218331336975, 22.346147283911705, -1188.612417280674, -175.50291664898396, 20.515398018062115, -55.30385689623654, -14.70509959757328, -37.182404827326536, -11.620165064930916, -12.201896987855434, 9.410913221538067, -751.3272150680423, -24.764178909361362, -22.631996043026447, -72.41939033567905, -840.1531747449189, 9.983440993353724, -129.14572569169104, -647.1879653036594, -31.95221184939146, 24.483006116002798, 26.966704927384853, 13.07672955468297, 28.39390577375889, 22.57804185897112, -67.58658187836409, -25.23026479780674, -131.29943220317364, -302.0293522924185, -159.65782529115677, -58.445039197802544, -26.95497889816761, -16.266865342855453, 38.23432894051075, 20.647147927433252, 13.299150735139847, -54.83966551721096, -42.38065619952977, -11.185409761965275, -28.926455354318023, -32.054095666855574, -166.17517748475075, -7.841927800327539, 17.869560584425926, -700.8440090455115, -33.954887099564075, -25.74761112034321, -101.39776860177517, -360.13549552857876, -44.97184430062771, -1400.531005114317, -1134.8617173060775, -373.19338558614254, -36.567674435675144, -24.05861046910286, -1491.4085610955954, -531.3391479589045, -30.992821216583252, -46.41496925055981, -834.9825304746628, -37.09399810433388, -1075.8713063299656, -44.92155349999666, -6.8322814255952835, -33.889265298843384, -113.17761039733887, 20.771589562296867, -843.8140293210745, -108.99202017486095, -257.4722959846258, -13.57679532468319, -35.39505223929882, -768.3905248045921, -48.94206392765045, -37.54249395430088, -76.6578952819109, -42.194145172834396, -18.568398237228394, -20.43730753660202, -11.907667325809598, -58.64415416121483, -13.815567510202527, -1192.6048392876983, -333.831238463521, -63.10241489112377, -216.38010503351688, -64.91254214942455, -889.5372256562114, -91.82423482090235, 31.211007669568062, -11.70163730531931, -99.74304714798927, -18.662310630083084, -1659.6601040363312, -17.385393671691418, -15.737438797950745, -248.59532910585403, -70.16741316020489, -6.28137020021677, 27.273381389677525, -1235.6334883198142, -90.75220181792974, 3.3293113708496094, -2470.701230827719, -47.660732224583626, -232.22371457144618, -142.76390181481838, -29.20003367960453, -290.83931414037943, -24.128519490361214, -64.22201958671212, -110.05724979192019, -890.8794867601246, -436.4063530564308, -1242.4486126825213, -12.866598889231682, -1275.0327403396368, -227.90694407373667, -1162.877078190446, -10.595992848277092, -238.59153059124947, -16.320561204105616, -597.6158766597509, 9.138773564249277, -777.8904198184609, -43.67530283331871, -101.83650832250714, -1252.592736363411, -444.04992654919624, -82.9813073426485, -9.904943093657494, -55.82612024247646, -62.69132600724697, -3.9702901393175125, -452.10745710879564, -72.69123289734125, -111.33257426321507, -461.21810342371464, -41.649697333574295, -51.979888543486595, -800.5855018794537, 14.093463227152824, -21.15739856660366, -333.50751654803753, 23.01987712830305, -39.30445698276162, -20.548752933740616, -1018.059933014214, -25.13835935294628, -2050.655210778117, 17.910446502268314, -1.45213383436203, -1623.8207011669874, -1820.4993948340416, -707.5582720339298, -47.145408257842064, -83.44240591675043, -1286.9419824331999, -47.64743288606405, -97.81544569134712, -1269.0086653903127, -491.950957223773, -1217.1299214959145, -37.60275908187032, -70.25501860678196, -16.395924672484398, -38.85486418381333, -102.9161229878664, 3.235755629837513, -125.25232091546059, -31.06135495007038, -113.19499404728413, -7.719493806362152, -93.58009349368513, 22.480942346155643, 30.113131724298, -75.97330766916275, -3.0349847972393036, -44.05139631778002, -67.31713628768921, -46.62015423178673, -156.04869427531958, -459.2349521368742, -697.2409595921636, -28.95420677959919, -54.132463842630386, -18.7426944822073, -36.195402942597866, -10.072665549814701, -87.18031053990126, 2.3894091602414846, -91.91875856369734, -30.102563694119453, -15.168172359466553, -134.2426279336214, -433.0302940607071, -148.09191412478685, -75.87362714856863, -717.8657855466008, -27.874387327581644, -938.6542078405619, -55.32208667695522, -38.1765241920948, -96.90116257220507, -269.083042755723, 12.956070058047771, -721.1788011416793, -15.833847604691982, 7.8643315732479095, -3.749193549156189, -168.90898990631104, 57.18731891363859, -839.7667340487242, -103.02247329056263, -1375.0862206816673, 16.938242454081774, -106.99481618404388, -95.1344954483211, -60.41106104850769, -31.99029678851366, -163.5266700387001, -1407.997425466776, -31.229482039809227, 18.502007260918617, -29.276910580694675, -83.60769833624363, 56.891658902168274, -55.61185985803604, -18.131641678512096, -17.551555261015892, -87.69385047256947, -726.7138412445784, -509.4144966006279, 24.2072262018919, 18.27141073346138, -74.57210657373071, -1.112618237733841, -209.84829887747765, -900.9046979546547, -254.00016450881958, -114.68381942808628, -31.48003989458084, 1.8002417236566544, -134.846272662282, -1351.805602401495, -55.509545028209686, -19.996637120842934, -46.891828536987305, -79.87350322306156, -86.54290021955967, -63.39319262653589, -5.9786360412836075, 11.500225402414799, 8.920877382159233, -95.77514813840389, -28.88117314875126, -45.53042270243168, 19.59556147828698, -30.171550132334232, -16.895786829292774, -129.0705883204937, -51.49565400183201, 23.73434880003333, 8.581220332533121, -50.975507505238056, -23.119942843914032, 11.850929103791714, -8.807890743017197, -901.6211518198252, -43.19452392309904, -138.6215664744377, -64.02073735743761, -49.66163270175457, -15.27511591091752, -189.71466491371393, -1058.1188583672047, -7.662444204092026, -68.35986677743495, -18.282614827156067, -83.18434777855873, -5.946203038096428, -73.59019037336111, -1537.7354206591845, 36.781986095011234, -29.1573134213686, -11.96990168839693, -399.80009308457375, -1138.2469230294228, -12.019748397171497, -123.35634721815586, -2.950228199362755, -196.76080994307995, -69.93101471662521, -107.83832623064518, -8.571150474250317, -328.3862323015928, 20.952689290046692, -65.70961436629295, 12.495019532740116, -60.39188435673714, -38.13490284234285, -121.19876663386822, -709.3385634347796, -650.7070530354977, -104.17792011797428, -28.61155240982771, -51.869847908616066, -375.7488541640341, -45.393589556217194, -36.84311743453145, -557.4427468106151, 11.963015802204609, 3.5571415051817894, -40.125232584774494, -18.61009558290243, -86.67501405254006, -14.807777881622314, -694.9205129742622, -16.403052419424057, -675.1717017740011, 21.70477418601513, -57.98782327771187, 2.888715371489525, -768.8776436895132, -218.75858667492867, -88.0415194183588, -199.37641073018312, -55.08340938389301, -60.29547917097807, -42.935478523373604, -47.91703353822231, -50.12174828350544, -136.75913733243942, -1584.6898043900728, 16.011728769168258, -69.78102599084377, -27.95804938673973, -1049.581470683217, -895.9542644843459, -26.967756297439337, -253.45416954159737, 31.61078143119812], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429182416169995, "mean_inference_ms": 4.564652541999289, "mean_action_processing_ms": 4.2142195777163725, "mean_env_wait_ms": 3.2392220060359325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 15724800, "timesteps_this_iter": 131040, "agent_timesteps_total": 15724800, "timers": {"sample_time_ms": 30026.85, "sample_throughput": 4364.094, "load_time_ms": 23.006, "load_throughput": 5695790.775, "learn_time_ms": 15098.372, "learn_throughput": 8679.081, "update_time_ms": 2.436}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0092655381050554e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 222.288956867384, "policy_loss": 0.00361300823971078, "vf_loss": 44.45354190949471, "vf_explained_var": 0.013136950658640982, "kl": 0.002190937191770766, "entropy": -0.6373043505735295, "entropy_coeff": 0.001}}}, "num_steps_sampled": 15724800, "num_agent_steps_sampled": 15724800, "num_steps_trained": 15724800, "num_steps_trained_this_iter": 131040, "num_agent_steps_trained": 15724800}, "done": false, "episodes_total": 31680, "training_iteration": 120, "trial_id": "0f0c5_00000", "experiment_id": "efcd3ca870f949ad83fc0c145306e1f8", "date": "2023-08-03_00-42-47", "timestamp": 1691023367, "time_this_iter_s": 39.19626450538635, "time_total_s": 3689.777899980545, "pid": 237, "hostname": "7386675a1c17", "node_ip": "172.17.0.2", "config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1456, "batch_mode": "truncate_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": false, "evaluation_config": {"num_workers": 5, "num_envs_per_worker": 9, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.995, "lr": 5e-05, "train_batch_size": 65536, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "model", "custom_model_config": {"activation": "relu", "msg_features": 32, "comm_range": 2.0}, "custom_action_dist": "hom_multi_action", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "passage_env", "observation_space": null, "action_space": null, "env_config": {"world_dim": [6.0, 10.0], "dt": 0.05, "num_envs": 32, "device": "cpu", "n_agents": 5, "agent_formation": [[0.32, -0.32], [-0.32, -0.32], [0.0, 0.0], [-0.64, -0.64], [0.64, -0.64]], "placement_keepout_border": 1.0, "placement_keepout_wall": 1.5, "pos_noise_std": 0.0, "max_time_steps": 500, "communication_range": 2.0, "wall_width": 5.0, "gap_length": 2.3, "grid_px_per_m": 40, "agent_radius": 0.1, "render": false, "render_px_per_m": 160, "max_v": 1.5, "max_a": 1.0, "min_a": -1.0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": true, "record_env": "videos", "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 5, "evaluation_duration": 1, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": true, "in_evaluation": true, "evaluation_config": {"record_env": "videos", "render_env": true}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 1, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'rllib_multi_agent_demo.multi_trainer.MultiPPOTorchPolicy'>", "Dict(goal:Box(-6.0, 6.0, (5, 2), float64), pos:Box(-6.0, 6.0, (5, 2), float64), time:Box(0.0, 25.0, (5, 1), float64), vel:Box(-100000.0, 100000.0, (5, 2), float64))", "Tuple(Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64), Box(-1.5, 1.5, (2,), float64))", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4096, "shuffle_sequences": true, "num_sgd_iter": 18, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3689.777899980545, "timesteps_since_restore": 15724800, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 44.68035714285715, "ram_util_percent": 51.63928571428572}}
